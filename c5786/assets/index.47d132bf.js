(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ne(){}const Dt=l=>l;function Yt(l,e){for(const t in e)l[t]=e[t];return l}function Ul(l){return l()}function xt(){return Object.create(null)}function Ae(l){l.forEach(Ul)}function He(l){return typeof l=="function"}function pe(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let at;function We(l,e){return at||(at=document.createElement("a")),at.href=e,l===at.href}function nn(l){return Object.keys(l).length===0}function It(l,...e){if(l==null)return ne;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Le(l,e,t){l.$$.on_destroy.push(It(e,t))}function Ye(l,e,t){return l.set(t),e}function Ze(l){return l&&He(l.destroy)?l.destroy:ne}const Yl=typeof window<"u";let xl=Yl?()=>window.performance.now():()=>Date.now(),Ct=Yl?l=>requestAnimationFrame(l):ne;const Ke=new Set;function ql(l){Ke.forEach(e=>{e.c(l)||(Ke.delete(e),e.f())}),Ke.size!==0&&Ct(ql)}function Wl(l){let e;return Ke.size===0&&Ct(ql),{promise:new Promise(t=>{Ke.add(e={c:l,f:t})}),abort(){Ke.delete(e)}}}function g(l,e){l.appendChild(e)}function sn(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function rn(l,e){return g(l.head||l,e),e.sheet}function H(l,e,t){l.insertBefore(e,t||null)}function P(l){l.parentNode.removeChild(l)}function on(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function b(l){return document.createElement(l)}function ze(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function Z(l){return document.createTextNode(l)}function E(){return Z(" ")}function Ve(){return Z("")}function K(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function an(l){return function(e){return e.preventDefault(),l.call(this,e)}}function fn(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function w(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function cn(l){return Array.from(l.childNodes)}function _e(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function qt(l,e){l.value=e==null?"":e}function N(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function le(l,e,t){l.classList[t?"add":"remove"](e)}function Vl(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const gt=new Map;let pt=0;function un(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function dn(l){const e={style_element:b("style"),rules:{}};return gt.set(l,e),e}function Wt(l,e,t,n,i,s,r,o=0){const c=16.666/n;let a=`{
`;for(let k=0;k<=1;k+=c){const S=e+(t-e)*s(k);a+=k*100+`%{${r(S,1-S)}}
`}const f=a+`100% {${r(t,1-t)}}
}`,p=`__svelte_${un(f)}_${o}`,d=sn(l),{style_element:u,rules:_}=gt.get(d)||dn(d);if(!_[p]){const k=rn(d,u);_[p]=!0,k.insertRule(`@keyframes ${p} ${f}`,k.cssRules.length)}const m=l.style.animation||"";return l.style.animation=`${m?`${m}, `:""}${p} ${n}ms linear ${i}ms 1 both`,pt+=1,p}function _n(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),pt-=i,pt||gn())}function gn(){Ct(()=>{pt||(gt.forEach(l=>{const{style_element:e}=l;P(e)}),gt.clear())})}let lt;function tt(l){lt=l}function Xl(){if(!lt)throw new Error("Function called outside component initialization");return lt}function Xe(l){Xl().$$.on_destroy.push(l)}function pn(){const l=Xl();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=Vl(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function mn(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const et=[],Ne=[],dt=[],Lt=[],hn=Promise.resolve();let St=!1;function vn(){St||(St=!0,hn.then(Jl))}function je(l){dt.push(l)}function mt(l){Lt.push(l)}const bt=new Set;let ft=0;function Jl(){const l=lt;do{for(;ft<et.length;){const e=et[ft];ft++,tt(e),wn(e.$$)}for(tt(null),et.length=0,ft=0;Ne.length;)Ne.pop()();for(let e=0;e<dt.length;e+=1){const t=dt[e];bt.has(t)||(bt.add(t),t())}dt.length=0}while(et.length);for(;Lt.length;)Lt.pop()();St=!1,bt.clear(),tt(l)}function wn(l){if(l.fragment!==null){l.update(),Ae(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(je)}}let $e;function bn(){return $e||($e=Promise.resolve(),$e.then(()=>{$e=null})),$e}function yt(l,e,t){l.dispatchEvent(Vl(`${e?"intro":"outro"}${t}`))}const _t=new Set;let Re;function ve(){Re={r:0,c:[],p:Re}}function we(){Re.r||Ae(Re.c),Re=Re.p}function z(l,e){l&&l.i&&(_t.delete(l),l.i(e))}function B(l,e,t,n){if(l&&l.o){if(_t.has(l))return;_t.add(l),Re.c.push(()=>{_t.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const yn={duration:0};function Se(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,c=null;function a(){c&&_n(l,c)}function f(d,u){const _=d.b-s;return u*=Math.abs(_),{a:s,b:d.b,d:_,duration:u,start:d.start,end:d.start+u,group:d.group}}function p(d){const{delay:u=0,duration:_=300,easing:m=Dt,tick:k=ne,css:S}=i||yn,v={start:xl()+u,b:d};d||(v.group=Re,Re.r+=1),r||o?o=v:(S&&(a(),c=Wt(l,s,d,_,u,m,S)),d&&k(0,1),r=f(v,_),je(()=>yt(l,d,"start")),Wl(h=>{if(o&&h>o.start&&(r=f(o,_),o=null,yt(l,r.b,"start"),S&&(a(),c=Wt(l,s,r.b,r.duration,0,m,i.css))),r){if(h>=r.end)k(s=r.b,1-s),yt(l,r.b,"end"),o||(r.b?a():--r.group.r||Ae(r.group.c)),r=null;else if(h>=r.start){const A=h-r.start;s=r.a+r.d*m(A/r.duration),k(s,1-s)}}return!!(r||o)}))}return{run(d){He(i)?bn().then(()=>{i=i(),p(d)}):p(d)},end(){a(),r=o=null}}}const Kl=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function jt(l,e){l.d(1),e.delete(l.key)}function nt(l,e){B(l,1,1,()=>{e.delete(l.key)})}function xe(l,e,t,n,i,s,r,o,c,a,f,p){let d=l.length,u=s.length,_=d;const m={};for(;_--;)m[l[_].key]=_;const k=[],S=new Map,v=new Map;for(_=u;_--;){const y=p(i,s,_),C=t(y);let O=r.get(C);O?n&&O.p(y,e):(O=a(C,y),O.c()),S.set(C,k[_]=O),C in m&&v.set(C,Math.abs(_-m[C]))}const h=new Set,A=new Set;function T(y){z(y,1),y.m(o,f),r.set(y.key,y),f=y.first,u--}for(;d&&u;){const y=k[u-1],C=l[d-1],O=y.key,L=C.key;y===C?(f=y.first,d--,u--):S.has(L)?!r.has(O)||h.has(O)?T(y):A.has(L)?d--:v.get(O)>v.get(L)?(A.add(O),T(y)):(h.add(L),d--):(c(C,r),d--)}for(;d--;){const y=l[d];S.has(y.key)||c(y,r)}for(;u;)T(k[u-1]);return k}function ht(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function ge(l){l&&l.c()}function ue(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||je(()=>{const c=s.map(Ul).filter(He);r?r.push(...c):Ae(c),l.$$.on_mount=[]}),o.forEach(je)}function de(l,e){const t=l.$$;t.fragment!==null&&(Ae(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function kn(l,e){l.$$.dirty[0]===-1&&(et.push(l),vn(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ye(l,e,t,n,i,s,r,o=[-1]){const c=lt;tt(l);const a=l.$$={fragment:null,ctx:null,props:s,update:ne,not_equal:i,bound:xt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:xt(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};r&&r(a.root);let f=!1;if(a.ctx=t?t(l,e.props||{},(p,d,...u)=>{const _=u.length?u[0]:d;return a.ctx&&i(a.ctx[p],a.ctx[p]=_)&&(!a.skip_bound&&a.bound[p]&&a.bound[p](_),f&&kn(l,p)),d}):[],a.update(),f=!0,Ae(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){const p=cn(e.target);a.fragment&&a.fragment.l(p),p.forEach(P)}else a.fragment&&a.fragment.c();e.intro&&z(l.$$.fragment),ue(l,e.target,e.anchor,e.customElement),Jl()}tt(c)}class ke{$destroy(){de(this,1),this.$destroy=ne}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!nn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Ln(l){const e=l-1;return e*e*e+1}function Ie(l,{delay:e=0,duration:t=400,easing:n=Dt}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function vt(l,{delay:e=0,duration:t=400,easing:n=Ln}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),c=parseFloat(i.paddingBottom),a=parseFloat(i.marginTop),f=parseFloat(i.marginBottom),p=parseFloat(i.borderTopWidth),d=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*s};height: ${u*r}px;padding-top: ${u*o}px;padding-bottom: ${u*c}px;margin-top: ${u*a}px;margin-bottom: ${u*f}px;border-top-width: ${u*p}px;border-bottom-width: ${u*d}px;`}}const Je=[];function Be(l,e=ne){let t;const n=new Set;function i(o){if(pe(l,o)&&(l=o,t)){const c=!Je.length;for(const a of n)a[1](),Je.push(a,l);if(c){for(let a=0;a<Je.length;a+=2)Je[a][0](Je[a+1]);Je.length=0}}}function s(o){i(o(l))}function r(o,c=ne){const a=[o,c];return n.add(a),n.size===1&&(t=e(i)||ne),o(l),()=>{n.delete(a),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const Vt=()=>{},wt=l=>new Promise(e=>setTimeout(e,l)),Pe=(l,e,t)=>Math.min(t,Math.max(l,e)),At=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),Mt=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,c)=>Mt(o,e[c]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,c])=>!(!r.has(o)||!Mt(c,r.get(o))))}catch{}return!1},Sn=l=>{let e=!1,t=[];const n=async i=>{e=!0;let s,r,o;try{s=await l()}catch(c){o=!0,r=c}if(i.map(c=>{o&&c.reject(r),c.resolve(s)}),t.length){const c=t;return t=[],n(c)}e=!1};return()=>{const i=At();return e?t.push(i):(e=!0,n([i])),i.promise}},Mn=l=>{const e=At();return setTimeout(e.resolve,l),e},Tn=Symbol("RangeLoadList_ItemLastUpdateTime"),On=l=>{var F,X,ee,te;const e=Pe(1,((F=l.updateInterval)!=null?F:1e3)|0,36e5),t=Pe(1,((X=l.maxLimit)!=null?X:50)|0,1e3);let n=l.fLoad;const i=(ee=l.onUpdateItem)!=null?ee:Vt,s=(te=l.onUpdateItemList)!=null?te:Vt,r=!!l.isLoadEnd,o=Tn,c={},a=Be(null),f={subscribe:a.subscribe};let p=0,d=t,u=null;const _=V=>n=V,m=async(V,se)=>{try{const me=await n({offset:V,limit:se});if(typeof me.count=="number"&&Array.isArray(me.results))return me}catch{}return null},k=async(V,se)=>{const me=await m(V,se);if(me){const Y=me.results,fe=Math.max(0,me.count|0),he=u!==fe,U=Date.now();u=fe;const J=[];for(let re=0,ae=V;re<Y.length&&ae<u;re++,ae++){const Me=Y[re];c[ae]!==void 0&&Mt(c[ae],Me)||(Me[o]=U,c[ae]=Me,i(Me),J.push(Me))}J.length&&s(J),(he||J.length)&&a.set({total:u,list:c})}},S=async V=>{const se=[];se.push(k(p,d)),u!==null&&p+d<u&&r&&se.push(k(u,t)),await Promise.all(se),u!==null&&p+d<u&&r&&V&&await k(u,t)};let v=!1,h=!0,A,T=1;return(async()=>{let V=0;for(;h;){for(;h&&!v;){const se=T;if(await S(V++===0),se===T)break}A=Mn(e),await A.promise}})(),{setFLoad:_,update:()=>{T++,A&&A.resolve()},setRange:(V,se)=>{p=Math.max(0,V|0),d=Pe(0,se|0,t)},destroy:()=>h=!1,getData_r:()=>f,symbolUpdateTime:o,pause:()=>v=!0,resume:()=>v=!1}},Dn=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},Zl=(l,e,t=!0)=>{let n=!0;return(async()=>{for(t&&await wt(l);n;){try{await e()}catch(i){console.error("setIntervalAwait error",i)}await wt(l)}})(),()=>n=!1},In=()=>{let l=new Map;try{l=new Map([...new URLSearchParams(location.hash.replace(/^\#/,""))])}catch{}return l},Cn=()=>{const l={};return{on:(n,i)=>{var o;const s={event:n,cb:i},r=l[n]=(o=l[n])!=null?o:[];return r.push(s),()=>{const c=r.findIndex(a=>a===s);c!==-1&&r.splice(c,1)}},emit:(n,...i)=>{var s;return((s=l[n])!=null?s:[]).map(r=>r.cb(...i))}}},Ql=(l,e="file-")=>{const t=document.createElement("a");t.href=l;const n=e+t.pathname.split(/[^a-zA-Z0-9\.\-_]/).pop();t.download=n,t.target="blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},Tt=l=>Ql(l,"image-"),Et=Be(null),$l=l=>{var e;Et.set(l),g_Api.setHeader("x-username",(e=l==null?void 0:l.username)!=null?e:void 0)},ct=(l,e)=>{const{subscribe:t,set:n,update:i}=Be(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},jn=(l,e)=>{const{subscribe:t,set:n,update:i}=Be(l);return[{subscribe:t},i]},An=l=>parseInt(l.id);function En(l,e){const t={},n={...e};Object.assign(t,{appConfig:n});const i=Cn();Object.assign(t,{events:i});const s=[],r=j=>s.push(j);Object.assign(t,{destroy:()=>s.map(j=>j())});const c=l,[a]=ct(c),[f,p]=ct(null);let d=0;const[u,_]=ct(d),m=Sn(g_Api.operatorSelf_GetOnlineInfo),k=async()=>{_(++d);const j=await m();return j&&p(j),_(--d),j};Object.assign(t,{operatorSelf_r:a,operatorSelfLastOnlineInfo_r:f,operatorSelfLastOnlineInfo_Update:k,operatorSelfLastOnline_SetOnlineFlag:async j=>{_(++d);const x=await g_Api.operatorSelf_SetOnlineFlag(j);return x&&p(x),_(--d),x},operatorSelfLastOnlineInfoLoading_r:u});const v=Object.create(null),[h,A]=jn(v),T=j=>{!j.length||A(x=>{for(const F of j)x[An(F)]=F;return x})},y=j=>T([j]),[C,O]=ct(null);return Object.assign(t,{dialogMap_r:h,dialogMap_SetDialogList:T,dialogMap_SetDialog:y,dialogActiveID_r:C,dialogActiveID_Set:O}),Object.assign(t,{lead_GetStatusTitle:j=>{var x,F,X;return(X=(F=((x=e==null?void 0:e.lead_StatusList)!=null?x:[]).find(ee=>ee.id===j))==null?void 0:F.title)!=null?X:j},lead_GetStatusList:j=>{var x;return((x=e==null?void 0:e.lead_StatusList)!=null?x:[]).filter(F=>F.access==="user").filter(F=>F.id!==j).filter(F=>F.id!=="DL")}}),r(Zl(e.updateIntervals.sync_online_info,k,!1)),Object.freeze(t),t}function Xt(l){let e,t,n;return{c(){e=b("div"),e.textContent="Operators",w(e,"class","item cursor_ptr svelte-vbcb9r"),le(e,"active",l[0]==="operators"),le(e,"disabled",l[1].has("operators"))},m(i,s){H(i,e,s),t||(n=K(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&le(e,"active",i[0]==="operators"),s&2&&le(e,"disabled",i[1].has("operators"))},d(i){i&&P(e),t=!1,n()}}}function Jt(l){let e,t=l[2].username+"",n,i,s;return{c(){e=b("div"),n=Z(t),w(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),N(e,"max-width","200px")},m(r,o){H(r,e,o),g(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&_e(n,t)},i(r){s||(je(()=>{i||(i=Se(e,Ie,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=Se(e,Ie,{},!1)),i.run(0),s=!1},d(r){r&&P(e),r&&i&&i.end()}}}function zn(l){let e,t,n,i,s,r,o=!l[2]&&Xt(l),c=l[2]&&0,a=l[2]&&Jt(l);return{c(){e=b("div"),o&&o.c(),t=E(),c&&c.c(),n=E(),i=b("div"),s=E(),a&&a.c(),w(i,"class","flex flex_grow_1"),w(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(f,p){H(f,e,p),o&&o.m(e,null),g(e,t),c&&c.m(e,null),g(e,n),g(e,i),g(e,s),a&&a.m(e,null),r=!0},p(f,[p]){f[2]?o&&(o.d(1),o=null):o?o.p(f,p):(o=Xt(f),o.c(),o.m(e,t)),f[2],c&&(c.d(1),c=null),f[2]?a?(a.p(f,p),p&4&&z(a,1)):(a=Jt(f),a.c(),z(a,1),a.m(e,null)):a&&(ve(),B(a,1,1,()=>{a=null}),we())},i(f){r||(z(a),r=!0)},o(f){B(a),r=!1},d(f){f&&P(e),o&&o.d(),c&&c.d(),a&&a.d()}}}function Pn(l,e,t){let n;Le(l,Et,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>c=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class Hn extends ke{constructor(e){super(),ye(this,e,Pn,zn,pe,{select:0,disabled:1})}}function Nn(l){let e;return{c(){e=b("div"),w(e,"class","pos_abs notify_list svelte-bjfmev")},m(t,n){H(t,e,n)},p:ne,i:ne,o:ne,d(t){t&&P(e)}}}class Fn extends ke{constructor(e){super(),ye(this,e,null,Nn,pe,{})}}function Kt(l){return Object.prototype.toString.call(l)==="[object Date]"}function Ot(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>Ot(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if(Kt(l)&&Kt(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=Ot(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function Ge(l,e={}){const t=Be(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let c=n,a=!1,{delay:f=0,duration:p=400,easing:d=Dt,interpolate:u=Ot}=Yt(Yt({},e),o);if(p===0)return c&&(c.abort(),c=null),t.set(l=i),Promise.resolve();const _=xl()+f;let m;return n=Wl(k=>{if(k<_)return!0;a||(m=u(l,r),typeof p=="function"&&(p=p(l,r)),a=!0),c&&(c.abort(),c=null);const S=k-_;return S>p?(t.set(l=r),!1):(t.set(l=m(d(S/p))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}function Bn(l){let e,t,n,i,s,r,o,c,a;return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=E(),o=b("div"),c=E(),a=b("div"),w(n,"class","pos_abs s1 svelte-fxby3d"),w(s,"class","pos_abs s2 svelte-fxby3d"),w(o,"class","pos_abs s3 svelte-fxby3d"),w(a,"class","pos_abs s4 svelte-fxby3d"),w(t,"class","flex pos_rel ellipsis svelte-fxby3d"),N(t,"transform","scale("+l[1]+")"),w(e,"class","flex"),N(e,"height",l[0]+"px"),N(e,"width",l[2]+"px")},m(f,p){H(f,e,p),g(e,t),g(t,n),g(t,i),g(t,s),g(t,r),g(t,o),g(t,c),g(t,a)},p(f,[p]){p&2&&N(t,"transform","scale("+f[1]+")"),p&1&&N(e,"height",f[0]+"px"),p&4&&N(e,"width",f[2]+"px")},i:ne,o:ne,d(f){f&&P(e)}}}function Rn(l,e,t){let n,i,{height:s=5}=e;return l.$$set=r=>{"height"in r&&t(0,s=r.height)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=s/.1625),l.$$.dirty&1&&t(1,i=s/13)},[s,i,n]}class Gn extends ke{constructor(e){super(),ye(this,e,Rn,Bn,pe,{height:0})}}function Zt(l){let e,t,n,i;return t=new Gn({props:{height:6}}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","flex pos_abs loading svelte-15wz55f")},m(s,r){H(s,e,r),ue(t,e,null),i=!0},i(s){i||(z(t.$$.fragment,s),s&&je(()=>{n||(n=Se(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){B(t.$$.fragment,s),s&&(n||(n=Se(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function Un(l){let e,t,n,i,s,r,o,c,a,f,p,d,u,_=l[0]&&Zt();return{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),i.textContent="offline",s=E(),r=b("div"),o=Z(`online\r
		`),c=b("div"),a=Z(l[2]),f=E(),_&&_.c(),w(t,"class","pos_abs h100 onlineProgressTrumb svelte-15wz55f"),N(t,"width",l[1]+"%"),w(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-15wz55f"),le(i,"hideR",l[1]>=1),w(c,"class","pos_abs onlineProgressTrumbLastTime svelte-15wz55f"),w(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-15wz55f"),le(r,"hideL",l[1]<1),w(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-15wz55f")},m(m,k){H(m,e,k),g(e,t),g(e,n),g(e,i),g(e,s),g(e,r),g(r,o),g(r,c),g(c,a),g(e,f),_&&_.m(e,null),p=!0,d||(u=K(e,"click",l[8]),d=!0)},p(m,[k]){(!p||k&2)&&N(t,"width",m[1]+"%"),(!p||k&2)&&le(i,"hideR",m[1]>=1),(!p||k&4)&&_e(a,m[2]),(!p||k&2)&&le(r,"hideL",m[1]<1),m[0]?_?k&1&&z(_,1):(_=Zt(),_.c(),z(_,1),_.m(e,null)):_&&(ve(),B(_,1,1,()=>{_=null}),we())},i(m){p||(z(_),p=!0)},o(m){B(_),p=!1},d(m){m&&P(e),_&&_.d(),d=!1,u()}}}function Yn(l,e,t){let n,i,s,{endTime:r=0}=e,{intervalTime:o=1}=e,{loading:c=!1}=e;const a=Ge(0);Le(l,a,_=>t(7,s=_));let f=0;function p(){const _=Math.max(0,r-Date.now());t(1,f=Math.floor(Pe(0,_/o,1)*100)),Ye(a,s=Math.ceil(_/1e3),s)}Xe(Zl(1e3,p));const d=_=>{const m=Math.floor(_%60);_/=60;const k=Math.floor(_%60);_/=60;const S=Math.floor(_),v=[];return(v.length||S)&&v.push(`${String(S).padStart(v.length?2:1,"0")}h`),(v.length||k)&&v.push(`${String(k).padStart(v.length?2:1,"0")}m`),(v.length||m)&&v.push(`${String(m).padStart(v.length?2:1,"0")}s`),v.join(" ")};function u(_){mn.call(this,l,_)}return l.$$set=_=>{"endTime"in _&&t(4,r=_.endTime),"intervalTime"in _&&t(5,o=_.intervalTime),"loading"in _&&t(0,c=_.loading)},l.$$.update=()=>{l.$$.dirty&128&&t(6,n=Math.ceil(s)),l.$$.dirty&64&&t(2,i=d(n))},[c,f,i,a,r,o,n,s,u]}class xn extends ke{constructor(e){super(),ye(this,e,Yn,Un,pe,{endTime:4,intervalTime:5,loading:0})}}function qn(l){let e;return{c(){e=Z("\xA0")},m(t,n){H(t,e,n)},p:ne,d(t){t&&P(e)}}}function Wn(l){let e,t=l[2].username+"",n;return{c(){e=Z("@"),n=Z(t)},m(i,s){H(i,e,s),H(i,n,s)},p(i,s){s&4&&t!==(t=i[2].username+"")&&_e(n,t)},d(i){i&&P(e),i&&P(n)}}}function Vn(l){var X,ee;let e,t,n,i,s=((X=l[2].first_name)!=null?X:"")+"",r,o,c,a,f,p=((ee=l[2].last_name)!=null?ee:"")+"",d,u,_,m,k,S,v,h,A,T,y,C,O,L,M;function j(te,V){return te[2].username?Wn:qn}let x=j(l),F=x(l);return T=new xn({props:{intervalTime:l[1],endTime:l[0],loading:l[3]}}),T.$on("click",l[8]),{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),r=Z(s),o=E(),c=b("div"),a=E(),f=b("div"),d=Z(p),u=Z("\xA0"),_=E(),m=b("div"),F.c(),k=E(),S=b("div"),S.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',v=E(),h=b("div"),A=E(),ge(T.$$.fragment),y=E(),C=b("div"),N(c,"width","8px"),w(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),w(m,"class","nowrap textOverEllipsis username svelte-1qt21qp"),w(S,"class","pos_abs btnLogout svelte-1qt21qp"),w(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),N(h,"height","8px"),N(C,"height","8px"),w(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(te,V){H(te,e,V),g(e,t),g(t,n),g(n,i),g(i,r),g(n,o),g(n,c),g(n,a),g(n,f),g(f,d),g(f,u),g(t,_),g(t,m),F.m(m,null),g(t,k),g(t,S),g(e,v),g(e,h),g(e,A),ue(T,e,null),g(e,y),g(e,C),O=!0,L||(M=K(S,"click",l[7]),L=!0)},p(te,[V]){var me,Y;(!O||V&4)&&s!==(s=((me=te[2].first_name)!=null?me:"")+"")&&_e(r,s),(!O||V&4)&&p!==(p=((Y=te[2].last_name)!=null?Y:"")+"")&&_e(d,p),x===(x=j(te))&&F?F.p(te,V):(F.d(1),F=x(te),F&&(F.c(),F.m(m,null)));const se={};V&2&&(se.intervalTime=te[1]),V&1&&(se.endTime=te[0]),V&8&&(se.loading=te[3]),T.$set(se)},i(te){O||(z(T.$$.fragment,te),O=!0)},o(te){B(T.$$.fragment,te),O=!1},d(te){te&&P(e),F.d(),de(T),L=!1,M()}}}function Xn(l,e,t){let n,i,s,{app:r}=e;const{operatorSelf_r:o,operatorSelfLastOnlineInfo_r:c,operatorSelfLastOnlineInfoLoading_r:a,operatorSelfLastOnline_SetOnlineFlag:f}=r;Le(l,o,S=>t(2,i=S)),Le(l,c,S=>t(10,n=S)),Le(l,a,S=>t(3,s=S));const p=()=>$l(null);let d=0,u=1;const _=S=>{if(!S){t(0,d=0),t(1,u=1);return}t(0,d=+new Date(S.offline_at)),t(1,u=Pe(1,(S.interval|0)*1e3,1e9))};let m=!1;const k=async()=>{var S;!((S=r.appConfig)!=null&&S.operatorSelf_CanSetOnline)||m||(m=!0,await f(!0),m=!1)};return l.$$set=S=>{"app"in S&&t(9,r=S.app)},l.$$.update=()=>{l.$$.dirty&1024&&_(n)},[d,u,i,s,o,c,a,p,k,r,n]}class Jn extends ke{constructor(e){super(),ye(this,e,Xn,Vn,pe,{app:9})}}const st=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{i&&setTimeout(s,10);const o=l.parentNode;if(o){const c=o.getBoundingClientRect();(t!==c.width||n!==c.height)&&(t=c.width,n=c.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(c))}};return s(),{destroy:()=>i=!1}},Kn=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{r&&setTimeout(o,10);const a=l.getBoundingClientRect();(t!==a.width||n!==a.height||i!==a.x||s!==a.y)&&(t=a.width,n=a.height,i=a.x,s=a.y,e&&e.set(a))};return o(),{destroy:()=>r=!1}};function Zn(l){let e,t,n,i,s,r,o,c,a,f,p,d,u,_,m,k,S;return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=E(),o=b("div"),c=E(),a=b("div"),f=E(),p=b("div"),d=E(),u=b("div"),_=E(),m=b("div"),k=E(),S=b("div"),w(n,"class","svelte-1lltvmx"),w(s,"class","svelte-1lltvmx"),w(o,"class","svelte-1lltvmx"),w(a,"class","svelte-1lltvmx"),w(p,"class","svelte-1lltvmx"),w(u,"class","svelte-1lltvmx"),w(m,"class","svelte-1lltvmx"),w(S,"class","svelte-1lltvmx"),w(t,"class","lds-roller svelte-1lltvmx"),N(t,"transform","scale("+l[2]+")"),N(t,"--loadingItemColor",l[1]),w(e,"class","flex"),N(e,"height",l[0]+"px"),N(e,"width",l[0]+"px")},m(v,h){H(v,e,h),g(e,t),g(t,n),g(t,i),g(t,s),g(t,r),g(t,o),g(t,c),g(t,a),g(t,f),g(t,p),g(t,d),g(t,u),g(t,_),g(t,m),g(t,k),g(t,S)},p(v,[h]){h&4&&N(t,"transform","scale("+v[2]+")"),h&2&&N(t,"--loadingItemColor",v[1]),h&1&&N(e,"height",v[0]+"px"),h&1&&N(e,"width",v[0]+"px")},i:ne,o:ne,d(v){v&&P(e)}}}function Qn(l,e,t){let n,{size:i=80}=e,{color:s="#000"}=e;return l.$$set=r=>{"size"in r&&t(0,i=r.size),"color"in r&&t(1,s=r.color)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=i/80)},[i,s,n]}class en extends ke{constructor(e){super(),ye(this,e,Qn,Zn,pe,{size:0,color:1})}}const{Map:$n}=Kl;function Qt(l,e,t){const n=l.slice();return n[15]=e[t],n}function $t(l){let e,t,n,i;return t=new en({props:{color:"#fff",size:"32"}}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_abs loading svelte-1i0u6mf")},m(s,r){H(s,e,r),ue(t,e,null),i=!0},i(s){i||(z(t.$$.fragment,s),s&&je(()=>{n||(n=Se(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){B(t.$$.fragment,s),s&&(n||(n=Se(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function el(l){let e,t,n=l[15].username+"",i;return{c(){e=b("div"),t=Z("@"),i=Z(n),w(e,"class","nowrap textOverEllipsis username svelte-1i0u6mf")},m(s,r){H(s,e,r),g(e,t),g(e,i)},p(s,r){r&8&&n!==(n=s[15].username+"")&&_e(i,n)},d(s){s&&P(e)}}}function tl(l){let e,t,n;return t=new en({props:{color:"#fff",size:"32"}}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","flex flex_cy h100 pos_abs loadingLead svelte-1i0u6mf")},m(i,s){H(i,e,s),ue(t,e,null),n=!0},i(i){n||(z(t.$$.fragment,i),n=!0)},o(i){B(t.$$.fragment,i),n=!1},d(i){i&&P(e),de(t)}}}function ll(l,e){var C,O;let t,n,i,s=((C=e[15].first_name)!=null?C:"")+"",r,o,c,a,f,p=((O=e[15].last_name)!=null?O:"")+"",d,u,_,m,k=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id),S,v,h,A,T=e[15].username&&el(e),y=k&&tl();return{key:l,first:null,c(){t=b("div"),n=b("div"),i=b("div"),r=Z(s),o=E(),c=b("div"),a=E(),f=b("div"),d=Z(p),u=Z("\xA0"),_=E(),T&&T.c(),m=E(),y&&y.c(),S=E(),N(c,"width","8px"),w(n,"class","flex nowrap textOverEllipsis userAttr svelte-1i0u6mf"),w(t,"class","flex flex_clm cursor_ptr w100 item unselect pos_abs svelte-1i0u6mf"),N(t,"top",e[15].y+"px"),N(t,"height",tn+"px"),le(t,"disabled",e[1].has(e[15].tg_id)),this.first=t},m(L,M){H(L,t,M),g(t,n),g(n,i),g(i,r),g(n,o),g(n,c),g(n,a),g(n,f),g(f,d),g(f,u),g(t,_),T&&T.m(t,null),g(t,m),y&&y.m(t,null),g(t,S),v=!0,h||(A=K(t,"click",function(){He(e[6](e[15].tg_id))&&e[6](e[15].tg_id).apply(this,arguments)}),h=!0)},p(L,M){var j,x;e=L,(!v||M&8)&&s!==(s=((j=e[15].first_name)!=null?j:"")+"")&&_e(r,s),(!v||M&8)&&p!==(p=((x=e[15].last_name)!=null?x:"")+"")&&_e(d,p),e[15].username?T?T.p(e,M):(T=el(e),T.c(),T.m(t,m)):T&&(T.d(1),T=null),M&14&&(k=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id)),k?y?M&14&&z(y,1):(y=tl(),y.c(),z(y,1),y.m(t,S)):y&&(ve(),B(y,1,1,()=>{y=null}),we()),(!v||M&8)&&N(t,"top",e[15].y+"px"),(!v||M&10)&&le(t,"disabled",e[1].has(e[15].tg_id))},i(L){v||(z(y),v=!0)},o(L){B(y),v=!1},d(L){L&&P(t),T&&T.d(),y&&y.d(),h=!1,A()}}}function es(l){var O;let e,t,n,i,s,r,o,c=((O=l[4])!=null?O:0)+"",a,f,p,d,u,_,m,k=[],S=new $n,v,h,A,T=l[5]&&$t(),y=l[3];const C=L=>L[15].tg_id;for(let L=0;L<y.length;L+=1){let M=Qt(l,y,L),j=C(M);S.set(j,k[L]=ll(j,M))}return{c(){e=b("div"),t=b("div"),n=b("div"),n.textContent="New leads",i=E(),T&&T.c(),s=E(),r=b("div"),o=Z("count: "),a=Z(c),f=E(),p=b("div"),d=E(),u=b("div"),_=b("div"),m=b("div");for(let L=0;L<k.length;L+=1)k[L].c();w(n,"class","flex mainLabel svelte-1i0u6mf"),w(r,"class","flex pos_abs labelCount svelte-1i0u6mf"),w(t,"class","flex flex_cx flex_cy header pos_rel w100 svelte-1i0u6mf"),N(p,"height","20px"),w(m,"class","flex list h100 svelte-1i0u6mf"),w(_,"class","pos_abs w100"),N(_,"overflow","hidden"),w(u,"class","flex cnt h100 pos_rel w100 svelte-1i0u6mf"),w(e,"class","flex flex_clm wrapMain flex_grow_1 w100 svelte-1i0u6mf")},m(L,M){H(L,e,M),g(e,t),g(t,n),g(t,i),T&&T.m(t,null),g(t,s),g(t,r),g(r,o),g(r,a),g(e,f),g(e,p),g(e,d),g(e,u),g(u,_),g(_,m);for(let j=0;j<k.length;j+=1)k[j].m(m,null);l[9](_),v=!0,h||(A=Ze(st.call(null,_)),h=!0)},p(L,[M]){var j;L[5]?T?M&32&&z(T,1):(T=$t(),T.c(),z(T,1),T.m(t,s)):T&&(ve(),B(T,1,1,()=>{T=null}),we()),(!v||M&16)&&c!==(c=((j=L[4])!=null?j:0)+"")&&_e(a,c),M&78&&(y=L[3],ve(),k=xe(k,M,C,1,L,y,S,m,nt,ll,null,Qt),we())},i(L){if(!v){z(T);for(let M=0;M<y.length;M+=1)z(k[M]);v=!0}},o(L){B(T);for(let M=0;M<k.length;M+=1)B(k[M]);v=!1},d(L){L&&P(e),T&&T.d();for(let M=0;M<k.length;M+=1)k[M].d();l[9](null),h=!1,A()}}}const ts=160,tn=42,kt=0;function ls(l,e,t){let{app:n}=e,i=[],s=new Map,r=new Set,o=[],c=null;function a(){if(!c)return;const v=c.getBoundingClientRect(),h=ts+kt*2,A=tn+kt*2,T=Math.max(1,Math.floor(v.width/h)),y=(v.width-T*h)/2,C=kt;t(3,o=i.map((O,L)=>{const M={...O};return M.x=L%T*h+y,M.y=C+Math.floor(L/T)*A,M}))}let f=null,p=!1;async function d(){var h;const v=await g_Api.lead_GetUnassignedList({offset:0,limit:20});return v?(t(4,f=v.count),(h=v.results)!=null?h:v):null}let u=!0;async function _(){for(;u;){await wt(g_Config.updateIntervals.new_leads);const v=await d();if(!v)continue;const h=new Set(i.map(L=>L.tg_id)),A=new Set(v.map(L=>L.tg_id)),T=v.filter(L=>!h.has(L.tg_id)),y=i.filter(L=>!A.has(L.tg_id)),C=Date.now();y.map(L=>s.has(L.tg_id)||s.set(L.tg_id,C)),T.length===0&&y.length===0||t(8,i=[...i,...T]);const O=new Set;[...s].map(L=>{L[1]+2e3<=C&&O.add(L[0]),L[1]+1e4<=C&&s.delete(L[0])}),O.size&&t(8,i=i.filter(L=>!O.has(L.tg_id)))}}async function m(){for(t(5,p=!0);u;){const v=await d();if(v){t(8,i=v);break}}t(5,p=!1),_()}Xe(()=>u=!1);const k=v=>async h=>{if(r.has(v)||s.has(v))return;r.add(v),t(2,r);const A=await g_Api.lead_AssignOperatorSelft(v);r.delete(v),t(2,r),A!==null&&(s.set(v,Date.now()),t(1,s)),t(8,i),t(3,o)};m();function S(v){Ne[v?"unshift":"push"](()=>{c=v,t(0,c)})}return l.$$set=v=>{"app"in v&&t(7,n=v.app)},l.$$.update=()=>{l.$$.dirty&257&&a()},[c,s,r,o,f,p,k,n,i,S]}class ns extends ke{constructor(e){super(),ye(this,e,ls,es,pe,{app:7})}}function ss(l){let e,t,n,i,s,r,o,c,a,f,p,d,u,_,m,k,S,v;return{c(){e=b("label"),t=b("input"),n=E(),i=ze("svg"),s=ze("symbol"),r=ze("path"),o=ze("defs"),c=ze("mask"),a=ze("use"),f=ze("use"),p=ze("path"),d=E(),u=ze("svg"),_=ze("path"),m=ze("path"),k=ze("path"),w(t,"type","checkbox"),w(t,"class","svelte-13drl8w"),w(r,"d","M5.22003 7.26C5.72003 7.76 7.57 9.7 8.67 11.45C12.2 6.05 15.65 3.5 19.19 1.69"),w(r,"fill","none"),w(r,"stroke-width","2.25"),w(r,"stroke-linecap","round"),w(r,"stroke-linejoin","round"),w(s,"id","tick-path"),w(s,"viewBox","0 0 21 18"),w(s,"xmlns","http://www.w3.org/2000/svg"),w(a,"class","tick mask svelte-13drl8w"),w(a,"href","#tick-path"),w(c,"id","tick"),w(f,"class","tick svelte-13drl8w"),w(f,"href","#tick-path"),w(f,"stroke","currentColor"),w(p,"fill","white"),w(p,"mask","url(#tick)"),w(p,"d","M18 9C18 10.4464 17.9036 11.8929 17.7589 13.1464C17.5179 15.6054 15.6054 17.5179 13.1625 17.7589C11.8929 17.9036 10.4464 18 9 18C7.55357 18 6.10714 17.9036 4.85357 17.7589C2.39464 17.5179 0.498214 15.6054 0.241071 13.1464C0.0964286 11.8929 0 10.4464 0 9C0 7.55357 0.0964286 6.10714 0.241071 4.8375C0.498214 2.39464 2.39464 0.482143 4.85357 0.241071C6.10714 0.0964286 7.55357 0 9 0C10.4464 0 11.8929 0.0964286 13.1625 0.241071C15.6054 0.482143 17.5179 2.39464 17.7589 4.8375C17.9036 6.10714 18 7.55357 18 9Z"),w(i,"viewBox","0 0 21 18"),w(i,"class","svelte-13drl8w"),w(_,"d","M5.88086 5.89441L9.53504 4.26746"),w(m,"d","M5.5274 8.78838L9.45391 9.55161"),w(k,"d","M3.49371 4.22065L5.55387 0.79198"),w(u,"class","lines svelte-13drl8w"),w(u,"viewBox","0 0 11 11"),w(e,"class","checkbox svelte-13drl8w")},m(h,A){H(h,e,A),g(e,t),t.checked=l[0],g(e,n),g(e,i),g(i,s),g(s,r),g(i,o),g(o,c),g(c,a),g(i,f),g(i,p),g(e,d),g(e,u),g(u,_),g(u,m),g(u,k),S||(v=K(t,"change",l[1]),S=!0)},p(h,[A]){A&1&&(t.checked=h[0])},i:ne,o:ne,d(h){h&&P(e),S=!1,v()}}}function is(l,e,t){let{checked:n=!1}=e;function i(){n=this.checked,t(0,n)}return l.$$set=s=>{"checked"in s&&t(0,n=s.checked)},[n,i]}class rs extends ke{constructor(e){super(),ye(this,e,is,ss,pe,{checked:0})}}function nl(l,e,t){const n=l.slice();return n[16]=e[t],n}function sl(l,e){let t,n=e[16].title.toLowerCase()+"",i;return{key:l,first:null,c(){t=b("div"),i=Z(n),w(t,"class","flex tag svelte-1uzyfoc"),N(t,"background",e[16].background_color),N(t,"color",e[16].color),this.first=t},m(s,r){H(s,t,r),g(t,i)},p(s,r){e=s,r&16&&n!==(n=e[16].title.toLowerCase()+"")&&_e(i,n),r&16&&N(t,"background",e[16].background_color),r&16&&N(t,"color",e[16].color)},d(s){s&&P(t)}}}function il(l){var i;let e,t=l[12]((i=l[4])==null?void 0:i._lastTime)+"",n;return{c(){e=b("div"),n=Z(t),w(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-1uzyfoc")},m(s,r){H(s,e,r),g(e,n)},p(s,r){var o;r&16&&t!==(t=s[12]((o=s[4])==null?void 0:o._lastTime)+"")&&_e(n,t)},d(s){s&&P(e)}}}function rl(l){var i;let e,t=((i=l[4])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=b("div"),n=Z(t),w(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-1uzyfoc")},m(s,r){H(s,e,r),g(e,n)},p(s,r){var o;r&16&&t!==(t=((o=s[4])==null?void 0:o.unread_messages_count)+"")&&_e(n,t)},d(s){s&&P(e)}}}function os(l){var Me,Fe,Ee,be,D,I,R,G,W,q,ie,oe,Q,Te,De;let e,t,n,i,s,r,o=((Ee=(Fe=(Me=l[4])==null?void 0:Me.lead)==null?void 0:Fe.first_name)!=null?Ee:"")+"",c,a,f,p,d,u=((I=(D=(be=l[4])==null?void 0:be.lead)==null?void 0:D.last_name)!=null?I:"")+"",_,m,k,S,v=((W=(G=(R=l[4])==null?void 0:R.last_message)==null?void 0:G.text)!=null?W:"")+"",h,A,T,y,C,O,L,M,j=l[0].lead_GetStatusTitle((ie=(q=l[4])==null?void 0:q.lead)==null?void 0:ie.status)+"",x,F,X,ee,te,V=[],se=new Map,me,Y,fe,he,U=(Q=(oe=l[4])==null?void 0:oe.tag)!=null?Q:[];const J=$=>$[16].id;for(let $=0;$<U.length;$+=1){let ce=nl(l,U,$),Ce=J(ce);se.set(Ce,V[$]=sl(Ce,ce))}let re=((Te=l[4])==null?void 0:Te._lastTime)&&il(l),ae=((De=l[4])==null?void 0:De.unread_messages_count)&&rl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),s=E(),r=b("div"),c=Z(o),a=E(),f=b("div"),p=E(),d=b("div"),_=Z(u),m=Z("\xA0"),k=E(),S=b("div"),h=Z(v),A=Z("\xA0"),T=E(),y=b("div"),C=b("div"),O=b("img"),M=E(),x=Z(j),F=E(),X=b("div"),ee=E(),te=b("div");for(let $=0;$<V.length;$+=1)V[$].c();me=E(),re&&re.c(),Y=E(),ae&&ae.c(),N(i,"width","8px"),N(f,"width","8px"),w(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-1uzyfoc"),w(S,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-1uzyfoc"),We(O.src,L="assets/icons/status1.png")||w(O,"src",L),w(O,"draggable","false"),w(O,"class","pos_abs statusIcon svelte-1uzyfoc"),w(C,"class","flex flex_cy leadStatus pos_rel svelte-1uzyfoc"),N(X,"width","4px"),w(te,"class","flex tag_list svelte-1uzyfoc"),w(y,"class","flex"),w(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-1uzyfoc"),N(t,"height",l[1]+"px"),le(t,"active",l[2]===l[6]),le(t,"disabled",l[11](l[4])),w(e,"class","pos_abs w100"),N(e,"transform","translate(0px, "+(l[5]+l[3])+"px)")},m($,ce){H($,e,ce),g(e,t),g(t,n),g(n,i),g(n,s),g(n,r),g(r,c),g(n,a),g(n,f),g(n,p),g(n,d),g(d,_),g(d,m),g(t,k),g(t,S),g(S,h),g(S,A),g(t,T),g(t,y),g(y,C),g(C,O),g(C,M),g(C,x),g(y,F),g(y,X),g(y,ee),g(y,te);for(let Ce=0;Ce<V.length;Ce+=1)V[Ce].m(te,null);g(t,me),re&&re.m(t,null),g(t,Y),ae&&ae.m(t,null),fe||(he=K(t,"click",l[10]),fe=!0)},p($,[ce]){var Ce,Qe,Oe,qe,rt,ot,zt,Pt,Ht,Nt,Ft,Bt,Rt,Gt,Ut;ce&16&&o!==(o=((Oe=(Qe=(Ce=$[4])==null?void 0:Ce.lead)==null?void 0:Qe.first_name)!=null?Oe:"")+"")&&_e(c,o),ce&16&&u!==(u=((ot=(rt=(qe=$[4])==null?void 0:qe.lead)==null?void 0:rt.last_name)!=null?ot:"")+"")&&_e(_,u),ce&16&&v!==(v=((Ht=(Pt=(zt=$[4])==null?void 0:zt.last_message)==null?void 0:Pt.text)!=null?Ht:"")+"")&&_e(h,v),ce&17&&j!==(j=$[0].lead_GetStatusTitle((Ft=(Nt=$[4])==null?void 0:Nt.lead)==null?void 0:Ft.status)+"")&&_e(x,j),ce&16&&(U=(Rt=(Bt=$[4])==null?void 0:Bt.tag)!=null?Rt:[],V=xe(V,ce,J,1,$,U,se,te,jt,sl,null,nl)),(Gt=$[4])!=null&&Gt._lastTime?re?re.p($,ce):(re=il($),re.c(),re.m(t,Y)):re&&(re.d(1),re=null),(Ut=$[4])!=null&&Ut.unread_messages_count?ae?ae.p($,ce):(ae=rl($),ae.c(),ae.m(t,null)):ae&&(ae.d(1),ae=null),ce&2&&N(t,"height",$[1]+"px"),ce&68&&le(t,"active",$[2]===$[6]),ce&2064&&le(t,"disabled",$[11]($[4])),ce&40&&N(e,"transform","translate(0px, "+($[5]+$[3])+"px)")},i:ne,o:ne,d($){$&&P(e);for(let ce=0;ce<V.length;ce+=1)V[ce].d();re&&re.d(),ae&&ae.d(),fe=!1,he()}}}function as(l,e,t){let n,i,s,r,{app:o}=e;const{dialogMap_r:c,dialogActiveID_r:a,dialogActiveID_Set:f}=o;Le(l,c,h=>t(14,i=h)),Le(l,a,h=>t(6,r=h));let{height:p=54}=e,{dialog_id:d}=e,{y:u=0}=e,{scrollY:_=0}=e;const m=Ge(u);Le(l,m,h=>t(5,s=h));const k=h=>{n&&!S(n)&&f(n.id)},S=h=>{var A;return((A=h==null?void 0:h.lead)==null?void 0:A.status)==="DL"},v=h=>{if(!h)return"";const A=y=>String(y).padStart(2,"0"),T=new Date;return h=new Date(h),h.getYear()===T.getYear()&&h.getMonth()===T.getMonth()?h.getDate()===T.getDate()?`${A(h.getHours())}:${A(h.getMinutes())}`:`${A(h.getDate())}d ${A(h.getHours())}:${A(h.getMinutes())}`:`${A(h.getDate())}.${A(h.getMonth())}.${h.getFullYear()}`};return l.$$set=h=>{"app"in h&&t(0,o=h.app),"height"in h&&t(1,p=h.height),"dialog_id"in h&&t(2,d=h.dialog_id),"y"in h&&t(13,u=h.y),"scrollY"in h&&t(3,_=h.scrollY)},l.$$.update=()=>{l.$$.dirty&8192&&Ye(m,s=u,s),l.$$.dirty&16388&&t(4,n=i[d])},[o,p,d,_,n,s,r,c,a,m,k,S,v,u,i]}class fs extends ke{constructor(e){super(),ye(this,e,as,os,pe,{app:0,height:1,dialog_id:2,y:13,scrollY:3})}}function cs(l){let e,t,n,i;return{c(){e=b("div"),t=b("div"),w(t,"class","pos_abs thumb w100 svelte-5ca5ia"),N(t,"height",l[1]+"px"),N(t,"transform","translate(0px, "+l[5](l[0],l[2],l[1])+"px)"),le(t,"active",l[3]),w(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),le(e,"active",l[3])},m(s,r){H(s,e,r),g(e,t),n||(i=[K(window,"mousemove",l[7]),K(window,"mouseup",l[8]),K(window,"blur",l[8]),K(t,"mousedown",l[6]),Ze(Kn.call(null,e,l[4])),K(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&N(t,"height",s[1]+"px"),r&7&&N(t,"transform","translate(0px, "+s[5](s[0],s[2],s[1])+"px)"),r&8&&le(t,"active",s[3]),r&8&&le(e,"active",s[3])},i:ne,o:ne,d(s){s&&P(e),n=!1,Ae(i)}}}function us(l,e,t){let n;const i=h=>Pe(0,Array.isArray(h)?h[0]:h,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:c=null}=e;const a=Be(null);Le(l,a,h=>t(2,n=h));const f=()=>n?n.height-o:1,p=h=>n?h*f():0,d=()=>{if(!n)return 1;if(c===null)return o;t(1,o=Pe(.1,c,1)*n.height)};let u=null;const _=h=>{!n||t(3,u={y:h.clientY,value_out:r})},m=h=>{if(!n||!u)return;const A=h.clientY-u.y;if(n.height){const T=A/f();t(0,r=Pe(0,u.value_out+T,1))}},k=h=>{t(3,u=null)},S=h=>{!n||u||(t(0,r=Pe(0,(h.clientY-n.y-o/2)/f(),1)),t(3,u={y:h.clientY,value_out:r}))},v=()=>{if(!n)return 0;u||t(0,r=i(s))};return l.$$set=h=>{"value_in"in h&&t(10,s=h.value_in),"value_out"in h&&t(0,r=h.value_out),"thumb_Height"in h&&t(1,o=h.thumb_Height),"thumb_HeightRate"in h&&t(11,c=h.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&d(),l.$$.dirty&1024&&v()},[r,o,n,u,a,p,_,m,k,S,s,c]}class ln extends ke{constructor(e){super(),ye(this,e,us,cs,pe,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:ds}=Kl;function ol(l,e,t){const n=l.slice();return n[24]=e[t],n}function al(l,e){let t,n,i;return n=new fs({props:{app:e[0],height:Ue,dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Ve(),ge(n.$$.fragment),this.first=t},m(s,r){H(s,t,r),ue(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(z(n.$$.fragment,s),i=!0)},o(s){B(n.$$.fragment,s),i=!1},d(s){s&&P(t),de(n,s)}}}function fl(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new ln({props:r}),Ne.push(()=>ht(t,"value_out",s)),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,c){H(o,e,c),ue(t,e,null),i=!0},p(o,c){const a={};c&32&&(a.value_in=o[5]),c&64&&(a.thumb_HeightRate=o[6]),!n&&c&2&&(n=!0,a.value_out=o[1],mt(()=>n=!1)),t.$set(a)},i(o){i||(z(t.$$.fragment,o),i=!0)},o(o){B(t.$$.fragment,o),i=!1},d(o){o&&P(e),de(t)}}}function cl(l){let e,t,n,i,s;return{c(){e=b("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',w(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){H(r,e,o),n=!0,i||(s=K(e,"click",l[15]),i=!0)},p:ne,i(r){n||(r&&je(()=>{t||(t=Se(e,Ie,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Se(e,Ie,{},!1)),t.run(0)),n=!1},d(r){r&&P(e),r&&t&&t.end(),i=!1,s()}}}function _s(l){let e,t,n=[],i=new ds,s,r,o,c,a,f=l[4];const p=_=>_[24].dialog_id;for(let _=0;_<f.length;_+=1){let m=ol(l,f,_),k=p(m);i.set(k,n[_]=al(k,m))}let d=l[6]<1&&fl(l),u=l[6]<1&&l[7]&&cl(l);return{c(){e=b("div"),t=b("div");for(let _=0;_<n.length;_+=1)n[_].c();s=E(),d&&d.c(),r=E(),u&&u.c(),w(t,"class","flex flex_clm flex_grow_1 overhide pos_abs"),w(e,"class","flex flex_grow_1 pos_rel")},m(_,m){H(_,e,m),g(e,t);for(let k=0;k<n.length;k+=1)n[k].m(t,null);g(e,s),d&&d.m(e,null),g(e,r),u&&u.m(e,null),o=!0,c||(a=[Ze(st.call(null,t,l[8])),K(e,"wheel",l[10],{passive:!0})],c=!0)},p(_,[m]){m&21&&(f=_[4],ve(),n=xe(n,m,p,1,_,f,i,t,nt,al,null,ol),we()),_[6]<1?d?(d.p(_,m),m&64&&z(d,1)):(d=fl(_),d.c(),z(d,1),d.m(e,r)):d&&(ve(),B(d,1,1,()=>{d=null}),we()),_[6]<1&&_[7]?u?(u.p(_,m),m&192&&z(u,1)):(u=cl(_),u.c(),z(u,1),u.m(e,null)):u&&(ve(),B(u,1,1,()=>{u=null}),we())},i(_){if(!o){for(let m=0;m<f.length;m+=1)z(n[m]);z(d),z(u),o=!0}},o(_){for(let m=0;m<n.length;m+=1)B(n[m]);B(d),B(u),o=!1},d(_){_&&P(e);for(let m=0;m<n.length;m+=1)n[m].d();d&&d.d(),u&&u.d(),c=!1,Ae(a)}}}const Ue=54;function gs(l,e,t){let n,i,s=ne,r=()=>(s(),s=It(_,F=>t(13,i=F)),_),o;l.$$.on_destroy.push(()=>s());let{app:c}=e;const{dialogMap_SetDialogList:a}=c;let{filter:f={}}=e;const p=F=>{var X;return[f.filterUnreadFirst?1:0,(X=f.filterTag)!=null?X:""].join("/")};let d={},u=null,_=Be(null);r();function m(){const F={...f},X=p();d[X]||(d[X]=On({fLoad:ee=>(ee={unread_first:F.filterUnreadFirst?1:0,...ee},F.filterTag&&(ee.tag=F.filterTag),g_Api.dialog_GetList(ee)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:a})),u!==d[X]&&([...Object.values(d)].map(ee=>ee.pause()),u=d[X],u.resume(),console.log({filterHash:X}),r(t(3,_=u.getData_r())))}Xe(()=>[...Object.values(d)].map(F=>F.destroy()));let k=[];const S=Be(null);Le(l,S,F=>t(12,n=F));let v=0,h=0,A=1,T=0,y=Ge(T,{duration:200});Le(l,y,F=>t(2,o=F));function C(){if(!n||!i)return;const F=Math.max(1,Math.floor(n.height)),X=i.total*Ue,ee=X-F;t(6,A=X?Pe(0,F/X,1):1),ee<0?T=0:T=h*ee,Ye(y,o=T,o)}let O=!1;function L(){if(!n||!i)return;const F=i,X=Math.max(1,Math.floor(n.height)),ee=Math.ceil(X/Ue);i.total*Ue;let V=Math.max(0,Math.floor(o/Ue)-1);const se=ee+2;V>F.total&&(V=Math.max(0,F.total-se)),u&&u.setRange(V,se);const me=[];for(let Y=V,fe=0;fe<se&&Y<F.total;fe++,Y++){const he=F.list[Y];me.push({index:Y,item:he,y:Y*Ue})}t(4,k=[...new Map(me.filter(Y=>Y.item).map(Y=>[Y.item.id,Y]))].map(([Y,fe])=>({dialog_id:fe.item.id,y:fe.y}))),t(7,O=V>1)}const M=F=>{if(!n||!i)return;const X=i,ee=Math.max(1,Math.floor(n.height)),V=X.total*Ue-ee;if(V<0)return;const se=F.deltaY>0?1:-1;t(5,v=[h+Ue/V*se])};function j(F){h=F,t(1,h)}const x=()=>t(5,v=[0]);return l.$$set=F=>{"app"in F&&t(0,c=F.app),"filter"in F&&t(11,f=F.filter)},l.$$.update=()=>{l.$$.dirty&2048&&m(),l.$$.dirty&12290&&C(),l.$$.dirty&12294&&L()},[c,h,o,_,k,v,A,O,S,y,M,f,n,i,j,x]}class ps extends ke{constructor(e){super(),ye(this,e,gs,_s,pe,{app:0,filter:11})}}function ul(l,e,t){const n=l.slice();return n[5]=e[t],n}function dl(l,e){let t,n=e[5].title+"",i,s,r;function o(){return e[4](e[5])}return{key:l,first:null,c(){t=b("div"),i=Z(n),w(t,"class","cursor_ptr filter_tag inactive svelte-1t7cez8"),N(t,"background",e[5].background_color),N(t,"color",e[5].color),le(t,"active",e[0]===e[5].title),this.first=t},m(c,a){H(c,t,a),g(t,i),s||(r=K(t,"click",o),s=!0)},p(c,a){e=c,a&3&&le(t,"active",e[0]===e[5].title)},d(c){c&&P(t),s=!1,r()}}}function ms(l){let e,t,n,i,s,r,o=[],c=new Map,a,f,p=l[1];const d=u=>u[5].title;for(let u=0;u<p.length;u+=1){let _=ul(l,p,u),m=d(_);c.set(m,o[u]=dl(m,_))}return{c(){e=b("div"),t=b("div"),t.textContent="Filter tag",n=E(),i=b("div"),s=b("div"),s.textContent="all",r=E();for(let u=0;u<o.length;u+=1)o[u].c();w(t,"class","flex label svelte-1t7cez8"),w(s,"class","cursor_ptr filter_tag inactive svelte-1t7cez8"),N(s,"background","#fff"),N(s,"color","#000"),le(s,"active",l[0]===null),w(i,"class","flex filter_tag_list svelte-1t7cez8"),w(e,"class","flex flex_clm cnt unselect svelte-1t7cez8")},m(u,_){H(u,e,_),g(e,t),g(e,n),g(e,i),g(i,s),g(i,r);for(let m=0;m<o.length;m+=1)o[m].m(i,null);a||(f=K(s,"click",l[3]),a=!0)},p(u,[_]){_&1&&le(s,"active",u[0]===null),_&3&&(p=u[1],o=xe(o,_,d,1,u,p,c,i,jt,dl,null,ul))},i:ne,o:ne,d(u){u&&P(e);for(let _=0;_<o.length;_+=1)o[_].d();a=!1,f()}}}function hs(l,e,t){let{app:n}=e,{filterTag:i=null}=e,s=[...g_Config.pinnedTags];const r=()=>t(0,i=null),o=c=>t(0,i=c.title);return l.$$set=c=>{"app"in c&&t(2,n=c.app),"filterTag"in c&&t(0,i=c.filterTag)},[i,s,n,r,o]}class vs extends ke{constructor(e){super(),ye(this,e,hs,ms,pe,{app:2,filterTag:0})}}function _l(l){let e,t,n,i,s,r,o,c,a;return{c(){e=b("img"),n=E(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',r=E(),o=b("div"),o.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/fullscreen.png"/>',w(e,"class","a_img svelte-1m8yuzj"),We(e.src,t=l[2].url)||w(e,"src",t),N(e,"max-height",l[4]+"px"),w(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(o,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(f,p){H(f,e,p),H(f,n,p),H(f,i,p),g(i,s),g(i,r),g(i,o),c||(a=[K(s,"click",function(){He(l[5](l[2]))&&l[5](l[2]).apply(this,arguments)}),K(o,"click",function(){He(l[6](l[2]))&&l[6](l[2]).apply(this,arguments)})],c=!0)},p(f,p){l=f,p&4&&!We(e.src,t=l[2].url)&&w(e,"src",t),p&16&&N(e,"max-height",l[4]+"px")},d(f){f&&P(e),f&&P(n),f&&P(i),c=!1,Ae(a)}}}function gl(l){let e,t,n,i,s,r,o;return{c(){e=b("img"),n=E(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',w(e,"class","a_img fileIcon svelte-1m8yuzj"),We(e.src,t="assets/icons/folder.png")||w(e,"src",t),N(e,"max-height",l[4]+"px"),w(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(c,a){H(c,e,a),H(c,n,a),H(c,i,a),g(i,s),r||(o=K(s,"click",l[13]),r=!0)},p(c,a){a&16&&N(e,"max-height",c[4]+"px")},d(c){c&&P(e),c&&P(n),c&&P(i),r=!1,o()}}}function pl(l){var i;let e,t=((i=l[0])==null?void 0:i.text)+"",n;return{c(){e=b("pre"),n=Z(t),w(e,"class","w100 text textPre svelte-1m8yuzj")},m(s,r){H(s,e,r),g(e,n)},p(s,r){var o;r&1&&t!==(t=((o=s[0])==null?void 0:o.text)+"")&&_e(n,t)},d(s){s&&P(e)}}}function ws(l){var p,d;let e,t,n,i,s,r=l[7]((p=l[0])==null?void 0:p.received_at)+"",o,c=l[2]&&_l(l),a=l[3]&&gl(l),f=((d=l[0])==null?void 0:d.text)&&pl(l);return{c(){var u,_,m,k;e=b("div"),c&&c.c(),t=E(),a&&a.c(),n=E(),f&&f.c(),i=E(),s=b("div"),o=Z(r),w(s,"class","flex pos_abs unselect date svelte-1m8yuzj"),le(s,"attachment_mode",l[2]&&!((u=l[0])!=null&&u.text)),w(e,"class","flex flex_clm overhide pos_abs chat_item svelte-1m8yuzj"),le(e,"chat_item_other",(_=l[0])==null?void 0:_.incoming),le(e,"chat_item_self",!((m=l[0])!=null&&m.incoming)),le(e,"has_text",(k=l[0])==null?void 0:k.text)},m(u,_){H(u,e,_),c&&c.m(e,null),g(e,t),a&&a.m(e,null),g(e,n),f&&f.m(e,null),g(e,i),g(e,s),g(s,o),l[14](e)},p(u,[_]){var m,k,S,v,h,A;u[2]?c?c.p(u,_):(c=_l(u),c.c(),c.m(e,t)):c&&(c.d(1),c=null),u[3]?a?a.p(u,_):(a=gl(u),a.c(),a.m(e,n)):a&&(a.d(1),a=null),(m=u[0])!=null&&m.text?f?f.p(u,_):(f=pl(u),f.c(),f.m(e,i)):f&&(f.d(1),f=null),_&1&&r!==(r=u[7]((k=u[0])==null?void 0:k.received_at)+"")&&_e(o,r),_&5&&le(s,"attachment_mode",u[2]&&!((S=u[0])!=null&&S.text)),_&1&&le(e,"chat_item_other",(v=u[0])==null?void 0:v.incoming),_&1&&le(e,"chat_item_self",!((h=u[0])!=null&&h.incoming)),_&1&&le(e,"has_text",(A=u[0])==null?void 0:A.text)},i:ne,o:ne,d(u){u&&P(e),c&&c.d(),a&&a.d(),f&&f.d(),l[14](null)}}}function bs(l,e,t){let{app:n}=e,{bbox:i=null}=e,{message:s=null}=e,{render_Width:r=1}=e,{render_X:o=-r*2}=e,c=null,a=null,f=null,p=null,d=[],u=[],_=1;function m(y){var O;d=[],u=[],y&&(O=y.attachments)!=null&&O.length&&(d=y.attachments.filter(L=>L.file_type==="IM").map(L=>({url:L.url})),u=y.attachments.filter(L=>L.file_type==="DC").map(L=>({url:L.url})));const C=i.height*.7;i.width,t(4,_=C),t(2,f=d==null?void 0:d[0]),t(3,p=u==null?void 0:u[0])}function k(y){if(!y||!Array.isArray(y.attachments)){t(0,a=null);return}if(!a){t(0,a=y);return}if(a.text!==y.text||a.incoming!==y.incoming||a.received_at!==y.received_at||a.attachments.length!==y.attachments.length){t(0,a=y);return}if(!a.attachments.map((C,O)=>[C,y.attachments[O]]).every(([C,O])=>C.file_type===O.file_type&&C.url===O.url)){t(0,a=y);return}}const S=y=>C=>{y&&y.url&&Tt(y.url)},v=y=>C=>{y&&y.url&&n.events.emit("openOverlayImageView",y.url)},h=y=>{if(y===null)return"";const C=L=>String(L).padStart(2,"0"),O=new Date;return y=new Date(y),y.getYear()===O.getYear()&&y.getMonth()===O.getMonth()&&y.getDate()===O.getDate()?`${C(y.getHours())}:${C(y.getMinutes())}`:`${C(y.getDate())}.${C(y.getMonth())}.${y.getFullYear()} ${C(y.getHours())}:${C(y.getMinutes())}`},A=()=>Ql(p.url);function T(y){Ne[y?"unshift":"push"](()=>{c=y,t(1,c)})}return l.$$set=y=>{"app"in y&&t(8,n=y.app),"bbox"in y&&t(9,i=y.bbox),"message"in y&&t(10,s=y.message),"render_Width"in y&&t(11,r=y.render_Width),"render_X"in y&&t(12,o=y.render_X)},l.$$.update=()=>{l.$$.dirty&1024&&k(s),l.$$.dirty&1&&m(a)},[a,c,f,p,_,S,v,h,n,i,s,r,o,A,T]}class ys extends ke{constructor(e){super(),ye(this,e,bs,ws,pe,{app:8,bbox:9,message:10,render_Width:11,render_X:12})}}function ks(l){let e;return{c(){e=b("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,w(e,"class","lds-roller svelte-j15bjw")},m(t,n){H(t,e,n)},p:ne,i:ne,o:ne,d(t){t&&P(e)}}}class it extends ke{constructor(e){super(),ye(this,e,null,ks,pe,{})}}function ml(l,e,t){const n=l.slice();return n[21]=e[t],n}function hl(l){var A,T,y,C;let e,t,n,i,s,r,o,c,a=l[0].lead_GetStatusTitle((T=(A=l[6])==null?void 0:A.lead)==null?void 0:T.status)+"",f,p,d,u,_,m,k,S=l[2]&&vl(l),v=((C=(y=l[6])==null?void 0:y.lead)==null?void 0:C.status)!=="DL"&&bl(l),h=l[3]&&yl();return{c(){var O,L,M,j;e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("img"),o=E(),c=b("div"),f=Z(a),p=E(),S&&S.c(),d=E(),v&&v.c(),u=E(),h&&h.c(),w(n,"class","pos_abs w100 h100 deleteProgress svelte-7zcguq"),N(n,"width",l[1]+"%"),w(t,"class","pos_abs w100 h100 overhide bg svelte-7zcguq"),We(s.src,r="assets/icons/status1.png")||w(s,"src",r),w(s,"draggable","false"),w(s,"class","pos_abs statusIcon svelte-7zcguq"),w(c,"class","flex flex_cy nowrap pos_rel label svelte-7zcguq"),le(c,"leftBlock",((L=(O=l[6])==null?void 0:O.lead)==null?void 0:L.status)!=="DL"),w(e,"class","flex flex_cx flex_cy cursor_ptr unselect statusCnt pos_rel svelte-7zcguq"),le(e,"loading",l[3]||((j=(M=l[6])==null?void 0:M.lead)==null?void 0:j.status)==="DL")},m(O,L){H(O,e,L),g(e,t),g(t,n),g(e,i),g(e,s),g(e,o),g(e,c),g(c,f),g(c,p),S&&S.m(c,null),g(e,d),v&&v.m(e,null),g(e,u),h&&h.m(e,null),l[15](e),_=!0,m||(k=K(c,"click",l[8]),m=!0)},p(O,L){var M,j,x,F,X,ee,te,V;(!_||L&2)&&N(n,"width",O[1]+"%"),(!_||L&65)&&a!==(a=O[0].lead_GetStatusTitle((j=(M=O[6])==null?void 0:M.lead)==null?void 0:j.status)+"")&&_e(f,a),O[2]?S?(S.p(O,L),L&4&&z(S,1)):(S=vl(O),S.c(),z(S,1),S.m(c,null)):S&&(ve(),B(S,1,1,()=>{S=null}),we()),(!_||L&64)&&le(c,"leftBlock",((F=(x=O[6])==null?void 0:x.lead)==null?void 0:F.status)!=="DL"),((ee=(X=O[6])==null?void 0:X.lead)==null?void 0:ee.status)!=="DL"?v?v.p(O,L):(v=bl(O),v.c(),v.m(e,u)):v&&(v.d(1),v=null),O[3]?h?L&8&&z(h,1):(h=yl(),h.c(),z(h,1),h.m(e,null)):h&&(ve(),B(h,1,1,()=>{h=null}),we()),(!_||L&72)&&le(e,"loading",O[3]||((V=(te=O[6])==null?void 0:te.lead)==null?void 0:V.status)==="DL")},i(O){_||(z(S),z(h),_=!0)},o(O){B(S),B(h),_=!1},d(O){O&&P(e),S&&S.d(),v&&v.d(),h&&h.d(),l[15](null),m=!1,k()}}}function vl(l){var c,a;let e,t=[],n=new Map,i,s,r=l[0].lead_GetStatusList((a=(c=l[6])==null?void 0:c.lead)==null?void 0:a.status);const o=f=>f[21].id;for(let f=0;f<r.length;f+=1){let p=ml(l,r,f),d=o(p);n.set(d,t[f]=wl(d,p))}return{c(){e=b("div");for(let f=0;f<t.length;f+=1)t[f].c();w(e,"class","flex flex_clm pos_abs overhide selectList svelte-7zcguq")},m(f,p){H(f,e,p);for(let d=0;d<t.length;d+=1)t[d].m(e,null);s=!0},p(f,p){var d,u;p&1089&&(r=f[0].lead_GetStatusList((u=(d=f[6])==null?void 0:d.lead)==null?void 0:u.status),t=xe(t,p,o,1,f,r,n,e,jt,wl,null,ml))},i(f){s||(f&&je(()=>{i||(i=Se(e,vt,{},!0)),i.run(1)}),s=!0)},o(f){f&&(i||(i=Se(e,vt,{},!1)),i.run(0)),s=!1},d(f){f&&P(e);for(let p=0;p<t.length;p+=1)t[p].d();f&&i&&i.end()}}}function wl(l,e){let t,n=e[21].title+"",i,s,r;return{key:l,first:null,c(){t=b("div"),i=Z(n),w(t,"class","flex nowrap cursor_ptr w100 label selectItem svelte-7zcguq"),this.first=t},m(o,c){H(o,t,c),g(t,i),s||(r=K(t,"click",fn(an(function(){He(e[10](e[21].id))&&e[10](e[21].id).apply(this,arguments)}))),s=!0)},p(o,c){e=o,c&65&&n!==(n=e[21].title+"")&&_e(i,n)},d(o){o&&P(t),s=!1,r()}}}function bl(l){let e,t,n;return{c(){e=b("div"),e.textContent="Delete",w(e,"class","flex flex_cy nowrap pos_rel pad svelte-7zcguq")},m(i,s){H(i,e,s),t||(n=[K(e,"mousedown",function(){He(l[11](l[6]))&&l[11](l[6]).apply(this,arguments)}),K(e,"mouseleave",l[12])],t=!0)},p(i,s){l=i},d(i){i&&P(e),t=!1,Ae(n)}}}function yl(l){let e,t,n,i;return t=new it({}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_abs loadingInd svelte-7zcguq"),N(e,"transform","scale(0.23)"),N(e,"transform-origin","top"),N(e,"filter","invert(1)")},m(s,r){H(s,e,r),ue(t,e,null),i=!0},i(s){i||(z(t.$$.fragment,s),s&&je(()=>{n||(n=Se(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){B(t.$$.fragment,s),s&&(n||(n=Se(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function Ls(l){let e,t,n,i,s=l[6]&&l[6].lead&&hl(l);return{c(){s&&s.c(),e=Ve()},m(r,o){s&&s.m(r,o),H(r,e,o),t=!0,n||(i=[K(window,"mouseup",l[12]),K(window,"mousedown",l[9]),K(window,"blur",l[9])],n=!0)},p(r,[o]){r[6]&&r[6].lead?s?(s.p(r,o),o&64&&z(s,1)):(s=hl(r),s.c(),z(s,1),s.m(e.parentNode,e)):s&&(ve(),B(s,1,1,()=>{s=null}),we())},i(r){t||(z(s),t=!0)},o(r){B(s),t=!1},d(r){s&&s.d(r),r&&P(e),n=!1,Ae(i)}}}function Ss(l,e,t){let n,i,s,r=ne,o=()=>(r(),r=It(T,M=>t(1,s=M)),T);l.$$.on_destroy.push(()=>r());let{app:c}=e;const{dialogMap_r:a,dialogMap_SetDialog:f}=c;Le(l,a,M=>t(14,i=M));let{dialog_id:p}=e,d=!1,u=!1;const _=()=>{var M;return!(!n||!n.lead||((M=n==null?void 0:n.lead)==null?void 0:M.status)==="DL"||u)};let m;const k=M=>{!_()||t(2,d=!d)},S=M=>{let j=M.target;for(;j;){if(j===m)return;j=j.parentNode}t(2,d=!1)},v=M=>async j=>{if(!!_()){if(t(2,d=!1),t(3,u=!0),n){const x=await g_Api.lead_SetStatus(n.lead.tg_id,M);x&&n&&n.lead&&n.lead.tg_id===x.tg_id&&(t(6,n.lead=x,n),f(n))}t(3,u=!1)}};let h=null,A=Number.POSITIVE_INFINITY,T=Ge(0,{duration:2e3});o();const y=M=>j=>{var x;t(2,d=!1),h=(x=M==null?void 0:M.lead)==null?void 0:x.tg_id,A=Date.now(),o(t(5,T=Ge(s,{duration:2e3}))),Ye(T,s=100,s)},C=M=>{t(2,d=!1),h=null,A=Number.POSITIVE_INFINITY,o(t(5,T=Ge(s,{duration:200}))),Ye(T,s=0,s)},O=async()=>{var M;!_()||(A+1200<Date.now()&&h===((M=n==null?void 0:n.lead)==null?void 0:M.tg_id)&&await v("DL")(),C())};function L(M){Ne[M?"unshift":"push"](()=>{m=M,t(4,m)})}return l.$$set=M=>{"app"in M&&t(0,c=M.app),"dialog_id"in M&&t(13,p=M.dialog_id)},l.$$.update=()=>{l.$$.dirty&2&&s>=100&&O(),l.$$.dirty&24576&&t(6,n=i[p])},[c,s,d,u,m,T,n,a,k,S,v,y,C,p,i,L]}class Ms extends ke{constructor(e){super(),ye(this,e,Ss,Ls,pe,{app:0,dialog_id:13})}}function kl(l,e,t){const n=l.slice();return n[20]=e[t],n}function Ll(l,e,t){const n=l.slice();return n[20]=e[t],n}function Sl(l){var u,_;let e,t,n,i=[],s=new Map,r,o,c,a,f=(_=(u=l[0])==null?void 0:u.tag)!=null?_:[];const p=m=>m[20].id;for(let m=0;m<f.length;m+=1){let k=Ll(l,f,m),S=p(k);s.set(S,i[m]=Tl(S,k))}let d=l[1]!==null&&l[0]&&l[1]===l[0].id&&l[3].length&&Ol(l);return{c(){e=b("div"),t=b("div"),t.innerHTML=`Add tag
			<div class="flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6">+</div>`,n=E();for(let m=0;m<i.length;m+=1)i[m].c();r=E(),d&&d.c(),w(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),le(t,"disabled",l[3].length===0),w(e,"class","flex tag_list unselect pos_rel svelte-elfos6")},m(m,k){H(m,e,k),g(e,t),g(e,n);for(let S=0;S<i.length;S+=1)i[S].m(e,null);g(e,r),d&&d.m(e,null),l[14](e),o=!0,c||(a=K(t,"click",l[13]),c=!0)},p(m,k){var S,v;(!o||k&8)&&le(t,"disabled",m[3].length===0),k&325&&(f=(v=(S=m[0])==null?void 0:S.tag)!=null?v:[],ve(),i=xe(i,k,p,1,m,f,s,e,nt,Tl,r,Ll),we()),m[1]!==null&&m[0]&&m[1]===m[0].id&&m[3].length?d?(d.p(m,k),k&11&&z(d,1)):(d=Ol(m),d.c(),z(d,1),d.m(e,null)):d&&(ve(),B(d,1,1,()=>{d=null}),we())},i(m){if(!o){for(let k=0;k<f.length;k+=1)z(i[k]);z(d),o=!0}},o(m){for(let k=0;k<i.length;k+=1)B(i[k]);B(d),o=!1},d(m){m&&P(e);for(let k=0;k<i.length;k+=1)i[k].d();d&&d.d(),l[14](null),c=!1,a()}}}function Ml(l){let e,t,n;return t=new it({}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){H(i,e,s),ue(t,e,null),n=!0},i(i){n||(z(t.$$.fragment,i),n=!0)},o(i){B(t.$$.fragment,i),n=!1},d(i){i&&P(e),de(t)}}}function Tl(l,e){let t,n=e[20].title.toLowerCase()+"",i,s,r,o,c=e[2]===e[6](e[0].id,e[20]),a,f,p,d=c&&Ml();return{key:l,first:null,c(){t=b("div"),i=Z(n),s=E(),r=b("div"),r.textContent="X",o=E(),d&&d.c(),w(r,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),w(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag svelte-elfos6"),N(t,"background",e[20].background_color),N(t,"color",e[20].color),le(t,"disabled",e[2]),this.first=t},m(u,_){H(u,t,_),g(t,i),g(t,s),g(t,r),g(t,o),d&&d.m(t,null),a=!0,f||(p=K(t,"click",function(){He(e[8](e[20]))&&e[8](e[20]).apply(this,arguments)}),f=!0)},p(u,_){e=u,(!a||_&1)&&n!==(n=e[20].title.toLowerCase()+"")&&_e(i,n),_&5&&(c=e[2]===e[6](e[0].id,e[20])),c?d?_&5&&z(d,1):(d=Ml(),d.c(),z(d,1),d.m(t,null)):d&&(ve(),B(d,1,1,()=>{d=null}),we()),(!a||_&1)&&N(t,"background",e[20].background_color),(!a||_&1)&&N(t,"color",e[20].color),(!a||_&4)&&le(t,"disabled",e[2])},i(u){a||(z(d),a=!0)},o(u){B(d),a=!1},d(u){u&&P(t),d&&d.d(),f=!1,p()}}}function Ol(l){let e,t,n=[],i=new Map,s,r,o=l[3];const c=a=>a[20].title;for(let a=0;a<o.length;a+=1){let f=kl(l,o,a),p=c(f);i.set(p,n[a]=Il(p,f))}return{c(){e=b("div"),t=b("div");for(let a=0;a<n.length;a+=1)n[a].c();w(t,"class","flex tagAddList1 svelte-elfos6"),N(t,"flex-wrap","wrap"),w(e,"class","pos_abs tag_settings flex flex_clm svelte-elfos6")},m(a,f){H(a,e,f),g(e,t);for(let p=0;p<n.length;p+=1)n[p].m(t,null);r=!0},p(a,f){f&205&&(o=a[3],ve(),n=xe(n,f,c,1,a,o,i,t,nt,Il,null,kl),we())},i(a){if(!r){for(let f=0;f<o.length;f+=1)z(n[f]);a&&je(()=>{s||(s=Se(e,vt,{},!0)),s.run(1)}),r=!0}},o(a){for(let f=0;f<n.length;f+=1)B(n[f]);a&&(s||(s=Se(e,vt,{},!1)),s.run(0)),r=!1},d(a){a&&P(e);for(let f=0;f<n.length;f+=1)n[f].d();a&&s&&s.end()}}}function Dl(l){let e,t,n;return t=new it({}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){H(i,e,s),ue(t,e,null),n=!0},i(i){n||(z(t.$$.fragment,i),n=!0)},o(i){B(t.$$.fragment,i),n=!1},d(i){i&&P(e),de(t)}}}function Il(l,e){let t,n=e[20].title+"",i,s,r,o=e[2]===e[6](e[0].id,e[20]),c,a,f,p,d=o&&Dl();return{key:l,first:null,c(){t=b("div"),i=Z(n),s=b("div"),s.textContent="+",r=E(),d&&d.c(),c=E(),w(s,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),w(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),N(t,"background",e[20].background_color),N(t,"color",e[20].color),le(t,"disabled",e[2]),this.first=t},m(u,_){H(u,t,_),g(t,i),g(t,s),g(t,r),d&&d.m(t,null),g(t,c),a=!0,f||(p=K(t,"click",function(){He(e[7](e[20]))&&e[7](e[20]).apply(this,arguments)}),f=!0)},p(u,_){e=u,(!a||_&8)&&n!==(n=e[20].title+"")&&_e(i,n),_&13&&(o=e[2]===e[6](e[0].id,e[20])),o?d?_&13&&z(d,1):(d=Dl(),d.c(),z(d,1),d.m(t,c)):d&&(ve(),B(d,1,1,()=>{d=null}),we()),(!a||_&8)&&N(t,"background",e[20].background_color),(!a||_&8)&&N(t,"color",e[20].color),(!a||_&4)&&le(t,"disabled",e[2])},i(u){a||(z(d),a=!0)},o(u){B(d),a=!1},d(u){u&&P(t),d&&d.d(),f=!1,p()}}}function Ts(l){let e,t,n,i,s=l[0]&&Sl(l);return{c(){s&&s.c(),e=Ve()},m(r,o){s&&s.m(r,o),H(r,e,o),t=!0,n||(i=[K(window,"mousedown",l[9]),K(window,"blur",l[9])],n=!0)},p(r,[o]){r[0]?s?(s.p(r,o),o&1&&z(s,1)):(s=Sl(r),s.c(),z(s,1),s.m(e.parentNode,e)):s&&(ve(),B(s,1,1,()=>{s=null}),we())},i(r){t||(z(s),t=!0)},o(r){B(s),t=!1},d(r){s&&s.d(r),r&&P(e),n=!1,Ae(i)}}}function Os(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r,dialogMap_SetDialog:o}=s;Le(l,r,T=>t(12,i=T));let{dialog_id:c=null}=e,a=null,f=!1;const p=async(T,y)=>{const C=await g_Api.dialog_SetTags(n.id,y);return C&&o(C),C},d=(T,y)=>{var C;return`${T}|${(C=y==null?void 0:y.title)!=null?C:"*"}`},u=T=>async y=>{if(!n||f)return;t(2,f=d(n.id,T));const C={color:"#fff",background_color:"#f00",...T,title:T.title.toLowerCase().trim()};await p(n.id,[...n.tag,C]),t(2,f=!1)},_=T=>async y=>{if(!n||f)return;t(2,f=d(n.id,T));const C=n.tag.filter(O=>O.id!==T.id).map(O=>({title:O.title,color:O.color,background_color:O.background_color}));await p(n.id,C),t(2,f=!1)};let m=[];function k(){var y;if(!n)return;const T=new Set(((y=n==null?void 0:n.tag)!=null?y:[]).map(C=>C.title));t(3,m=g_Config.pinnedTags.filter(C=>!T.has(C.title)))}let S;const v=T=>{let y=T.target;for(;y;){if(y===S)return;y=y.parentNode}t(1,a=null)},h=()=>t(1,a=n.id);function A(T){Ne[T?"unshift":"push"](()=>{S=T,t(4,S)})}return l.$$set=T=>{"app"in T&&t(10,s=T.app),"dialog_id"in T&&t(11,c=T.dialog_id)},l.$$.update=()=>{l.$$.dirty&6144&&t(0,n=i[c]),l.$$.dirty&1&&k()},[n,a,f,m,S,r,d,u,_,v,s,c,i,h,A]}class Ds extends ke{constructor(e){super(),ye(this,e,Os,Ts,pe,{app:10,dialog_id:11})}}function Cl(l){var F,X,ee,te,V,se,me,Y,fe,he;let e,t,n,i,s=((ee=(X=(F=l[2])==null?void 0:F.lead)==null?void 0:X.first_name)!=null?ee:"")+"",r,o,c,a,f,p=((se=(V=(te=l[2])==null?void 0:te.lead)==null?void 0:V.last_name)!=null?se:"")+"",d,u,_,m,k,S,v,h,A,T,y,C,O,L,M,j=((Y=(me=l[2])==null?void 0:me.lead)==null?void 0:Y.username)&&jl(l),x=((he=(fe=l[2])==null?void 0:fe.lead)==null?void 0:he.ref_link)&&Al(l);return h=new Ms({props:{app:l[0],dialog_id:l[2].id}}),C=new Ds({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),r=Z(s),o=E(),c=b("div"),a=E(),f=b("div"),d=Z(p),u=Z("\xA0"),_=E(),m=b("div"),j&&j.c(),k=E(),x&&x.c(),S=E(),v=b("div"),ge(h.$$.fragment),A=E(),T=b("div"),y=E(),ge(C.$$.fragment),O=E(),L=b("div"),N(t,"width","8px"),N(c,"width","8px"),w(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),w(m,"class","nowrap textOverEllipsis username svelte-qywc37"),N(T,"width","4px"),w(v,"class","flex"),N(L,"height","4px")},m(U,J){H(U,e,J),g(e,t),g(e,n),g(e,i),g(i,r),g(e,o),g(e,c),g(e,a),g(e,f),g(f,d),g(f,u),H(U,_,J),H(U,m,J),j&&j.m(m,null),H(U,k,J),x&&x.m(U,J),H(U,S,J),H(U,v,J),ue(h,v,null),g(v,A),g(v,T),g(v,y),ue(C,v,null),H(U,O,J),H(U,L,J),M=!0},p(U,J){var Me,Fe,Ee,be,D,I,R,G,W,q;(!M||J&4)&&s!==(s=((Ee=(Fe=(Me=U[2])==null?void 0:Me.lead)==null?void 0:Fe.first_name)!=null?Ee:"")+"")&&_e(r,s),(!M||J&4)&&p!==(p=((I=(D=(be=U[2])==null?void 0:be.lead)==null?void 0:D.last_name)!=null?I:"")+"")&&_e(d,p),(G=(R=U[2])==null?void 0:R.lead)!=null&&G.username?j?j.p(U,J):(j=jl(U),j.c(),j.m(m,null)):j&&(j.d(1),j=null),(q=(W=U[2])==null?void 0:W.lead)!=null&&q.ref_link?x?x.p(U,J):(x=Al(U),x.c(),x.m(S.parentNode,S)):x&&(x.d(1),x=null);const re={};J&1&&(re.app=U[0]),J&4&&(re.dialog_id=U[2].id),h.$set(re);const ae={};J&1&&(ae.app=U[0]),J&4&&(ae.dialog_id=U[2].id),C.$set(ae)},i(U){M||(z(h.$$.fragment,U),z(C.$$.fragment,U),M=!0)},o(U){B(h.$$.fragment,U),B(C.$$.fragment,U),M=!1},d(U){U&&P(e),U&&P(_),U&&P(m),j&&j.d(),U&&P(k),x&&x.d(U),U&&P(S),U&&P(v),de(h),de(C),U&&P(O),U&&P(L)}}}function jl(l){let e,t=l[2].lead.username+"",n;return{c(){e=Z("@"),n=Z(t)},m(i,s){H(i,e,s),H(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&_e(n,t)},d(i){i&&P(e),i&&P(n)}}}function Al(l){var p,d;let e,t,n,i,s=((d=(p=l[2])==null?void 0:p.lead)==null?void 0:d.ref_link)+"",r,o,c,a,f;return{c(){e=b("div"),t=b("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=E(),i=b("div"),r=Z(s),o=E(),c=b("div"),w(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),w(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),w(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),N(c,"height","4px")},m(u,_){H(u,e,_),g(e,t),g(e,n),g(e,i),g(i,r),H(u,o,_),H(u,c,_),a||(f=K(e,"click",l[6]),a=!0)},p(u,_){var m,k;_&4&&s!==(s=((k=(m=u[2])==null?void 0:m.lead)==null?void 0:k.ref_link)+"")&&_e(r,s)},d(u){u&&P(e),u&&P(o),u&&P(c),a=!1,f()}}}function El(l){let e,t,n,i;return t=new it({}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_abs loading svelte-qywc37")},m(s,r){H(s,e,r),ue(t,e,null),i=!0},i(s){i||(z(t.$$.fragment,s),s&&je(()=>{n||(n=Se(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){B(t.$$.fragment,s),s&&(n||(n=Se(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function Is(l){let e,t,n,i,s=l[2]&&Cl(l),r=l[1]&&El();return{c(){e=b("div"),t=b("div"),s&&s.c(),n=E(),r&&r.c(),w(t,"class","flex flex_clm flex_cx flex_grow_1"),w(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,c){H(o,e,c),g(e,t),s&&s.m(t,null),g(e,n),r&&r.m(e,null),i=!0},p(o,[c]){o[2]?s?(s.p(o,c),c&4&&z(s,1)):(s=Cl(o),s.c(),z(s,1),s.m(t,null)):s&&(ve(),B(s,1,1,()=>{s=null}),we()),o[1]?r?c&2&&z(r,1):(r=El(),r.c(),z(r,1),r.m(e,null)):r&&(ve(),B(r,1,1,()=>{r=null}),we())},i(o){i||(z(s),z(r),i=!0)},o(o){B(s),B(r),i=!1},d(o){o&&P(e),s&&s.d(),r&&r.d()}}}function Cs(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;Le(l,r,f=>t(5,i=f));let{dialog_id:o=null}=e,{loading:c=!1}=e;const a=()=>{var f;return Dn((f=n==null?void 0:n.lead)==null?void 0:f.ref_link)};return l.$$set=f=>{"app"in f&&t(0,s=f.app),"dialog_id"in f&&t(4,o=f.dialog_id),"loading"in f&&t(1,c=f.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,c,n,r,o,i,a]}class js extends ke{constructor(e){super(),ye(this,e,Cs,Is,pe,{app:0,dialog_id:4,loading:1})}}function zl(l,e,t){const n=l.slice();return n[36]=e[t],n}function Pl(l,e){let t,n,i;return n=new ys({props:{app:e[0],bbox:e[9],message:e[36],render_Width:e[8]}}),{key:l,first:null,c(){t=Ve(),ge(n.$$.fragment),this.first=t},m(s,r){H(s,t,r),ue(n,s,r),i=!0},p(s,r){e=s;const o={};r[0]&1&&(o.app=e[0]),r[0]&512&&(o.bbox=e[9]),r[0]&4&&(o.message=e[36]),r[0]&256&&(o.render_Width=e[8]),n.$set(o)},i(s){i||(z(n.$$.fragment,s),i=!0)},o(s){B(n.$$.fragment,s),i=!1},d(s){s&&P(t),de(n,s)}}}function As(l){let e,t,n,i,s,r,o,c=[],a=new Map,f,p,d,u,_,m,k,S,v,h;t=new js({props:{app:l[0],dialog_id:l[1],loading:l[3]}});let A=l[2];const T=O=>O[36].index;for(let O=0;O<A.length;O+=1){let L=zl(l,A,O),M=T(L);a.set(M,c[O]=Pl(M,L))}function y(O){l[17](O)}let C={value_in:l[4]};return l[5]!==void 0&&(C.value_out=l[5]),d=new ln({props:C}),Ne.push(()=>ht(d,"value_out",y)),{c(){e=b("div"),ge(t.$$.fragment),n=E(),i=b("div"),s=b("div"),r=b("div"),o=b("div");for(let O=0;O<c.length;O+=1)c[O].c();f=E(),p=b("div"),ge(d.$$.fragment),_=E(),m=b("div"),k=b("textarea"),w(o,"class","pos_rel w100 h100"),w(p,"class","pos_abs h100 chatScroll svelte-1khz9us"),w(r,"class","pos_rel w100 h100"),w(s,"class","flex pos_abs overhide"),w(i,"class","flex flex_grow_1 pos_rel overhide"),w(k,"class","flex flex_grow_1 chat_input_textarea svelte-1khz9us"),w(m,"class","flex chat_input svelte-1khz9us"),w(e,"class","flex flex_clm flex_grow_1 overhide cnt svelte-1khz9us")},m(O,L){H(O,e,L),ue(t,e,null),g(e,n),g(e,i),g(i,s),g(s,r),g(r,o);for(let M=0;M<c.length;M+=1)c[M].m(o,null);l[16](o),g(r,f),g(r,p),ue(d,p,null),g(e,_),g(e,m),g(m,k),qt(k,l[7]),S=!0,v||(h=[K(r,"wheel",l[13],{passive:!0}),Ze(st.call(null,s,l[11])),K(k,"input",l[18]),K(k,"keyup",l[12]),K(k,"keydown",l[12])],v=!0)},p(O,L){const M={};L[0]&1&&(M.app=O[0]),L[0]&2&&(M.dialog_id=O[1]),L[0]&8&&(M.loading=O[3]),t.$set(M),L[0]&773&&(A=O[2],ve(),c=xe(c,L,T,1,O,A,a,o,nt,Pl,null,zl),we());const j={};L[0]&16&&(j.value_in=O[4]),!u&&L[0]&32&&(u=!0,j.value_out=O[5],mt(()=>u=!1)),d.$set(j),L[0]&128&&qt(k,O[7])},i(O){if(!S){z(t.$$.fragment,O);for(let L=0;L<A.length;L+=1)z(c[L]);z(d.$$.fragment,O),S=!0}},o(O){B(t.$$.fragment,O);for(let L=0;L<c.length;L+=1)B(c[L]);B(d.$$.fragment,O),S=!1},d(O){O&&P(e),de(t);for(let L=0;L<c.length;L+=1)c[L].d();l[16](null),de(d),v=!1,Ae(h)}}}const Hl=10,ut=4;function Es(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;Le(l,o,Y=>t(15,i=Y));let{dialog_id:c=null}=e,a=[],f=[],p=new Set,d=0,u=0,_=1,m=1,k=null;const S=Be(null);Le(l,S,Y=>t(9,s=Y)),new Date().toJSON();let v=-1;async function h(Y,fe=0,he=20){const U=await g_Api.message_GetList({dialog_id:Y,offset:fe,limit:he});if(!!U&&n&&n.id===Y){for(d=U.count;a.length<d;){const re=a.length;a.push({id:v--,index:re,_isFakeMsg:!0})}const J=U.results;J.map((re,ae)=>re.index=fe+ae),J.map(re=>a[re.index]=re)}}let A="";const T=async Y=>{if(Y.which===13&&!Y.shiftKey&&!Y.ctrlKey&&(Y.preventDefault(),t(7,A=A.trim()),A)){const fe=A;t(7,A=""),n&&await g_Api.message_Create(n.id,fe)}};function y(){a=[],t(2,f=[]),p=new Set,d=0,console.log("clear all")}let C=null,O=null;async function L(Y){if(!Y){if(!C)return;C=null,y();return}O!==Y.id&&(C=Y,O=Y.id,y(),a=[],t(2,f=[]),d=0,t(3,u++,u),await h(Y.id),d&&await h(Y.id,Math.max(d-20,0),20),await g_Api.dialog_SetReadFlagAllMessages(Y.id),t(3,u--,u))}let M=1,j=!0;function x(){if(j&&requestAnimationFrame(x),!s||!k||!a.length)return;s.width;const Y=s.height,fe=s.width-Hl*2,he=Hl;t(8,M=fe-Math.max(120,Math.floor(fe*.1)));const U=1+m*(a.length-1);let J=Math.floor(U),re=U-J;J>=a.length&&(J=a.length-1,re=1);const ae=[],Me=[];let Fe=null;t(2,f=[]);for(let be=J-100,D=0,I=!0;be<J+100;be++)be<0||be>=a.length||(a[be]._isFakeMsg&&p.add(be),f[D]!==a[be]&&(I&&(I=!1,f.splice(D,1e9)),t(2,f[D]=a[be],f),t(2,f)),t(2,f[D]._drawIndex=D,f),be<J&&ae.push(f[D]),be>J&&Me.push(f[D]),be===J&&(Fe=f[D]),D++);const Ee=[...k.children];if(Ee.length===f.length){Ee.map((G,W)=>{const q=f[W];if(!q||G._remove)return;const ie=G.getBoundingClientRect();G._bbox=ie;const oe=Math.floor(he+(q.incoming?0:Math.max(100,s.width*.05)));G.__cacheWidth!==M&&(G.__cacheWidth=M,G.style.maxWidth=M+"px"),G.__cacheLeft!==oe&&(G.__cacheLeft=oe,G.style.left=oe+"px")});const be=(G,W,q=1)=>(G.__cacheTop!==W&&(G.__cacheTop=W,G.style.top=W+"px"),W+(G._bbox.height+ut)*q);let D=0,I=0;const R=Ee[Fe._drawIndex];if(R){const G=R;D=Y+ut-(G._bbox.height+ut)*re,I=D,D=be(G,D,1)}Me.map((G,W)=>{const q=Ee[G._drawIndex];D=be(q,D,1)}),D=I,ae.reverse().map((G,W)=>{const q=Ee[G._drawIndex];D-=q._bbox.height+ut,be(q,D,0)})}}requestAnimationFrame(x),Xe(()=>j=!1);async function F(){if(p.size){const Y=[...p].sort((U,J)=>U-J);p.clear();const fe=[];let he={offset:null,limit:0};for(const U of Y){if(he.offset!==null){if(he.limit<=500&&he.offset+he.limit===U){he.limit++;continue}fe.push(he)}he={offset:U,limit:1}}he.offset!==null&&fe.push(he),n&&(t(3,u++,u),await Promise.all(fe.map(U=>h(n.id,U.offset,U.limit))),t(3,u--,u))}j&&setTimeout(F,500)}F();async function X(){n&&await g_Api.dialog_SetReadFlagAllMessages(n.id),j&&setTimeout(X,5e3)}X();async function ee(){n&&await h(n.id,d,20),j&&setTimeout(ee,500)}ee();const te=Y=>{t(4,_=a.length?m+Math.sign(Y.deltaY)/(a.length-1):0)};function V(Y){Ne[Y?"unshift":"push"](()=>{k=Y,t(6,k)})}function se(Y){m=Y,t(5,m)}function me(){A=this.value,t(7,A)}return l.$$set=Y=>{"app"in Y&&t(0,r=Y.app),"dialog_id"in Y&&t(1,c=Y.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&32770&&t(14,n=i[c]),l.$$.dirty[0]&16384&&L(n)},[r,c,f,u,_,m,k,A,M,s,o,S,T,te,n,i,V,se,me]}class zs extends ke{constructor(e){super(),ye(this,e,Es,As,pe,{app:0,dialog_id:1},null,[-1,-1])}}function Ps(l){let e,t,n,i,s,r,o,c,a,f,p,d,u,_,m,k,S,v,h,A,T;function y(M){l[5](M)}let C={};l[2]!==void 0&&(C.checked=l[2]),f=new rs({props:C}),Ne.push(()=>ht(f,"checked",y));function O(M){l[6](M)}let L={app:l[0]};return l[1]!==void 0&&(L.filterTag=l[1]),u=new vs({props:L}),Ne.push(()=>ht(u,"filterTag",O)),v=new ps({props:{app:l[0],filter:{filterTag:l[1],filterUnreadFirst:l[2]}}}),A=new zs({props:{app:l[0],dialog_id:l[3]}}),{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=b("label"),o=Z(`First unread \r
				`),c=b("div"),a=E(),ge(f.$$.fragment),d=E(),ge(u.$$.fragment),m=E(),k=b("div"),S=E(),ge(v.$$.fragment),h=E(),ge(A.$$.fragment),N(n,"height","2px"),N(c,"width","4px"),w(r,"class","flex flex_cy cursor_ptr unselect firstUnread svelte-14xikx8"),w(s,"class","flex flex_clm flex_cx header pos_rel svelte-14xikx8"),N(k,"height","20px"),w(t,"class","flex flex_clm list svelte-14xikx8"),w(e,"class","flex flex_grow_1")},m(M,j){H(M,e,j),g(e,t),g(t,n),g(t,i),g(t,s),g(s,r),g(r,o),g(r,c),g(r,a),ue(f,r,null),g(s,d),ue(u,s,null),g(t,m),g(t,k),g(t,S),ue(v,t,null),g(e,h),ue(A,e,null),T=!0},p(M,[j]){const x={};!p&&j&4&&(p=!0,x.checked=M[2],mt(()=>p=!1)),f.$set(x);const F={};j&1&&(F.app=M[0]),!_&&j&2&&(_=!0,F.filterTag=M[1],mt(()=>_=!1)),u.$set(F);const X={};j&1&&(X.app=M[0]),j&6&&(X.filter={filterTag:M[1],filterUnreadFirst:M[2]}),v.$set(X);const ee={};j&1&&(ee.app=M[0]),j&8&&(ee.dialog_id=M[3]),A.$set(ee)},i(M){T||(z(f.$$.fragment,M),z(u.$$.fragment,M),z(v.$$.fragment,M),z(A.$$.fragment,M),T=!0)},o(M){B(f.$$.fragment,M),B(u.$$.fragment,M),B(v.$$.fragment,M),B(A.$$.fragment,M),T=!1},d(M){M&&P(e),de(f),de(u),de(v),de(A)}}}function Hs(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;Le(l,s,f=>t(3,n=f));let r=null,o=1;function c(f){o=f,t(2,o)}function a(f){r=f,t(1,r)}return l.$$set=f=>{"app"in f&&t(0,i=f.app)},[i,r,o,n,s,c,a]}class Ns extends ke{constructor(e){super(),ye(this,e,Hs,Ps,pe,{app:0})}}function Fs(l){let e,t,n,i,s,r,o,c,a,f,p,d,u,_,m,k;return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("img"),r=E(),o=b("div"),c=b("div"),c.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/rotate.png"/>',a=E(),f=b("div"),f.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/download.png"/>',p=E(),d=b("div"),d.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/close.png"/>',w(i,"class","img svelte-d45see"),w(i,"draggable","false"),We(i.src,s=l[0])||w(i,"src",s),N(i,"transform","rotate("+l[3]+"deg)"),w(n,"class","pos_abs flex flex_cx flex_cy pad svelte-d45see"),N(n,"width",l[5]+"px"),N(n,"height",l[4]+"px"),w(t,"class","pos_abs flex flex_cx flex_cy pos_abs w100 h100 "),N(t,"transform","translate("+l[1]+"px, "+l[2]+"px)"),w(c,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(f,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(d,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(o,"class","flex pos_abs imgCtrlBtnGroup svelte-d45see"),w(e,"class","pos_abs w100 h100 unselect cnt layer_bg svelte-d45see")},m(S,v){H(S,e,v),g(e,t),g(t,n),g(n,i),g(e,r),g(e,o),g(o,c),g(o,a),g(o,f),g(o,p),g(o,d),_=!0,m||(k=[K(window,"mousemove",l[14]),K(window,"mouseup",l[13]),K(window,"blur",l[13]),K(window,"keydown",l[16]),K(i,"mousedown",l[12]),Ze(st.call(null,t,l[6])),K(c,"click",l[10]),K(f,"click",function(){He(Tt(l[0]))&&Tt(l[0]).apply(this,arguments)}),K(d,"click",l[15]),K(e,"wheel",l[11])],m=!0)},p(S,[v]){l=S,(!_||v&1&&!We(i.src,s=l[0]))&&w(i,"src",s),(!_||v&8)&&N(i,"transform","rotate("+l[3]+"deg)"),(!_||v&32)&&N(n,"width",l[5]+"px"),(!_||v&16)&&N(n,"height",l[4]+"px"),(!_||v&6)&&N(t,"transform","translate("+l[1]+"px, "+l[2]+"px)")},i(S){_||(je(()=>{u||(u=Se(e,Ie,{duration:100},!0)),u.run(1)}),_=!0)},o(S){u||(u=Se(e,Ie,{duration:100},!1)),u.run(0),_=!1},d(S){S&&P(e),S&&u&&u.end(),m=!1,Ae(k)}}}function Bs(l,e,t){let n,i,s,r,{url:o=null}=e;const c=pn(),a=Be(null);Le(l,a,L=>t(18,n=L));const f=Ge(0);Le(l,f,L=>t(3,i=L));const p=Ge(0);Le(l,p,L=>t(5,r=L));const d=Ge(0);Le(l,d,L=>t(4,s=L));let u=0,_=0,m={rotate:0,scale:1,whInverse:!1};const k=()=>{if(!n||!m)return;const L=m.whInverse?n.height:n.width,M=m.whInverse?n.width:n.height;Ye(p,r=L*m.scale,r),Ye(d,s=M*m.scale,s),Ye(f,i=m.rotate,i)},S=()=>{!n||!m||(t(17,m.rotate+=90,m),t(17,m.whInverse=!m.whInverse,m),t(17,m))},v=L=>{t(17,m.scale=Pe(.1,m.scale+Math.sign(L.deltaY)*.1,10),m)};let h=null;const A=L=>h=[L.clientX,L.clientY,u,_],T=L=>h=null,y=L=>{!h||t(1,[u,_]=[L.clientX,L.clientY].map((M,j)=>M-h[j]+h[j+2]),u,t(2,_))},C=L=>c("close"),O=L=>L.which===27&&C();return l.$$set=L=>{"url"in L&&t(0,o=L.url)},l.$$.update=()=>{l.$$.dirty&393216&&k()},[o,u,_,i,s,r,a,f,p,d,S,v,A,T,y,C,O,m,n]}class Rs extends ke{constructor(e){super(),ye(this,e,Bs,Fs,pe,{url:0})}}function Nl(l){let e=l[0],t,n,i=Fl(l);return{c(){i.c(),t=Ve()},m(s,r){i.m(s,r),H(s,t,r),n=!0},p(s,r){r&1&&pe(e,e=s[0])?(ve(),B(i,1,1,ne),we(),i=Fl(s),i.c(),z(i,1),i.m(t.parentNode,t)):i.p(s,r)},i(s){n||(z(i),n=!0)},o(s){B(i),n=!1},d(s){s&&P(t),i.d(s)}}}function Fl(l){let e,t;return e=new Rs({props:{url:l[1]}}),e.$on("close",l[3]),{c(){ge(e.$$.fragment)},m(n,i){ue(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.url=n[1]),e.$set(s)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){de(e,n)}}}function Gs(l){let e,t,n=l[1]&&Nl(l);return{c(){n&&n.c(),e=Ve()},m(i,s){n&&n.m(i,s),H(i,e,s),t=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&z(n,1)):(n=Nl(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(ve(),B(n,1,1,()=>{n=null}),we())},i(i){t||(z(n),t=!0)},o(i){B(n),t=!1},d(i){n&&n.d(i),i&&P(e)}}}function Us(l,e,t){let n=1,i=null,{events:s}=e;Xe(s.on("openOverlayImageView",o=>{t(0,n++,n),t(1,i=o)}));const r=()=>t(1,i=null);return l.$$set=o=>{"events"in o&&t(2,s=o.events)},[n,i,s,r]}class Ys extends ke{constructor(e){super(),ye(this,e,Us,Gs,pe,{events:2})}}function xs(l){let e,t,n,i,s,r,o,c,a,f;return n=new Jn({props:{app:l[0]}}),s=new ns({props:{app:l[0]}}),o=new Ns({props:{app:l[0]}}),a=new Ys({props:{events:l[0].events}}),{c(){e=b("div"),t=b("div"),ge(n.$$.fragment),i=E(),ge(s.$$.fragment),r=E(),ge(o.$$.fragment),c=E(),ge(a.$$.fragment),w(t,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),w(e,"class","flex w100 h100 pos_rel")},m(p,d){H(p,e,d),g(e,t),ue(n,t,null),g(t,i),ue(s,t,null),g(e,r),ue(o,e,null),g(e,c),ue(a,e,null),f=!0},p:ne,i(p){f||(z(n.$$.fragment,p),z(s.$$.fragment,p),z(o.$$.fragment,p),z(a.$$.fragment,p),f=!0)},o(p){B(n.$$.fragment,p),B(s.$$.fragment,p),B(o.$$.fragment,p),B(a.$$.fragment,p),f=!1},d(p){p&&P(e),de(n),de(s),de(o),de(a)}}}function qs(l,e,t){let{operatorSelf:n}=e,{config:i}=e;const s=En(n,i);return Xe(s.destroy),l.$$set=r=>{"operatorSelf"in r&&t(1,n=r.operatorSelf),"config"in r&&t(2,i=r.config)},[s,n,i]}class Ws extends ke{constructor(e){super(),ye(this,e,qs,xs,pe,{operatorSelf:1,config:2})}}function Bl(l,e,t){const n=l.slice();return n[5]=e[t],n}function Vs(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=Gl(Bl(l,n,r));const s=r=>B(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Ve()},m(r,o){for(let c=0;c<i.length;c+=1)i[c].m(r,o);H(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let c;for(c=0;c<n.length;c+=1){const a=Bl(r,n,c);i[c]?(i[c].p(a,o),z(i[c],1)):(i[c]=Gl(a),i[c].c(),z(i[c],1),i[c].m(e.parentNode,e))}for(ve(),c=n.length;c<i.length;c+=1)s(c);we()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)z(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)B(i[o]);t=!1},d(r){on(i,r),r&&P(e)}}}function Xs(l){let e,t,n,i,s;return i=new it({}),{c(){e=b("div"),t=b("div"),n=E(),ge(i.$$.fragment),N(t,"height","20px"),w(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){H(r,e,o),g(e,t),g(e,n),ue(i,e,null),s=!0},p:ne,i(r){s||(z(i.$$.fragment,r),s=!0)},o(r){B(i.$$.fragment,r),s=!1},d(r){r&&P(e),de(i)}}}function Rl(l){let e,t,n=l[5].username+"",i;return{c(){e=b("div"),t=Z("@"),i=Z(n),w(e,"class","nowrap textOverEllipsis")},m(s,r){H(s,e,r),g(e,t),g(e,i)},p(s,r){r&1&&n!==(n=s[5].username+"")&&_e(i,n)},d(s){s&&P(e)}}}function Gl(l){var h,A;let e,t,n,i=((h=l[5].first_name)!=null?h:"")+"",s,r,o,c,a,f=((A=l[5].last_name)!=null?A:"")+"",p,d,u,_,m,k,S,v=l[5].username&&Rl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),s=Z(i),r=E(),o=b("div"),c=E(),a=b("div"),p=Z(f),d=E(),v&&v.c(),u=E(),N(o,"width","8px"),w(t,"class","flex nowrap textOverEllipsis"),w(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(T,y){H(T,e,y),g(e,t),g(t,n),g(n,s),g(t,r),g(t,o),g(t,c),g(t,a),g(a,p),g(e,d),v&&v.m(e,null),g(e,u),m=!0,k||(S=K(e,"click",function(){He(l[2](l[5]))&&l[2](l[5]).apply(this,arguments)}),k=!0)},p(T,y){var C,O;l=T,(!m||y&1)&&i!==(i=((C=l[5].first_name)!=null?C:"")+"")&&_e(s,i),(!m||y&1)&&f!==(f=((O=l[5].last_name)!=null?O:"")+"")&&_e(p,f),l[5].username?v?v.p(l,y):(v=Rl(l),v.c(),v.m(e,u)):v&&(v.d(1),v=null)},i(T){m||(T&&je(()=>{_||(_=Se(e,Ie,{},!0)),_.run(1)}),m=!0)},o(T){T&&(_||(_=Se(e,Ie,{},!1)),_.run(0)),m=!1},d(T){T&&P(e),v&&v.d(),T&&_&&_.end(),k=!1,S()}}}function Js(l){let e,t,n,i;const s=[Xs,Vs],r=[];function o(c,a){return c[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=b("div"),n.c(),w(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(c,a){H(c,e,a),r[t].m(e,null),i=!0},p(c,[a]){let f=t;t=o(c),t===f?r[t].p(c,a):(ve(),B(r[f],1,1,()=>{r[f]=null}),we(),n=r[t],n?n.p(c,a):(n=r[t]=s[t](c),n.c()),z(n,1),n.m(e,null))},i(c){i||(z(n),i=!0)},o(c){B(n),i=!1},d(c){c&&P(e),r[t].d()}}}function Ks(l,e,t){let n=[],i=!1;const s=async()=>{var c;t(1,i=!0),t(0,n=[]);try{const a=await g_Api("GET","operators");t(0,n=(c=a.results)!=null?c:[])}catch{}t(1,i=!1)};let r=!1;const o=c=>a=>{r||($l(c),r=!0)};return s(),[n,i,o]}class Zs extends ke{constructor(e){super(),ye(this,e,Ks,Js,pe,{})}}const Qs=()=>{const l=()=>!0,e=D=>new Promise(I=>setTimeout(I,D)),t=(D,I)=>e(D+Math.round(Math.random()*(I-D))),n=(D,I,R)=>Math.min(R,Math.max(D,I)),i=(D=0)=>new Date(Date.now()+(D!=null?D:0)).toJSON(),s=(D,I)=>{var ie;const R=Math.max(0,(I==null?void 0:I.offset)|0),G=n(1,((ie=I==null?void 0:I.limit)!=null?ie:20)|0,1e6),W=D.length,q=D.slice(R,R+G);return{count:W,results:q}};let r=1;const o=D=>(D!=null?D:[]).map(I=>({...I,id:r++}));let c=1;const a=[],f={},p=D=>{var I;return(I=f[D])!=null?I:null},d=()=>a,u=D=>{var R,G,W;const I={operator_id:c++,username:(R=D.username)!=null?R:null,first_name:(G=D.first_name)!=null?G:null,last_name:(W=D.last_name)!=null?W:null};return a.push(I),f[I.username]=I,U(I.username),I};let _=123123124;const m=[],k={},S=D=>{var I;return(I=k[D])!=null?I:null},v=()=>m.filter(D=>!D.hasOperator).sort((D,I)=>D._date_joined_msec-I._date_joined_msec),h=D=>{var G,W,q;const I=_++,R={tg_id:I,username:(G=D.username)!=null?G:null,first_name:(W=D.first_name)!=null?W:null,last_name:(q=D.last_name)!=null?q:null,date_joined:i(D.timeDelta),esub:null,pub_id:null,refcode:null,subpub:null,hasOperator:!1,status:"NW",ref_link:`https://ref.global.com/getRef?tg_id=${I}`};return R._date_joined_msec=+new Date(R.date_joined),m.push(R),k[R.tg_id]=R,R},A=(D,I)=>{const R=S(I);return!R||!p(D)||R.hasOperator?!1:(j(D,I),R.hasOperator=!0,!0)},T=(D,I,R)=>{const G=S(I);return G?(R.status&&(G.status=R.status),G):null};let y=1;const C=[],O={},L=D=>{var I;return(I=O[D])!=null?I:null},M=(D,I=[])=>{D.tag||(D.tag=[],D._tagSearch=new Set);const R=o(I);D.tag.splice(0,1e9),D._tagSearch.clear(),R.map(G=>{D.tag.push(G),D._tagSearch.add(G.title)})},j=(D,I)=>{const R=S(I);if(!R||!p(D))return null;const W={id:y++,lead_id:I,lead:R,operator:D,unread_messages_count:0,last_message:null};return M(W),C.push(W),O[W.id]=W,R.hasOperator=!0,W},x=(D,I,R)=>{const G=L(I);return G?(R.tag&&M(G,R.tag),G):null},F=(D,I,R)=>{const G=L(I);return G?(me(D,{dialog_id:+I}).map(q=>q.is_read=!1),G.unread_messages_count=0,!0):null},X=(D,I={})=>{const R=Q=>Q.last_message?Q.last_message._received_at_msec:Q.lead?Q.lead._date_joined_msec:0,G=(Q,Te)=>Te-Q,W=(Q,Te)=>{let De=G(R(Q),R(Te));return De===0&&(De=G(Q.id,Te.id)),De},q=C.filter(Q=>Q.operator===D).filter(I.tag?Q=>Q._tagSearch.has(I.tag):l).filter(Q=>{var Te;return((Te=Q==null?void 0:Q.lead)==null?void 0:Te.status)!=="DL"});let ie=[],oe=[];return I.unread_first?(ie=q.filter(Q=>Q.unread_messages_count!==0),oe=q.filter(Q=>Q.unread_messages_count===0)):ie=q,ie.sort(W),oe.sort(W),ie.concat(oe)};let ee=1;const te=[],V={},se=(D,I={})=>{var ie,oe,Q;const R=+I.dialog,G=I.text,W=L(R);if(!W)return null;const q={id:ee++,dialog:R,text:G,is_read:(ie=I.is_read)!=null?ie:!0,incoming:(oe=I.incoming)!=null?oe:!1,attachments:(Q=I.attachments)!=null?Q:[],received_at:i(I.timeDelta)};return q._received_at_msec=+new Date(q.received_at),te.push(q),V[q.id]=q,W.last_message=q,q.is_read||W.unread_messages_count++,q},me=(D,I={})=>te.filter(I.dialog_id?R=>R.dialog===I.dialog_id:l),Y=5*60*1e3,fe={},he=D=>{var I;return(I=fe[D])!=null?I:null},U=(D,I={})=>{const G={online:!!I.online,offline_at:i(Y),interval:Math.round(Y/1e3)};return fe[D]=G,G},J=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.webp","9.webp","10.png","11.png","13.png","12.webp"],re=`\u0414\u0430, \u043C\u0451\u0440\u0442\u0432.
\u0411\u0435\u0434\u0441\u0442\u0432\u0438\u0435, \u0443\u0433\u0440\u043E\u0436\u0430\u044E\u0449\u0435\u0435 \u0436\u0438\u0437\u043D\u0438 \u0434\u0435\u0432\u0443\u0448\u043A\u0438, \u0438\u0441\u0447\u0435\u0437\u043B\u043E, \u0441\u043B\u043E\u0432\u043D\u043E \u044D\u0442\u043E \u0431\u044B\u043B\u0430 \u043A\u0430\u043A\u0430\u044F-\u0442\u043E \u0448\u0443\u0442\u043A\u0430. \u041D\u043E \u043E\u043D\u0430 \u043D\u0435 \u043C\u043E\u0433\u043B\u0430 \u0440\u0430\u0434\u043E\u0432\u0430\u0442\u044C\u0441\u044F, \u0432\u0435\u0434\u044C \u0421\u043C\u0435\u0440\u0442\u044C \u0441\u043C\u0435\u043D\u0438\u043B\u0430 \u0441\u0432\u043E\u044E \u0444\u043E\u0440\u043C\u0443 \u0438 \u043F\u0440\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432 \u0431\u043E\u043B\u0435\u0435 \u044F\u0432\u043D\u043E\u043C \u0432\u0438\u0434\u0435.
\u041F\u043E\u0434 \u0432\u0437\u0433\u043B\u044F\u0434\u043E\u043C \u043D\u0430\u043F\u0443\u0433\u0430\u043D\u043D\u043E\u0439 \u0434\u0435\u0432\u0443\u0448\u043A\u0438 \u0421\u043C\u0435\u0440\u0442\u044C \u0434\u0432\u0438\u043D\u0443\u043B\u0430\u0441\u044C \u0432 \u0435\u0451 \u0441\u0442\u043E\u0440\u043E\u043D\u0443. \u0422\u044C\u043C\u0430 \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439 \u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0433\u0443\u0449\u0430\u0442\u044C\u0441\u044F.
\u0422\u044C\u043C\u0430... \u043E\u043D\u0430 \u0441\u0435\u0439\u0447\u0430\u0441 \u043C\u0435\u043D\u044F \u043F\u0440\u043E\u0433\u043B\u043E\u0442\u0438\u0442, \u2014 \u043F\u043E\u0434\u0443\u043C\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430 \u0438 \u0435\u0449\u0451 \u043A\u0440\u0435\u043F\u0447\u0435 \u043E\u0431\u043D\u044F\u043B\u0430 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443. \u041E\u043D\u0430 \u0443\u0436\u0435 \u0434\u0430\u0436\u0435 \u0438 \u043D\u0435 \u0434\u0443\u043C\u0430\u043B\u0430 \u0431\u0435\u0436\u0430\u0442\u044C. \u0411\u0443\u0434\u044C \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u043E\u043C, \u043E\u043D\u0430 \u0431\u044B \u0435\u0449\u0435 \u043C\u043E\u0433\u043B\u0430 \u043D\u0430 \u0447\u0442\u043E-\u0442\u043E \u043D\u0430\u0434\u0435\u044F\u0442\u044C\u0441\u044F. \u041D\u043E \u043D\u0435\u0447\u0442\u043E, \u0432\u043E\u0437\u0432\u044B\u0448\u0430\u044E\u0449\u0435\u0435\u0441\u044F \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439, \u0441 \u043B\u0435\u0433\u043A\u043E\u0441\u0442\u044C\u044E \u0440\u0430\u0437\u0432\u0435\u044F\u043B\u043E \u0442\u0430\u043A\u0438\u0435 \u043C\u044B\u0441\u043B\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0445\u043E\u0442\u044F \u0431\u044B \u0434\u0430\u0440\u0443\u0439 \u043C\u043D\u0435 \u0431\u0435\u0437\u0431\u043E\u043B\u0435\u0437\u043D\u0435\u043D\u043D\u0443\u044E \u0441\u043C\u0435\u0440\u0442\u044C.
\u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u043C\u043E\u043B\u0438\u0442\u044C\u0441\u044F.
\u041C\u0430\u043B\u044B\u0448\u043A\u0430 \u0443\u0446\u0435\u043F\u0438\u043B\u0430\u0441\u044C \u0437\u0430 \u0435\u0451 \u0442\u0430\u043B\u0438\u044E, \u0434\u0440\u043E\u0436\u0430 \u043E\u0442 \u0443\u0436\u0430\u0441\u0430. \u0421\u043F\u0430\u0441\u0442\u0438 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443... \u043D\u043E \u044D\u0442\u043E \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E. \u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u0438\u0437\u0432\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u0437\u0430 \u0441\u0432\u043E\u0451 \u0431\u0435\u0441\u0441\u0438\u043B\u0438\u0435. \u0421\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0430, \u0442\u044B \u043D\u0435 \u0431\u0443\u0434\u0435\u0448\u044C \u043E\u0434\u0438\u043D\u043E\u043A\u0430, \u044F \u043F\u043E\u0439\u0434\u0443 \u0441 \u0442\u043E\u0431\u043E\u0439.
\u0418 \u0442\u043E\u0433\u0434\u0430...`;let ae=1;const Me=(D=null,I=null)=>(D=D!=null?D:Math.random()*J.length|0,I=I!=null?I:I=["IM","DC"][Math.random()*2|0],{file:ae++,file_type:I,url:`assets/img-test/${J[D]}`});(async()=>{const D=(W,q)=>{const ie=q/W;let oe=-(q+ie);return()=>(oe+=ie,oe)};let I=1;const R=(W=0)=>{let q=Math.random()<.5,ie=Math.random()<.5,oe=Math.random()<.5;!q&&!ie&&!oe&&(q=!0),q=ie=oe=!0;const Q=(I++).toString(36);return h({username:q?`test_lead_${Q}`:null,first_name:ie?`F${Q}`:null,last_name:oe?`L${Q}`:null,timeDelta:W})},G=(W,q,ie=0)=>{se(W,{dialog:q,text:`\u041F\u0440\u0438\u0432\u0435\u0442 @${W}. \u042F \u043D\u043E\u0432\u044B\u0439 \u043B\u0438\u0434, \u0432\u043E\u0442.`,is_read:!1,incoming:!0,timeDelta:ie});for(let oe=0;oe<Math.round(Math.random()*J.length);oe++){const Q=Me(oe);se(W,{dialog:q,text:`${Q.file_type==="IM"?"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430":"\u0424\u0430\u0439\u043B"} ${oe+1}.`,is_read:!1,incoming:!0,attachments:[Q],timeDelta:ie+oe*1e3})}};for(let W=0;W<10;W++){const ie=[10,100,1e3,5e3,7e3,1e4,1e4,1e5,2,3,5,7,8,10][W],oe=`op_test_${W}`;u({username:oe,first_name:"OpNumDlgs",last_name:ie+""});let Q=0;const Te=D(ie,6e4*ie);for(let De=0;De<ie;De++){const $=Te(),ce=R($),Ce=j(oe,ce.tg_id);Math.random()<.5&&Q++<5&&G(oe,Ce.id,$)}}for(;;)await t(1e3,1e4),R()})();const Ee=(D,I,R)=>{const G=q=>{q&&U(R)},W=async q=>{await t(1e3,1e4);const ie=I.text.match(/without_text/i),oe=I.text.match(/long_text/i),Q=I.text.match(/allimg|allfile/i),Te=ie?"":oe?re:`\u042D\u0445\u043E \u043E\u0442\u0432\u0435\u0442 \u0434\u043B\u044F @${R}.
"${I.text}"`;if(Q){const $=I.text.match(/allimg/i)?"IM":"DC";for(let ce=0;ce<J.length;ce++)se(R,{dialog:I.dialog,text:Te,is_read:!1,incoming:!0,attachments:[Me(ce,$)]});return}const De=[];I.text.match(/img/i)?De.push(Me(null,"IM")):I.text.match(/file/i)&&De.push(Me(null,"DC")),se(R,{dialog:I.dialog,text:Te,is_read:!1,incoming:!0,attachments:De})};D("GET","operators",()=>s(d(),I)),D("GET","online",()=>he(R)),D("PUT","online",()=>U(R,I)),D("GET","leads/unassigned",()=>s(v(),I)),D("POST",/^leads\/(\d+)\/assign$/,q=>A(R,q),[G]),D("PATCH",/^leads\/(\d+)$/,q=>T(R,q,I),[G]),D("GET","dialogs",()=>s(X(R,I),I)),D("POST",/^dialogs\/(\d+)\/read$/,q=>F(R,q)),D("PATCH",/^dialogs\/(\d+)$/,q=>x(R,q,I),[G]),D("GET","messages",()=>s(me(R,I),I)),D("POST","messages",()=>se(R,I),[G,W])},be=D=>{var De,$,ce,Ce,Qe;const I=((De=D==null?void 0:D.method)!=null?De:"").toUpperCase().trim(),R=(($=D==null?void 0:D.path)!=null?$:"").split("/").map(Oe=>Oe.trim()).filter(Boolean).join("/"),G=Object.fromEntries(Object.entries((ce=D==null?void 0:D.headers)!=null?ce:{}).map(Oe=>[Oe[0].toLowerCase(),Oe[1]])),W=(Ce=D==null?void 0:D.options)!=null?Ce:{},q=(Qe=G["x-username"])!=null?Qe:null,ie=[];Ee((Oe,qe,rt,ot=[])=>ie.push({method:Oe,pathPattern:qe,cb:rt,mwList:ot}),W,q);const Q=ie.map(Oe=>{if(Oe.method===I){if(Oe.pathPattern instanceof RegExp){const qe=R.match(Oe.pathPattern);return qe?{...Oe,args:qe.slice(1)}:!1}return Oe.pathPattern===R?{...Oe,args:[]}:!1}}).filter(Boolean)[0];if(!Q)return null;const Te=Q.cb(...Q.args);return Q.mwList&&Q.mwList.map(Oe=>Oe(Te,q,W)),Te};try{self.addEventListener("message",({data:{rpcID:D,data:I}})=>{let R,G;try{R=be(I)}catch(W){G=W.message}self.postMessage({rpcID:D,result:R,error:G})})}catch{}return{request:be}},$s=()=>{const l=`( ${Qs.toString()} )()`,e=new Blob([l],{type:"text/javascript"}),t=new Worker(window.URL.createObjectURL(e));let n=1;const i={};return t.addEventListener("message",({data:{rpcID:o,result:c,error:a}})=>{const f=i[o];delete i[o],a&&f.reject(new Error(a)),f.resolve(c)}),{request:o=>{const c=n++,a=i[c]=At();return t.postMessage({rpcID:c,data:o}),a.promise},destroy:()=>t.terminate()}};function ei(l){let e,t,n,i,s;return t=new Ws({props:{operatorSelf:l[0],config:g_Config}}),{c(){e=b("div"),ge(t.$$.fragment),w(e,"class","pos_rel flex")},m(r,o){H(r,e,o),ue(t,e,null),n=!0,i||(s=Ze(st.call(null,e)),i=!0)},p(r,o){const c={};o&1&&(c.operatorSelf=r[0]),t.$set(c)},i(r){n||(z(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&P(e),de(t),i=!1,s()}}}function ti(l){let e,t,n,i,s;return e=new Hn({props:{select:"operators"}}),i=new Zs({}),{c(){ge(e.$$.fragment),t=E(),n=b("div"),ge(i.$$.fragment),w(n,"class","flex")},m(r,o){ue(e,r,o),H(r,t,o),H(r,n,o),ue(i,n,null),s=!0},p:ne,i(r){s||(z(e.$$.fragment,r),z(i.$$.fragment,r),s=!0)},o(r){B(e.$$.fragment,r),B(i.$$.fragment,r),s=!1},d(r){de(e,r),r&&P(t),r&&P(n),de(i)}}}function li(l){let e,t,n,i,s,r;const o=[ti,ei],c=[];function a(f,p){return f[0]?1:0}return t=a(l),n=c[t]=o[t](l),s=new Fn({}),{c(){e=b("main"),n.c(),i=E(),ge(s.$$.fragment),w(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-116f09r")},m(f,p){H(f,e,p),c[t].m(e,null),g(e,i),ue(s,e,null),r=!0},p(f,[p]){let d=t;t=a(f),t===d?c[t].p(f,p):(ve(),B(c[d],1,1,()=>{c[d]=null}),we(),n=c[t],n?n.p(f,p):(n=c[t]=o[t](f),n.c()),z(n,1),n.m(e,i))},i(f){r||(z(n),z(s.$$.fragment,f),r=!0)},o(f){B(n),B(s.$$.fragment,f),r=!1},d(f){f&&P(e),c[t].d(),de(s)}}}function ni(l,e,t){let n;Le(l,Et,r=>t(0,n=r));const i=$s();Xe(i.destroy);function s(){const r={"Content-Type":"application/json"},o=async(a,f,p={},d=0,u=!0)=>{var y,C,O,L;if(!location.hash.match(/real\-api/)){const[M,j]=String((y=In().get("ping"))!=null?y:"").split(",").concat(200,300).map(Number).map(X=>Pe(0,X|0,6e4)).slice(0,2).sort((X,ee)=>X-ee),x=M+Math.round(Math.random()*(j-M));await wt(x);let F;performance.now();try{F=await i.request({method:a,path:f,options:p,headers:r})}catch(X){console.error(X)}if(performance.now(),F==null&&console.log("request",{method:a,path:f,options:p,headers:r},F),d===0)return F;if(d===1)return{status:200,json:()=>F}}const m=g_Config.api,k=(C=m.protocol)!=null?C:location.protocol,S=(O=m.host)!=null?O:location.host,v=(L=m.path_base)!=null?L:"/",h=new URL(`${k}//${S}/${v}`);a==="GET"&&Object.entries(p).map(([M,j])=>h.searchParams.append(M,j)),h.pathname=[h.pathname,f].join("/").split("/").filter(Boolean).concat(u?" ":"").filter(Boolean).join("/").trim();let A;(a==="POST"||a==="PATCH"||a==="PUT")&&(A=JSON.stringify(p));const T=await fetch(h,{method:a,headers:r,body:A});if(d===0)return await T.json();if(d===1)return T},c=a=>{var p,d,u;const f=(u=(p=a==null?void 0:a.last_message)==null?void 0:p.received_at)!=null?u:(d=a==null?void 0:a.lead)==null?void 0:d.date_joined;return{...a,_lastTime:f?+new Date(f):null}};return o.message_GetList=async a=>{try{const f=await g_Api("GET","messages",a,1);if(f.status===200)return await f.json()}catch(f){console.error(f.message)}return null},o.message_Create=async(a,f)=>{try{const p=await g_Api("POST","messages",{dialog:a,text:f,is_read:!0},1);if(p.status===200)return await p.json()}catch(p){console.error(p.message)}return null},o.dialog_SetTags=async(a,f)=>{try{const p=await g_Api("PATCH",`dialogs/${a}`,{tag:f},1);if(p.status===200)return await p.json()}catch(p){console.error(p.message)}return null},o.dialog_GetList=async a=>{try{const f=await g_Api("GET","dialogs",a,1);if(f.status===200){const p=await f.json();return p.results=p.results.map(c),p}}catch(f){console.error(f.message)}return null},o.dialog_SetReadFlagAllMessages=async a=>{try{const f=await g_Api("POST",`dialogs/${a}/read`,{},1);if(f.status===200||f.status===204)return!0}catch(f){console.log(f.message)}return!1},o.lead_GetUnassignedList=async a=>{try{const f=await g_Api("GET","leads/unassigned",a,1);if(f.status===200)return await f.json()}catch(f){console.error(f.message)}return null},o.lead_AssignOperatorSelft=async a=>{try{const f=await g_Api("POST",`leads/${a}/assign`,{},1),p=await f.json();if(f.status===200)return!0;if(f.status===400)return!1}catch(f){console.error(f.message)}return null},o.lead_SetStatus=async(a,f)=>{try{const p=await g_Api("PATCH",`leads/${a}`,{status:f},1);if(p.status===200)return await p.json()}catch(p){console.error(p.message)}return null},o.operatorSelf_GetOnlineInfo=async()=>{try{const a=await g_Api("GET","online",{},1);if(a.status===200)return await a.json()}catch(a){console.error(a.message)}return null},o.operatorSelf_SetOnlineFlag=async a=>{try{const f=await g_Api("PUT","online",{online:!!a},1);if(f.status===200)return await f.json()}catch(f){console.error(f.message)}return null},o.setHeader=(a,f)=>{r[a]=f,f==null&&delete r[a]},o}return globalThis.g_Api=s(),[n]}class si extends ke{constructor(e){super(),ye(this,e,ni,li,pe,{})}}new si({target:document.getElementById("app")});
