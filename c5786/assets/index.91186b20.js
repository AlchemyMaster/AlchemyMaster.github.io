(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ie(){}const Bt=l=>l;function Vt(l,e){for(const t in e)l[t]=e[t];return l}function Ql(l){return l()}function Kt(){return Object.create(null)}function Fe(l){l.forEach(Ql)}function Ye(l){return typeof l=="function"}function _e(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let ct;function Ke(l,e){return ct||(ct=document.createElement("a")),ct.href=e,l===ct.href}function yn(l){return Object.keys(l).length===0}function Ht(l,...e){if(l==null)return ie;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Le(l,e,t){l.$$.on_destroy.push(Ht(e,t))}function Ve(l,e,t){return l.set(t),e}function at(l){return l&&Ye(l.destroy)?l.destroy:ie}const $l=typeof window<"u";let en=$l?()=>window.performance.now():()=>Date.now(),Pt=$l?l=>requestAnimationFrame(l):ie;const et=new Set;function tn(l){et.forEach(e=>{e.c(l)||(et.delete(e),e.f())}),et.size!==0&&Pt(tn)}function ln(l){let e;return et.size===0&&Pt(tn),{promise:new Promise(t=>{et.add(e={c:l,f:t})}),abort(){et.delete(e)}}}function p(l,e){l.appendChild(e)}function kn(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function Sn(l,e){return p(l.head||l,e),e.sheet}function N(l,e,t){l.insertBefore(e,t||null)}function E(l){l.parentNode.removeChild(l)}function Gt(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function b(l){return document.createElement(l)}function He(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function te(l){return document.createTextNode(l)}function A(){return te(" ")}function Be(){return te("")}function ne(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function w(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Ln(l){return Array.from(l.childNodes)}function he(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function Xt(l,e){l.value=e==null?"":e}function H(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function X(l,e,t){l.classList[t?"add":"remove"](e)}function nn(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const wt=new Map;let bt=0;function Mn(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function Dn(l){const e={style_element:b("style"),rules:{}};return wt.set(l,e),e}function Zt(l,e,t,n,i,s,r,o=0){const a=16.666/n;let f=`{
`;for(let v=0;v<=1;v+=a){const S=e+(t-e)*s(v);f+=v*100+`%{${r(S,1-S)}}
`}const c=f+`100% {${r(t,1-t)}}
}`,m=`__svelte_${Mn(c)}_${o}`,_=kn(l),{style_element:d,rules:u}=wt.get(_)||Dn(_);if(!u[m]){const v=Sn(_,d);u[m]=!0,v.insertRule(`@keyframes ${m} ${c}`,v.cssRules.length)}const g=l.style.animation||"";return l.style.animation=`${g?`${g}, `:""}${m} ${n}ms linear ${i}ms 1 both`,bt+=1,m}function On(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),bt-=i,bt||Tn())}function Tn(){Pt(()=>{bt||(wt.forEach(l=>{const{style_element:e}=l;E(e)}),wt.clear())})}let rt;function it(l){rt=l}function zt(){if(!rt)throw new Error("Function called outside component initialization");return rt}function qt(l){zt().$$.on_mount.push(l)}function je(l){zt().$$.on_destroy.push(l)}function sn(){const l=zt();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=nn(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function rn(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const st=[],Re=[],gt=[],xt=[],on=Promise.resolve();let Et=!1;function an(){Et||(Et=!0,on.then(fn))}function In(){return an(),on}function Ne(l){gt.push(l)}function yt(l){xt.push(l)}const It=new Set;let ut=0;function fn(){const l=rt;do{for(;ut<st.length;){const e=st[ut];ut++,it(e),Cn(e.$$)}for(it(null),st.length=0,ut=0;Re.length;)Re.pop()();for(let e=0;e<gt.length;e+=1){const t=gt[e];It.has(t)||(It.add(t),t())}gt.length=0}while(st.length);for(;xt.length;)xt.pop()();Et=!1,It.clear(),it(l)}function Cn(l){if(l.fragment!==null){l.update(),Fe(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Ne)}}let nt;function An(){return nt||(nt=Promise.resolve(),nt.then(()=>{nt=null})),nt}function Ct(l,e,t){l.dispatchEvent(nn(`${e?"intro":"outro"}${t}`))}const ht=new Set;let ze;function Me(){ze={r:0,c:[],p:ze}}function De(){ze.r||Fe(ze.c),ze=ze.p}function j(l,e){l&&l.i&&(ht.delete(l),l.i(e))}function z(l,e,t,n){if(l&&l.o){if(ht.has(l))return;ht.add(l),ze.c.push(()=>{ht.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const xn={duration:0};function Oe(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,a=null;function f(){a&&On(l,a)}function c(_,d){const u=_.b-s;return d*=Math.abs(u),{a:s,b:_.b,d:u,duration:d,start:_.start,end:_.start+d,group:_.group}}function m(_){const{delay:d=0,duration:u=300,easing:g=Bt,tick:v=ie,css:S}=i||xn,y={start:en()+d,b:_};_||(y.group=ze,ze.r+=1),r||o?o=y:(S&&(f(),a=Zt(l,s,_,u,d,g,S)),_&&v(0,1),r=c(y,u),Ne(()=>Ct(l,_,"start")),ln(k=>{if(o&&k>o.start&&(r=c(o,u),o=null,Ct(l,r.b,"start"),S&&(f(),a=Zt(l,s,r.b,r.duration,0,g,i.css))),r){if(k>=r.end)v(s=r.b,1-s),Ct(l,r.b,"end"),o||(r.b?f():--r.group.r||Fe(r.group.c)),r=null;else if(k>=r.start){const O=k-r.start;s=r.a+r.d*g(O/r.duration),v(s,1-s)}}return!!(r||o)}))}return{run(_){Ye(i)?An().then(()=>{i=i(),m(_)}):m(_)},end(){f(),r=o=null}}}const En=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function cn(l,e){l.d(1),e.delete(l.key)}function lt(l,e){z(l,1,1,()=>{e.delete(l.key)})}function Je(l,e,t,n,i,s,r,o,a,f,c,m){let _=l.length,d=s.length,u=_;const g={};for(;u--;)g[l[u].key]=u;const v=[],S=new Map,y=new Map;for(u=d;u--;){const h=m(i,s,u),I=t(h);let M=r.get(I);M?n&&M.p(h,e):(M=f(I,h),M.c()),S.set(I,v[u]=M),I in g&&y.set(I,Math.abs(u-g[I]))}const k=new Set,O=new Set;function T(h){j(h,1),h.m(o,c),r.set(h.key,h),c=h.first,d--}for(;_&&d;){const h=v[d-1],I=l[_-1],M=h.key,C=I.key;h===I?(c=h.first,_--,d--):S.has(C)?!r.has(M)||k.has(M)?T(h):O.has(C)?_--:y.get(M)>y.get(C)?(O.add(M),T(h)):(k.add(C),_--):(a(I,r),_--)}for(;_--;){const h=l[_];S.has(h.key)||a(h,r)}for(;d;)T(v[d-1]);return v}function kt(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function ce(l){l&&l.c()}function re(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||Ne(()=>{const a=s.map(Ql).filter(Ye);r?r.push(...a):Fe(a),l.$$.on_mount=[]}),o.forEach(Ne)}function oe(l,e){const t=l.$$;t.fragment!==null&&(Fe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function jn(l,e){l.$$.dirty[0]===-1&&(st.push(l),an(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function me(l,e,t,n,i,s,r,o=[-1]){const a=rt;it(l);const f=l.$$={fragment:null,ctx:null,props:s,update:ie,not_equal:i,bound:Kt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Kt(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(f.root);let c=!1;if(f.ctx=t?t(l,e.props||{},(m,_,...d)=>{const u=d.length?d[0]:_;return f.ctx&&i(f.ctx[m],f.ctx[m]=u)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](u),c&&jn(l,m)),_}):[],f.update(),c=!0,Fe(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const m=Ln(e.target);f.fragment&&f.fragment.l(m),m.forEach(E)}else f.fragment&&f.fragment.c();e.intro&&j(l.$$.fragment),re(l,e.target,e.anchor,e.customElement),fn()}it(a)}class pe{$destroy(){oe(this,1),this.$destroy=ie}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!yn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Nn(l){const e=l-1;return e*e*e+1}function Ie(l,{delay:e=0,duration:t=400,easing:n=Bt}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function St(l,{delay:e=0,duration:t=400,easing:n=Nn}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),m=parseFloat(i.borderTopWidth),_=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:d=>`overflow: hidden;opacity: ${Math.min(d*20,1)*s};height: ${d*r}px;padding-top: ${d*o}px;padding-bottom: ${d*a}px;margin-top: ${d*f}px;margin-bottom: ${d*c}px;border-top-width: ${d*m}px;border-bottom-width: ${d*_}px;`}}const Qe=[];function Pe(l,e=ie){let t;const n=new Set;function i(o){if(_e(l,o)&&(l=o,t)){const a=!Qe.length;for(const f of n)f[1](),Qe.push(f,l);if(a){for(let f=0;f<Qe.length;f+=2)Qe[f][0](Qe[f+1]);Qe.length=0}}}function s(o){i(o(l))}function r(o,a=ie){const f=[o,a];return n.add(f),n.size===1&&(t=e(i)||ie),o(l),()=>{n.delete(f),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const ot=new Map,Mt=l=>ot.set(l,(ot.get(l)|0)+1),Dt=l=>ot.set(l,(ot.get(l)|0)-1),Fn=()=>ot,jt=new Map,Rn=(l,e)=>{var n;const t=(n=jt.get(l))!=null?n:{};Object.assign(t,{key:l,duration:e,timeUpdate:Date.now()}),jt.set(l,t)},Bn=(l,e)=>jt,$e=()=>{},tt=l=>new Promise(e=>setTimeout(e,l)),xe=(l,e,t)=>Math.min(t,Math.max(l,e)),Ot=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),Nt=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,a)=>Nt(o,e[a]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,a])=>!(!r.has(o)||!Nt(a,r.get(o))))}catch{}return!1},Hn=l=>{let e=!1,t=[];const n=async i=>{e=!0;let s,r,o;try{s=await l()}catch(a){o=!0,r=a}if(i.map(a=>{o&&a.reject(r),a.resolve(s)}),t.length){const a=t;return t=[],n(a)}e=!1};return()=>{const i=Ot();return e?t.push(i):(e=!0,n([i])),i.promise}},Pn=l=>{const e=Ot();return setTimeout(e.resolve,l),e},Gn=Symbol("RangeLoadList_ItemLastUpdateTime"),zn=l=>{var P,Z,K,B;const e=xe(1,((P=l.updateInterval)!=null?P:1e3)|0,36e5),t=xe(1,((Z=l.maxLimit)!=null?Z:50)|0,1e3);let n=l.fLoad;const i=(K=l.onUpdateItem)!=null?K:$e,s=(B=l.onUpdateItemList)!=null?B:$e,r=!!l.isLoadEnd,o=Gn,a={},f=Pe(null),c={subscribe:f.subscribe};let m=0,_=t,d=null;const u=q=>n=q,g=async(q,se)=>{try{const U=await n({offset:q,limit:se});if(typeof U.count=="number"&&Array.isArray(U.results))return U}catch{}return null},v=async(q,se)=>{const U=await g(q,se);if(U){const x=U.results,ae=Math.max(0,U.count|0),ve=d!==ae,ye=Date.now();d=ae;const W=[];for(let G=0,V=q;G<x.length&&V<d;G++,V++){const we=x[G];a[V]!==void 0&&Nt(a[V],we)||(we[o]=ye,a[V]=we,i(we),W.push(we))}W.length&&s(W),(ve||W.length)&&f.set({total:d,list:a})}},S=async q=>{const se=[];se.push(v(m,_)),d!==null&&m+_<d&&r&&se.push(v(d,t)),await Promise.all(se),d!==null&&m+_<d&&r&&q&&await v(d,t)};let y=!1,k=!0,O,T=1;return(async()=>{let q=0;for(;k;){for(;k&&!y;){const se=T;if(await S(q++===0),se===T)break}O=Pn(e),await O.promise}})(),{setFLoad:u,update:()=>{T++,O&&O.resolve()},setRange:(q,se)=>{m=Math.max(0,q|0),_=xe(0,se|0,t)},destroy:()=>k=!1,getData_r:()=>c,symbolUpdateTime:o,pause:()=>y=!0,resume:()=>y=!1}},qn=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},Xe=(l,e,t=!0)=>{let n=!0;return(async()=>{for(Mt("setIntervalAwait"),t&&await tt(l);n;){try{await e()}catch(i){console.error("setIntervalAwait error",i)}await tt(l)}Dt("setIntervalAwait")})(),()=>n=!1},Un=(l,e=!0)=>{let t=!0;const n=()=>{!t||(l(),requestAnimationFrame(n))};return e?requestAnimationFrame(n):n(),Mt("requestAnimationFrameLoop"),()=>{t=!1,Dt("requestAnimationFrameLoop")}},vt=()=>{let l=new Map;try{l=new Map([...new URLSearchParams(location.hash.replace(/^\#/,""))])}catch{}return l},Ut=()=>{const l={};return{on:(n,i)=>{var o;const s={event:n,cb:i},r=l[n]=(o=l[n])!=null?o:[];return r.push(s),()=>{const a=r.findIndex(f=>f===s);a!==-1&&r.splice(a,1)}},emit:(n,...i)=>{var s;return((s=l[n])!=null?s:[]).map(r=>r.cb(...i))}}},Wn=()=>{const l={};return l.addModule=(e,t)=>l[e]=t,l},un=(l,e="file-")=>{const t=document.createElement("a");t.href=l;const n=e+t.pathname.split(/[^a-zA-Z0-9\.\-_]/).pop();t.download=n,t.target="blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},Ft=l=>un(l,"image-"),Yn=l=>{try{if(typeof l.message=="string")return l.message}catch{}return""},Qt=typeof performance=="object"&&typeof performance.now=="function"?performance.now.bind(performance):Date.now,Lt=Pe(null),dn=Lt.set,dt=(l,e)=>{const{subscribe:t,set:n,update:i}=Pe(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},Jn=(l,e)=>{const{subscribe:t,set:n,update:i}=Pe(l);return[{subscribe:t},i]},Vn=l=>parseInt(l.id);function Kn(l,e,t,n){var ve,ye;const i={},s={...e};Object.assign(i,{appConfig:s}),Object.assign(i,{api:t}),Object.assign(i,{moduleMgr:n});const r=Ut();Object.assign(i,{events:r});const o=[],a=W=>o.push(W);Object.assign(i,{destroy:()=>o.map(W=>W())});const c=l,[m]=dt(c),[_,d]=dt(null);let u=0;const[g,v]=dt(u),S=Hn(t.operatorSelf_GetOnlineInfo),y=async()=>{v(++u);const W=await S();return W&&d(W),v(--u),W};Object.assign(i,{operatorSelf_r:m,operatorSelfLastOnlineInfo_r:_,operatorSelfLastOnlineInfo_Update:y,operatorSelfLastOnline_SetOnlineFlag:async W=>{v(++u);const G=await t.operatorSelf_SetOnlineFlag(W);return G&&d(G),v(--u),G},operatorSelfLastOnlineInfoLoading_r:g});const O=Object.create(null),[T,h]=Jn(O),I=W=>{!W.length||h(G=>{for(const V of W)G[Vn(V)]=V;return G})},M=W=>I([W]),[C,Y]=dt(null);Object.assign(i,{dialogMap_r:T,dialogMap_SetDialogList:I,dialogMap_SetDialog:M,dialogActiveID_r:C,dialogActiveID_Set:Y});const F=new Map(((ve=s==null?void 0:s.lead_StatusList)!=null?ve:[]).map(W=>[W.id,W])),Q=Object.entries((ye=s==null?void 0:s.lead_StatusJumpMap)!=null?ye:{}).reduce((W,[G,V])=>(V.map(we=>{var ke;return(W[we]=(ke=W[we])!=null?ke:[]).push(G)}),W),{}),P=W=>{var G;return(G=F.get(W))!=null?G:null},Z=W=>{var G;try{return(G=s.lead_StatusGetID(W))!=null?G:null}catch{}return null},K=W=>{var V,we,ke;const G=P(W);return{id:W,title:(V=G==null?void 0:G.title)!=null?V:G!=null&&G.id?`#${G==null?void 0:G.id}`:"*UNK*",bgColor:(we=G==null?void 0:G.bgColor)!=null?we:"#000",color:(ke=G==null?void 0:G.color)!=null?ke:"#fff"}},B=W=>K(Z(W)),q=(W,G)=>{var V;try{return(V=s.lead_StatusPrevIDResolve(W,G))!=null?V:null}catch{}return null},se=(W,G)=>{try{const V=Q==null?void 0:Q[W],we=(V==null?void 0:V.length)===1?V==null?void 0:V[0]:(V==null?void 0:V.length)>1?q(W,G):null,ke=P(we);return ke&&!(ke!=null&&ke.stopPrevSearch)?we:null}catch{}return null};return Object.assign(i,{lead_GetStatusOrDefault:B,lead_GetStatusByID:P,lead_GetStatusTitle:W=>{var G,V;return(V=(G=P(W))==null?void 0:G.title)!=null?V:W},lead_GetStatusList:W=>{var G;return((G=e==null?void 0:e.lead_StatusList)!=null?G:[]).filter(V=>V.access==="user").filter(V=>V.id!==W).filter(V=>V.id!=="DL")},lead_GetStatusID:Z,lead_StatusPrevIDResolve:q,lead_GetStatusPrevID:se,lead_GetStatusHistory:W=>{let G=Z(W);const V=[G];for(;G=se(G,W),W=null,!!G;)V.unshift(G);return V.map(K).filter(Boolean)}}),a(Xe(e.updateIntervals.sync_online_info,y,!1)),Object.freeze(i),i}function $t(l){let e,t,n;return{c(){e=b("div"),e.textContent="Operators",w(e,"class","item cursor_ptr svelte-vbcb9r"),X(e,"active",l[0]==="operators"),X(e,"disabled",l[1].has("operators"))},m(i,s){N(i,e,s),t||(n=ne(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&X(e,"active",i[0]==="operators"),s&2&&X(e,"disabled",i[1].has("operators"))},d(i){i&&E(e),t=!1,n()}}}function el(l){let e,t=l[2].username+"",n,i,s;return{c(){e=b("div"),n=te(t),w(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),H(e,"max-width","200px")},m(r,o){N(r,e,o),p(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&he(n,t)},i(r){s||(Ne(()=>{i||(i=Oe(e,Ie,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=Oe(e,Ie,{},!1)),i.run(0),s=!1},d(r){r&&E(e),r&&i&&i.end()}}}function Xn(l){let e,t,n,i,s,r,o=!l[2]&&$t(l),a=l[2]&&0,f=l[2]&&el(l);return{c(){e=b("div"),o&&o.c(),t=A(),a&&a.c(),n=A(),i=b("div"),s=A(),f&&f.c(),w(i,"class","flex flex_grow_1"),w(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(c,m){N(c,e,m),o&&o.m(e,null),p(e,t),a&&a.m(e,null),p(e,n),p(e,i),p(e,s),f&&f.m(e,null),r=!0},p(c,[m]){c[2]?o&&(o.d(1),o=null):o?o.p(c,m):(o=$t(c),o.c(),o.m(e,t)),c[2],a&&(a.d(1),a=null),c[2]?f?(f.p(c,m),m&4&&j(f,1)):(f=el(c),f.c(),j(f,1),f.m(e,null)):f&&(Me(),z(f,1,1,()=>{f=null}),De())},i(c){r||(j(f),r=!0)},o(c){z(f),r=!1},d(c){c&&E(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function Zn(l,e,t){let n;Le(l,Lt,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>a=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class Qn extends pe{constructor(e){super(),me(this,e,Zn,Xn,_e,{select:0,disabled:1})}}function tl(l,e,t){const n=l.slice();return n[4]=e[t],n}function ll(l,e,t){const n=l.slice();return n[7]=e[t],n}function nl(l){let e,t=l[7].text+"",n,i;return{c(){e=b("div"),n=te(t),i=te("\xA0"),w(e,"class","text svelte-13s1vua"),H(e,"color",l[7].color)},m(s,r){N(s,e,r),p(e,n),N(s,i,r)},p(s,r){r&2&&t!==(t=s[7].text+"")&&he(n,t),r&2&&H(e,"color",s[7].color)},d(s){s&&E(e),s&&E(i)}}}function sl(l){let e,t,n=l[4].chunks,i=[];for(let s=0;s<n.length;s+=1)i[s]=nl(ll(l,n,s));return{c(){e=b("div");for(let s=0;s<i.length;s+=1)i[s].c();t=A(),w(e,"class","flex flex_cy line svelte-13s1vua"),X(e,"mini",l[4].type==="mini")},m(s,r){N(s,e,r);for(let o=0;o<i.length;o+=1)i[o].m(e,null);p(e,t)},p(s,r){if(r&2){n=s[4].chunks;let o;for(o=0;o<n.length;o+=1){const a=ll(s,n,o);i[o]?i[o].p(a,r):(i[o]=nl(a),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}r&2&&X(e,"mini",s[4].type==="mini")},d(s){s&&E(e),Gt(i,s)}}}function $n(l){let e,t,n,i=l[1],s=[];for(let r=0;r<i.length;r+=1)s[r]=sl(tl(l,i,r));return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();w(e,"class","flex flex_clm notify svelte-13s1vua"),X(e,"normal",l[0]==="normal"),X(e,"error",l[0]==="error"),X(e,"debug",l[0]==="debug")},m(r,o){N(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,[o]){if(o&2){i=r[1];let a;for(a=0;a<i.length;a+=1){const f=tl(r,i,a);s[a]?s[a].p(f,o):(s[a]=sl(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}(!n||o&1)&&X(e,"normal",r[0]==="normal"),(!n||o&1)&&X(e,"error",r[0]==="error"),(!n||o&1)&&X(e,"debug",r[0]==="debug")},i(r){n||(r&&Ne(()=>{t||(t=Oe(e,St,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Oe(e,St,{},!1)),t.run(0)),n=!1},d(r){r&&E(e),Gt(s,r),r&&t&&t.end()}}}function es(l,e,t){let{notify:n}=e,i="normal",s=[];const r=()=>{t(0,i=n==null?void 0:n.type),t(1,s=[]),Array.isArray(n==null?void 0:n.data)&&t(1,s=n.data.filter(Boolean).map(o=>{let a="normal",f=[];return typeof o=="string"?f.push({color:"#fff",text:o}):(a=o.type,f=o.chunks?o.chunks:[{color:"#fff",text:o.text}]),f=f.filter(c=>c.text),{type:a,chunks:f}}).filter(o=>o.chunks.length))};return l.$$set=o=>{"notify"in o&&t(2,n=o.notify)},l.$$.update=()=>{l.$$.dirty&4&&r()},[i,s,n]}class ts extends pe{constructor(e){super(),me(this,e,es,$n,_e,{notify:2})}}function il(l,e,t){const n=l.slice();return n[4]=e[t],n}function rl(l,e){let t,n,i;return n=new ts({props:{notify:e[4]}}),{key:l,first:null,c(){t=Be(),ce(n.$$.fragment),this.first=t},m(s,r){N(s,t,r),re(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.notify=e[4]),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){z(n.$$.fragment,s),i=!1},d(s){s&&E(t),oe(n,s)}}}function ls(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[4].id;for(let o=0;o<s.length;o+=1){let a=il(l,s,o),f=r(a);n.set(f,t[o]=rl(f,a))}return{c(){e=b("div");for(let o=0;o<t.length;o+=1)t[o].c();w(e,"class","pos_abs notify_list svelte-11tn2wf")},m(o,a){N(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],Me(),t=Je(t,a,r,1,o,s,n,e,lt,rl,null,il),De())},i(o){if(!i){for(let a=0;a<s.length;a+=1)j(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)z(t[a]);i=!1},d(o){o&&E(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}const ns=5e3;function ss(l,e,t){let{events:n=Ut()}=e,i=1,s=[];const r=o=>a=>{s.push({id:i++,time:Date.now(),type:o,data:a}),t(0,s)};return je(Xe(1e3,()=>{const o=Date.now(),a=s.filter(f=>f.time+ns>=o);a.length!==s.length&&t(0,s=a)})),je(n.on("error",r("error"))),vt().has("debug")&&je(n.on("debug",r("debug"))),l.$$set=o=>{"events"in o&&t(1,n=o.events)},[s,n]}class is extends pe{constructor(e){super(),me(this,e,ss,ls,_e,{events:1})}}function ol(l){return Object.prototype.toString.call(l)==="[object Date]"}function Rt(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>Rt(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if(ol(l)&&ol(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=Rt(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function qe(l,e={}){const t=Pe(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let a=n,f=!1,{delay:c=0,duration:m=400,easing:_=Bt,interpolate:d=Rt}=Vt(Vt({},e),o);if(m===0)return a&&(a.abort(),a=null),t.set(l=i),Promise.resolve();const u=en()+c;let g;return n=ln(v=>{if(v<u)return!0;f||(g=d(l,r),typeof m=="function"&&(m=m(l,r)),f=!0),a&&(a.abort(),a=null);const S=v-u;return S>m?(t.set(l=r),!1):(t.set(l=g(_(S/m))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}function rs(l){let e,t,n,i,s;var r=l[0].svelteComponent;function o(a){return{props:{options:a[0].options,abort_wr:a[0].abort_wr,result:a[0].result,close:a[7]}}}return r&&(n=new r(o(l))),{c(){e=b("div"),t=b("div"),n&&ce(n.$$.fragment),w(t,"class","flex pos_abs wrapper2 svelte-1c0izo5"),H(t,"max-width",l[2]+"px"),w(e,"class","flex flex_cx wrapper svelte-1c0izo5"),w(e,"style",i=""+(l[6]("left",l[3])+l[6]("top",l[4]))),X(e,"show",l[5])},m(a,f){N(a,e,f),p(e,t),n&&re(n,t,null),l[8](t),s=!0},p(a,[f]){const c={};if(f&1&&(c.options=a[0].options),f&1&&(c.abort_wr=a[0].abort_wr),f&1&&(c.result=a[0].result),r!==(r=a[0].svelteComponent)){if(n){Me();const m=n;z(m.$$.fragment,1,0,()=>{oe(m,1)}),De()}r?(n=new r(o(a)),ce(n.$$.fragment),j(n.$$.fragment,1),re(n,t,null)):n=null}else r&&n.$set(c);(!s||f&4)&&H(t,"max-width",a[2]+"px"),(!s||f&24&&i!==(i=""+(a[6]("left",a[3])+a[6]("top",a[4]))))&&w(e,"style",i),(!s||f&32)&&X(e,"show",a[5])},i(a){s||(n&&j(n.$$.fragment,a),s=!0)},o(a){n&&z(n.$$.fragment,a),s=!1},d(a){a&&E(e),n&&oe(n),l[8](null)}}}const At=10,al=10,fl=4;function os(l,e,t){let{modalContext:n={}}=e,i,s=2e4,r=null,o=null,a=!1,f=!1;const c=(u,g,v=S=>S)=>g===null?"":`${u}: ${v(g)};`,m=(u,g)=>c(u,g,v=>`${v}px`),_=async()=>{a||(a=!0,t(5,f=!1),await tt(1e3),t(3,r=null),t(4,o=null),t(0,n._needDestroy=!0,n))};qt(async()=>{await In(),await tt(10),t(5,f=!a)}),je(Un(()=>{var h,I,M,C;if(!i)return;const u=window.innerWidth,g=window.innerHeight;t(2,s=u-At*2);const v=i.offsetWidth,S=i.offsetHeight,y=v/2,k=S/2;let O=u/2,T=50+k;try{const Y=(h=n==null?void 0:n.options)!=null?h:{};if(Y!=null&&Y.position&&(I=Y.position)!=null&&I.target){const F=Y.position.target.getBoundingClientRect();((M=Y.position)==null?void 0:M.stick)==="bottom"&&(T=F.bottom+fl),((C=Y.position)==null?void 0:C.stick)==="top"&&(T=F.top-fl-S),O=F.width/2+F.left}}catch{}O=xe(y+At,O,u-y-At),T=xe(al,T,g-S-al),t(3,r=Math.round(O)),t(4,o=Math.round(T))}));function d(u){Re[u?"unshift":"push"](()=>{i=u,t(1,i)})}return l.$$set=u=>{"modalContext"in u&&t(0,n=u.modalContext)},[n,i,s,r,o,f,m,_,d]}class as extends pe{constructor(e){super(),me(this,e,os,rs,_e,{modalContext:0})}}function fs(l){var u,g;let e,t,n=((g=(u=l[0])==null?void 0:u.text)!=null?g:"")+"",i,s,r,o,a,f,c,m,_,d;return{c(){e=b("div"),t=b("div"),i=te(n),s=A(),r=b("div"),o=b("button"),o.textContent="cancel",a=A(),f=b("div"),c=A(),m=b("button"),m.textContent="continue",w(t,"class","flex text"),w(o,"class","flex nowrap cursor_ptr unselect btn cancel svelte-1dvmulk"),H(f,"width","4px"),w(m,"class","flex nowrap cursor_ptr unselect btn continue svelte-1dvmulk"),w(r,"class","flex btnGroup svelte-1dvmulk"),w(e,"class","flex flex_clm modal svelte-1dvmulk")},m(v,S){N(v,e,S),p(e,t),p(t,i),p(e,s),p(e,r),p(r,o),l[8](o),p(r,a),p(r,f),p(r,c),p(r,m),_||(d=[ne(o,"click",l[3]),ne(m,"click",l[4])],_=!0)},p(v,[S]){var y,k;S&1&&n!==(n=((k=(y=v[0])==null?void 0:y.text)!=null?k:"")+"")&&he(i,n)},i:ie,o:ie,d(v){v&&E(e),l[8](null),_=!1,Fe(d)}}}function cs(l,e,t){let n,i=ie,s=()=>(i(),i=Ht(o,u=>t(7,n=u)),o);l.$$.on_destroy.push(()=>i());let{options:r={}}=e,{abort_wr:o}=e;s();let{result:a}=e,{close:f}=e,c;const m=()=>{a.resolve(!1),f()},_=()=>{a.resolve(!0),f()};qt(()=>c.focus());function d(u){Re[u?"unshift":"push"](()=>{c=u,t(2,c)})}return l.$$set=u=>{"options"in u&&t(0,r=u.options),"abort_wr"in u&&s(t(1,o=u.abort_wr)),"result"in u&&t(5,a=u.result),"close"in u&&t(6,f=u.close)},l.$$.update=()=>{l.$$.dirty&128&&n&&m()},[r,o,c,m,_,a,f,n,d]}class us extends pe{constructor(e){super(),me(this,e,cs,fs,_e,{options:0,abort_wr:1,result:5,close:6})}}function cl(l,e,t){const n=l.slice();return n[5]=e[t],n}function ul(l,e){let t,n,i;return n=new as({props:{modalContext:e[5]}}),{key:l,first:null,c(){t=Be(),ce(n.$$.fragment),this.first=t},m(s,r){N(s,t,r),re(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.modalContext=e[5]),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){z(n.$$.fragment,s),i=!1},d(s){s&&E(t),oe(n,s)}}}function ds(l){let e=[],t=new Map,n,i,s=l[0];const r=o=>o[5].id;for(let o=0;o<s.length;o+=1){let a=cl(l,s,o),f=r(a);t.set(f,e[o]=ul(f,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();n=Be()},m(o,a){for(let f=0;f<e.length;f+=1)e[f].m(o,a);N(o,n,a),i=!0},p(o,[a]){a&1&&(s=o[0],Me(),e=Je(e,a,r,1,o,s,t,n.parentNode,lt,ul,n,cl),De())},i(o){if(!i){for(let a=0;a<s.length;a+=1)j(e[a]);i=!0}},o(o){for(let a=0;a<e.length;a+=1)z(e[a]);i=!1},d(o){for(let a=0;a<e.length;a+=1)e[a].d(o);o&&E(n)}}}function _s(l,e,t){let{modules:n}=e,i=[],s=1;const r=a=>{i.push(a),t(0,i)},o=(a,f)=>{const c={type:a,options:f,id:s++,result:Ot(),abort_wr:Pe(!1)};switch(a){case"cancel/continue":c.svelteComponent=us;break}return c.svelteComponent?(r(c),{abort:()=>c.abort_wr.set(!0),result:c.result.promise}):null};return je(Xe(1e3,()=>{const a=i.filter(f=>!f._needDestroy);a.length!==i.length&&t(0,i=a)})),n.addModule("modal",{createModal:o}),l.$$set=a=>{"modules"in a&&t(1,n=a.modules)},[i,n]}class ms extends pe{constructor(e){super(),me(this,e,_s,ds,_e,{modules:1})}}function ps(l){let e,t,n,i,s,r,o,a=l[5](l[1])+"",f,c,m,_,d;return{c(){e=b("div"),t=b("div"),n=te(l[0]),i=A(),s=b("div"),r=A(),o=b("div"),f=te(a),c=A(),m=b("div"),w(t,"class","flex nowrap lcKey svelte-6huedz"),H(s,"width","8px"),w(o,"class","flex nowrap lcVal svelte-6huedz"),w(m,"class","flex pos_abs liveRate svelte-6huedz"),H(m,"width",l[2]+"%"),w(e,"class","flex flex_grow_1 pos_rel item svelte-6huedz")},m(u,g){N(u,e,g),p(e,t),p(t,n),p(e,i),p(e,s),p(e,r),p(e,o),p(o,f),p(e,c),p(e,m),d=!0},p(u,[g]){(!d||g&1)&&he(n,u[0]),(!d||g&2)&&a!==(a=u[5](u[1])+"")&&he(f,a),(!d||g&4)&&H(m,"width",u[2]+"%")},i(u){d||(u&&Ne(()=>{_||(_=Oe(e,St,{},!0)),_.run(1)}),d=!0)},o(u){u&&(_||(_=Oe(e,St,{},!1)),_.run(0)),d=!1},d(u){u&&E(e),u&&_&&_.end()}}}function gs(l,e,t){let n,i,{key:s}=e,{duration:r}=e,{liveRate:o}=e;const a=qe(r);Le(l,a,m=>t(1,n=m));const f=qe(o);Le(l,f,m=>t(2,i=m));const c=m=>m<1e3?Math.round(m)+"ms":(m/1e3).toFixed(2)+"s";return l.$$set=m=>{"key"in m&&t(0,s=m.key),"duration"in m&&t(6,r=m.duration),"liveRate"in m&&t(7,o=m.liveRate)},l.$$.update=()=>{l.$$.dirty&64&&a.set(r),l.$$.dirty&128&&f.set(o)},[s,n,i,a,f,c,r,o]}class hs extends pe{constructor(e){super(),me(this,e,gs,ps,_e,{key:0,duration:6,liveRate:7})}}function dl(l,e,t){const n=l.slice();return n[3]=e[t],n}function _l(l,e,t){const n=l.slice();return n[6]=e[t],n}function ml(l){let e,t=[],n=new Map,i,s=[],r=new Map,o,a=l[1];const f=_=>_[6][0];for(let _=0;_<a.length;_+=1){let d=_l(l,a,_),u=f(d);n.set(u,t[_]=pl(u,d))}let c=l[2];const m=_=>_[3].key;for(let _=0;_<c.length;_+=1){let d=dl(l,c,_),u=m(d);r.set(u,s[_]=gl(u,d))}return{c(){e=b("div");for(let _=0;_<t.length;_+=1)t[_].c();i=A();for(let _=0;_<s.length;_+=1)s[_].c();w(e,"class","pos_abs flex flex_clm unselect cnt svelte-1qapcdn")},m(_,d){N(_,e,d);for(let u=0;u<t.length;u+=1)t[u].m(e,null);p(e,i);for(let u=0;u<s.length;u+=1)s[u].m(e,null);o=!0},p(_,d){d&2&&(a=_[1],t=Je(t,d,f,1,_,a,n,e,cn,pl,i,_l)),d&4&&(c=_[2],Me(),s=Je(s,d,m,1,_,c,r,e,lt,gl,null,dl),De())},i(_){if(!o){for(let d=0;d<c.length;d+=1)j(s[d]);o=!0}},o(_){for(let d=0;d<s.length;d+=1)z(s[d]);o=!1},d(_){_&&E(e);for(let d=0;d<t.length;d+=1)t[d].d();for(let d=0;d<s.length;d+=1)s[d].d()}}}function pl(l,e){let t,n,i=e[6][0]+"",s,r,o,a,f,c=e[6][1]+"",m;return{key:l,first:null,c(){t=b("div"),n=b("div"),s=te(i),r=A(),o=b("div"),a=A(),f=b("div"),m=te(c),w(n,"class","flex nowrap lcKey svelte-1qapcdn"),H(o,"width","8px"),w(f,"class","flex nowrap lcVal svelte-1qapcdn"),w(t,"class","flex"),this.first=t},m(_,d){N(_,t,d),p(t,n),p(n,s),p(t,r),p(t,o),p(t,a),p(t,f),p(f,m)},p(_,d){e=_,d&2&&i!==(i=e[6][0]+"")&&he(s,i),d&2&&c!==(c=e[6][1]+"")&&he(m,c)},d(_){_&&E(t)}}}function gl(l,e){let t,n,i;return n=new hs({props:{key:e[3].key,duration:e[3].duration,liveRate:e[3].liveRate}}),{key:l,first:null,c(){t=Be(),ce(n.$$.fragment),this.first=t},m(s,r){N(s,t,r),re(n,s,r),i=!0},p(s,r){e=s;const o={};r&4&&(o.key=e[3].key),r&4&&(o.duration=e[3].duration),r&4&&(o.liveRate=e[3].liveRate),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){z(n.$$.fragment,s),i=!1},d(s){s&&E(t),oe(n,s)}}}function vs(l){let e,t,n=l[0]&&ml(l);return{c(){n&&n.c(),e=Be()},m(i,s){n&&n.m(i,s),N(i,e,s),t=!0},p(i,[s]){i[0]?n?(n.p(i,s),s&1&&j(n,1)):(n=ml(i),n.c(),j(n,1),n.m(e.parentNode,e)):n&&(Me(),z(n,1,1,()=>{n=null}),De())},i(i){t||(j(n),t=!0)},o(i){z(n),t=!1},d(i){n&&n.d(i),i&&E(e)}}}const hl=2e4;function ws(l,e,t){let n=!1,i=[],s=[];return je(Xe(200,()=>{if(t(0,n=location.hash.indexOf("dev_stat")!==-1),n){t(1,i=[...Fn()].filter(c=>c[1]));const r=Bn(),o=Date.now(),a=[],f=[];for(const c of r.values()){const m=xe(0,(c.timeUpdate+hl-o)/hl,1)*100;m||a.push(c.key),f.push({key:c.key,duration:c.duration,liveRate:m})}a.map(c=>r.delete(c)),t(2,s=f)}})),[n,i,s]}class bs extends pe{constructor(e){super(),me(this,e,ws,vs,_e,{})}}function ys(l){let e,t,n,i,s,r,o,a,f;return{c(){e=b("div"),t=b("div"),n=b("div"),i=A(),s=b("div"),r=A(),o=b("div"),a=A(),f=b("div"),w(n,"class","pos_abs s1 svelte-fxby3d"),w(s,"class","pos_abs s2 svelte-fxby3d"),w(o,"class","pos_abs s3 svelte-fxby3d"),w(f,"class","pos_abs s4 svelte-fxby3d"),w(t,"class","flex pos_rel ellipsis svelte-fxby3d"),H(t,"transform","scale("+l[1]+")"),w(e,"class","flex"),H(e,"height",l[0]+"px"),H(e,"width",l[2]+"px")},m(c,m){N(c,e,m),p(e,t),p(t,n),p(t,i),p(t,s),p(t,r),p(t,o),p(t,a),p(t,f)},p(c,[m]){m&2&&H(t,"transform","scale("+c[1]+")"),m&1&&H(e,"height",c[0]+"px"),m&4&&H(e,"width",c[2]+"px")},i:ie,o:ie,d(c){c&&E(e)}}}function ks(l,e,t){let n,i,{height:s=5}=e;return l.$$set=r=>{"height"in r&&t(0,s=r.height)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=s/.1625),l.$$.dirty&1&&t(1,i=s/13)},[s,i,n]}class _n extends pe{constructor(e){super(),me(this,e,ks,ys,_e,{height:0})}}function vl(l){let e,t,n,i;return t=new _n({props:{height:6}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","flex pos_abs loading svelte-15wz55f")},m(s,r){N(s,e,r),re(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ne(()=>{n||(n=Oe(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){z(t.$$.fragment,s),s&&(n||(n=Oe(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&E(e),oe(t),s&&n&&n.end()}}}function Ss(l){let e,t,n,i,s,r,o,a,f,c,m,_,d,u=l[0]&&vl();return{c(){e=b("div"),t=b("div"),n=A(),i=b("div"),i.textContent="offline",s=A(),r=b("div"),o=te(`online\r
		`),a=b("div"),f=te(l[2]),c=A(),u&&u.c(),w(t,"class","pos_abs h100 onlineProgressTrumb svelte-15wz55f"),H(t,"width",l[1]+"%"),w(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-15wz55f"),X(i,"hideR",l[1]>=1),w(a,"class","pos_abs onlineProgressTrumbLastTime svelte-15wz55f"),w(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-15wz55f"),X(r,"hideL",l[1]<1),w(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-15wz55f")},m(g,v){N(g,e,v),p(e,t),p(e,n),p(e,i),p(e,s),p(e,r),p(r,o),p(r,a),p(a,f),p(e,c),u&&u.m(e,null),m=!0,_||(d=ne(e,"click",l[8]),_=!0)},p(g,[v]){(!m||v&2)&&H(t,"width",g[1]+"%"),(!m||v&2)&&X(i,"hideR",g[1]>=1),(!m||v&4)&&he(f,g[2]),(!m||v&2)&&X(r,"hideL",g[1]<1),g[0]?u?v&1&&j(u,1):(u=vl(),u.c(),j(u,1),u.m(e,null)):u&&(Me(),z(u,1,1,()=>{u=null}),De())},i(g){m||(j(u),m=!0)},o(g){z(u),m=!1},d(g){g&&E(e),u&&u.d(),_=!1,d()}}}function Ls(l,e,t){let n,i,s,{endTime:r=0}=e,{intervalTime:o=1}=e,{loading:a=!1}=e;const f=qe(0);Le(l,f,u=>t(7,s=u));let c=0;function m(){const u=Math.max(0,r-Date.now());t(1,c=Math.floor(xe(0,u/o,1)*100)),Ve(f,s=Math.ceil(u/1e3),s)}je(Xe(1e3,m));const _=u=>{const g=Math.floor(u%60);u/=60;const v=Math.floor(u%60);u/=60;const S=Math.floor(u),y=[];return(y.length||S)&&y.push(`${String(S).padStart(y.length?2:1,"0")}h`),(y.length||v)&&y.push(`${String(v).padStart(y.length?2:1,"0")}m`),(y.length||g)&&y.push(`${String(g).padStart(y.length?2:1,"0")}s`),y.join(" ")};function d(u){rn.call(this,l,u)}return l.$$set=u=>{"endTime"in u&&t(4,r=u.endTime),"intervalTime"in u&&t(5,o=u.intervalTime),"loading"in u&&t(0,a=u.loading)},l.$$.update=()=>{l.$$.dirty&128&&t(6,n=Math.ceil(s)),l.$$.dirty&64&&t(2,i=_(n))},[a,c,i,f,r,o,n,s,d]}class Ms extends pe{constructor(e){super(),me(this,e,Ls,Ss,_e,{endTime:4,intervalTime:5,loading:0})}}function Ds(l){let e;return{c(){e=te("\xA0")},m(t,n){N(t,e,n)},p:ie,d(t){t&&E(e)}}}function Os(l){let e,t=l[2].username+"",n;return{c(){e=te("@"),n=te(t)},m(i,s){N(i,e,s),N(i,n,s)},p(i,s){s&4&&t!==(t=i[2].username+"")&&he(n,t)},d(i){i&&E(e),i&&E(n)}}}function Ts(l){var Z,K;let e,t,n,i,s=((Z=l[2].first_name)!=null?Z:"")+"",r,o,a,f,c,m=((K=l[2].last_name)!=null?K:"")+"",_,d,u,g,v,S,y,k,O,T,h,I,M,C,Y;function F(B,q){return B[2].username?Os:Ds}let Q=F(l),P=Q(l);return T=new Ms({props:{intervalTime:l[1],endTime:l[0],loading:l[3]}}),T.$on("click",l[8]),{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),r=te(s),o=A(),a=b("div"),f=A(),c=b("div"),_=te(m),d=te("\xA0"),u=A(),g=b("div"),P.c(),v=A(),S=b("div"),S.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',y=A(),k=b("div"),O=A(),ce(T.$$.fragment),h=A(),I=b("div"),H(a,"width","8px"),w(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),w(g,"class","nowrap textOverEllipsis username svelte-1qt21qp"),w(S,"class","pos_abs btnLogout svelte-1qt21qp"),w(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),H(k,"height","8px"),H(I,"height","8px"),w(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(B,q){N(B,e,q),p(e,t),p(t,n),p(n,i),p(i,r),p(n,o),p(n,a),p(n,f),p(n,c),p(c,_),p(c,d),p(t,u),p(t,g),P.m(g,null),p(t,v),p(t,S),p(e,y),p(e,k),p(e,O),re(T,e,null),p(e,h),p(e,I),M=!0,C||(Y=ne(S,"click",l[7]),C=!0)},p(B,[q]){var U,x;(!M||q&4)&&s!==(s=((U=B[2].first_name)!=null?U:"")+"")&&he(r,s),(!M||q&4)&&m!==(m=((x=B[2].last_name)!=null?x:"")+"")&&he(_,m),Q===(Q=F(B))&&P?P.p(B,q):(P.d(1),P=Q(B),P&&(P.c(),P.m(g,null)));const se={};q&2&&(se.intervalTime=B[1]),q&1&&(se.endTime=B[0]),q&8&&(se.loading=B[3]),T.$set(se)},i(B){M||(j(T.$$.fragment,B),M=!0)},o(B){z(T.$$.fragment,B),M=!1},d(B){B&&E(e),P.d(),oe(T),C=!1,Y()}}}function Is(l,e,t){let n,i,s,{app:r}=e;const{operatorSelf_r:o,operatorSelfLastOnlineInfo_r:a,operatorSelfLastOnlineInfoLoading_r:f,operatorSelfLastOnline_SetOnlineFlag:c}=r;Le(l,o,S=>t(2,i=S)),Le(l,a,S=>t(10,n=S)),Le(l,f,S=>t(3,s=S));const m=()=>dn(null);let _=0,d=1;const u=S=>{if(!S){t(0,_=0),t(1,d=1);return}t(0,_=+new Date(S.offline_at)),t(1,d=xe(1,(S.interval|0)*1e3,1e9))};let g=!1;const v=async()=>{var S;!((S=r.appConfig)!=null&&S.operatorSelf_CanSetOnline)||g||(g=!0,await c(!0),g=!1)};return l.$$set=S=>{"app"in S&&t(9,r=S.app)},l.$$.update=()=>{l.$$.dirty&1024&&u(n)},[_,d,i,s,o,a,f,m,v,r,n]}class Cs extends pe{constructor(e){super(),me(this,e,Is,Ts,_e,{app:9})}}const Tt=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{if(!i)return;const o=l.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||n!==a.height)&&(t=a.width,n=a.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(a))}setTimeout(s,10)};return s(),Mt("useAbsSizeFromParent"),{destroy:()=>{i=!1,Dt("useAbsSizeFromParent")}}},As=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{if(!r)return;const f=l.getBoundingClientRect();(t!==f.width||n!==f.height||i!==f.x||s!==f.y)&&(t=f.width,n=f.height,i=f.x,s=f.y,e&&e.set(f)),setTimeout(o,10)};return o(),Mt("useWatchNodeBBox"),{destroy:()=>{r=!1,Dt("useWatchNodeBBox")}}};function xs(l){let e,t,n,i,s,r,o,a,f,c,m,_,d,u,g,v,S;return{c(){e=b("div"),t=b("div"),n=b("div"),i=A(),s=b("div"),r=A(),o=b("div"),a=A(),f=b("div"),c=A(),m=b("div"),_=A(),d=b("div"),u=A(),g=b("div"),v=A(),S=b("div"),w(n,"class","svelte-1lltvmx"),w(s,"class","svelte-1lltvmx"),w(o,"class","svelte-1lltvmx"),w(f,"class","svelte-1lltvmx"),w(m,"class","svelte-1lltvmx"),w(d,"class","svelte-1lltvmx"),w(g,"class","svelte-1lltvmx"),w(S,"class","svelte-1lltvmx"),w(t,"class","lds-roller svelte-1lltvmx"),H(t,"transform","scale("+l[2]+")"),H(t,"--loadingItemColor",l[1]),w(e,"class","flex"),H(e,"height",l[0]+"px"),H(e,"width",l[0]+"px")},m(y,k){N(y,e,k),p(e,t),p(t,n),p(t,i),p(t,s),p(t,r),p(t,o),p(t,a),p(t,f),p(t,c),p(t,m),p(t,_),p(t,d),p(t,u),p(t,g),p(t,v),p(t,S)},p(y,[k]){k&4&&H(t,"transform","scale("+y[2]+")"),k&2&&H(t,"--loadingItemColor",y[1]),k&1&&H(e,"height",y[0]+"px"),k&1&&H(e,"width",y[0]+"px")},i:ie,o:ie,d(y){y&&E(e)}}}function Es(l,e,t){let n,{size:i=80}=e,{color:s="#000"}=e;return l.$$set=r=>{"size"in r&&t(0,i=r.size),"color"in r&&t(1,s=r.color)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=i/80)},[i,s,n]}class mn extends pe{constructor(e){super(),me(this,e,Es,xs,_e,{size:0,color:1})}}function wl(l){let e,t,n,i;return t=new mn({props:{color:"#fff",size:"32"}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs loading svelte-1r93skw")},m(s,r){N(s,e,r),re(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ne(()=>{n||(n=Oe(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){z(t.$$.fragment,s),s&&(n||(n=Oe(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&E(e),oe(t),s&&n&&n.end()}}}function bl(l){let e,t,n,i;return t=new mn({props:{color:"#fff",size:"24"}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs flex flex_cy h100 loading svelte-1r93skw")},m(s,r){N(s,e,r),re(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ne(()=>{n||(n=Oe(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){z(t.$$.fragment,s),s&&(n||(n=Oe(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&E(e),oe(t),s&&n&&n.end()}}}function js(l){var O;let e,t,n,i,s,r,o,a=((O=l[0])!=null?O:0)+"",f,c,m,_,d,u,g,v,S,y=l[1]&&wl(),k=l[2]&&bl();return{c(){e=b("div"),t=b("div"),n=b("div"),n.textContent="New leads",i=A(),y&&y.c(),s=A(),r=b("div"),o=b("div"),f=te(a),c=A(),m=b("div"),_=A(),d=b("div"),k&&k.c(),u=te(`\r
		Get one`),w(n,"class","flex mainLabel svelte-1r93skw"),w(o,"class","flex labelCountNum svelte-1r93skw"),w(r,"class","flex flex_cx flex_cy labelCount svelte-1r93skw"),w(t,"class","flex flex_cx flex_cy flex_clm header pos_rel w100 svelte-1r93skw"),H(m,"height","4px"),w(d,"class","flex flex_cx flex_cy cursor_ptr noselect pos_rel bntMain svelte-1r93skw"),X(d,"disabled",!l[0]&&!l[2]&&!l[3]),X(d,"btnLoading",l[2]),X(d,"animationDone",l[3]==="done"),X(d,"animationFail",l[3]==="fail"),w(e,"class","flex flex_clm wrapMain flex_grow_1 w100 unselect svelte-1r93skw")},m(T,h){N(T,e,h),p(e,t),p(t,n),p(t,i),y&&y.m(t,null),p(t,s),p(t,r),p(r,o),p(o,f),p(e,c),p(e,m),p(e,_),p(e,d),k&&k.m(d,null),p(d,u),g=!0,v||(S=ne(d,"click",l[4]),v=!0)},p(T,[h]){var I;T[1]?y?h&2&&j(y,1):(y=wl(),y.c(),j(y,1),y.m(t,s)):y&&(Me(),z(y,1,1,()=>{y=null}),De()),(!g||h&1)&&a!==(a=((I=T[0])!=null?I:0)+"")&&he(f,a),T[2]?k?h&4&&j(k,1):(k=bl(),k.c(),j(k,1),k.m(d,u)):k&&(Me(),z(k,1,1,()=>{k=null}),De()),(!g||h&13)&&X(d,"disabled",!T[0]&&!T[2]&&!T[3]),(!g||h&4)&&X(d,"btnLoading",T[2]),(!g||h&8)&&X(d,"animationDone",T[3]==="done"),(!g||h&8)&&X(d,"animationFail",T[3]==="fail")},i(T){g||(j(y),j(k),g=!0)},o(T){z(y),z(k),g=!1},d(T){T&&E(e),y&&y.d(),k&&k.d(),v=!1,S()}}}function Ns(l,e,t){var f,c;let{app:n}=e,i=0,s=!0,r=!1,o=null;const a=async()=>{if(r||o||!i)return;t(2,r=!0);const m=await n.api.lead_AssignOneLead();t(2,r=!1),t(3,o=m?"done":"fail"),await tt(1e3),t(3,o=null)};return je(Xe(xe(100,((c=(f=n==null?void 0:n.appConfig)==null?void 0:f.updateIntervals)==null?void 0:c.new_leads_count)|0,36e5),async()=>{var m;t(0,i=((m=await n.api.lead_GetUnassignedLeadCount())==null?void 0:m.count)|0),t(1,s=!1)},!1)),l.$$set=m=>{"app"in m&&t(5,n=m.app)},[i,s,r,o,a,n]}class Fs extends pe{constructor(e){super(),me(this,e,Ns,js,_e,{app:5})}}function Rs(l){let e,t,n,i,s,r,o,a,f,c,m,_,d,u,g,v,S,y;return{c(){e=b("label"),t=b("input"),n=A(),i=He("svg"),s=He("symbol"),r=He("path"),o=He("defs"),a=He("mask"),f=He("use"),c=He("use"),m=He("path"),_=A(),d=He("svg"),u=He("path"),g=He("path"),v=He("path"),w(t,"type","checkbox"),w(t,"class","svelte-13drl8w"),w(r,"d","M5.22003 7.26C5.72003 7.76 7.57 9.7 8.67 11.45C12.2 6.05 15.65 3.5 19.19 1.69"),w(r,"fill","none"),w(r,"stroke-width","2.25"),w(r,"stroke-linecap","round"),w(r,"stroke-linejoin","round"),w(s,"id","tick-path"),w(s,"viewBox","0 0 21 18"),w(s,"xmlns","http://www.w3.org/2000/svg"),w(f,"class","tick mask svelte-13drl8w"),w(f,"href","#tick-path"),w(a,"id","tick"),w(c,"class","tick svelte-13drl8w"),w(c,"href","#tick-path"),w(c,"stroke","currentColor"),w(m,"fill","white"),w(m,"mask","url(#tick)"),w(m,"d","M18 9C18 10.4464 17.9036 11.8929 17.7589 13.1464C17.5179 15.6054 15.6054 17.5179 13.1625 17.7589C11.8929 17.9036 10.4464 18 9 18C7.55357 18 6.10714 17.9036 4.85357 17.7589C2.39464 17.5179 0.498214 15.6054 0.241071 13.1464C0.0964286 11.8929 0 10.4464 0 9C0 7.55357 0.0964286 6.10714 0.241071 4.8375C0.498214 2.39464 2.39464 0.482143 4.85357 0.241071C6.10714 0.0964286 7.55357 0 9 0C10.4464 0 11.8929 0.0964286 13.1625 0.241071C15.6054 0.482143 17.5179 2.39464 17.7589 4.8375C17.9036 6.10714 18 7.55357 18 9Z"),w(i,"viewBox","0 0 21 18"),w(i,"class","svelte-13drl8w"),w(u,"d","M5.88086 5.89441L9.53504 4.26746"),w(g,"d","M5.5274 8.78838L9.45391 9.55161"),w(v,"d","M3.49371 4.22065L5.55387 0.79198"),w(d,"class","lines svelte-13drl8w"),w(d,"viewBox","0 0 11 11"),w(e,"class","checkbox svelte-13drl8w")},m(k,O){N(k,e,O),p(e,t),t.checked=l[0],p(e,n),p(e,i),p(i,s),p(s,r),p(i,o),p(o,a),p(a,f),p(i,c),p(i,m),p(e,_),p(e,d),p(d,u),p(d,g),p(d,v),S||(y=ne(t,"change",l[1]),S=!0)},p(k,[O]){O&1&&(t.checked=k[0])},i:ie,o:ie,d(k){k&&E(e),S=!1,y()}}}function Bs(l,e,t){let{checked:n=!1}=e;function i(){n=this.checked,t(0,n)}return l.$$set=s=>{"checked"in s&&t(0,n=s.checked)},[n,i]}class Hs extends pe{constructor(e){super(),me(this,e,Bs,Rs,_e,{checked:0})}}function yl(l){let e,t=l[13](l[4])+"",n;return{c(){e=b("div"),n=te(t),w(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-n8zo8q")},m(i,s){N(i,e,s),p(e,n)},p(i,s){s&16&&t!==(t=i[13](i[4])+"")&&he(n,t)},d(i){i&&E(e)}}}function kl(l){var i;let e,t=((i=l[3])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=b("div"),n=te(t),w(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-n8zo8q")},m(s,r){N(s,e,r),p(e,n)},p(s,r){var o;r&8&&t!==(t=((o=s[3])==null?void 0:o.unread_messages_count)+"")&&he(n,t)},d(s){s&&E(e)}}}function Ps(l){var ae,ve,ye,W,G,V,we,ke,Te,Se,ge;let e,t,n,i,s,r,o=((ye=(ve=(ae=l[3])==null?void 0:ae.lead)==null?void 0:ve.first_name)!=null?ye:"")+"",a,f,c,m,_,d=((V=(G=(W=l[3])==null?void 0:W.lead)==null?void 0:G.last_name)!=null?V:"")+"",u,g,v,S,y=((Te=(ke=(we=l[3])==null?void 0:we.last_message)==null?void 0:ke.text)!=null?Te:"")+"",k,O,T,h,I,M,C,Y,F=((Se=l[5])==null?void 0:Se.title)+"",Q,P,Z,K,B,q,se,U=l[4]&&yl(l),x=((ge=l[3])==null?void 0:ge.unread_messages_count)&&kl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),s=A(),r=b("div"),a=te(o),f=A(),c=b("div"),m=A(),_=b("div"),u=te(d),g=te("\xA0"),v=A(),S=b("div"),k=te(y),O=te("\xA0"),T=A(),h=b("div"),I=b("div"),M=b("img"),Y=A(),Q=te(F),P=A(),Z=b("div"),K=A(),U&&U.c(),B=A(),x&&x.c(),H(i,"width","8px"),H(c,"width","8px"),w(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-n8zo8q"),w(S,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-n8zo8q"),Ke(M.src,C="assets/icons/status1.png")||w(M,"src",C),w(M,"draggable","false"),w(M,"class","pos_abs statusIcon svelte-n8zo8q"),w(I,"class","flex flex_cy leadStatus pos_rel svelte-n8zo8q"),H(I,"background",l[5].bgColor),H(I,"color",l[5].color),H(Z,"width","4px"),w(h,"class","flex"),w(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-n8zo8q"),H(t,"height",l[0]+"px"),X(t,"active",l[1]===l[7]),X(t,"disabled",l[12](l[3])),w(e,"class","pos_abs w100 cntWrapper svelte-n8zo8q"),H(e,"transform","translate3d(0px, "+(l[6]+l[2])+"px, 0px)")},m(fe,D){N(fe,e,D),p(e,t),p(t,n),p(n,i),p(n,s),p(n,r),p(r,a),p(n,f),p(n,c),p(n,m),p(n,_),p(_,u),p(_,g),p(t,v),p(t,S),p(S,k),p(S,O),p(t,T),p(t,h),p(h,I),p(I,M),p(I,Y),p(I,Q),p(h,P),p(h,Z),p(t,K),U&&U.m(t,null),p(t,B),x&&x.m(t,null),q||(se=ne(t,"click",l[11]),q=!0)},p(fe,[D]){var L,R,J,$,le,ee,de,be,ue,Ce,Ae;D&8&&o!==(o=((J=(R=(L=fe[3])==null?void 0:L.lead)==null?void 0:R.first_name)!=null?J:"")+"")&&he(a,o),D&8&&d!==(d=((ee=(le=($=fe[3])==null?void 0:$.lead)==null?void 0:le.last_name)!=null?ee:"")+"")&&he(u,d),D&8&&y!==(y=((ue=(be=(de=fe[3])==null?void 0:de.last_message)==null?void 0:be.text)!=null?ue:"")+"")&&he(k,y),D&32&&F!==(F=((Ce=fe[5])==null?void 0:Ce.title)+"")&&he(Q,F),D&32&&H(I,"background",fe[5].bgColor),D&32&&H(I,"color",fe[5].color),fe[4]?U?U.p(fe,D):(U=yl(fe),U.c(),U.m(t,B)):U&&(U.d(1),U=null),(Ae=fe[3])!=null&&Ae.unread_messages_count?x?x.p(fe,D):(x=kl(fe),x.c(),x.m(t,null)):x&&(x.d(1),x=null),D&1&&H(t,"height",fe[0]+"px"),D&130&&X(t,"active",fe[1]===fe[7]),D&4104&&X(t,"disabled",fe[12](fe[3])),D&68&&H(e,"transform","translate3d(0px, "+(fe[6]+fe[2])+"px, 0px)")},i:ie,o:ie,d(fe){fe&&E(e),U&&U.d(),x&&x.d(),q=!1,se()}}}function Gs(l,e,t){let n,i,s,r,o,a,{app:f}=e;const{dialogMap_r:c,dialogActiveID_r:m,dialogActiveID_Set:_}=f;Le(l,c,h=>t(16,r=h)),Le(l,m,h=>t(7,a=h));let{height:d=54}=e,{dialog_id:u}=e,{y:g=0}=e,{scrollY:v=0}=e;const S=qe(g);Le(l,S,h=>t(6,o=h));const y=h=>{n&&!k(n)&&_(n.id)},k=h=>{var I;return((I=h==null?void 0:h.lead)==null?void 0:I.status)==="DL"},O=h=>{if(!h)return"";const I=C=>String(C).padStart(2,"0"),M=new Date;return h=new Date(h),h.getYear()===M.getYear()&&h.getMonth()===M.getMonth()?h.getDate()===M.getDate()?`${I(h.getHours())}:${I(h.getMinutes())}`:`${I(h.getDate())}d ${I(h.getHours())}:${I(h.getMinutes())}`:`${I(h.getDate())}.${I(h.getMonth())}.${h.getFullYear()}`},T=h=>{var I,M,C;return(C=(I=h==null?void 0:h.last_message)==null?void 0:I.received_at)!=null?C:(M=h==null?void 0:h.lead)==null?void 0:M.date_joined};return l.$$set=h=>{"app"in h&&t(14,f=h.app),"height"in h&&t(0,d=h.height),"dialog_id"in h&&t(1,u=h.dialog_id),"y"in h&&t(15,g=h.y),"scrollY"in h&&t(2,v=h.scrollY)},l.$$.update=()=>{l.$$.dirty&32768&&Ve(S,o=g,o),l.$$.dirty&65538&&t(3,n=r[u]),l.$$.dirty&16392&&t(5,i=f.lead_GetStatusOrDefault(n==null?void 0:n.lead)),l.$$.dirty&8&&t(4,s=T(n))},[d,u,v,n,s,i,o,a,c,m,S,y,k,O,f,g,r]}class zs extends pe{constructor(e){super(),me(this,e,Gs,Ps,_e,{app:14,height:0,dialog_id:1,y:15,scrollY:2})}}function qs(l){let e,t,n,i;return{c(){e=b("div"),t=b("div"),w(t,"class","pos_abs thumb w100 svelte-5ca5ia"),H(t,"height",l[1]+"px"),H(t,"transform","translate(0px, "+l[5](l[0],l[2],l[1])+"px)"),X(t,"active",l[3]),w(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),X(e,"active",l[3])},m(s,r){N(s,e,r),p(e,t),n||(i=[ne(window,"mousemove",l[7]),ne(window,"mouseup",l[8]),ne(window,"blur",l[8]),ne(t,"mousedown",l[6]),at(As.call(null,e,l[4])),ne(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&H(t,"height",s[1]+"px"),r&7&&H(t,"transform","translate(0px, "+s[5](s[0],s[2],s[1])+"px)"),r&8&&X(t,"active",s[3]),r&8&&X(e,"active",s[3])},i:ie,o:ie,d(s){s&&E(e),n=!1,Fe(i)}}}function Us(l,e,t){let n;const i=k=>xe(0,Array.isArray(k)?k[0]:k,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:a=null}=e;const f=Pe(null);Le(l,f,k=>t(2,n=k));const c=()=>n?n.height-o:1,m=k=>n?k*c():0,_=()=>{if(!n)return 1;if(a===null)return o;t(1,o=xe(.1,a,1)*n.height)};let d=null;const u=k=>{!n||t(3,d={y:k.clientY,value_out:r})},g=k=>{if(!n||!d)return;const O=k.clientY-d.y;if(n.height){const T=O/c();t(0,r=xe(0,d.value_out+T,1))}},v=k=>{t(3,d=null)},S=k=>{!n||d||(t(0,r=xe(0,(k.clientY-n.y-o/2)/c(),1)),t(3,d={y:k.clientY,value_out:r}))},y=()=>{if(!n)return 0;d||t(0,r=i(s))};return l.$$set=k=>{"value_in"in k&&t(10,s=k.value_in),"value_out"in k&&t(0,r=k.value_out),"thumb_Height"in k&&t(1,o=k.thumb_Height),"thumb_HeightRate"in k&&t(11,a=k.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&_(),l.$$.dirty&1024&&y()},[r,o,n,d,f,m,u,g,v,S,s,a]}class pn extends pe{constructor(e){super(),me(this,e,Us,qs,_e,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:Ws}=En;function Sl(l,e,t){const n=l.slice();return n[24]=e[t],n}function Ll(l,e){let t,n,i;return n=new zs({props:{app:e[0],dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Be(),ce(n.$$.fragment),this.first=t},m(s,r){N(s,t,r),re(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){z(n.$$.fragment,s),i=!1},d(s){s&&E(t),oe(n,s)}}}function Ml(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new pn({props:r}),Re.push(()=>kt(t,"value_out",s)),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,a){N(o,e,a),re(t,e,null),i=!0},p(o,a){const f={};a&32&&(f.value_in=o[5]),a&64&&(f.thumb_HeightRate=o[6]),!n&&a&2&&(n=!0,f.value_out=o[1],yt(()=>n=!1)),t.$set(f)},i(o){i||(j(t.$$.fragment,o),i=!0)},o(o){z(t.$$.fragment,o),i=!1},d(o){o&&E(e),oe(t)}}}function Dl(l){let e,t,n,i,s;return{c(){e=b("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',w(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){N(r,e,o),n=!0,i||(s=ne(e,"click",l[15]),i=!0)},p:ie,i(r){n||(r&&Ne(()=>{t||(t=Oe(e,Ie,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Oe(e,Ie,{},!1)),t.run(0)),n=!1},d(r){r&&E(e),r&&t&&t.end(),i=!1,s()}}}function Ys(l){let e,t,n=[],i=new Ws,s,r,o,a,f,c=l[4];const m=u=>u[24].dialog_id;for(let u=0;u<c.length;u+=1){let g=Sl(l,c,u),v=m(g);i.set(v,n[u]=Ll(v,g))}let _=l[6]<1&&Ml(l),d=l[6]<1&&l[7]&&Dl(l);return{c(){e=b("div"),t=b("div");for(let u=0;u<n.length;u+=1)n[u].c();s=A(),_&&_.c(),r=A(),d&&d.c(),w(t,"class","flex overhide pos_rel"),w(e,"class","flex flex_grow_1 pos_rel"),H(e,"--itemHeight",We+"px")},m(u,g){N(u,e,g),p(e,t);for(let v=0;v<n.length;v+=1)n[v].m(t,null);p(e,s),_&&_.m(e,null),p(e,r),d&&d.m(e,null),o=!0,a||(f=[at(Tt.call(null,t,l[8])),ne(e,"wheel",l[10],{passive:!0})],a=!0)},p(u,[g]){g&21&&(c=u[4],Me(),n=Je(n,g,m,1,u,c,i,t,lt,Ll,null,Sl),De()),u[6]<1?_?(_.p(u,g),g&64&&j(_,1)):(_=Ml(u),_.c(),j(_,1),_.m(e,r)):_&&(Me(),z(_,1,1,()=>{_=null}),De()),u[6]<1&&u[7]?d?(d.p(u,g),g&192&&j(d,1)):(d=Dl(u),d.c(),j(d,1),d.m(e,null)):d&&(Me(),z(d,1,1,()=>{d=null}),De())},i(u){if(!o){for(let g=0;g<c.length;g+=1)j(n[g]);j(_),j(d),o=!0}},o(u){for(let g=0;g<n.length;g+=1)z(n[g]);z(_),z(d),o=!1},d(u){u&&E(e);for(let g=0;g<n.length;g+=1)n[g].d();_&&_.d(),d&&d.d(),a=!1,Fe(f)}}}const We=54;function Js(l,e,t){let n,i,s=ie,r=()=>(s(),s=Ht(u,P=>t(13,i=P)),u),o;l.$$.on_destroy.push(()=>s());let{app:a}=e;const{dialogMap_SetDialogList:f}=a;let{filter:c={}}=e;const m=P=>{var Z,K;return[c.filterUnreadFirst?1:0,(Z=c.filterTag)!=null?Z:"",(K=c.filterStatus)!=null?K:""].join("/")};let _={},d=null,u=Pe(null);r();function g(){const P={...c},Z=m();_[Z]||(_[Z]=zn({fLoad:K=>(K={unread_first:P.filterUnreadFirst?1:0,...K},P.filterTag&&(K.tag=P.filterTag),P.filterStatus&&(K.status=P.filterStatus),a.api.dialog_GetList(K)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:f})),d!==_[Z]&&([...Object.values(_)].map(K=>K.pause()),d=_[Z],d.resume(),console.log({filterHash:Z}),r(t(3,u=d.getData_r())))}je(()=>[...Object.values(_)].map(P=>P.destroy()));let v=[];const S=Pe(null);Le(l,S,P=>t(12,n=P));let y=0,k=0,O=1,T=0,h=qe(T,{duration:200});Le(l,h,P=>t(2,o=P));function I(){if(!n||!i)return;const P=Math.max(1,Math.floor(n.height)),Z=i.total*We,K=Z-P;t(6,O=Z?xe(0,P/Z,1):1),K<0?T=0:T=k*K,Ve(h,o=T,o)}let M=!1;function C(){if(!n||!i)return;const P=i,Z=Math.max(1,Math.floor(n.height)),K=Math.ceil(Z/We);i.total*We;let q=Math.max(0,Math.floor(o/We)-1);const se=K+2;q>P.total&&(q=Math.max(0,P.total-se)),d&&d.setRange(q,se);const U=[];for(let x=q,ae=0;ae<se&&x<P.total;ae++,x++){const ve=P.list[x];U.push({index:x,item:ve,y:x*We})}t(4,v=[...new Map(U.filter(x=>x.item).map(x=>[x.item.id,x]))].map(([x,ae])=>({dialog_id:ae.item.id,y:ae.y}))),t(7,M=q>1)}const Y=P=>{if(!n||!i)return;const Z=i,K=Math.max(1,Math.floor(n.height)),q=Z.total*We-K;if(q<0)return;const se=P.deltaY>0?1:-1;t(5,y=[k+We/q*se])};function F(P){k=P,t(1,k)}const Q=()=>t(5,y=[0]);return l.$$set=P=>{"app"in P&&t(0,a=P.app),"filter"in P&&t(11,c=P.filter)},l.$$.update=()=>{l.$$.dirty&2048&&g(),l.$$.dirty&12290&&I(),l.$$.dirty&12292&&C()},[a,k,o,u,v,y,O,M,S,h,Y,c,n,i,F,Q]}class Vs extends pe{constructor(e){super(),me(this,e,Js,Ys,_e,{app:0,filter:11})}}function Ol(l,e,t){const n=l.slice();return n[6]=e[t],n}function Tl(l){let e,t,n,i,s=[],r=new Map,o=l[0];const a=f=>f[6].id;for(let f=0;f<o.length;f+=1){let c=Ol(l,o,f),m=a(c);r.set(m,s[f]=Il(m,c))}return{c(){e=b("div"),t=b("div"),t.textContent="Filter status",n=A(),i=b("div");for(let f=0;f<s.length;f+=1)s[f].c();w(t,"class","flex label svelte-1ovi0to"),w(i,"class","flex unselect"),w(e,"class","flex flex_clm unselect")},m(f,c){N(f,e,c),p(e,t),p(e,n),p(e,i);for(let m=0;m<s.length;m+=1)s[m].m(i,null)},p(f,c){c&3&&(o=f[0],s=Je(s,c,a,1,f,o,r,i,cn,Il,null,Ol))},d(f){f&&E(e);for(let c=0;c<s.length;c+=1)s[c].d()}}}function Il(l,e){let t,n=e[6].title+"",i,s,r;return{key:l,first:null,c(){var o,a,f,c;t=b("div"),i=te(n),w(t,"class","flex flex_cx flex_cy nowrap cursor_ptr statusItem svelte-1ovi0to"),H(t,"background",(a=(o=e[6])==null?void 0:o.bgColor)!=null?a:"#000"),H(t,"color",(c=(f=e[6])==null?void 0:f.color)!=null?c:"#fff"),X(t,"select",e[6]._select),this.first=t},m(o,a){N(o,t,a),p(t,i),s||(r=ne(t,"click",function(){Ye(e[1](e[6]))&&e[1](e[6]).apply(this,arguments)}),s=!0)},p(o,a){var f,c,m,_;e=o,a&1&&n!==(n=e[6].title+"")&&he(i,n),a&1&&H(t,"background",(c=(f=e[6])==null?void 0:f.bgColor)!=null?c:"#000"),a&1&&H(t,"color",(_=(m=e[6])==null?void 0:m.color)!=null?_:"#fff"),a&1&&X(t,"select",e[6]._select)},d(o){o&&E(t),s=!1,r()}}}function Ks(l){let e,t=l[0].length>1&&Tl(l);return{c(){t&&t.c(),e=Be()},m(n,i){t&&t.m(n,i),N(n,e,i)},p(n,[i]){n[0].length>1?t?t.p(n,i):(t=Tl(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ie,o:ie,d(n){t&&t.d(n),n&&E(e)}}}const Cl="__ALL__";function Xs(l,e,t){var a,f;let{app:n}=e,{filterStatus:i=null}=e,s=[{title:"ALL",id:Cl,color:"#000",bgColor:"#fff",_select:!0},...((f=(a=n==null?void 0:n.appConfig)==null?void 0:a.lead_StatusFilterList)!=null?f:[]).map(n.lead_GetStatusByID).map(c=>({...c,_select:!1}))];const r=()=>{var c,m;t(0,s),t(2,i=s.length?s[0]._select?null:(m=(c=s.find(_=>_._select))==null?void 0:c.id)!=null?m:null:null)},o=c=>{const m=!c._select;return m?(s.map(_=>_._select=!1),c._select=m,r()):c.id===Cl?void 0:(t(0,s[0]._select=!0,s),c._select=m,r())};return r(),l.$$set=c=>{"app"in c&&t(3,n=c.app),"filterStatus"in c&&t(2,i=c.filterStatus)},[s,o,i,n]}class Zs extends pe{constructor(e){super(),me(this,e,Xs,Ks,_e,{app:3,filterStatus:2})}}function Al(l){let e,t,n,i,s,r,o,a,f;return{c(){e=b("img"),n=A(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',r=A(),o=b("div"),o.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/fullscreen.png"/>',w(e,"class","a_img svelte-1m8yuzj"),Ke(e.src,t=l[2].url)||w(e,"src",t),H(e,"max-height",l[4]+"px"),w(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(o,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(c,m){N(c,e,m),N(c,n,m),N(c,i,m),p(i,s),p(i,r),p(i,o),a||(f=[ne(s,"click",function(){Ye(l[5](l[2]))&&l[5](l[2]).apply(this,arguments)}),ne(o,"click",function(){Ye(l[6](l[2]))&&l[6](l[2]).apply(this,arguments)})],a=!0)},p(c,m){l=c,m&4&&!Ke(e.src,t=l[2].url)&&w(e,"src",t),m&16&&H(e,"max-height",l[4]+"px")},d(c){c&&E(e),c&&E(n),c&&E(i),a=!1,Fe(f)}}}function xl(l){let e,t,n,i,s,r,o;return{c(){e=b("img"),n=A(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',w(e,"class","a_img fileIcon svelte-1m8yuzj"),Ke(e.src,t="assets/icons/folder.png")||w(e,"src",t),H(e,"max-height",l[4]+"px"),w(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(a,f){N(a,e,f),N(a,n,f),N(a,i,f),p(i,s),r||(o=ne(s,"click",l[13]),r=!0)},p(a,f){f&16&&H(e,"max-height",a[4]+"px")},d(a){a&&E(e),a&&E(n),a&&E(i),r=!1,o()}}}function El(l){var i;let e,t=((i=l[0])==null?void 0:i.text)+"",n;return{c(){e=b("pre"),n=te(t),w(e,"class","w100 text textPre svelte-1m8yuzj")},m(s,r){N(s,e,r),p(e,n)},p(s,r){var o;r&1&&t!==(t=((o=s[0])==null?void 0:o.text)+"")&&he(n,t)},d(s){s&&E(e)}}}function Qs(l){var m,_;let e,t,n,i,s,r=l[7]((m=l[0])==null?void 0:m.received_at)+"",o,a=l[2]&&Al(l),f=l[3]&&xl(l),c=((_=l[0])==null?void 0:_.text)&&El(l);return{c(){var d,u,g,v;e=b("div"),a&&a.c(),t=A(),f&&f.c(),n=A(),c&&c.c(),i=A(),s=b("div"),o=te(r),w(s,"class","flex pos_abs unselect date svelte-1m8yuzj"),X(s,"attachment_mode",l[2]&&!((d=l[0])!=null&&d.text)),w(e,"class","flex flex_clm overhide pos_abs chat_item svelte-1m8yuzj"),X(e,"chat_item_other",(u=l[0])==null?void 0:u.incoming),X(e,"chat_item_self",!((g=l[0])!=null&&g.incoming)),X(e,"has_text",(v=l[0])==null?void 0:v.text)},m(d,u){N(d,e,u),a&&a.m(e,null),p(e,t),f&&f.m(e,null),p(e,n),c&&c.m(e,null),p(e,i),p(e,s),p(s,o),l[14](e)},p(d,[u]){var g,v,S,y,k,O;d[2]?a?a.p(d,u):(a=Al(d),a.c(),a.m(e,t)):a&&(a.d(1),a=null),d[3]?f?f.p(d,u):(f=xl(d),f.c(),f.m(e,n)):f&&(f.d(1),f=null),(g=d[0])!=null&&g.text?c?c.p(d,u):(c=El(d),c.c(),c.m(e,i)):c&&(c.d(1),c=null),u&1&&r!==(r=d[7]((v=d[0])==null?void 0:v.received_at)+"")&&he(o,r),u&5&&X(s,"attachment_mode",d[2]&&!((S=d[0])!=null&&S.text)),u&1&&X(e,"chat_item_other",(y=d[0])==null?void 0:y.incoming),u&1&&X(e,"chat_item_self",!((k=d[0])!=null&&k.incoming)),u&1&&X(e,"has_text",(O=d[0])==null?void 0:O.text)},i:ie,o:ie,d(d){d&&E(e),a&&a.d(),f&&f.d(),c&&c.d(),l[14](null)}}}function $s(l,e,t){let{app:n}=e,{bbox:i=null}=e,{message:s=null}=e,{render_Width:r=1}=e,{render_X:o=-r*2}=e,a=null,f=null,c=null,m=null,_=[],d=[],u=1;function g(h){var M;_=[],d=[],h&&(M=h.attachments)!=null&&M.length&&(_=h.attachments.filter(C=>C.file_type==="IM").map(C=>({url:C.url})),d=h.attachments.filter(C=>C.file_type==="DC").map(C=>({url:C.url})));const I=i.height*.7;i.width,t(4,u=I),t(2,c=_==null?void 0:_[0]),t(3,m=d==null?void 0:d[0])}function v(h){if(!h||!Array.isArray(h.attachments)){t(0,f=null);return}if(!f){t(0,f=h);return}if(f.text!==h.text||f.incoming!==h.incoming||f.received_at!==h.received_at||f.attachments.length!==h.attachments.length){t(0,f=h);return}if(!f.attachments.map((I,M)=>[I,h.attachments[M]]).every(([I,M])=>I.file_type===M.file_type&&I.url===M.url)){t(0,f=h);return}}const S=h=>I=>{h&&h.url&&Ft(h.url)},y=h=>I=>{h&&h.url&&n.events.emit("openOverlayImageView",h.url)},k=h=>{if(h===null)return"";const I=C=>String(C).padStart(2,"0"),M=new Date;return h=new Date(h),h.getYear()===M.getYear()&&h.getMonth()===M.getMonth()&&h.getDate()===M.getDate()?`${I(h.getHours())}:${I(h.getMinutes())}`:`${I(h.getDate())}.${I(h.getMonth())}.${h.getFullYear()} ${I(h.getHours())}:${I(h.getMinutes())}`},O=()=>un(m.url);function T(h){Re[h?"unshift":"push"](()=>{a=h,t(1,a)})}return l.$$set=h=>{"app"in h&&t(8,n=h.app),"bbox"in h&&t(9,i=h.bbox),"message"in h&&t(10,s=h.message),"render_Width"in h&&t(11,r=h.render_Width),"render_X"in h&&t(12,o=h.render_X)},l.$$.update=()=>{l.$$.dirty&1024&&v(s),l.$$.dirty&1&&g(f)},[f,a,c,m,u,S,y,k,n,i,s,r,o,O,T]}class ei extends pe{constructor(e){super(),me(this,e,$s,Qs,_e,{app:8,bbox:9,message:10,render_Width:11,render_X:12})}}function ti(l){let e;return{c(){e=b("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,w(e,"class","lds-roller svelte-j15bjw")},m(t,n){N(t,e,n)},p:ie,i:ie,o:ie,d(t){t&&E(e)}}}class gn extends pe{constructor(e){super(),me(this,e,null,ti,_e,{})}}function jl(l){let e,t=l[0]===">"?">":"",n;return{c(){e=b("div"),n=te(t),w(e,"class","flex flex_cx flex_cy statusItemDlm svelte-1h7gd9r")},m(i,s){N(i,e,s),p(e,n)},p(i,s){s&1&&t!==(t=i[0]===">"?">":"")&&he(n,t)},d(i){i&&E(e)}}}function li(l){var c,m,_,d;let e,t,n,i,s=((d=(c=l[1])==null?void 0:c.title)!=null?d:(m=l[1])!=null&&m.id?`#${(_=l[1])==null?void 0:_.id}`:"*UNK*")+"",r,o,a,f=l[0]&&jl(l);return{c(){var u,g,v,S,y;e=b("div"),t=b("div"),f&&f.c(),n=A(),i=b("div"),r=te(s),w(i,"class","flex flex_cx flex_cy nowrap statusItem svelte-1h7gd9r"),H(i,"background",(g=(u=l[1])==null?void 0:u.bgColor)!=null?g:"#000"),H(i,"color",(S=(v=l[1])==null?void 0:v.color)!=null?S:"#fff"),X(i,"select",l[1].canSelect),w(t,"class","flex"),w(e,"class","flex flex_cy h100 overhide itemWrapper svelte-1h7gd9r"),H(e,"width",l[5]+"px"),X(e,"overhide",l[5]<l[4]&&l[4]>0),X(e,"cursor_ptr",(y=l[1])==null?void 0:y.canSelect)},m(u,g){N(u,e,g),p(e,t),f&&f.m(t,null),p(t,n),p(t,i),p(i,r),l[10](t),l[11](e),o||(a=ne(i,"click",l[9]),o=!0)},p(u,[g]){var v,S,y,k,O,T,h,I,M;u[0]?f?f.p(u,g):(f=jl(u),f.c(),f.m(t,n)):f&&(f.d(1),f=null),g&2&&s!==(s=((k=(v=u[1])==null?void 0:v.title)!=null?k:(S=u[1])!=null&&S.id?`#${(y=u[1])==null?void 0:y.id}`:"*UNK*")+"")&&he(r,s),g&2&&H(i,"background",(T=(O=u[1])==null?void 0:O.bgColor)!=null?T:"#000"),g&2&&H(i,"color",(I=(h=u[1])==null?void 0:h.color)!=null?I:"#fff"),g&2&&X(i,"select",u[1].canSelect),g&32&&H(e,"width",u[5]+"px"),g&48&&X(e,"overhide",u[5]<u[4]&&u[4]>0),g&2&&X(e,"cursor_ptr",(M=u[1])==null?void 0:M.canSelect)},i:ie,o:ie,d(u){u&&E(e),f&&f.d(),l[10](null),l[11](null),o=!1,a()}}}function ni(l,e,t){let n,{beforeDlm:i=!1}=e,{hide:s=!1}=e,{status:r={}}=e;const o=sn();let a,f,c=0;const m=qe(0,{duration:200});Le(l,m,v=>t(5,n=v));const _=()=>{a&&f&&m.set(s?0:c)};qt(()=>{a&&f&&(t(4,c=f.offsetWidth),_())});const d=()=>r.canSelect&&o("click",r);function u(v){Re[v?"unshift":"push"](()=>{f=v,t(3,f)})}function g(v){Re[v?"unshift":"push"](()=>{a=v,t(2,a)})}return l.$$set=v=>{"beforeDlm"in v&&t(0,i=v.beforeDlm),"hide"in v&&t(8,s=v.hide),"status"in v&&t(1,r=v.status)},l.$$.update=()=>{l.$$.dirty&256&&_()},[i,r,a,f,c,n,o,m,s,d,u,g]}class si extends pe{constructor(e){super(),me(this,e,ni,li,_e,{beforeDlm:0,hide:8,status:1})}}function Nl(l,e,t){const n=l.slice();return n[8]=e[t],n[10]=t,n}function Fl(l,e){var s;let t,n,i;return n=new si({props:{beforeDlm:(s=e[8].status)==null?void 0:s.beforeDlm,status:e[8].status,hide:e[8].hide}}),n.$on("click",e[3]),{key:l,first:null,c(){t=Be(),ce(n.$$.fragment),this.first=t},m(r,o){N(r,t,o),re(n,r,o),i=!0},p(r,o){var f;e=r;const a={};o&1&&(a.beforeDlm=(f=e[8].status)==null?void 0:f.beforeDlm),o&1&&(a.status=e[8].status),o&1&&(a.hide=e[8].hide),n.$set(a)},i(r){i||(j(n.$$.fragment,r),i=!0)},o(r){z(n.$$.fragment,r),i=!1},d(r){r&&E(t),oe(n,r)}}}function ii(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[8].rID;for(let o=0;o<s.length;o+=1){let a=Nl(l,s,o),f=r(a);n.set(f,t[o]=Fl(f,a))}return{c(){e=b("div");for(let o=0;o<t.length;o+=1)t[o].c();w(e,"class","flex h100")},m(o,a){N(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],Me(),t=Je(t,a,r,1,o,s,n,e,lt,Fl,null,Nl),De())},i(o){if(!i){for(let a=0;a<s.length;a+=1)j(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)z(t[a]);i=!1},d(o){o&&E(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ri(l,e,t){let{statusList:n=[]}=e,{statusSelectList:i=[]}=e,s=[],r=1;je(Xe(1e3,()=>{const f=Date.now();t(0,s=s.filter(c=>!c.hide||c.hide<=f))}));const o=()=>{const f=[...n];let c=-1;const m=r++;for(;f.length;){const _=f.shift(),d=s.findIndex(u=>{var g,v;return((g=u==null?void 0:u.status)==null?void 0:g.id)===(_==null?void 0:_.id)&&((v=u==null?void 0:u.status)==null?void 0:v.beforeDlm)===(_==null?void 0:_.beforeDlm)});if(d>c)c=d,t(0,s[d].seq=m,s),t(0,s[d].status=_,s);else{const u={rID:r++,seq:m,status:_,hide:!1};s.splice(c+1,0,u),c++}}s.filter(_=>_.seq===m).map(_=>_.hide=!1),s.filter(_=>_.seq!==m).map(_=>_.hide=Date.now()+1e3),t(0,s)};function a(f){rn.call(this,l,f)}return l.$$set=f=>{"statusList"in f&&t(1,n=f.statusList),"statusSelectList"in f&&t(2,i=f.statusSelectList)},l.$$.update=()=>{l.$$.dirty&2&&o()},[s,n,i,a]}class oi extends pe{constructor(e){super(),me(this,e,ri,ii,_e,{statusList:1,statusSelectList:2})}}function Rl(l){var d;let e,t,n,i,s,r,o,a,f,c,m;o=new oi({props:{statusList:l[7]((d=l[0])==null?void 0:d.lead,l[2])}}),o.$on("click",l[12]);let _=l[1]&&Bl();return{c(){e=b("div"),t=b("div"),n=A(),i=b("img"),r=A(),ce(o.$$.fragment),a=A(),_&&_.c(),w(t,"class","pos_abs w100 h100 overhide bg svelte-socr2e"),Ke(i.src,s="assets/icons/status1.png")||w(i,"src",s),w(i,"draggable","false"),w(i,"class","pos_abs statusIcon svelte-socr2e"),w(e,"class","flex flex_cx flex_cy unselect statusCnt pos_rel svelte-socr2e"),X(e,"loading",l[1])},m(u,g){N(u,e,g),p(e,t),p(e,n),p(e,i),p(e,r),re(o,e,null),p(e,a),_&&_.m(e,null),l[13](e),f=!0,c||(m=[ne(e,"mouseenter",l[14]),ne(e,"mouseleave",l[15]),ne(e,"click",l[16])],c=!0)},p(u,g){var S;const v={};g&5&&(v.statusList=u[7]((S=u[0])==null?void 0:S.lead,u[2])),o.$set(v),u[1]?_?g&2&&j(_,1):(_=Bl(),_.c(),j(_,1),_.m(e,null)):_&&(Me(),z(_,1,1,()=>{_=null}),De()),(!f||g&2)&&X(e,"loading",u[1])},i(u){f||(j(o.$$.fragment,u),j(_),f=!0)},o(u){z(o.$$.fragment,u),z(_),f=!1},d(u){u&&E(e),oe(o),_&&_.d(),l[13](null),c=!1,Fe(m)}}}function Bl(l){let e,t,n,i;return t=new _n({props:{height:"6"}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","flex pos_abs flex_cy h100 loadingInd svelte-socr2e"),H(e,"filter","invert(0)")},m(s,r){N(s,e,r),re(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ne(()=>{n||(n=Oe(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){z(t.$$.fragment,s),s&&(n||(n=Oe(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&E(e),oe(t),s&&n&&n.end()}}}function ai(l){let e,t,n,i,s=l[0]&&l[0].lead&&Rl(l);return{c(){s&&s.c(),e=Be()},m(r,o){s&&s.m(r,o),N(r,e,o),t=!0,n||(i=[ne(window,"mousedown",l[5]),ne(window,"blur",l[5])],n=!0)},p(r,[o]){r[0]&&r[0].lead?s?(s.p(r,o),o&1&&j(s,1)):(s=Rl(r),s.c(),j(s,1),s.m(e.parentNode,e)):s&&(Me(),z(s,1,1,()=>{s=null}),De())},i(r){t||(j(s),t=!0)},o(r){z(s),t=!1},d(r){s&&s.d(r),r&&E(e),n=!1,Fe(i)}}}function fi(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o,dialogMap_SetDialog:a}=r;Le(l,o,F=>t(11,s=F));let{dialog_id:f}=e,c=!1,m=!1,_=!1,d;const u=()=>!(!n||!(n!=null&&n.lead)||c||_);let g;const v=F=>{if(F!=null&&F.target){let Q=F.target;for(;Q;){if(Q===g)return;Q=Q.parentNode}}_||t(2,m=!1)},S=()=>{d&&d(),t(2,m=!1),_=!1},y=(F,Q)=>async P=>{var K,B;if(!u())return;_=!0;const Z=Q.id;if(Q.protectionModal){const q=(B=(K=r.moduleMgr)==null?void 0:K.modal)==null?void 0:B.createModal("cancel/continue",{...Q.protectionModal,position:{target:g,stick:"bottom"}});if(q&&(d=q.abort,!await q.result))return S()}if(t(1,c=!0),F){const q=await r.api.lead_SetStatus(F.lead.tg_id,Z);q&&F&&F.lead&&F.lead.tg_id===q.tg_id&&(F.lead=q,a(F))}t(1,c=!1),S()},k=F=>{var Q,P,Z,K;try{const B=r.lead_GetStatusID(F);return(r.lead_GetStatusByID(B)?(P=(Q=r==null?void 0:r.appConfig)==null?void 0:Q.lead_StatusJumpMap)==null?void 0:P[B]:(K=(Z=r==null?void 0:r.appConfig)==null?void 0:Z.lead_StatusNextListForUnkStatus)!=null?K:[]).map(r==null?void 0:r.lead_GetStatusByID).filter(Boolean)}catch{}return[]},O=F=>r.lead_GetStatusHistory(F).map((Q,P)=>({...Q,beforeDlm:P!==0})),T=(F,Q=!1)=>{const P=O(F).map((K,B)=>({...K,beforeDlm:B!==0?">":!1})),Z=Q?k(F).map((K,B)=>({...K,beforeDlm:B===0?">":!0,canSelect:!0})):[];return[...P,...Z]};je(S);const h=F=>y(n,F.detail)();function I(F){Re[F?"unshift":"push"](()=>{g=F,t(3,g)})}const M=()=>t(2,m=!0),C=()=>v(),Y=()=>t(2,m=!0);return l.$$set=F=>{"app"in F&&t(8,r=F.app),"dialog_id"in F&&t(9,f=F.dialog_id)},l.$$.update=()=>{var F;l.$$.dirty&2560&&t(0,n=s[f]),l.$$.dirty&1&&t(10,i=(F=n==null?void 0:n.lead)==null?void 0:F.status),l.$$.dirty&1&&T(n==null?void 0:n.lead),l.$$.dirty&1536&&S()},[n,c,m,g,o,v,y,T,r,f,i,s,h,I,M,C,Y]}class ci extends pe{constructor(e){super(),me(this,e,fi,ai,_e,{app:8,dialog_id:9})}}function Hl(l){var C,Y,F,Q,P,Z,K,B,q,se;let e,t,n,i,s=((F=(Y=(C=l[2])==null?void 0:C.lead)==null?void 0:Y.first_name)!=null?F:"")+"",r,o,a,f,c,m=((Z=(P=(Q=l[2])==null?void 0:Q.lead)==null?void 0:P.last_name)!=null?Z:"")+"",_,d,u,g,v,S,y,k,O,T,h,I=((B=(K=l[2])==null?void 0:K.lead)==null?void 0:B.username)&&Pl(l),M=((se=(q=l[2])==null?void 0:q.lead)==null?void 0:se.ref_link)&&Gl(l);return k=new ci({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=b("div"),t=b("div"),n=A(),i=b("div"),r=te(s),o=A(),a=b("div"),f=A(),c=b("div"),_=te(m),d=te("\xA0"),u=A(),g=b("div"),I&&I.c(),v=A(),M&&M.c(),S=A(),y=b("div"),ce(k.$$.fragment),O=A(),T=b("div"),H(t,"width","8px"),H(a,"width","8px"),w(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),w(g,"class","nowrap textOverEllipsis username svelte-qywc37"),w(y,"class","flex"),H(T,"height","4px")},m(U,x){N(U,e,x),p(e,t),p(e,n),p(e,i),p(i,r),p(e,o),p(e,a),p(e,f),p(e,c),p(c,_),p(c,d),N(U,u,x),N(U,g,x),I&&I.m(g,null),N(U,v,x),M&&M.m(U,x),N(U,S,x),N(U,y,x),re(k,y,null),N(U,O,x),N(U,T,x),h=!0},p(U,x){var ve,ye,W,G,V,we,ke,Te,Se,ge;(!h||x&4)&&s!==(s=((W=(ye=(ve=U[2])==null?void 0:ve.lead)==null?void 0:ye.first_name)!=null?W:"")+"")&&he(r,s),(!h||x&4)&&m!==(m=((we=(V=(G=U[2])==null?void 0:G.lead)==null?void 0:V.last_name)!=null?we:"")+"")&&he(_,m),(Te=(ke=U[2])==null?void 0:ke.lead)!=null&&Te.username?I?I.p(U,x):(I=Pl(U),I.c(),I.m(g,null)):I&&(I.d(1),I=null),(ge=(Se=U[2])==null?void 0:Se.lead)!=null&&ge.ref_link?M?M.p(U,x):(M=Gl(U),M.c(),M.m(S.parentNode,S)):M&&(M.d(1),M=null);const ae={};x&1&&(ae.app=U[0]),x&4&&(ae.dialog_id=U[2].id),k.$set(ae)},i(U){h||(j(k.$$.fragment,U),h=!0)},o(U){z(k.$$.fragment,U),h=!1},d(U){U&&E(e),U&&E(u),U&&E(g),I&&I.d(),U&&E(v),M&&M.d(U),U&&E(S),U&&E(y),oe(k),U&&E(O),U&&E(T)}}}function Pl(l){let e,t=l[2].lead.username+"",n;return{c(){e=te("@"),n=te(t)},m(i,s){N(i,e,s),N(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&he(n,t)},d(i){i&&E(e),i&&E(n)}}}function Gl(l){var m,_;let e,t,n,i,s=((_=(m=l[2])==null?void 0:m.lead)==null?void 0:_.ref_link)+"",r,o,a,f,c;return{c(){e=b("div"),t=b("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=A(),i=b("div"),r=te(s),o=A(),a=b("div"),w(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),w(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),w(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),H(a,"height","4px")},m(d,u){N(d,e,u),p(e,t),p(e,n),p(e,i),p(i,r),N(d,o,u),N(d,a,u),f||(c=ne(e,"click",l[6]),f=!0)},p(d,u){var g,v;u&4&&s!==(s=((v=(g=d[2])==null?void 0:g.lead)==null?void 0:v.ref_link)+"")&&he(r,s)},d(d){d&&E(e),d&&E(o),d&&E(a),f=!1,c()}}}function zl(l){let e,t,n,i;return t=new gn({}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs loading svelte-qywc37")},m(s,r){N(s,e,r),re(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ne(()=>{n||(n=Oe(e,Ie,{},!0)),n.run(1)}),i=!0)},o(s){z(t.$$.fragment,s),s&&(n||(n=Oe(e,Ie,{},!1)),n.run(0)),i=!1},d(s){s&&E(e),oe(t),s&&n&&n.end()}}}function ui(l){let e,t,n,i,s=l[2]&&Hl(l),r=l[1]&&zl();return{c(){e=b("div"),t=b("div"),s&&s.c(),n=A(),r&&r.c(),w(t,"class","flex flex_clm flex_cx flex_grow_1"),w(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,a){N(o,e,a),p(e,t),s&&s.m(t,null),p(e,n),r&&r.m(e,null),i=!0},p(o,[a]){o[2]?s?(s.p(o,a),a&4&&j(s,1)):(s=Hl(o),s.c(),j(s,1),s.m(t,null)):s&&(Me(),z(s,1,1,()=>{s=null}),De()),o[1]?r?a&2&&j(r,1):(r=zl(),r.c(),j(r,1),r.m(e,null)):r&&(Me(),z(r,1,1,()=>{r=null}),De())},i(o){i||(j(s),j(r),i=!0)},o(o){z(s),z(r),i=!1},d(o){o&&E(e),s&&s.d(),r&&r.d()}}}function di(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;Le(l,r,c=>t(5,i=c));let{dialog_id:o=null}=e,{loading:a=!1}=e;const f=()=>{var c;return qn((c=n==null?void 0:n.lead)==null?void 0:c.ref_link)};return l.$$set=c=>{"app"in c&&t(0,s=c.app),"dialog_id"in c&&t(4,o=c.dialog_id),"loading"in c&&t(1,a=c.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,a,n,r,o,i,f]}class _i extends pe{constructor(e){super(),me(this,e,di,ui,_e,{app:0,dialog_id:4,loading:1})}}function ql(l,e,t){const n=l.slice();return n[36]=e[t],n}function Ul(l,e){let t,n,i;return n=new ei({props:{app:e[0],bbox:e[9],message:e[36],render_Width:e[8]}}),{key:l,first:null,c(){t=Be(),ce(n.$$.fragment),this.first=t},m(s,r){N(s,t,r),re(n,s,r),i=!0},p(s,r){e=s;const o={};r[0]&1&&(o.app=e[0]),r[0]&512&&(o.bbox=e[9]),r[0]&4&&(o.message=e[36]),r[0]&256&&(o.render_Width=e[8]),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){z(n.$$.fragment,s),i=!1},d(s){s&&E(t),oe(n,s)}}}function mi(l){let e,t,n,i,s,r,o,a=[],f=new Map,c,m,_,d,u,g,v,S,y,k;t=new _i({props:{app:l[0],dialog_id:l[1],loading:l[3]}});let O=l[2];const T=M=>M[36].index;for(let M=0;M<O.length;M+=1){let C=ql(l,O,M),Y=T(C);f.set(Y,a[M]=Ul(Y,C))}function h(M){l[17](M)}let I={value_in:l[4]};return l[5]!==void 0&&(I.value_out=l[5]),_=new pn({props:I}),Re.push(()=>kt(_,"value_out",h)),{c(){e=b("div"),ce(t.$$.fragment),n=A(),i=b("div"),s=b("div"),r=b("div"),o=b("div");for(let M=0;M<a.length;M+=1)a[M].c();c=A(),m=b("div"),ce(_.$$.fragment),u=A(),g=b("div"),v=b("textarea"),w(o,"class","pos_rel w100 h100"),w(m,"class","pos_abs h100 chatScroll svelte-1khz9us"),w(r,"class","pos_rel w100 h100"),w(s,"class","flex pos_abs overhide"),w(i,"class","flex flex_grow_1 pos_rel overhide"),w(v,"class","flex flex_grow_1 chat_input_textarea svelte-1khz9us"),w(g,"class","flex chat_input svelte-1khz9us"),w(e,"class","flex flex_clm flex_grow_1 overhide cnt svelte-1khz9us")},m(M,C){N(M,e,C),re(t,e,null),p(e,n),p(e,i),p(i,s),p(s,r),p(r,o);for(let Y=0;Y<a.length;Y+=1)a[Y].m(o,null);l[16](o),p(r,c),p(r,m),re(_,m,null),p(e,u),p(e,g),p(g,v),Xt(v,l[7]),S=!0,y||(k=[ne(r,"wheel",l[13],{passive:!0}),at(Tt.call(null,s,l[11])),ne(v,"input",l[18]),ne(v,"keyup",l[12]),ne(v,"keydown",l[12])],y=!0)},p(M,C){const Y={};C[0]&1&&(Y.app=M[0]),C[0]&2&&(Y.dialog_id=M[1]),C[0]&8&&(Y.loading=M[3]),t.$set(Y),C[0]&773&&(O=M[2],Me(),a=Je(a,C,T,1,M,O,f,o,lt,Ul,null,ql),De());const F={};C[0]&16&&(F.value_in=M[4]),!d&&C[0]&32&&(d=!0,F.value_out=M[5],yt(()=>d=!1)),_.$set(F),C[0]&128&&Xt(v,M[7])},i(M){if(!S){j(t.$$.fragment,M);for(let C=0;C<O.length;C+=1)j(a[C]);j(_.$$.fragment,M),S=!0}},o(M){z(t.$$.fragment,M);for(let C=0;C<a.length;C+=1)z(a[C]);z(_.$$.fragment,M),S=!1},d(M){M&&E(e),oe(t);for(let C=0;C<a.length;C+=1)a[C].d();l[16](null),oe(_),y=!1,Fe(k)}}}const Wl=10,_t=4;function pi(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;Le(l,o,x=>t(15,i=x));let{dialog_id:a=null}=e,f=[],c=[],m=new Set,_=0,d=0,u=1,g=1,v=null;const S=Pe(null);Le(l,S,x=>t(9,s=x)),new Date().toJSON();let y=-1;async function k(x,ae=0,ve=20){const ye=await r.api.message_GetList({dialog_id:x,offset:ae,limit:ve});if(!!ye&&n&&n.id===x){for(_=ye.count;f.length<_;){const G=f.length;f.push({id:y--,index:G,_isFakeMsg:!0})}const W=ye.results.map(G=>{var V;return(V=G==null?void 0:G.attachments)!=null&&V.length&&G.attachments.map(we=>{var ke,Te,Se,ge,fe,D,L,R;if((Te=(ke=r==null?void 0:r.appConfig)==null?void 0:ke.api)!=null&&Te.attachments_OverwriteApiHostProtocol)try{const J=new URL(we.url);J.protocol=(fe=(ge=(Se=r==null?void 0:r.appConfig)==null?void 0:Se.api)==null?void 0:ge.protocol)!=null?fe:location.protocol,J.host=(R=(L=(D=r==null?void 0:r.appConfig)==null?void 0:D.api)==null?void 0:L.host)!=null?R:location.host,we.url=String(J)}catch{}}),G});W.map((G,V)=>G.index=ae+V),W.map(G=>f[G.index]=G)}}let O="";const T=async x=>{if(x.which===13&&!x.shiftKey&&!x.ctrlKey&&(x.preventDefault(),t(7,O=O.trim()),O)){const ae=O;t(7,O=""),n&&await r.api.message_Create(n.id,ae)}};function h(){f=[],t(2,c=[]),m=new Set,_=0,console.log("clear all")}let I=null,M=null;async function C(x){if(!x){if(!I)return;I=null,h();return}M!==x.id&&(I=x,M=x.id,h(),f=[],t(2,c=[]),_=0,t(3,d++,d),await k(x.id),_&&await k(x.id,Math.max(_-20,0),20),await r.api.dialog_SetReadFlagAllMessages(x.id),t(3,d--,d))}let Y=1,F=!0;function Q(){if(F&&requestAnimationFrame(Q),!s||!v||!f.length)return;s.width;const x=s.height,ae=s.width-Wl*2,ve=Wl;t(8,Y=ae-Math.max(120,Math.floor(ae*.1)));const ye=1+g*(f.length-1);let W=Math.floor(ye),G=ye-W;W>=f.length&&(W=f.length-1,G=1);const V=[],we=[];let ke=null;t(2,c=[]);for(let Se=W-100,ge=0,fe=!0;Se<W+100;Se++)Se<0||Se>=f.length||(f[Se]._isFakeMsg&&m.add(Se),c[ge]!==f[Se]&&(fe&&(fe=!1,c.splice(ge,1e9)),t(2,c[ge]=f[Se],c),t(2,c)),t(2,c[ge]._drawIndex=ge,c),Se<W&&V.push(c[ge]),Se>W&&we.push(c[ge]),Se===W&&(ke=c[ge]),ge++);const Te=[...v.children];if(Te.length===c.length){Te.map((L,R)=>{const J=c[R];if(!J||L._remove)return;const $=L.getBoundingClientRect();L._bbox=$;const le=Math.floor(ve+(J.incoming?0:Math.max(100,s.width*.05)));L.__cacheWidth!==Y&&(L.__cacheWidth=Y,L.style.maxWidth=Y+"px"),L.__cacheLeft!==le&&(L.__cacheLeft=le,L.style.left=le+"px")});const Se=(L,R,J=1)=>(L.__cacheTop!==R&&(L.__cacheTop=R,L.style.transform=`translate3d(0px, ${R}px, 0px)`),R+(L._bbox.height+_t)*J);let ge=0,fe=0;const D=Te[ke._drawIndex];if(D){const L=D;ge=x+_t-(L._bbox.height+_t)*G,fe=ge,ge=Se(L,ge,1)}we.map((L,R)=>{const J=Te[L._drawIndex];ge=Se(J,ge,1)}),ge=fe,V.reverse().map((L,R)=>{const J=Te[L._drawIndex];ge-=J._bbox.height+_t,Se(J,ge,0)})}}requestAnimationFrame(Q),je(()=>F=!1);async function P(){if(m.size){const x=[...m].sort((ye,W)=>ye-W);m.clear();const ae=[];let ve={offset:null,limit:0};for(const ye of x){if(ve.offset!==null){if(ve.limit<=500&&ve.offset+ve.limit===ye){ve.limit++;continue}ae.push(ve)}ve={offset:ye,limit:1}}ve.offset!==null&&ae.push(ve),n&&(t(3,d++,d),await Promise.all(ae.map(ye=>k(n.id,ye.offset,ye.limit))),t(3,d--,d))}F&&setTimeout(P,500)}P();async function Z(){n&&await r.api.dialog_SetReadFlagAllMessages(n.id),F&&setTimeout(Z,5e3)}Z();async function K(){n&&await k(n.id,_,20),F&&setTimeout(K,500)}K();const B=x=>{t(4,u=f.length?g+Math.sign(x.deltaY)/(f.length-1):0)};function q(x){Re[x?"unshift":"push"](()=>{v=x,t(6,v)})}function se(x){g=x,t(5,g)}function U(){O=this.value,t(7,O)}return l.$$set=x=>{"app"in x&&t(0,r=x.app),"dialog_id"in x&&t(1,a=x.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&32770&&t(14,n=i[a]),l.$$.dirty[0]&16384&&C(n)},[r,a,c,d,u,g,v,O,Y,s,o,S,T,B,n,i,q,se,U]}class gi extends pe{constructor(e){super(),me(this,e,pi,mi,_e,{app:0,dialog_id:1},null,[-1,-1])}}function hi(l){let e,t,n,i,s,r,o,a,f,c,m,_,d,u,g,v,S,y,k,O,T,h,I,M,C,Y,F;function Q(B){l[5](B)}let P={};l[2]!==void 0&&(P.checked=l[2]),u=new Hs({props:P}),Re.push(()=>kt(u,"checked",Q));function Z(B){l[6](B)}let K={app:l[0]};return l[1]!==void 0&&(K.filterStatus=l[1]),k=new Zs({props:K}),Re.push(()=>kt(k,"filterStatus",Z)),M=new Vs({props:{app:l[0],filter:{filterTag:Yl,filterStatus:l[1],filterUnreadFirst:l[2]}}}),Y=new gi({props:{app:l[0],dialog_id:l[3]}}),{c(){e=b("div"),t=b("div"),n=b("div"),i=A(),s=b("div"),r=b("div"),r.innerHTML=`Download report csv
				<div class="flex cursor_ptr imgCtrlBtn svelte-18tcqv1"><img class="w100 h100 svelte-18tcqv1" draggable="false" src="assets/icons/download.png"/></div>`,o=A(),a=b("div"),f=A(),c=b("label"),m=te(`First unread \r
				`),_=b("div"),d=A(),ce(u.$$.fragment),v=A(),S=b("div"),y=A(),ce(k.$$.fragment),T=A(),h=b("div"),I=A(),ce(M.$$.fragment),C=A(),ce(Y.$$.fragment),H(n,"height","2px"),w(r,"class","flex flex_cy cursor_ptr unselect downloadDialogs svelte-18tcqv1"),H(a,"height","2px"),H(_,"width","4px"),w(c,"class","flex flex_cy cursor_ptr unselect firstUnread svelte-18tcqv1"),H(S,"height","2px"),w(s,"class","flex flex_clm flex_cx header pos_rel svelte-18tcqv1"),H(h,"min-height","20px"),w(t,"class","flex flex_clm list svelte-18tcqv1"),w(e,"class","flex flex_grow_1")},m(B,q){N(B,e,q),p(e,t),p(t,n),p(t,i),p(t,s),p(s,r),p(s,o),p(s,a),p(s,f),p(s,c),p(c,m),p(c,_),p(c,d),re(u,c,null),p(s,v),p(s,S),p(s,y),re(k,s,null),p(t,T),p(t,h),p(t,I),re(M,t,null),p(e,C),re(Y,e,null),F=!0},p(B,[q]){const se={};!g&&q&4&&(g=!0,se.checked=B[2],yt(()=>g=!1)),u.$set(se);const U={};q&1&&(U.app=B[0]),!O&&q&2&&(O=!0,U.filterStatus=B[1],yt(()=>O=!1)),k.$set(U);const x={};q&1&&(x.app=B[0]),q&6&&(x.filter={filterTag:Yl,filterStatus:B[1],filterUnreadFirst:B[2]}),M.$set(x);const ae={};q&1&&(ae.app=B[0]),q&8&&(ae.dialog_id=B[3]),Y.$set(ae)},i(B){F||(j(u.$$.fragment,B),j(k.$$.fragment,B),j(M.$$.fragment,B),j(Y.$$.fragment,B),F=!0)},o(B){z(u.$$.fragment,B),z(k.$$.fragment,B),z(M.$$.fragment,B),z(Y.$$.fragment,B),F=!1},d(B){B&&E(e),oe(u),oe(k),oe(M),oe(Y)}}}let Yl=null;function vi(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;Le(l,s,c=>t(3,n=c));let r=null,o=1;function a(c){o=c,t(2,o)}function f(c){r=c,t(1,r)}return l.$$set=c=>{"app"in c&&t(0,i=c.app)},[i,r,o,n,s,a,f]}class wi extends pe{constructor(e){super(),me(this,e,vi,hi,_e,{app:0})}}function bi(l){let e,t,n,i,s,r,o,a,f,c,m,_,d,u,g,v;return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("img"),r=A(),o=b("div"),a=b("div"),a.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/rotate.png"/>',f=A(),c=b("div"),c.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/download.png"/>',m=A(),_=b("div"),_.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/close.png"/>',w(i,"class","img svelte-d45see"),w(i,"draggable","false"),Ke(i.src,s=l[0])||w(i,"src",s),H(i,"transform","rotate("+l[3]+"deg)"),w(n,"class","pos_abs flex flex_cx flex_cy pad svelte-d45see"),H(n,"width",l[5]+"px"),H(n,"height",l[4]+"px"),w(t,"class","pos_abs flex flex_cx flex_cy pos_abs w100 h100 "),H(t,"transform","translate("+l[1]+"px, "+l[2]+"px)"),w(a,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(c,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(_,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(o,"class","flex pos_abs imgCtrlBtnGroup svelte-d45see"),w(e,"class","pos_abs w100 h100 unselect cnt layer_bg svelte-d45see")},m(S,y){N(S,e,y),p(e,t),p(t,n),p(n,i),p(e,r),p(e,o),p(o,a),p(o,f),p(o,c),p(o,m),p(o,_),u=!0,g||(v=[ne(window,"mousemove",l[14]),ne(window,"mouseup",l[13]),ne(window,"blur",l[13]),ne(window,"keydown",l[16]),ne(i,"mousedown",l[12]),at(Tt.call(null,t,l[6])),ne(a,"click",l[10]),ne(c,"click",function(){Ye(Ft(l[0]))&&Ft(l[0]).apply(this,arguments)}),ne(_,"click",l[15]),ne(e,"wheel",l[11])],g=!0)},p(S,[y]){l=S,(!u||y&1&&!Ke(i.src,s=l[0]))&&w(i,"src",s),(!u||y&8)&&H(i,"transform","rotate("+l[3]+"deg)"),(!u||y&32)&&H(n,"width",l[5]+"px"),(!u||y&16)&&H(n,"height",l[4]+"px"),(!u||y&6)&&H(t,"transform","translate("+l[1]+"px, "+l[2]+"px)")},i(S){u||(Ne(()=>{d||(d=Oe(e,Ie,{duration:100},!0)),d.run(1)}),u=!0)},o(S){d||(d=Oe(e,Ie,{duration:100},!1)),d.run(0),u=!1},d(S){S&&E(e),S&&d&&d.end(),g=!1,Fe(v)}}}function yi(l,e,t){let n,i,s,r,{url:o=null}=e;const a=sn(),f=Pe(null);Le(l,f,C=>t(18,n=C));const c=qe(0);Le(l,c,C=>t(3,i=C));const m=qe(0);Le(l,m,C=>t(5,r=C));const _=qe(0);Le(l,_,C=>t(4,s=C));let d=0,u=0,g={rotate:0,scale:1,whInverse:!1};const v=()=>{if(!n||!g)return;const C=g.whInverse?n.height:n.width,Y=g.whInverse?n.width:n.height;Ve(m,r=C*g.scale,r),Ve(_,s=Y*g.scale,s),Ve(c,i=g.rotate,i)},S=()=>{!n||!g||(t(17,g.rotate+=90,g),t(17,g.whInverse=!g.whInverse,g),t(17,g))},y=C=>{t(17,g.scale=xe(.1,g.scale+Math.sign(C.deltaY)*.1,10),g)};let k=null;const O=C=>k=[C.clientX,C.clientY,d,u],T=C=>k=null,h=C=>{!k||t(1,[d,u]=[C.clientX,C.clientY].map((Y,F)=>Y-k[F]+k[F+2]),d,t(2,u))},I=C=>a("close"),M=C=>C.which===27&&I();return l.$$set=C=>{"url"in C&&t(0,o=C.url)},l.$$.update=()=>{l.$$.dirty&393216&&v()},[o,d,u,i,s,r,f,c,m,_,S,y,O,T,h,I,M,g,n]}class ki extends pe{constructor(e){super(),me(this,e,yi,bi,_e,{url:0})}}function Jl(l){let e=l[0],t,n,i=Vl(l);return{c(){i.c(),t=Be()},m(s,r){i.m(s,r),N(s,t,r),n=!0},p(s,r){r&1&&_e(e,e=s[0])?(Me(),z(i,1,1,ie),De(),i=Vl(s),i.c(),j(i,1),i.m(t.parentNode,t)):i.p(s,r)},i(s){n||(j(i),n=!0)},o(s){z(i),n=!1},d(s){s&&E(t),i.d(s)}}}function Vl(l){let e,t;return e=new ki({props:{url:l[1]}}),e.$on("close",l[3]),{c(){ce(e.$$.fragment)},m(n,i){re(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.url=n[1]),e.$set(s)},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Si(l){let e,t,n=l[1]&&Jl(l);return{c(){n&&n.c(),e=Be()},m(i,s){n&&n.m(i,s),N(i,e,s),t=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&j(n,1)):(n=Jl(i),n.c(),j(n,1),n.m(e.parentNode,e)):n&&(Me(),z(n,1,1,()=>{n=null}),De())},i(i){t||(j(n),t=!0)},o(i){z(n),t=!1},d(i){n&&n.d(i),i&&E(e)}}}function Li(l,e,t){let n=1,i=null,{events:s}=e;je(s.on("openOverlayImageView",o=>{t(0,n++,n),t(1,i=o)}));const r=()=>t(1,i=null);return l.$$set=o=>{"events"in o&&t(2,s=o.events)},[n,i,s,r]}class Mi extends pe{constructor(e){super(),me(this,e,Li,Si,_e,{events:2})}}function Di(l){let e,t,n,i,s,r,o,a,f,c,m,_=Oi;return i=new Cs({props:{app:l[0]}}),r=new Fs({props:{app:l[0]}}),a=new wi({props:{app:l[0]}}),c=new Mi({props:{events:l[0].events}}),{c(){e=b("div"),t=A(),n=b("div"),ce(i.$$.fragment),s=A(),ce(r.$$.fragment),o=A(),ce(a.$$.fragment),f=A(),ce(c.$$.fragment),w(n,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),w(e,"class","flex w100 h100 pos_rel")},m(d,u){N(d,e,u),p(e,t),p(e,n),re(i,n,null),p(n,s),re(r,n,null),p(e,o),re(a,e,null),p(e,f),re(c,e,null),m=!0},p(d,[u]){},i(d){m||(j(_),j(i.$$.fragment,d),j(r.$$.fragment,d),j(a.$$.fragment,d),j(c.$$.fragment,d),m=!0)},o(d){z(_),z(i.$$.fragment,d),z(r.$$.fragment,d),z(a.$$.fragment,d),z(c.$$.fragment,d),m=!1},d(d){d&&E(e),oe(i),oe(r),oe(a),oe(c)}}}const Oi=!1;function Ti(l,e,t){let{operatorSelf:n}=e,{config:i}=e,{notifyEvents:s}=e,{moduleMgr:r}=e,{createApi:o}=e;const a=o(n.username),f=Kn(n,i,a,r);return je(f.destroy),l.$$set=c=>{"operatorSelf"in c&&t(1,n=c.operatorSelf),"config"in c&&t(2,i=c.config),"notifyEvents"in c&&t(3,s=c.notifyEvents),"moduleMgr"in c&&t(4,r=c.moduleMgr),"createApi"in c&&t(5,o=c.createApi)},[f,n,i,s,r,o]}class Ii extends pe{constructor(e){super(),me(this,e,Ti,Di,_e,{operatorSelf:1,config:2,notifyEvents:3,moduleMgr:4,createApi:5})}}function Kl(l,e,t){const n=l.slice();return n[6]=e[t],n}function Ci(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=Zl(Kl(l,n,r));const s=r=>z(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Be()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);N(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let a;for(a=0;a<n.length;a+=1){const f=Kl(r,n,a);i[a]?(i[a].p(f,o),j(i[a],1)):(i[a]=Zl(f),i[a].c(),j(i[a],1),i[a].m(e.parentNode,e))}for(Me(),a=n.length;a<i.length;a+=1)s(a);De()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)j(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)z(i[o]);t=!1},d(r){Gt(i,r),r&&E(e)}}}function Ai(l){let e,t,n,i,s;return i=new gn({}),{c(){e=b("div"),t=b("div"),n=A(),ce(i.$$.fragment),H(t,"height","20px"),w(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){N(r,e,o),p(e,t),p(e,n),re(i,e,null),s=!0},p:ie,i(r){s||(j(i.$$.fragment,r),s=!0)},o(r){z(i.$$.fragment,r),s=!1},d(r){r&&E(e),oe(i)}}}function Xl(l){let e,t,n=l[6].username+"",i;return{c(){e=b("div"),t=te("@"),i=te(n),w(e,"class","nowrap textOverEllipsis")},m(s,r){N(s,e,r),p(e,t),p(e,i)},p(s,r){r&1&&n!==(n=s[6].username+"")&&he(i,n)},d(s){s&&E(e)}}}function Zl(l){var k,O;let e,t,n,i=((k=l[6].first_name)!=null?k:"")+"",s,r,o,a,f,c=((O=l[6].last_name)!=null?O:"")+"",m,_,d,u,g,v,S,y=l[6].username&&Xl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),s=te(i),r=A(),o=b("div"),a=A(),f=b("div"),m=te(c),_=A(),y&&y.c(),d=A(),H(o,"width","8px"),w(t,"class","flex nowrap textOverEllipsis"),w(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(T,h){N(T,e,h),p(e,t),p(t,n),p(n,s),p(t,r),p(t,o),p(t,a),p(t,f),p(f,m),p(e,_),y&&y.m(e,null),p(e,d),g=!0,v||(S=ne(e,"click",function(){Ye(l[2](l[6]))&&l[2](l[6]).apply(this,arguments)}),v=!0)},p(T,h){var I,M;l=T,(!g||h&1)&&i!==(i=((I=l[6].first_name)!=null?I:"")+"")&&he(s,i),(!g||h&1)&&c!==(c=((M=l[6].last_name)!=null?M:"")+"")&&he(m,c),l[6].username?y?y.p(l,h):(y=Xl(l),y.c(),y.m(e,d)):y&&(y.d(1),y=null)},i(T){g||(T&&Ne(()=>{u||(u=Oe(e,Ie,{},!0)),u.run(1)}),g=!0)},o(T){T&&(u||(u=Oe(e,Ie,{},!1)),u.run(0)),g=!1},d(T){T&&E(e),y&&y.d(),T&&u&&u.end(),v=!1,S()}}}function xi(l){let e,t,n,i;const s=[Ai,Ci],r=[];function o(a,f){return a[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=b("div"),n.c(),w(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){N(a,e,f),r[t].m(e,null),i=!0},p(a,[f]){let c=t;t=o(a),t===c?r[t].p(a,f):(Me(),z(r[c],1,1,()=>{r[c]=null}),De(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),j(n,1),n.m(e,null))},i(a){i||(j(n),i=!0)},o(a){z(n),i=!1},d(a){a&&E(e),r[t].d()}}}function Ei(l,e,t){let{api:n}=e,i=[],s=!1;const r=async()=>{var f,c;t(1,s=!0),t(0,i=(c=(f=await n.operator_GetList())==null?void 0:f.results)!=null?c:[]),t(1,s=!1)};let o=!1;const a=f=>c=>{o||(dn(f),o=!0)};return r(),l.$$set=f=>{"api"in f&&t(3,n=f.api)},[i,s,a,n]}class ji extends pe{constructor(e){super(),me(this,e,Ei,xi,_e,{api:3})}}const Ni=l=>typeof l=="number"&&String(l|0)===String(l);class hn extends Error{}const Ge=async(l,e=null)=>{try{return await l()}catch{}return e},Wt=l=>async e=>{if(await Ge(()=>e.response.status===l))return e;throw new Error(`Invalid response status, expected ${l}`)},Fi=Wt(200),Ri=Wt(201),Bi=Wt(204),Hi=async l=>{if(await Ge(()=>Ni(l.result.count)&&Array.isArray(l.result.results)))return l;throw new Error("Invalid result, expected list container")},mt=async l=>{if(await Ge(()=>l.result.detail==="Authentication credentials were not provided.")===!0)throw new hn("Not authorized");return l},pt=async l=>({...l,result:l.response.status===204?null:await l.response.json()}),Pi=(l,e)=>{var a,f,c;const t=(a=l==null?void 0:l.protocol)!=null?a:location.protocol,n=(f=l==null?void 0:l.host)!=null?f:location.host,i=(c=l==null?void 0:l.path_base)!=null?c:"/",s=`${t}//${n}/${i}`,r=new Set(["POST","PATCH","PUT"]),o={...e!=null?e:{},"content-type":"application/json"};return(m,_,d)=>{const u=m.toUpperCase().trim(),g=_!=null?_:"",v=d!=null?d:{},S=new URL(s);u==="GET"&&Object.entries(v).map(([k,O])=>S.searchParams.append(k,O)),S.pathname=[S.pathname,g].join("/").split("/").filter(Boolean).concat(" ").filter(Boolean).join("/").trim();const y=r.has(u)?JSON.stringify(v):null;return new Request(S,{method:u,headers:o,body:y})}},Gi=(l,e,t)=>{var v,S,y,k;const n=Pi(l,e.operator?{"x-username":e.operator}:{}),i=(v=e.onerror)!=null?v:$e,s=(S=e.onnotify)!=null?S:$e,r=(y=e.ontimestat)!=null?y:$e,o=(k=e.onNotAuthorizedError)!=null?k:$e,a=t!=null?t:(O,T)=>T(),f=async([O,T,h],I)=>{const M=Qt();let C=null,Y=null,F={},Q=null,P=!1;try{F.request=C=n(O,T,h),F.response=Y=await a({request:C,method:O,path:T,options:h},()=>fetch(C));for(const q of I)F=await q(F)}catch(q){Q=q,P=!0}const K=Qt()-M;await Ge(()=>{Q instanceof hn&&o()});const B=[];return B.push(...await Ge(async()=>{const q=new URL(C.url);return[{type:"normal",chunks:[{color:"#fff",text:C.method},{color:"#000",text:`${q.pathname}${String(q.searchParams)?"?"+q.searchParams:""}`},{color:"#f00",text:await Ge(()=>Y.status,"")}]},{type:"mini",text:`${q.protocol}//${q.host}`},{type:"mini",text:`Time: ${K.toFixed(2)}ms`}]},[`${O} ${T}`])),B.push(await Ge(()=>C.body?"Body: "+JSON.stringify(h).slice(0,100):"")),B.push(await Ge(()=>F.result.detail?`Detail: ${F.result.detail}`:"")),B.push(Yn(Q)),P?i(B):s(B),r({method:O,path:T},K),!P&&F.hasOwnProperty("result")?F.result:null},c=[pt,mt],m=[pt,mt,Ri],_=[pt,mt,Fi],d=[pt,mt,Bi],u=[..._,Hi],g={};return g.message_GetList=O=>f(["GET","messages",O],u),g.message_Create=(O,T)=>f(["POST","messages",{dialog:O,text:T,is_read:!0}],m),g.dialog_GetList=O=>f(["GET","dialogs",O],u),g.dialog_SetTags=(O,T)=>f(["PATCH",`dialogs/${O}`,{tag:T}],_),g.dialog_SetReadFlagAllMessages=O=>f(["POST",`dialogs/${O}/read`,{}],d),g.lead_GetUnassignedList=O=>f(["GET","leads/unassigned",O],u),g.lead_AssignOperatorSelft=O=>f(["POST",`leads/${O}/assign`,{}],_),g.lead_SetStatus=(O,T)=>f(["PATCH",`leads/${O}`,{status:T}],_),g.lead_GetUnassignedLeadCount=()=>f(["GET","leads/count_free",{}],_),g.lead_AssignOneLead=()=>f(["POST","leads/get_one",{}],[...c,async O=>await Ge(()=>{var T;return O.result=(T={200:!0,400:!1}[O.response.status])!=null?T:null,O})]),g.operatorSelf_GetOnlineInfo=()=>f(["GET","online",{}],_),g.operatorSelf_SetOnlineFlag=O=>f(["PUT","online",{online:!!O}],_),g.operator_GetList=O=>f(["GET","operators",O],u),g},zi=()=>{const l=()=>!0,e=D=>new Promise(L=>setTimeout(L,D)),t=(D,L)=>e(D+Math.round(Math.random()*(L-D))),n=(D,L,R)=>Math.min(R,Math.max(D,L)),i=(D=0)=>new Date(Date.now()+(D!=null?D:0)).toJSON(),s=(D,L)=>{var ee;const R=Math.max(0,(L==null?void 0:L.offset)|0),J=n(1,((ee=L==null?void 0:L.limit)!=null?ee:20)|0,1e6),$=D.length,le=D.slice(R,R+J);return{count:$,results:le}};let r=1;const o=D=>(D!=null?D:[]).map(L=>({...L,id:r++}));let a=1;const f=[],c={},m=D=>{var L;return(L=c[D])!=null?L:null},_=()=>f,d=D=>{var R,J,$;const L={operator_id:a++,username:(R=D.username)!=null?R:null,first_name:(J=D.first_name)!=null?J:null,last_name:($=D.last_name)!=null?$:null};return f.push(L),c[L.username]=L,G(L.username),L};let u=123123124;const g=[],v={},S=D=>{var L;return(L=v[D])!=null?L:null},y=()=>g.filter(D=>!D.hasOperator).sort((D,L)=>D._date_joined_msec-L._date_joined_msec),k=()=>({count:g.filter(D=>!D.hasOperator).length}),O=D=>{var J,$,le;const L=u++,R={tg_id:L,username:(J=D.username)!=null?J:null,first_name:($=D.first_name)!=null?$:null,last_name:(le=D.last_name)!=null?le:null,date_joined:i(D.timeDelta),esub:null,pub_id:null,refcode:null,subpub:null,hasOperator:!1,status:"NW",is_fail:!1,ref_link:`https://ref.global.com/getRef?tg_id=${L}`};return R._date_joined_msec=+new Date(R.date_joined),g.push(R),v[R.tg_id]=R,R},T=(D,L)=>{const R=S(L);return!R||!m(D)||R.hasOperator?!1:(P(D,L),R.hasOperator=!0,R.status="IW",!0)},h=D=>{const L=y();let R=!1;return L.length&&(R=T(D,L[0].tg_id)),R?{status:"lead connected",__status:200}:{status:"error: there is no free leads",__status:400}},I=(D,L,R)=>{const J=S(L);return J?(R.status&&(R.status==="FL"?J.is_fail=!0:J.status=R.status),J):null};let M=1;const C=[],Y={},F=D=>{var L;return(L=Y[D])!=null?L:null},Q=(D,L=[])=>{D.tag||(D.tag=[],D._tagSearch=new Set);const R=o(L);D.tag.splice(0,1e9),D._tagSearch.clear(),R.map(J=>{D.tag.push(J),D._tagSearch.add(J.title)})},P=(D,L)=>{const R=S(L);if(!R||!m(D))return null;const $={id:M++,lead_id:L,lead:R,operator:D,unread_messages_count:0,last_message:null};return Q($),C.push($),Y[$.id]=$,R.hasOperator=!0,$},Z=(D,L,R)=>{const J=F(L);return J?(R.tag&&Q(J,R.tag),J):null},K=(D,L,R)=>{const J=F(L);return J?(ae(D,{dialog_id:+L}).map(le=>le.is_read=!1),J.unread_messages_count=0,!0):null},B=(D,L={})=>{const R=ue=>ue.last_message?ue.last_message._received_at_msec:ue.lead?ue.lead._date_joined_msec:0,J=(ue,Ce)=>Ce-ue,$=(ue,Ce)=>{let Ae=J(R(ue),R(Ce));return Ae===0&&(Ae=J(ue.id,Ce.id)),Ae},le=L.status?new Set(L.status.split(",")):null,ee=C.filter(ue=>ue.operator===D).filter(L.tag?ue=>ue._tagSearch.has(L.tag):l).filter(le?ue=>le.has(ue.lead.status):l).filter(ue=>{var Ce;return((Ce=ue==null?void 0:ue.lead)==null?void 0:Ce.status)!=="DL"});let de=[],be=[];return L.unread_first?(de=ee.filter(ue=>ue.unread_messages_count!==0),be=ee.filter(ue=>ue.unread_messages_count===0)):de=ee,de.sort($),be.sort($),de.concat(be)};let q=1;const se=[],U={},x=(D,L={})=>{var ee,de,be;const R=+L.dialog,J=L.text,$=F(R);if(!$)return null;const le={id:q++,dialog:R,text:J,is_read:(ee=L.is_read)!=null?ee:!0,incoming:(de=L.incoming)!=null?de:!1,attachments:(be=L.attachments)!=null?be:[],received_at:i(L.timeDelta)};return le._received_at_msec=+new Date(le.received_at),se.push(le),U[le.id]=le,$.last_message=le,le.is_read||$.unread_messages_count++,le},ae=(D,L={})=>se.filter(L.dialog_id?R=>R.dialog===L.dialog_id:l),ve=5*60*1e3,ye={},W=D=>{var L;return(L=ye[D])!=null?L:null},G=(D,L={})=>{const J={online:!!L.online,offline_at:i(ve),interval:Math.round(ve/1e3)};return ye[D]=J,J},V=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.webp","9.webp","10.png","11.png","13.png","12.webp"],we=`\u0414\u0430, \u043C\u0451\u0440\u0442\u0432.
\u0411\u0435\u0434\u0441\u0442\u0432\u0438\u0435, \u0443\u0433\u0440\u043E\u0436\u0430\u044E\u0449\u0435\u0435 \u0436\u0438\u0437\u043D\u0438 \u0434\u0435\u0432\u0443\u0448\u043A\u0438, \u0438\u0441\u0447\u0435\u0437\u043B\u043E, \u0441\u043B\u043E\u0432\u043D\u043E \u044D\u0442\u043E \u0431\u044B\u043B\u0430 \u043A\u0430\u043A\u0430\u044F-\u0442\u043E \u0448\u0443\u0442\u043A\u0430. \u041D\u043E \u043E\u043D\u0430 \u043D\u0435 \u043C\u043E\u0433\u043B\u0430 \u0440\u0430\u0434\u043E\u0432\u0430\u0442\u044C\u0441\u044F, \u0432\u0435\u0434\u044C \u0421\u043C\u0435\u0440\u0442\u044C \u0441\u043C\u0435\u043D\u0438\u043B\u0430 \u0441\u0432\u043E\u044E \u0444\u043E\u0440\u043C\u0443 \u0438 \u043F\u0440\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432 \u0431\u043E\u043B\u0435\u0435 \u044F\u0432\u043D\u043E\u043C \u0432\u0438\u0434\u0435.
\u041F\u043E\u0434 \u0432\u0437\u0433\u043B\u044F\u0434\u043E\u043C \u043D\u0430\u043F\u0443\u0433\u0430\u043D\u043D\u043E\u0439 \u0434\u0435\u0432\u0443\u0448\u043A\u0438 \u0421\u043C\u0435\u0440\u0442\u044C \u0434\u0432\u0438\u043D\u0443\u043B\u0430\u0441\u044C \u0432 \u0435\u0451 \u0441\u0442\u043E\u0440\u043E\u043D\u0443. \u0422\u044C\u043C\u0430 \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439 \u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0433\u0443\u0449\u0430\u0442\u044C\u0441\u044F.
\u0422\u044C\u043C\u0430... \u043E\u043D\u0430 \u0441\u0435\u0439\u0447\u0430\u0441 \u043C\u0435\u043D\u044F \u043F\u0440\u043E\u0433\u043B\u043E\u0442\u0438\u0442, \u2014 \u043F\u043E\u0434\u0443\u043C\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430 \u0438 \u0435\u0449\u0451 \u043A\u0440\u0435\u043F\u0447\u0435 \u043E\u0431\u043D\u044F\u043B\u0430 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443. \u041E\u043D\u0430 \u0443\u0436\u0435 \u0434\u0430\u0436\u0435 \u0438 \u043D\u0435 \u0434\u0443\u043C\u0430\u043B\u0430 \u0431\u0435\u0436\u0430\u0442\u044C. \u0411\u0443\u0434\u044C \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u043E\u043C, \u043E\u043D\u0430 \u0431\u044B \u0435\u0449\u0435 \u043C\u043E\u0433\u043B\u0430 \u043D\u0430 \u0447\u0442\u043E-\u0442\u043E \u043D\u0430\u0434\u0435\u044F\u0442\u044C\u0441\u044F. \u041D\u043E \u043D\u0435\u0447\u0442\u043E, \u0432\u043E\u0437\u0432\u044B\u0448\u0430\u044E\u0449\u0435\u0435\u0441\u044F \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439, \u0441 \u043B\u0435\u0433\u043A\u043E\u0441\u0442\u044C\u044E \u0440\u0430\u0437\u0432\u0435\u044F\u043B\u043E \u0442\u0430\u043A\u0438\u0435 \u043C\u044B\u0441\u043B\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0445\u043E\u0442\u044F \u0431\u044B \u0434\u0430\u0440\u0443\u0439 \u043C\u043D\u0435 \u0431\u0435\u0437\u0431\u043E\u043B\u0435\u0437\u043D\u0435\u043D\u043D\u0443\u044E \u0441\u043C\u0435\u0440\u0442\u044C.
\u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u043C\u043E\u043B\u0438\u0442\u044C\u0441\u044F.
\u041C\u0430\u043B\u044B\u0448\u043A\u0430 \u0443\u0446\u0435\u043F\u0438\u043B\u0430\u0441\u044C \u0437\u0430 \u0435\u0451 \u0442\u0430\u043B\u0438\u044E, \u0434\u0440\u043E\u0436\u0430 \u043E\u0442 \u0443\u0436\u0430\u0441\u0430. \u0421\u043F\u0430\u0441\u0442\u0438 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443... \u043D\u043E \u044D\u0442\u043E \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E. \u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u0438\u0437\u0432\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u0437\u0430 \u0441\u0432\u043E\u0451 \u0431\u0435\u0441\u0441\u0438\u043B\u0438\u0435. \u0421\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0430, \u0442\u044B \u043D\u0435 \u0431\u0443\u0434\u0435\u0448\u044C \u043E\u0434\u0438\u043D\u043E\u043A\u0430, \u044F \u043F\u043E\u0439\u0434\u0443 \u0441 \u0442\u043E\u0431\u043E\u0439.
\u0418 \u0442\u043E\u0433\u0434\u0430...`;let ke=1;const Te=(D=null,L=null)=>(D=D!=null?D:Math.random()*V.length|0,L=L!=null?L:L=["IM","DC"][Math.random()*2|0],{file:ke++,file_type:L,url:`assets/img-test/${V[D]}`});(async()=>{const D=($,le)=>{const ee=le/$;let de=-(le+ee);return()=>(de+=ee,de)};let L=1;const R=($=0)=>{let le=Math.random()<.5,ee=Math.random()<.5,de=Math.random()<.5;!le&&!ee&&!de&&(le=!0),le=ee=de=!0;const be=(L++).toString(36);return O({username:le?`test_lead_${be}`:null,first_name:ee?`F${be}`:null,last_name:de?`L${be}`:null,timeDelta:$})},J=($,le,ee=0)=>{x($,{dialog:le,text:`\u041F\u0440\u0438\u0432\u0435\u0442 @${$}. \u042F \u043D\u043E\u0432\u044B\u0439 \u043B\u0438\u0434, \u0432\u043E\u0442.`,is_read:!1,incoming:!0,timeDelta:ee});for(let de=0;de<Math.round(Math.random()*V.length);de++){const be=Te(de);x($,{dialog:le,text:`${be.file_type==="IM"?"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430":"\u0424\u0430\u0439\u043B"} ${de+1}.`,is_read:!1,incoming:!0,attachments:[be],timeDelta:ee+de*1e3})}};for(let $=0;$<10;$++){const ee=[10,100,1e3,5e3,7e3,1e4,1e4,1e5,2,3,5,7,8,10][$],de=`op_test_${$}`;d({username:de,first_name:"OpNumDlgs",last_name:ee+""});let be=0;const ue=D(ee,6e4*ee);for(let Ce=0;Ce<ee;Ce++){const Ae=ue(),Ze=R(Ae),Ue=P(de,Ze.tg_id);Math.random()<.5&&be++<5&&J(de,Ue.id,Ae)}}for(;;)await t(1e3,1e4),R()})();const ge=(D,L,R)=>{const J=ee=>{ee&&G(R)},$=async ee=>{await t(1e3,1e4);const de=L.text.match(/without_text/i),be=L.text.match(/long_text/i),ue=L.text.match(/allimg|allfile/i),Ce=de?"":be?we:`\u042D\u0445\u043E \u043E\u0442\u0432\u0435\u0442 \u0434\u043B\u044F @${R}.
"${L.text}"`;if(ue){const Ze=L.text.match(/allimg/i)?"IM":"DC";for(let Ue=0;Ue<V.length;Ue++)x(R,{dialog:L.dialog,text:Ce,is_read:!1,incoming:!0,attachments:[Te(Ue,Ze)]});return}const Ae=[];L.text.match(/img/i)?Ae.push(Te(null,"IM")):L.text.match(/file/i)&&Ae.push(Te(null,"DC")),x(R,{dialog:L.dialog,text:Ce,is_read:!1,incoming:!0,attachments:Ae})},le=ee=>{var de;return(de=ee==null?void 0:ee.__status)!=null?de:200};D("GET","operators",200,()=>s(_(),L)),D("GET","online",200,()=>W(R)),D("PUT","online",200,()=>G(R,L)),D("GET","leads/unassigned",200,()=>s(y(),L)),D("GET","leads/count_free",200,()=>k()),D("POST","leads/get_one",le,()=>h(R)),D("POST",/^leads\/(\d+)\/assign$/,200,ee=>T(R,ee),[J]),D("PATCH",/^leads\/(\d+)$/,200,ee=>I(R,ee,L),[J]),D("GET","dialogs",200,()=>s(B(R,L),L)),D("POST",/^dialogs\/(\d+)\/read$/,204,ee=>K(R,ee)),D("PATCH",/^dialogs\/(\d+)$/,200,ee=>Z(R,ee,L),[J]),D("GET","messages",200,()=>s(ae(R,L),L)),D("POST","messages",201,()=>x(R,L),[J,$])},fe=D=>{var Ae,Ze,Ue,Yt,Jt;const L=((Ae=D==null?void 0:D.method)!=null?Ae:"").toUpperCase().trim(),R=((Ze=D==null?void 0:D.path)!=null?Ze:"").split("/").map(Ee=>Ee.trim()).filter(Boolean).join("/"),J=Object.fromEntries(Object.entries((Ue=D==null?void 0:D.headers)!=null?Ue:{}).map(Ee=>[Ee[0].toLowerCase(),Ee[1]])),$=(Yt=D==null?void 0:D.options)!=null?Yt:{},le=(Jt=J["x-username"])!=null?Jt:null,ee=[];ge((Ee,ft,vn,wn,bn=[])=>ee.push({method:Ee,pathPattern:ft,cb:wn,status:vn,mwList:bn}),$,le);const be=ee.map(Ee=>{if(Ee.method===L){if(Ee.pathPattern instanceof RegExp){const ft=R.match(Ee.pathPattern);return ft?{...Ee,args:ft.slice(1)}:!1}return Ee.pathPattern===R?{...Ee,args:[]}:!1}}).filter(Boolean)[0];if(!be)return null;const ue=be.cb(...be.args);return be.mwList&&be.mwList.map(Ee=>Ee(ue,le,$)),{status:typeof be.status=="function"?be.status(ue):be.status,result:ue}};try{self.addEventListener("message",({data:{rpcID:D,data:L}})=>{let R,J;try{R=fe(L)}catch($){J=$.message}self.postMessage({rpcID:D,result:R,error:J})})}catch{}return{request:fe}},qi=()=>{const l=`( ${zi.toString()} )()`,e=new Blob([l],{type:"text/javascript"}),t=new Worker(window.URL.createObjectURL(e));let n=1;const i={};return t.addEventListener("message",({data:{rpcID:o,result:a,error:f}})=>{const c=i[o];delete i[o],f&&c.reject(new Error(f)),c.resolve(a)}),{request:o=>{const a=n++,f=i[a]=Ot();return t.postMessage({rpcID:a,data:o}),f.promise},destroy:()=>t.terminate()}};function Ui(l){let e,t,n,i,s;return t=new Ii({props:{operatorSelf:l[0],config:l[3],notifyEvents:l[1],moduleMgr:l[2],createApi:l[4]}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_rel flex")},m(r,o){N(r,e,o),re(t,e,null),n=!0,i||(s=at(Tt.call(null,e)),i=!0)},p(r,o){const a={};o&1&&(a.operatorSelf=r[0]),t.$set(a)},i(r){n||(j(t.$$.fragment,r),n=!0)},o(r){z(t.$$.fragment,r),n=!1},d(r){r&&E(e),oe(t),i=!1,s()}}}function Wi(l){let e,t,n,i,s;return e=new Qn({props:{select:"operators"}}),i=new ji({props:{api:l[5]}}),{c(){ce(e.$$.fragment),t=A(),n=b("div"),ce(i.$$.fragment),w(n,"class","flex")},m(r,o){re(e,r,o),N(r,t,o),N(r,n,o),re(i,n,null),s=!0},p:ie,i(r){s||(j(e.$$.fragment,r),j(i.$$.fragment,r),s=!0)},o(r){z(e.$$.fragment,r),z(i.$$.fragment,r),s=!1},d(r){oe(e,r),r&&E(t),r&&E(n),oe(i)}}}function Yi(l){let e,t,n,i,s,r,o,a,f,c;const m=[Wi,Ui],_=[];function d(u,g){return u[0]?1:0}return t=d(l),n=_[t]=m[t](l),s=new ms({props:{modules:l[2]}}),o=new bs({}),f=new is({props:{events:l[1]}}),{c(){e=b("main"),n.c(),i=A(),ce(s.$$.fragment),r=A(),ce(o.$$.fragment),a=A(),ce(f.$$.fragment),w(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-l8w6xt")},m(u,g){N(u,e,g),_[t].m(e,null),p(e,i),re(s,e,null),p(e,r),re(o,e,null),p(e,a),re(f,e,null),c=!0},p(u,[g]){let v=t;t=d(u),t===v?_[t].p(u,g):(Me(),z(_[v],1,1,()=>{_[v]=null}),De(),n=_[t],n?n.p(u,g):(n=_[t]=m[t](u),n.c()),j(n,1),n.m(e,i))},i(u){c||(j(n),j(s.$$.fragment,u),j(o.$$.fragment,u),j(f.$$.fragment,u),c=!0)},o(u){z(n),z(s.$$.fragment,u),z(o.$$.fragment,u),z(f.$$.fragment,u),c=!1},d(u){u&&E(e),_[t].d(),oe(s),oe(o),oe(f)}}}function Ji(l,e,t){let n;Le(l,Lt,m=>t(0,n=m));const i=Ut(),s=Wn(),r=()=>{const m=window==null?void 0:window.g_Config;m||alert(`Fatal error
Config not found`);const _=m!=null?m:{};return[...vt()].map(([u,g])=>{var S;const v=u.match(/^overwrite\-config\-([^]*)$/);if(v){try{g=JSON.parse(g)}catch(O){console.log("Invalid k value error: "+O.message);return}const y=v[1].split(".");let k=_;for(;y.length>=2;){const O=y.shift();k=k[O]=(S=k[O])!=null?S:{}}y.length===1&&(k[y[0]]=g)}}),_},o=m=>{var g,v;const _=((g=m.testMode)!=null?g:!0)&&!vt().has("real-api");let d=()=>null,u=m.api;if(_){const[S,y]=((v=vt().get("ping"))!=null?v:"").split(",").concat(200,300).filter(Boolean).map(O=>xe(0,O|0,6e4)).slice(0,2).sort((O,T)=>O-T);console.log({pingMin:S,pingMax:y});const k=qi();je(k.destroy),u={protocol:"https:",host:"test.mode.dev",path_base:"api/"},d=()=>async({method:O,path:T,options:h,request:I})=>{await tt(S+(y-S)*Math.random()|0);const M=Object.fromEntries([...I.headers]),{status:C,result:Y}=await k.request({method:O,path:T,options:h,headers:M});return{status:C,json:()=>Y}}}return(S=null)=>Gi(u,{onerror:y=>i.emit("error",y),onnotify:y=>i.emit("debug",y),onNotAuthorizedError:()=>Ve(Lt,n=null,n),ontimestat:(y,k)=>Rn(`${y.method} ${y.path}`,k),operator:S},d())},a=r(),f=o(a),c=f();return[n,i,s,a,f,c]}class Vi extends pe{constructor(e){super(),me(this,e,Ji,Yi,_e,{})}}new Vi({target:document.getElementById("app")});
