(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function z(){}const St=n=>n;function Tt(n){return n()}function et(){return Object.create(null)}function pe(n){n.forEach(Tt)}function Le(n){return typeof n=="function"}function ie(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Bt(n){return Object.keys(n).length===0}function Pt(n,...e){if(n==null)return z;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Me(n,e,t){n.$$.on_destroy.push(Pt(e,t))}function Ce(n){return n&&Le(n.destroy)?n.destroy:z}const Et=typeof window<"u";let Ct=Et?()=>window.performance.now():()=>Date.now(),Ue=Et?n=>requestAnimationFrame(n):z;const ke=new Set;function Ot(n){ke.forEach(e=>{e.c(n)||(ke.delete(e),e.f())}),ke.size!==0&&Ue(Ot)}function Ft(n){let e;return ke.size===0&&Ue(Ot),{promise:new Promise(t=>{ke.add(e={c:n,f:t})}),abort(){ke.delete(e)}}}function g(n,e){n.appendChild(e)}function Yt(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Rt(n,e){return g(n.head||n,e),e.sheet}function I(n,e,t){n.insertBefore(e,t||null)}function D(n){n.parentNode.removeChild(n)}function Wt(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function y(n){return document.createElement(n)}function H(n){return document.createTextNode(n)}function A(){return H(" ")}function Je(){return H("")}function Q(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function O(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Gt(n){return Array.from(n.childNodes)}function X(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function tt(n,e){n.value=e==null?"":e}function W(n,e,t,l){t===null?n.style.removeProperty(e):n.style.setProperty(e,t,l?"important":"")}function J(n,e,t){n.classList[t?"add":"remove"](e)}function qt(n,e,{bubbles:t=!1,cancelable:l=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(n,t,l,e),s}const Be=new Map;let Pe=0;function zt(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Ut(n){const e={style_element:y("style"),rules:{}};return Be.set(n,e),e}function nt(n,e,t,l,s,r,i,o=0){const a=16.666/l;let f=`{
`;for(let u=0;u<=1;u+=a){const m=e+(t-e)*r(u);f+=u*100+`%{${i(m,1-m)}}
`}const h=f+`100% {${i(t,1-t)}}
}`,v=`__svelte_${zt(h)}_${o}`,p=Yt(n),{style_element:c,rules:d}=Be.get(p)||Ut(p);if(!d[v]){const u=Rt(p,c);d[v]=!0,u.insertRule(`@keyframes ${v} ${h}`,u.cssRules.length)}const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${v} ${l}ms linear ${s}ms 1 both`,Pe+=1,v}function Jt(n,e){const t=(n.style.animation||"").split(", "),l=t.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),s=t.length-l.length;s&&(n.style.animation=l.join(", "),Pe-=s,Pe||Xt())}function Xt(){Ue(()=>{Pe||(Be.forEach(n=>{const{style_element:e}=n;D(e)}),Be.clear())})}let De;function Ae(n){De=n}function Kt(){if(!De)throw new Error("Function called outside component initialization");return De}function At(n){Kt().$$.on_destroy.push(n)}const Oe=[],we=[],$e=[],qe=[],Zt=Promise.resolve();let ze=!1;function Qt(){ze||(ze=!0,Zt.then(jt))}function ae(n){$e.push(n)}function Dt(n){qe.push(n)}const Ye=new Set;let Ie=0;function jt(){const n=De;do{for(;Ie<Oe.length;){const e=Oe[Ie];Ie++,Ae(e),Vt(e.$$)}for(Ae(null),Oe.length=0,Ie=0;we.length;)we.pop()();for(let e=0;e<$e.length;e+=1){const t=$e[e];Ye.has(t)||(Ye.add(t),t())}$e.length=0}while(Oe.length);for(;qe.length;)qe.pop()();ze=!1,Ye.clear(),Ae(n)}function Vt(n){if(n.fragment!==null){n.update(),pe(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ae)}}let Ee;function en(){return Ee||(Ee=Promise.resolve(),Ee.then(()=>{Ee=null})),Ee}function Re(n,e,t){n.dispatchEvent(qt(`${e?"intro":"outro"}${t}`))}const He=new Set;let oe;function _e(){oe={r:0,c:[],p:oe}}function me(){oe.r||pe(oe.c),oe=oe.p}function $(n,e){n&&n.i&&(He.delete(n),n.i(e))}function C(n,e,t,l){if(n&&n.o){if(He.has(n))return;He.add(n),oe.c.push(()=>{He.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}const tn={duration:0};function le(n,e,t,l){let s=e(n,t),r=l?0:1,i=null,o=null,a=null;function f(){a&&Jt(n,a)}function h(p,c){const d=p.b-r;return c*=Math.abs(d),{a:r,b:p.b,d,duration:c,start:p.start,end:p.start+c,group:p.group}}function v(p){const{delay:c=0,duration:d=300,easing:b=St,tick:u=z,css:m}=s||tn,_={start:Ct()+c,b:p};p||(_.group=oe,oe.r+=1),i||o?o=_:(m&&(f(),a=nt(n,r,p,d,c,b,m)),p&&u(0,1),i=h(_,d),ae(()=>Re(n,p,"start")),Ft(k=>{if(o&&k>o.start&&(i=h(o,d),o=null,Re(n,i.b,"start"),m&&(f(),a=nt(n,r,i.b,i.duration,0,b,s.css))),i){if(k>=i.end)u(r=i.b,1-r),Re(n,i.b,"end"),o||(i.b?f():--i.group.r||pe(i.group.c)),i=null;else if(k>=i.start){const x=k-i.start;r=i.a+i.d*b(x/i.duration),u(r,1-r)}}return!!(i||o)}))}return{run(p){Le(s)?en().then(()=>{s=s(),v(p)}):v(p)},end(){f(),i=o=null}}}const nn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ln(n,e){n.d(1),e.delete(n.key)}function It(n,e){C(n,1,1,()=>{e.delete(n.key)})}function Xe(n,e,t,l,s,r,i,o,a,f,h,v){let p=n.length,c=r.length,d=p;const b={};for(;d--;)b[n[d].key]=d;const u=[],m=new Map,_=new Map;for(d=c;d--;){const w=v(s,r,d),M=t(w);let E=i.get(M);E?l&&E.p(w,e):(E=f(M,w),E.c()),m.set(M,u[d]=E),M in b&&_.set(M,Math.abs(d-b[M]))}const k=new Set,x=new Set;function L(w){$(w,1),w.m(o,h),i.set(w.key,w),h=w.first,c--}for(;p&&c;){const w=u[c-1],M=n[p-1],E=w.key,B=M.key;w===M?(h=w.first,p--,c--):m.has(B)?!i.has(E)||k.has(E)?L(w):x.has(B)?p--:_.get(E)>_.get(B)?(x.add(E),L(w)):(k.add(B),p--):(a(M,i),p--)}for(;p--;){const w=n[p];m.has(w.key)||a(w,i)}for(;c;)L(u[c-1]);return u}function Nt(n,e,t){const l=n.$$.props[e];l!==void 0&&(n.$$.bound[l]=t,t(n.$$.ctx[l]))}function se(n){n&&n.c()}function ee(n,e,t,l){const{fragment:s,on_mount:r,on_destroy:i,after_update:o}=n.$$;s&&s.m(e,t),l||ae(()=>{const a=r.map(Tt).filter(Le);i?i.push(...a):pe(a),n.$$.on_mount=[]}),o.forEach(ae)}function te(n,e){const t=n.$$;t.fragment!==null&&(pe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function sn(n,e){n.$$.dirty[0]===-1&&(Oe.push(n),Qt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function fe(n,e,t,l,s,r,i,o=[-1]){const a=De;Ae(n);const f=n.$$={fragment:null,ctx:null,props:r,update:z,not_equal:s,bound:et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:et(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};i&&i(f.root);let h=!1;if(f.ctx=t?t(n,e.props||{},(v,p,...c)=>{const d=c.length?c[0]:p;return f.ctx&&s(f.ctx[v],f.ctx[v]=d)&&(!f.skip_bound&&f.bound[v]&&f.bound[v](d),h&&sn(n,v)),p}):[],f.update(),h=!0,pe(f.before_update),f.fragment=l?l(f.ctx):!1,e.target){if(e.hydrate){const v=Gt(e.target);f.fragment&&f.fragment.l(v),v.forEach(D)}else f.fragment&&f.fragment.c();e.intro&&$(n.$$.fragment),ee(n,e.target,e.anchor,e.customElement),jt()}Ae(a)}class ue{$destroy(){te(this,1),this.$destroy=z}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const s=l.indexOf(t);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!Bt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function rn(n){const e=n-1;return e*e*e+1}function he(n,{delay:e=0,duration:t=400,easing:l=St}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:l,css:r=>`opacity: ${r*s}`}}function lt(n,{delay:e=0,duration:t=400,easing:l=rn}={}){const s=getComputedStyle(n),r=+s.opacity,i=parseFloat(s.height),o=parseFloat(s.paddingTop),a=parseFloat(s.paddingBottom),f=parseFloat(s.marginTop),h=parseFloat(s.marginBottom),v=parseFloat(s.borderTopWidth),p=parseFloat(s.borderBottomWidth);return{delay:e,duration:t,easing:l,css:c=>`overflow: hidden;opacity: ${Math.min(c*20,1)*r};height: ${c*i}px;padding-top: ${c*o}px;padding-bottom: ${c*a}px;margin-top: ${c*f}px;margin-bottom: ${c*h}px;border-top-width: ${c*v}px;border-bottom-width: ${c*p}px;`}}const ye=[];function Ke(n,e=z){let t;const l=new Set;function s(o){if(ie(n,o)&&(n=o,t)){const a=!ye.length;for(const f of l)f[1](),ye.push(f,n);if(a){for(let f=0;f<ye.length;f+=2)ye[f][0](ye[f+1]);ye.length=0}}}function r(o){s(o(n))}function i(o,a=z){const f=[o,a];return l.add(f),l.size===1&&(t=e(s)||z),o(n),()=>{l.delete(f),l.size===0&&(t(),t=null)}}return{set:s,update:r,subscribe:i}}const je=Ke(null),on=n=>{je.set(n),g_Api.setHeader("x-username",n.username)};function st(n){let e,t,l;return{c(){e=y("div"),e.textContent="Operators",O(e,"class","item cursor_ptr svelte-vbcb9r"),J(e,"active",n[0]==="operators"),J(e,"disabled",n[1].has("operators"))},m(s,r){I(s,e,r),t||(l=Q(e,"click",n[3]("operators")),t=!0)},p(s,r){r&1&&J(e,"active",s[0]==="operators"),r&2&&J(e,"disabled",s[1].has("operators"))},d(s){s&&D(e),t=!1,l()}}}function it(n){let e,t=n[2].username+"",l,s,r;return{c(){e=y("div"),l=H(t),O(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),W(e,"max-width","200px")},m(i,o){I(i,e,o),g(e,l),r=!0},p(i,o){(!r||o&4)&&t!==(t=i[2].username+"")&&X(l,t)},i(i){r||(ae(()=>{s||(s=le(e,he,{},!0)),s.run(1)}),r=!0)},o(i){s||(s=le(e,he,{},!1)),s.run(0),r=!1},d(i){i&&D(e),i&&s&&s.end()}}}function an(n){let e,t,l,s,r,i,o=!n[2]&&st(n),a=n[2]&&0,f=n[2]&&it(n);return{c(){e=y("div"),o&&o.c(),t=A(),a&&a.c(),l=A(),s=y("div"),r=A(),f&&f.c(),O(s,"class","flex flex_grow_1"),O(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(h,v){I(h,e,v),o&&o.m(e,null),g(e,t),a&&a.m(e,null),g(e,l),g(e,s),g(e,r),f&&f.m(e,null),i=!0},p(h,[v]){h[2]?o&&(o.d(1),o=null):o?o.p(h,v):(o=st(h),o.c(),o.m(e,t)),h[2],a&&(a.d(1),a=null),h[2]?f?(f.p(h,v),v&4&&$(f,1)):(f=it(h),f.c(),$(f,1),f.m(e,null)):f&&(_e(),C(f,1,1,()=>{f=null}),me())},i(h){i||($(f),i=!0)},o(h){C(f),i=!1},d(h){h&&D(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function fn(n,e,t){let l;Me(n,je,o=>t(2,l=o));let{select:s=""}=e,{disabled:r=new Set}=e;r.add("newLeads"),r.add("myLeads");const i=o=>a=>{r.has(o)||t(0,s=o)};return n.$$set=o=>{"select"in o&&t(0,s=o.select),"disabled"in o&&t(1,r=o.disabled)},[s,r,l,i]}class un extends ue{constructor(e){super(),fe(this,e,fn,an,ie,{select:0,disabled:1})}}function cn(n){let e;return{c(){e=y("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,O(e,"class","lds-roller svelte-j15bjw")},m(t,l){I(t,e,l)},p:z,i:z,o:z,d(t){t&&D(e)}}}class Ze extends ue{constructor(e){super(),fe(this,e,null,cn,ie,{})}}function rt(n,e,t){const l=n.slice();return l[5]=e[t],l}function dn(n){let e,t,l=n[0],s=[];for(let i=0;i<l.length;i+=1)s[i]=at(rt(n,l,i));const r=i=>C(s[i],1,1,()=>{s[i]=null});return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=Je()},m(i,o){for(let a=0;a<s.length;a+=1)s[a].m(i,o);I(i,e,o),t=!0},p(i,o){if(o&5){l=i[0];let a;for(a=0;a<l.length;a+=1){const f=rt(i,l,a);s[a]?(s[a].p(f,o),$(s[a],1)):(s[a]=at(f),s[a].c(),$(s[a],1),s[a].m(e.parentNode,e))}for(_e(),a=l.length;a<s.length;a+=1)r(a);me()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)$(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)C(s[o]);t=!1},d(i){Wt(s,i),i&&D(e)}}}function _n(n){let e,t,l,s,r;return s=new Ze({}),{c(){e=y("div"),t=y("div"),l=A(),se(s.$$.fragment),W(t,"height","20px"),O(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(i,o){I(i,e,o),g(e,t),g(e,l),ee(s,e,null),r=!0},p:z,i(i){r||($(s.$$.fragment,i),r=!0)},o(i){C(s.$$.fragment,i),r=!1},d(i){i&&D(e),te(s)}}}function ot(n){let e,t,l=n[5].username+"",s;return{c(){e=y("div"),t=H("@"),s=H(l),O(e,"class","nowrap textOverEllipsis")},m(r,i){I(r,e,i),g(e,t),g(e,s)},p(r,i){i&1&&l!==(l=r[5].username+"")&&X(s,l)},d(r){r&&D(e)}}}function at(n){var k,x;let e,t,l,s=((k=n[5].first_name)!=null?k:"")+"",r,i,o,a,f,h=((x=n[5].last_name)!=null?x:"")+"",v,p,c,d,b,u,m,_=n[5].username&&ot(n);return{c(){e=y("div"),t=y("div"),l=y("div"),r=H(s),i=A(),o=y("div"),a=A(),f=y("div"),v=H(h),p=A(),_&&_.c(),c=A(),W(o,"width","8px"),O(t,"class","flex nowrap textOverEllipsis"),O(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(L,w){I(L,e,w),g(e,t),g(t,l),g(l,r),g(t,i),g(t,o),g(t,a),g(t,f),g(f,v),g(e,p),_&&_.m(e,null),g(e,c),b=!0,u||(m=Q(e,"click",function(){Le(n[2](n[5]))&&n[2](n[5]).apply(this,arguments)}),u=!0)},p(L,w){var M,E;n=L,(!b||w&1)&&s!==(s=((M=n[5].first_name)!=null?M:"")+"")&&X(r,s),(!b||w&1)&&h!==(h=((E=n[5].last_name)!=null?E:"")+"")&&X(v,h),n[5].username?_?_.p(n,w):(_=ot(n),_.c(),_.m(e,c)):_&&(_.d(1),_=null)},i(L){b||(L&&ae(()=>{d||(d=le(e,he,{},!0)),d.run(1)}),b=!0)},o(L){L&&(d||(d=le(e,he,{},!1)),d.run(0)),b=!1},d(L){L&&D(e),_&&_.d(),L&&d&&d.end(),u=!1,m()}}}function mn(n){let e,t,l,s;const r=[_n,dn],i=[];function o(a,f){return a[1]?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c(),O(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){I(a,e,f),i[t].m(e,null),s=!0},p(a,[f]){let h=t;t=o(a),t===h?i[t].p(a,f):(_e(),C(i[h],1,1,()=>{i[h]=null}),me(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),$(l,1),l.m(e,null))},i(a){s||($(l),s=!0)},o(a){C(l),s=!1},d(a){a&&D(e),i[t].d()}}}function hn(n,e,t){let l=[],s=!1;const r=async()=>{t(1,s=!0);const a=await g_Api("GET","operators");t(0,l=a.results),t(1,s=!1)};let i=!1;const o=a=>f=>{i||(on(a),i=!0)};return r(),[l,s,o]}class pn extends ue{constructor(e){super(),fe(this,e,hn,mn,ie,{})}}const $t=n=>new Promise(e=>setTimeout(e,n)),We=(n,e,t)=>Math.min(t,Math.max(n,e)),Qe=(n,e)=>{let t=null,l=null,s=!0;const r=()=>{s&&setTimeout(r,10);const o=n.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||l!==a.height)&&(t=a.width,l=a.height,n.style.width=`${t}px`,n.style.height=`${l}px`,e&&e.set(a))}};return r(),{destroy:()=>s=!1}},gn=(n,e)=>{let t=null,l=null,s=null,r=null,i=!0;const o=()=>{i&&setTimeout(o,10);const f=n.getBoundingClientRect();(t!==f.width||l!==f.height||s!==f.x||r!==f.y)&&(t=f.width,l=f.height,s=f.x,r=f.y,e&&e.set(f))};return o(),{destroy:()=>i=!1}};const{Map:vn}=nn;function ft(n,e,t){const l=n.slice();return l[13]=e[t],l}function ut(n){let e,t,l,s;return t=new Ze({}),{c(){e=y("div"),se(t.$$.fragment),O(e,"class","pos_abs loading svelte-1395xne")},m(r,i){I(r,e,i),ee(t,e,null),s=!0},i(r){s||($(t.$$.fragment,r),r&&ae(()=>{l||(l=le(e,he,{},!0)),l.run(1)}),s=!0)},o(r){C(t.$$.fragment,r),r&&(l||(l=le(e,he,{},!1)),l.run(0)),s=!1},d(r){r&&D(e),te(t),r&&l&&l.end()}}}function ct(n){let e,t,l=n[13].username+"",s;return{c(){e=y("div"),t=H("@"),s=H(l),O(e,"class","nowrap textOverEllipsis username svelte-1395xne")},m(r,i){I(r,e,i),g(e,t),g(e,s)},p(r,i){i&2&&l!==(l=r[13].username+"")&&X(s,l)},d(r){r&&D(e)}}}function dt(n,e){var _,k;let t,l,s,r=((_=e[13].first_name)!=null?_:"")+"",i,o,a,f,h,v=((k=e[13].last_name)!=null?k:"")+"",p,c,d,b,u,m=e[13].username&&ct(e);return{key:n,first:null,c(){t=y("div"),l=y("div"),s=y("div"),i=H(r),o=A(),a=y("div"),f=A(),h=y("div"),p=H(v),c=A(),m&&m.c(),d=A(),W(a,"width","8px"),O(l,"class","flex nowrap textOverEllipsis userAttr svelte-1395xne"),O(t,"class","flex flex_clm cursor_ptr item unselect pos_abs svelte-1395xne"),W(t,"left",e[13].x+"px"),W(t,"top",e[13].y+"px"),J(t,"disabled",e[3].has(e[13].tg_id)),this.first=t},m(x,L){I(x,t,L),g(t,l),g(l,s),g(s,i),g(l,o),g(l,a),g(l,f),g(l,h),g(h,p),g(t,c),m&&m.m(t,null),g(t,d),b||(u=Q(t,"click",function(){Le(e[4](e[13]))&&e[4](e[13]).apply(this,arguments)}),b=!0)},p(x,L){var w,M;e=x,L&2&&r!==(r=((w=e[13].first_name)!=null?w:"")+"")&&X(i,r),L&2&&v!==(v=((M=e[13].last_name)!=null?M:"")+"")&&X(p,v),e[13].username?m?m.p(e,L):(m=ct(e),m.c(),m.m(t,d)):m&&(m.d(1),m=null),L&2&&W(t,"left",e[13].x+"px"),L&2&&W(t,"top",e[13].y+"px"),L&10&&J(t,"disabled",e[3].has(e[13].tg_id))},d(x){x&&D(t),m&&m.d(),b=!1,u()}}}function bn(n){let e,t,l,s,r,i,o,a=[],f=new vn,h,v,p,c=n[2]&&ut(),d=n[1];const b=u=>u[13].tg_id;for(let u=0;u<d.length;u+=1){let m=ft(n,d,u),_=b(m);f.set(_,a[u]=dt(_,m))}return{c(){e=y("div"),t=y("div"),l=H(`New leads\r
		\r
		`),c&&c.c(),s=A(),r=y("div"),i=y("div"),o=y("div");for(let u=0;u<a.length;u+=1)a[u].c();O(t,"class","flex flex_cx flex_cy header pos_rel svelte-1395xne"),O(o,"class","flex list h100 svelte-1395xne"),O(i,"class","pos_abs"),W(i,"overflow","hidden"),O(r,"class","flex cnt h100 pos_rel svelte-1395xne"),O(e,"class","flex flex_clm wrapMain svelte-1395xne")},m(u,m){I(u,e,m),g(e,t),g(t,l),c&&c.m(t,null),g(e,s),g(e,r),g(r,i),g(i,o);for(let _=0;_<a.length;_+=1)a[_].m(o,null);n[6](i),h=!0,v||(p=Ce(Qe.call(null,i)),v=!0)},p(u,[m]){u[2]?c?m&4&&$(c,1):(c=ut(),c.c(),$(c,1),c.m(t,null)):c&&(_e(),C(c,1,1,()=>{c=null}),me()),m&26&&(d=u[1],a=Xe(a,m,b,1,u,d,f,o,ln,dt,null,ft))},i(u){h||($(c),h=!0)},o(u){C(c),h=!1},d(u){u&&D(e),c&&c.d();for(let m=0;m<a.length;m+=1)a[m].d();n[6](null),v=!1,p()}}}const wn=160,yn=33,Ge=0;async function _t(){var t;const n=await g_Api("GET","leads/unassigned",{offset:0,limit:20});return((t=n.results)!=null?t:n).map(l=>({...l,date_joined:+new Date(l.date_joined)})).sort((l,s)=>s.date_joined-l.date_joined)}function kn(n,e,t){let l;Me(n,je,u=>t(9,l=u));let s=[],r=new Map,i=[],o=null;function a(){if(!o)return;const u=o.getBoundingClientRect(),m=wn+Ge*2,_=yn+Ge*2,k=Math.max(1,Math.floor(u.width/m)),x=(u.width-k*m)/2,L=Ge;t(1,i=s.map((w,M)=>{const E={...w};return E.x=M%k*m+x,E.y=L+Math.floor(M/k)*_,E}))}let f=!1;async function h(){t(2,f=!0),t(5,s=await _t()),t(2,f=!1),p()}let v=!0;async function p(){for(;v;){await $t(1e3);const u=new Set(s.map(M=>M.tg_id)),m=await _t(),_=new Set(m.map(M=>M.tg_id)),k=m.filter(M=>!u.has(M.tg_id)),x=s.filter(M=>!_.has(M.tg_id)),L=Date.now();x.map(M=>r.has(M.tg_id)||r.set(M.tg_id,L)),k.length===0&&x.length===0||t(5,s=[...s,...k].sort((M,E)=>E.date_joined-M.date_joined));const w=new Set;[...r].map(M=>{M[1]+2e3<=L&&w.add(M[0]),M[1]+1e4<=L&&r.delete(M[0])}),w.size&&t(5,s=s.filter(M=>!w.has(M.tg_id)))}}At(()=>v=!1);let c=!1;const d=u=>async m=>{if(!l||c)return;c=!0;const _=await g_Api("POST",`leads/${u.tg_id}/assign`);_&&(r.set(u.tg_id,Date.now()),t(5,s)),console.log({result:_},s.length,i.length,r.size),c=!1};h();function b(u){we[u?"unshift":"push"](()=>{o=u,t(0,o)})}return n.$$.update=()=>{n.$$.dirty&33&&a()},[o,i,f,r,d,s,b]}class Ln extends ue{constructor(e){super(),fe(this,e,kn,bn,ie,{})}}function mt(n){let e,t;return{c(){e=y("div"),t=H(n[1]),O(e,"class","username svelte-10cuqsv")},m(l,s){I(l,e,s),g(e,t)},p(l,s){s&2&&X(t,l[1])},d(l){l&&D(e)}}}function Mn(n){let e,t,l,s,r,i=n[0]&&n[1]&&mt(n);return{c(){e=y("div"),i&&i.c(),t=A(),l=y("div"),s=y("pre"),r=H(n[2]),O(s,"class","text svelte-10cuqsv"),O(l,"class","flex"),O(e,"class","flex flex_clm chat_item pos_abs svelte-10cuqsv"),J(e,"chat_item_other",n[0]),J(e,"chat_item_self",!n[0])},m(o,a){I(o,e,a),i&&i.m(e,null),g(e,t),g(e,l),g(l,s),g(s,r),n[6](e)},p(o,[a]){o[0]&&o[1]?i?i.p(o,a):(i=mt(o),i.c(),i.m(e,t)):i&&(i.d(1),i=null),a&4&&X(r,o[2]),a&1&&J(e,"chat_item_other",o[0]),a&1&&J(e,"chat_item_self",!o[0])},i:z,o:z,d(o){o&&D(e),i&&i.d(),n[6](null)}}}function xn(n,e,t){let{incoming:l=!1}=e,{username:s=null}=e,{text:r=null}=e,{render_Width:i=1}=e,{render_X:o=-i*2}=e,a=null;function f(h){we[h?"unshift":"push"](()=>{a=h,t(3,a)})}return n.$$set=h=>{"incoming"in h&&t(0,l=h.incoming),"username"in h&&t(1,s=h.username),"text"in h&&t(2,r=h.text),"render_Width"in h&&t(4,i=h.render_Width),"render_X"in h&&t(5,o=h.render_X)},[l,s,r,a,i,o,f]}class Sn extends ue{constructor(e){super(),fe(this,e,xn,Mn,ie,{incoming:0,username:1,text:2,render_Width:4,render_X:5})}}function Tn(n){let e,t,l,s;return{c(){e=y("div"),t=y("div"),O(t,"class","pos_abs thumb w100 svelte-1un6dgr"),W(t,"height",n[1]+"px"),W(t,"top",n[5](n[0],n[3])+"px"),J(t,"active",n[2]),O(e,"class","pos_rel h100 unselect line svelte-1un6dgr"),J(e,"active",n[2])},m(r,i){I(r,e,i),g(e,t),l||(s=[Q(window,"mousemove",n[7]),Q(window,"mouseup",n[8]),Q(window,"blur",n[8]),Q(t,"mousedown",n[6]),Ce(gn.call(null,e,n[4])),Q(e,"mousedown",n[9])],l=!0)},p(r,[i]){i&2&&W(t,"height",r[1]+"px"),i&9&&W(t,"top",r[5](r[0],r[3])+"px"),i&4&&J(t,"active",r[2]),i&4&&J(e,"active",r[2])},i:z,o:z,d(r){r&&D(e),l=!1,pe(s)}}}function En(n,e,t){let l,{value_in:s=0}=e,{value_out:r=s}=e,{thumb_Height:i=20}=e;const o=Ke(null);Me(n,o,u=>t(3,l=u));const a=()=>l?l.height-i:1,f=u=>l?u*a():0;let h=null;const v=u=>{!l||t(2,h={y:u.clientY,value_out:r})},p=u=>{if(!l||!h)return;const m=u.clientY-h.y;if(l.height){const _=m/a();t(0,r=We(0,h.value_out+_,1))}},c=u=>{t(2,h=null)},d=u=>{!l||(t(0,r=We(0,(u.clientY-l.y-i/2)/a(),1)),t(2,h={y:u.clientY,value_out:r}))},b=()=>{h||t(0,r=We(0,s,1))};return n.$$set=u=>{"value_in"in u&&t(10,s=u.value_in),"value_out"in u&&t(0,r=u.value_out),"thumb_Height"in u&&t(1,i=u.thumb_Height)},n.$$.update=()=>{n.$$.dirty&1024&&b()},[r,i,h,l,o,f,v,p,c,d,s]}class On extends ue{constructor(e){super(),fe(this,e,En,Tn,ie,{value_in:10,value_out:0,thumb_Height:1})}}function ht(n,e,t){const l=n.slice();return l[32]=e[t],l}function pt(n){var u,m,_,k,x,L,w,M;let e,t,l,s,r=((_=(m=(u=n[0])==null?void 0:u.lead)==null?void 0:m.first_name)!=null?_:"")+"",i,o,a,f,h,v=((L=(x=(k=n[0])==null?void 0:k.lead)==null?void 0:x.last_name)!=null?L:"")+"",p,c,d,b=((M=(w=n[0])==null?void 0:w.lead)==null?void 0:M.username)&&gt(n);return{c(){e=y("div"),t=y("div"),l=A(),s=y("div"),i=H(r),o=A(),a=y("div"),f=A(),h=y("div"),p=H(v),c=A(),b&&b.c(),d=Je(),W(t,"width","8px"),W(a,"width","8px"),O(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-ffie4h")},m(E,B){I(E,e,B),g(e,t),g(e,l),g(e,s),g(s,i),g(e,o),g(e,a),g(e,f),g(e,h),g(h,p),I(E,c,B),b&&b.m(E,B),I(E,d,B)},p(E,B){var Y,T,S,N,V,ne,ge,ve;B[0]&1&&r!==(r=((S=(T=(Y=E[0])==null?void 0:Y.lead)==null?void 0:T.first_name)!=null?S:"")+"")&&X(i,r),B[0]&1&&v!==(v=((ne=(V=(N=E[0])==null?void 0:N.lead)==null?void 0:V.last_name)!=null?ne:"")+"")&&X(p,v),(ve=(ge=E[0])==null?void 0:ge.lead)!=null&&ve.username?b?b.p(E,B):(b=gt(E),b.c(),b.m(d.parentNode,d)):b&&(b.d(1),b=null)},d(E){E&&D(e),E&&D(c),b&&b.d(E),E&&D(d)}}}function gt(n){let e,t,l=n[0].lead.username+"",s;return{c(){e=y("div"),t=H("@"),s=H(l),O(e,"class","nowrap textOverEllipsis username svelte-ffie4h")},m(r,i){I(r,e,i),g(e,t),g(e,s)},p(r,i){i[0]&1&&l!==(l=r[0].lead.username+"")&&X(s,l)},d(r){r&&D(e)}}}function vt(n){let e,t,l,s;return t=new Ze({}),{c(){e=y("div"),se(t.$$.fragment),O(e,"class","pos_abs loading svelte-ffie4h")},m(r,i){I(r,e,i),ee(t,e,null),s=!0},i(r){s||($(t.$$.fragment,r),r&&ae(()=>{l||(l=le(e,he,{},!0)),l.run(1)}),s=!0)},o(r){C(t.$$.fragment,r),r&&(l||(l=le(e,he,{},!1)),l.run(0)),s=!1},d(r){r&&D(e),te(t),r&&l&&l.end()}}}function bt(n,e){var r,i,o,a,f,h;let t,l,s;return l=new Sn({props:{render_Width:e[7],incoming:(r=e[32])==null?void 0:r.incoming,username:(a=(o=(i=e[0])==null?void 0:i.lead)==null?void 0:o.username)!=null?a:"",text:(h=(f=e[32])==null?void 0:f.text)!=null?h:""}}),{key:n,first:null,c(){t=Je(),se(l.$$.fragment),this.first=t},m(v,p){I(v,t,p),ee(l,v,p),s=!0},p(v,p){var d,b,u,m,_,k;e=v;const c={};p[0]&128&&(c.render_Width=e[7]),p[0]&2&&(c.incoming=(d=e[32])==null?void 0:d.incoming),p[0]&1&&(c.username=(m=(u=(b=e[0])==null?void 0:b.lead)==null?void 0:u.username)!=null?m:""),p[0]&2&&(c.text=(k=(_=e[32])==null?void 0:_.text)!=null?k:""),l.$set(c)},i(v){s||($(l.$$.fragment,v),s=!0)},o(v){C(l.$$.fragment,v),s=!1},d(v){v&&D(t),te(l,v)}}}function An(n){let e,t,l,s,r,i,o,a,f=[],h=new Map,v,p,c,d,b,u,m,_,k,x,L=n[0]&&pt(n),w=n[2]&&vt(),M=n[1];const E=T=>T[32].index;for(let T=0;T<M.length;T+=1){let S=ht(n,M,T),N=E(S);h.set(N,f[T]=bt(N,S))}function B(T){n[12](T)}let Y={value_in:n[3]};return n[4]!==void 0&&(Y.value_out=n[4]),c=new On({props:Y}),we.push(()=>Nt(c,"value_out",B)),{c(){e=y("div"),t=y("div"),L&&L.c(),l=A(),w&&w.c(),s=A(),r=y("div"),i=y("div"),o=y("div"),a=y("div");for(let T=0;T<f.length;T+=1)f[T].c();v=A(),p=y("div"),se(c.$$.fragment),b=A(),u=y("div"),m=y("textarea"),O(t,"class","flex flex_clm flex_cx header pos_rel svelte-ffie4h"),O(a,"class","pos_rel w100 h100"),O(p,"class","pos_abs h100"),W(p,"width","10px"),W(p,"right","0px"),W(p,"height","calc( 100% - 10px )"),W(p,"top","5px"),O(o,"class","pos_rel w100 h100"),O(i,"class","flex pos_abs overhide"),O(r,"class","flex flex_grow_1 pos_rel overhide"),O(m,"class","flex flex_grow_1 chat_input_textarea svelte-ffie4h"),O(u,"class","flex chat_input svelte-ffie4h"),O(e,"class","flex flex_clm flex_grow_1 overhide")},m(T,S){I(T,e,S),g(e,t),L&&L.m(t,null),g(t,l),w&&w.m(t,null),g(e,s),g(e,r),g(r,i),g(i,o),g(o,a);for(let N=0;N<f.length;N+=1)f[N].m(a,null);n[11](a),g(o,v),g(o,p),ee(c,p,null),g(e,b),g(e,u),g(u,m),tt(m,n[6]),_=!0,k||(x=[Q(o,"wheel",n[10]),Ce(Qe.call(null,i,n[8])),Q(m,"input",n[13]),Q(m,"keyup",n[9])],k=!0)},p(T,S){T[0]?L?L.p(T,S):(L=pt(T),L.c(),L.m(t,l)):L&&(L.d(1),L=null),T[2]?w?S[0]&4&&$(w,1):(w=vt(),w.c(),$(w,1),w.m(t,null)):w&&(_e(),C(w,1,1,()=>{w=null}),me()),S[0]&131&&(M=T[1],_e(),f=Xe(f,S,E,1,T,M,h,a,It,bt,null,ht),me());const N={};S[0]&8&&(N.value_in=T[3]),!d&&S[0]&16&&(d=!0,N.value_out=T[4],Dt(()=>d=!1)),c.$set(N),S[0]&64&&tt(m,T[6])},i(T){if(!_){$(w);for(let S=0;S<M.length;S+=1)$(f[S]);$(c.$$.fragment,T),_=!0}},o(T){C(w);for(let S=0;S<f.length;S+=1)C(f[S]);C(c.$$.fragment,T),_=!1},d(T){T&&D(e),L&&L.d(),w&&w.d();for(let S=0;S<f.length;S+=1)f[S].d();n[11](null),te(c),k=!1,pe(x)}}}const wt=10,Ne=4;async function yt(n){try{await g_Api("POST",`dialogs/${n}/read`)}catch(e){console.log(e.message)}}function Dn(n,e,t){let l,{dialog:s=null}=e,r=[],i=[],o=[],a=new Set,f=0,h=0,v=1,p=1,c=null;const d=Ke(null);Me(n,d,j=>t(22,l=j));const b={id:1,text:"",received_at:new Date().toJSON(),is_read:!0,incoming:!0,dialog:1};let u=-1;async function m(j,K=0,P=20){const F=await g_Api("GET","messages",{dialog_id:j,offset:K,limit:P});if(s&&s.id===j){for(f=F.count;i.length<f;){const Z=i.length;i.push({id:u--,index:Z,_isFakeMsg:!0})}const G=F.results;G.map((Z,be)=>Z.index=K+be),G.map(Z=>i[Z.index]=Z)}}let _="";const k=async j=>{if(j.which===13&&(t(6,_=_.trim()),_)){const K={...b};K.id=Math.random()*1e9|0,K.text=_,K.incoming=!1,s&&g_Api("POST","messages",{dialog:s.id,text:_,is_read:!0}),r.push(K),r=r,t(6,_="")}};function x(){r=[],i=[],t(1,o=[]),a=new Set,f=0,console.log("clear all")}let L=null,w=null;async function M(j){if(!j){if(!L)return;L=null,x();return}w!==j.id&&(L=j,w=j.id,x(),r=[],i=[],t(1,o=[]),f=0,t(2,h++,h),await m(j.id),f&&await m(j.id,Math.max(f-20,0),20),await yt(j.id),t(2,h--,h))}let E=1,B=!0;function Y(){if(B&&requestAnimationFrame(Y),!l||!c||!i.length)return;l.width;const j=l.height,K=l.width-wt*2,P=wt;t(7,E=Math.floor(K*.9));const F=1+p*(i.length-1);let G=Math.floor(F),Z=F-G;G>=i.length&&(G=i.length-1,Z=1);const be=[],xe=[];let Se=null;t(1,o=[]);for(let U=G-22,q=0,Te=!0;U<G+2;U++)U<0||U>=i.length||(i[U]._isFakeMsg&&a.add(U),o[q]!==i[U]&&(Te&&(Te=!1,o.splice(q,1e9)),t(1,o[q]=i[U],o),t(1,o)),t(1,o[q]._drawIndex=q,o),U<G&&be.push(o[q]),U>G&&xe.push(o[q]),U===G&&(Se=o[q]),q++);const ce=[...c.children];if(ce.length===o.length){ce.map((R,de)=>{const re=o[de];if(!re||R._remove)return;const Ht=R.getBoundingClientRect();R._bbox=Ht;const Fe=Math.floor(P+(re.incoming?0:l.width*.05));R.__cacheWidth!==E&&(R.__cacheWidth=E,R.style.width=E+"px"),R.__cacheLeft!==Fe&&(R.__cacheLeft=Fe,R.style.left=Fe+"px")});const U=(R,de,re=1)=>(R.__cacheTop!==de&&(R.__cacheTop=de,R.style.top=de+"px"),de+(R._bbox.height+Ne)*re);let q=0,Te=0;const Ve=ce[Se._drawIndex];if(Ve){const R=Ve;q=j+Ne-(R._bbox.height+Ne)*Z,Te=q,q=U(R,q,1)}xe.map((R,de)=>{const re=ce[R._drawIndex];q=U(re,q,1)}),q=Te,be.reverse().map((R,de)=>{const re=ce[R._drawIndex];q-=re._bbox.height+Ne,U(re,q,0)})}}requestAnimationFrame(Y),At(()=>B=!1);async function T(){if(a.size){const j=[...a].sort((F,G)=>F-G);a.clear();const K=[];let P={offset:null,limit:0};for(const F of j){if(P.offset!==null){if(P.limit<=500&&P.offset+P.limit===F){P.limit++;continue}K.push(P)}P={offset:F,limit:1}}P.offset!==null&&K.push(P),s&&(t(2,h++,h),await Promise.all(K.map(F=>m(s.id,F.offset,F.limit))),t(2,h--,h))}setTimeout(T,500)}T();async function S(){s&&await yt(s.id),setTimeout(S,5e3)}S();async function N(){s&&await m(s.id,f,20),setTimeout(N,500)}N();const V=j=>{j.deltaY>0?t(3,v=p+1/(i.length-1)):t(3,v=p-1/(i.length-1))};function ne(j){we[j?"unshift":"push"](()=>{c=j,t(5,c)})}function ge(j){p=j,t(4,p)}function ve(){_=this.value,t(6,_)}return n.$$set=j=>{"dialog"in j&&t(0,s=j.dialog)},n.$$.update=()=>{n.$$.dirty[0]&1&&M(s)},[s,o,h,v,p,c,_,E,d,k,V,ne,ge,ve]}class jn extends ue{constructor(e){super(),fe(this,e,Dn,An,ie,{dialog:0},null,[-1,-1])}}function kt(n,e,t){const l=n.slice();return l[13]=e[t],l}function In(n){let e;return{c(){e=H("\xA0")},m(t,l){I(t,e,l)},p:z,d(t){t&&D(e)}}}function Nn(n){var l,s;let e=((s=(l=n[13])==null?void 0:l.last_message)==null?void 0:s.text)+"",t;return{c(){t=H(e)},m(r,i){I(r,t,i)},p(r,i){var o,a;i&1&&e!==(e=((a=(o=r[13])==null?void 0:o.last_message)==null?void 0:a.text)+"")&&X(t,e)},d(r){r&&D(t)}}}function Lt(n){let e,t=n[4](n[13]._lastTime)+"",l;return{c(){e=y("div"),l=H(t),O(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-1tl47rw")},m(s,r){I(s,e,r),g(e,l)},p(s,r){r&1&&t!==(t=s[4](s[13]._lastTime)+"")&&X(l,t)},d(s){s&&D(e)}}}function Mt(n){var s;let e,t=((s=n[13])==null?void 0:s.unread_messages_count)+"",l;return{c(){e=y("div"),l=H(t),O(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-1tl47rw")},m(r,i){I(r,e,i),g(e,l)},p(r,i){var o;i&1&&t!==(t=((o=r[13])==null?void 0:o.unread_messages_count)+"")&&X(l,t)},d(r){r&&D(e)}}}function xt(n,e){var N,V,ne,ge,ve,j,K;let t,l,s,r,i,o=((ne=(V=(N=e[13])==null?void 0:N.lead)==null?void 0:V.first_name)!=null?ne:"")+"",a,f,h,v,p,c=((j=(ve=(ge=e[13])==null?void 0:ge.lead)==null?void 0:ve.last_name)!=null?j:"")+"",d,b,u,m,_,k,x,L,w,M;function E(P,F){var G,Z;return(Z=(G=P[13])==null?void 0:G.last_message)!=null&&Z.text?Nn:In}let B=E(e),Y=B(e),T=e[13]._lastTime&&Lt(e),S=((K=e[13])==null?void 0:K.unread_messages_count)&&Mt(e);return{key:n,first:null,c(){t=y("div"),l=y("div"),s=y("div"),r=A(),i=y("div"),a=H(o),f=A(),h=y("div"),v=A(),p=y("div"),d=H(c),b=A(),u=y("div"),Y.c(),m=A(),T&&T.c(),_=A(),S&&S.c(),k=A(),W(s,"width","8px"),W(h,"width","8px"),O(l,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-1tl47rw"),O(u,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-1tl47rw"),O(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-1tl47rw"),J(t,"active",e[1]&&e[13].id===e[1].id),this.first=t},m(P,F){I(P,t,F),g(t,l),g(l,s),g(l,r),g(l,i),g(i,a),g(l,f),g(l,h),g(l,v),g(l,p),g(p,d),g(t,b),g(t,u),Y.m(u,null),g(t,m),T&&T.m(t,null),g(t,_),S&&S.m(t,null),g(t,k),L=!0,w||(M=Q(t,"click",function(){Le(e[3](e[13]))&&e[3](e[13]).apply(this,arguments)}),w=!0)},p(P,F){var G,Z,be,xe,Se,ce,U;e=P,(!L||F&1)&&o!==(o=((be=(Z=(G=e[13])==null?void 0:G.lead)==null?void 0:Z.first_name)!=null?be:"")+"")&&X(a,o),(!L||F&1)&&c!==(c=((ce=(Se=(xe=e[13])==null?void 0:xe.lead)==null?void 0:Se.last_name)!=null?ce:"")+"")&&X(d,c),B===(B=E(e))&&Y?Y.p(e,F):(Y.d(1),Y=B(e),Y&&(Y.c(),Y.m(u,null))),e[13]._lastTime?T?T.p(e,F):(T=Lt(e),T.c(),T.m(t,_)):T&&(T.d(1),T=null),(U=e[13])!=null&&U.unread_messages_count?S?S.p(e,F):(S=Mt(e),S.c(),S.m(t,k)):S&&(S.d(1),S=null),(!L||F&3)&&J(t,"active",e[1]&&e[13].id===e[1].id)},i(P){L||(P&&ae(()=>{x||(x=le(t,lt,{},!0)),x.run(1)}),L=!0)},o(P){P&&(x||(x=le(t,lt,{},!1)),x.run(0)),L=!1},d(P){P&&D(t),Y.d(),T&&T.d(),S&&S.d(),P&&x&&x.end(),w=!1,M()}}}function $n(n){let e,t,l,s,r,i,o,a,f=[],h=new Map,v,p,c,d,b,u=n[0];const m=_=>_[13].id;for(let _=0;_<u.length;_+=1){let k=kt(n,u,_),x=m(k);h.set(x,f[_]=xt(x,k))}return p=new jn({props:{dialog:n[1]}}),{c(){e=y("div"),t=y("div"),l=y("div"),s=H(`My leads\r
\r
			\r
			\r
			`),r=y("button"),i=H("UF:"),o=H(n[2]),a=A();for(let _=0;_<f.length;_+=1)f[_].c();v=A(),se(p.$$.fragment),O(r,"class","pos_abs cursor_ptr"),O(r,"style","right: 1px; background: #484848; color: #000; //border-radius: 4px; "),O(l,"class","flex flex_cx flex_cy header pos_rel svelte-1tl47rw"),O(t,"class","flex flex_clm list svelte-1tl47rw"),O(e,"class","flex flex_grow_1 ")},m(_,k){I(_,e,k),g(e,t),g(t,l),g(l,s),g(l,r),g(r,i),g(r,o),g(t,a);for(let x=0;x<f.length;x+=1)f[x].m(t,null);g(e,v),ee(p,e,null),c=!0,d||(b=Q(r,"click",n[5]),d=!0)},p(_,[k]){(!c||k&4)&&X(o,_[2]),k&27&&(u=_[0],_e(),f=Xe(f,k,m,1,_,u,h,t,It,xt,null,kt),me());const x={};k&2&&(x.dialog=_[1]),p.$set(x)},i(_){if(!c){for(let k=0;k<u.length;k+=1)$(f[k]);$(p.$$.fragment,_),c=!0}},o(_){for(let k=0;k<f.length;k+=1)C(f[k]);C(p.$$.fragment,_),c=!1},d(_){_&&D(e);for(let k=0;k<f.length;k+=1)f[k].d();te(p),d=!1,b()}}}function Hn(n,e,t){let l;Me(n,je,c=>t(8,l=c));let s=[],r=null;const i={id:1,text:"",received_at:new Date().toJSON(),is_read:!0,incoming:!0,dialog:1};for(let c=0;c<10;c++){const d={...i};d.id=c+1,d.text="Text...",d.incoming=Math.random()<.5}const o=c=>d=>{t(1,r=c)};let a=1;async function f(){if(!l)return;const c=await g_Api("GET","dialogs",{unread_first:a,offset:0,limit:20});t(0,s=c.results),s.map(d=>{var u,m,_;const b=(_=(u=d==null?void 0:d.last_message)==null?void 0:u.received_at)!=null?_:(m=d==null?void 0:d.lead)==null?void 0:m.date_joined;d._lastTime=b?+new Date(b):null})}f();async function h(){for(;;){const c=await g_Api("GET","dialogs",{unread_first:a,offset:0,limit:20});t(0,s=c.results),s.map(d=>{var u,m,_;const b=(_=(u=d==null?void 0:d.last_message)==null?void 0:u.received_at)!=null?_:(m=d==null?void 0:d.lead)==null?void 0:m.date_joined;d._lastTime=b?+new Date(b):null}),await $t(1e3)}}return h(),[s,r,a,o,c=>{const d=u=>String(u).padStart(2,"0"),b=new Date;return c=new Date(c),c.getYear()===b.getYear()&&c.getMonth()===b.getMonth()?c.getDate()===b.getDate()?`${d(c.getHours())}:${d(c.getMinutes())}`:`${d(c.getDate())}d ${d(c.getHours())}:${d(c.getMinutes())}`:`${d(c.getDate())}.${d(c.getMonth())}.${c.getFullYear()}`},()=>t(2,a^=1)]}class Bn extends ue{constructor(e){super(),fe(this,e,Hn,$n,ie,{})}}function Pn(n){let e,t,l,s,r,i,o;return t=new Ln({}),s=new Bn({}),{c(){e=y("div"),se(t.$$.fragment),l=A(),se(s.$$.fragment),O(e,"class","pos_abs content flex svelte-116f09r"),J(e,"contentHideL__",n[1]!=="newLeads")},m(a,f){I(a,e,f),ee(t,e,null),g(e,l),ee(s,e,null),r=!0,i||(o=Ce(Qe.call(null,e)),i=!0)},p(a,f){(!r||f&2)&&J(e,"contentHideL__",a[1]!=="newLeads")},i(a){r||($(t.$$.fragment,a),$(s.$$.fragment,a),r=!0)},o(a){C(t.$$.fragment,a),C(s.$$.fragment,a),r=!1},d(a){a&&D(e),te(t),te(s),i=!1,o()}}}function Cn(n){let e,t;return e=new pn({}),{c(){se(e.$$.fragment)},m(l,s){ee(e,l,s),t=!0},p:z,i(l){t||($(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Fn(n){let e,t,l,s,r,i,o,a;function f(d){n[2](d)}let h={};n[1]!==void 0&&(h.select=n[1]),t=new un({props:h}),we.push(()=>Nt(t,"select",f));const v=[Cn,Pn],p=[];function c(d,b){return d[0]?1:0}return i=c(n),o=p[i]=v[i](n),{c(){e=y("main"),se(t.$$.fragment),s=A(),r=y("div"),o.c(),O(r,"class","flex flex_grow_1 pos_rel overhide"),O(e,"class","flex flex_clm svelte-116f09r")},m(d,b){I(d,e,b),ee(t,e,null),g(e,s),g(e,r),p[i].m(r,null),a=!0},p(d,[b]){const u={};!l&&b&2&&(l=!0,u.select=d[1],Dt(()=>l=!1)),t.$set(u);let m=i;i=c(d),i===m?p[i].p(d,b):(_e(),C(p[m],1,1,()=>{p[m]=null}),me(),o=p[i],o?o.p(d,b):(o=p[i]=v[i](d),o.c()),$(o,1),o.m(r,null))},i(d){a||($(t.$$.fragment,d),$(o),a=!0)},o(d){C(t.$$.fragment,d),C(o),a=!1},d(d){d&&D(e),te(t),p[i].d()}}}function Yn(){const n=u=>new Promise(m=>setTimeout(m,u)),e=()=>n(200+(Math.random()*200|0)),t={id:1};let l=0;const s={tg_id:123123124,username:"123124123",first_name:"test",last_name:"ewr",date_joined:"2022-10-27T13:48:51.054781Z",esub:"123123",pub_id:"2312",refcode:"123123",subpub:"23123"};let r=[];const i=u=>r.find(m=>String(m.tg_id)===String(u)),o=()=>{const u={...s};u.tg_id+=l,u.first_name+=" "+l,u.last_name+=" "+l,u.date_joined=new Date().toJSON(),u.username=[u.first_name,u.last_name].map(m=>m.trim()).filter(Boolean).join(" ").replace(/\s/g,"_"),l++,r.push(u)},a=()=>[...r],f=()=>a().filter(u=>!u.hasOperator),h=(u,m)=>{var w;const _=m.offset|0,k=Math.max(1,Math.min(1e6,((w=m.limit)!=null?w:20)|0)),x=u.length,L=u.slice(_).slice(0,k);return{count:x,results:L}},v={},p={};let c=1;Array(10).fill().map(o),setInterval(()=>{},2400),setInterval(()=>{},3e3),setInterval(()=>{const u=Object.keys(p),m=u[u.length*Math.random()|0],_=p[m];if(_){const k=_.length?0:1e5;for(let x=0;x<k;x++)_.push({id:c++,dialog:m,text:Math.random()<.5?"Hi. And short message "+(c-1)+" ...":"Hi. And long message "+(c-1)+" ..."+`
 Long!`.repeat(20),is_read:!1,incoming:!0,received_at:new Date().toJSON()})}},1e3);const d={},b=async(u,m,_={})=>{var M,E,B,Y,T;if(!location.hash.match(/real\-api/)){if(u==="GET"&&m==="operators")return await e(),{results:[{username:"stan18k",first_name:"Stanislav",last_name:"Kulakov"},{username:"dmodev",first_name:"Demon",last_name:"Dev"},{username:"idandrey",first_name:"Andrey",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer ".repeat(1e3),first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer ".repeat(1e3),first_name:"YEHA ".repeat(1e3),last_name:"D sf  ".repeat(1e3)}]};if(u==="GET"&&m==="leads/unassigned")return await e(),h(f(),_);if(u==="POST"&&/leads\/\d+\/assign/.test(m)){const S=(M=m.match(/leads\/(\d+)\/assign/))==null?void 0:M[1],N=d["x-username"];if(!S||!N)return!1;const V=i(S);if(!V||V.hasOperator)return!1;V.hasOperator=!0,t.id++;const ne={...t,lead_id:S,operator:N};return v[N]=(E=v[N])!=null?E:[],v[N].push(ne),p[ne.id]=[],!0}if(u==="GET"&&m==="dialogs"){const S=[...(B=v[d["x-username"]])!=null?B:[]].map(N=>({...N,lead:i(N.lead_id)}));return h(S,_)}if(u==="GET"&&m==="messages"){await e();const S=p[_.dialog_id]=(Y=p[_.dialog_id])!=null?Y:[];return h(S,_)}if(u==="POST"&&m==="messages")return p[_.dialog]=(T=p[_.dialog])!=null?T:[],p[_.dialog].push({id:c++,dialog:_.dialog,text:_.text,is_read:!!_.is_read,incoming:!1,received_at:new Date().toJSON()}),!0}const k="https://92.255.108.70/",x=new URL(k);u==="GET"&&Object.entries(_).map(([S,N])=>x.searchParams.append(S,N)),x.pathname=m+"/";let L;const w={...d};return u==="POST"&&(w["Content-Type"]="application/json",L=JSON.stringify(_)),await(await fetch(x,{method:u,headers:w,body:L})).json()};return b.setHeader=(u,m)=>d[u]=m,b}function Rn(n,e,t){let l;Me(n,je,o=>t(0,l=o));let s="operators";function r(o){o&&t(1,s="newLeads")}globalThis.g_Api=Yn();function i(o){s=o,t(1,s)}return n.$$.update=()=>{n.$$.dirty&1&&r(l)},[l,s,i]}class Wn extends ue{constructor(e){super(),fe(this,e,Rn,Fn,ie,{})}}new Wn({target:document.getElementById("app")});
