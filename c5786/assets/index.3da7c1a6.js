(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ae(){}const xt=l=>l;function Ht(l,e){for(const t in e)l[t]=e[t];return l}function Pl(l){return l()}function Gt(){return Object.create(null)}function je(l){l.forEach(Pl)}function He(l){return typeof l=="function"}function ge(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let ot;function Xe(l,e){return ot||(ot=document.createElement("a")),ot.href=e,l===ot.href}function nn(l){return Object.keys(l).length===0}function Et(l,...e){if(l==null)return ae;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ke(l,e,t){l.$$.on_destroy.push(Et(e,t))}function Ye(l,e,t){return l.set(t),e}function nt(l){return l&&He(l.destroy)?l.destroy:ae}const Rl=typeof window<"u";let Hl=Rl?()=>window.performance.now():()=>Date.now(),At=Rl?l=>requestAnimationFrame(l):ae;const Ze=new Set;function Gl(l){Ze.forEach(e=>{e.c(l)||(Ze.delete(e),e.f())}),Ze.size!==0&&At(Gl)}function zl(l){let e;return Ze.size===0&&At(Gl),{promise:new Promise(t=>{Ze.add(e={c:l,f:t})}),abort(){Ze.delete(e)}}}function m(l,e){l.appendChild(e)}function sn(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function rn(l,e){return m(l.head||l,e),e.sheet}function j(l,e,t){l.insertBefore(e,t||null)}function A(l){l.parentNode.removeChild(l)}function wt(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function b(l){return document.createElement(l)}function Ne(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function ie(l){return document.createTextNode(l)}function E(){return ie(" ")}function Je(){return ie("")}function le(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function v(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function on(l){return Array.from(l.childNodes)}function we(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function zt(l,e){l.value=e==null?"":e}function R(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function Z(l,e,t){l.classList[t?"add":"remove"](e)}function Ul(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const pt=new Map;let gt=0;function an(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function fn(l){const e={style_element:b("style"),rules:{}};return pt.set(l,e),e}function Ut(l,e,t,n,i,s,r,o=0){const a=16.666/n;let f=`{
`;for(let w=0;w<=1;w+=a){const S=e+(t-e)*s(w);f+=w*100+`%{${r(S,1-S)}}
`}const c=f+`100% {${r(t,1-t)}}
}`,_=`__svelte_${an(c)}_${o}`,g=sn(l),{style_element:u,rules:d}=pt.get(g)||fn(g);if(!d[_]){const w=rn(g,u);d[_]=!0,w.insertRule(`@keyframes ${_} ${c}`,w.cssRules.length)}const p=l.style.animation||"";return l.style.animation=`${p?`${p}, `:""}${_} ${n}ms linear ${i}ms 1 both`,gt+=1,_}function cn(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),gt-=i,gt||un())}function un(){At(()=>{gt||(pt.forEach(l=>{const{style_element:e}=l;A(e)}),pt.clear())})}let lt;function et(l){lt=l}function jt(){if(!lt)throw new Error("Function called outside component initialization");return lt}function dn(l){jt().$$.on_mount.push(l)}function Pe(l){jt().$$.on_destroy.push(l)}function _n(){const l=jt();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=Ul(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function mn(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const $e=[],Re=[],_t=[],Mt=[],pn=Promise.resolve();let Tt=!1;function gn(){Tt||(Tt=!0,pn.then(ql))}function xe(l){_t.push(l)}function ht(l){Mt.push(l)}const St=new Set;let at=0;function ql(){const l=lt;do{for(;at<$e.length;){const e=$e[at];at++,et(e),hn(e.$$)}for(et(null),$e.length=0,at=0;Re.length;)Re.pop()();for(let e=0;e<_t.length;e+=1){const t=_t[e];St.has(t)||(St.add(t),t())}_t.length=0}while($e.length);for(;Mt.length;)Mt.pop()();Tt=!1,St.clear(),et(l)}function hn(l){if(l.fragment!==null){l.update(),je(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(xe)}}let Qe;function vn(){return Qe||(Qe=Promise.resolve(),Qe.then(()=>{Qe=null})),Qe}function Lt(l,e,t){l.dispatchEvent(Ul(`${e?"intro":"outro"}${t}`))}const mt=new Set;let qe;function Se(){qe={r:0,c:[],p:qe}}function Le(){qe.r||je(qe.c),qe=qe.p}function P(l,e){l&&l.i&&(mt.delete(l),l.i(e))}function U(l,e,t,n){if(l&&l.o){if(mt.has(l))return;mt.add(l),qe.c.push(()=>{mt.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const bn={duration:0};function ye(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,a=null;function f(){a&&cn(l,a)}function c(g,u){const d=g.b-s;return u*=Math.abs(d),{a:s,b:g.b,d,duration:u,start:g.start,end:g.start+u,group:g.group}}function _(g){const{delay:u=0,duration:d=300,easing:p=xt,tick:w=ae,css:S}=i||bn,h={start:Hl()+u,b:g};g||(h.group=qe,qe.r+=1),r||o?o=h:(S&&(f(),a=Ut(l,s,g,d,u,p,S)),g&&w(0,1),r=c(h,d),xe(()=>Lt(l,g,"start")),zl(y=>{if(o&&y>o.start&&(r=c(o,d),o=null,Lt(l,r.b,"start"),S&&(f(),a=Ut(l,s,r.b,r.duration,0,p,i.css))),r){if(y>=r.end)w(s=r.b,1-s),Lt(l,r.b,"end"),o||(r.b?f():--r.group.r||je(r.group.c)),r=null;else if(y>=r.start){const T=y-r.start;s=r.a+r.d*p(T/r.duration),w(s,1-s)}}return!!(r||o)}))}return{run(g){He(i)?vn().then(()=>{i=i(),_(g)}):_(g)},end(){f(),r=o=null}}}const wn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function yn(l,e){l.d(1),e.delete(l.key)}function yt(l,e){U(l,1,1,()=>{e.delete(l.key)})}function st(l,e,t,n,i,s,r,o,a,f,c,_){let g=l.length,u=s.length,d=g;const p={};for(;d--;)p[l[d].key]=d;const w=[],S=new Map,h=new Map;for(d=u;d--;){const L=_(i,s,d),C=t(L);let O=r.get(C);O?n&&O.p(L,e):(O=f(C,L),O.c()),S.set(C,w[d]=O),C in p&&h.set(C,Math.abs(d-p[C]))}const y=new Set,T=new Set;function D(L){P(L,1),L.m(o,c),r.set(L.key,L),c=L.first,u--}for(;g&&u;){const L=w[u-1],C=l[g-1],O=L.key,x=C.key;L===C?(c=L.first,g--,u--):S.has(x)?!r.has(O)||y.has(O)?D(L):T.has(x)?g--:h.get(O)>h.get(x)?(T.add(O),D(L)):(y.add(x),g--):(a(C,r),g--)}for(;g--;){const L=l[g];S.has(L.key)||a(L,r)}for(;u;)D(w[u-1]);return w}function vt(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function pe(l){l&&l.c()}function de(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||xe(()=>{const a=s.map(Pl).filter(He);r?r.push(...a):je(a),l.$$.on_mount=[]}),o.forEach(xe)}function _e(l,e){const t=l.$$;t.fragment!==null&&(je(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function kn(l,e){l.$$.dirty[0]===-1&&($e.push(l),gn(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function he(l,e,t,n,i,s,r,o=[-1]){const a=lt;et(l);const f=l.$$={fragment:null,ctx:null,props:s,update:ae,not_equal:i,bound:Gt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Gt(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(f.root);let c=!1;if(f.ctx=t?t(l,e.props||{},(_,g,...u)=>{const d=u.length?u[0]:g;return f.ctx&&i(f.ctx[_],f.ctx[_]=d)&&(!f.skip_bound&&f.bound[_]&&f.bound[_](d),c&&kn(l,_)),g}):[],f.update(),c=!0,je(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const _=on(e.target);f.fragment&&f.fragment.l(_),_.forEach(A)}else f.fragment&&f.fragment.c();e.intro&&P(l.$$.fragment),de(l,e.target,e.anchor,e.customElement),ql()}et(a)}class ve{$destroy(){_e(this,1),this.$destroy=ae}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!nn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Yl(l){const e=l-1;return e*e*e+1}function Oe(l,{delay:e=0,duration:t=400,easing:n=xt}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function qt(l,{delay:e=0,duration:t=400,easing:n=Yl}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),_=parseFloat(i.borderTopWidth),g=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*s};height: ${u*r}px;padding-top: ${u*o}px;padding-bottom: ${u*a}px;margin-top: ${u*f}px;margin-bottom: ${u*c}px;border-top-width: ${u*_}px;border-bottom-width: ${u*g}px;`}}const Ke=[];function Ge(l,e=ae){let t;const n=new Set;function i(o){if(ge(l,o)&&(l=o,t)){const a=!Ke.length;for(const f of n)f[1](),Ke.push(f,l);if(a){for(let f=0;f<Ke.length;f+=2)Ke[f][0](Ke[f+1]);Ke.length=0}}}function s(o){i(o(l))}function r(o,a=ae){const f=[o,a];return n.add(f),n.size===1&&(t=e(i)||ae),o(l),()=>{n.delete(f),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const tt=()=>{},Ot=l=>new Promise(e=>setTimeout(e,l)),Fe=(l,e,t)=>Math.min(t,Math.max(l,e)),Nt=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),Dt=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,a)=>Dt(o,e[a]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,a])=>!(!r.has(o)||!Dt(a,r.get(o))))}catch{}return!1},Sn=l=>{let e=!1,t=[];const n=async i=>{e=!0;let s,r,o;try{s=await l()}catch(a){o=!0,r=a}if(i.map(a=>{o&&a.reject(r),a.resolve(s)}),t.length){const a=t;return t=[],n(a)}e=!1};return()=>{const i=Nt();return e?t.push(i):(e=!0,n([i])),i.promise}},Ln=l=>{const e=Nt();return setTimeout(e.resolve,l),e},Mn=Symbol("RangeLoadList_ItemLastUpdateTime"),Tn=l=>{var q,Q,$,ne;const e=Fe(1,((q=l.updateInterval)!=null?q:1e3)|0,36e5),t=Fe(1,((Q=l.maxLimit)!=null?Q:50)|0,1e3);let n=l.fLoad;const i=($=l.onUpdateItem)!=null?$:tt,s=(ne=l.onUpdateItemList)!=null?ne:tt,r=!!l.isLoadEnd,o=Mn,a={},f=Ge(null),c={subscribe:f.subscribe};let _=0,g=t,u=null;const d=F=>n=F,p=async(F,V)=>{try{const H=await n({offset:F,limit:V});if(typeof H.count=="number"&&Array.isArray(H.results))return H}catch{}return null},w=async(F,V)=>{const H=await p(F,V);if(H){const I=H.results,se=Math.max(0,H.count|0),B=u!==se,z=Date.now();u=se;const Y=[];for(let te=0,oe=F;te<I.length&&oe<u;te++,oe++){const Me=I[te];a[oe]!==void 0&&Dt(a[oe],Me)||(Me[o]=z,a[oe]=Me,i(Me),Y.push(Me))}Y.length&&s(Y),(B||Y.length)&&f.set({total:u,list:a})}},S=async F=>{const V=[];V.push(w(_,g)),u!==null&&_+g<u&&r&&V.push(w(u,t)),await Promise.all(V),u!==null&&_+g<u&&r&&F&&await w(u,t)};let h=!1,y=!0,T,D=1;return(async()=>{let F=0;for(;y;){for(;y&&!h;){const V=D;if(await S(F++===0),V===D)break}T=Ln(e),await T.promise}})(),{setFLoad:d,update:()=>{D++,T&&T.resolve()},setRange:(F,V)=>{_=Math.max(0,F|0),g=Fe(0,V|0,t)},destroy:()=>y=!1,getData_r:()=>c,symbolUpdateTime:o,pause:()=>h=!0,resume:()=>h=!1}},On=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},it=(l,e,t=!0)=>{let n=!0;return(async()=>{for(t&&await Ot(l);n;){try{await e()}catch(i){console.error("setIntervalAwait error",i)}await Ot(l)}})(),()=>n=!1},Wl=()=>{let l=new Map;try{l=new Map([...new URLSearchParams(location.hash.replace(/^\#/,""))])}catch{}return l},Ft=()=>{const l={};return{on:(n,i)=>{var o;const s={event:n,cb:i},r=l[n]=(o=l[n])!=null?o:[];return r.push(s),()=>{const a=r.findIndex(f=>f===s);a!==-1&&r.splice(a,1)}},emit:(n,...i)=>{var s;return((s=l[n])!=null?s:[]).map(r=>r.cb(...i))}}},Jl=(l,e="file-")=>{const t=document.createElement("a");t.href=l;const n=e+t.pathname.split(/[^a-zA-Z0-9\.\-_]/).pop();t.download=n,t.target="blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},It=l=>Jl(l,"image-"),Dn=l=>{try{if(typeof l.message=="string")return l.message}catch{}return""},bt=Ge(null),Vl=bt.set,ft=(l,e)=>{const{subscribe:t,set:n,update:i}=Ge(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},In=(l,e)=>{const{subscribe:t,set:n,update:i}=Ge(l);return[{subscribe:t},i]},Cn=l=>parseInt(l.id);function xn(l,e,t){var se;const n={},i={...e};Object.assign(n,{appConfig:i}),Object.assign(n,{api:t});const s=Ft();Object.assign(n,{events:s});const r=[],o=B=>r.push(B);Object.assign(n,{destroy:()=>r.map(B=>B())});const f=l,[c]=ft(f),[_,g]=ft(null);let u=0;const[d,p]=ft(u),w=Sn(t.operatorSelf_GetOnlineInfo),S=async()=>{p(++u);const B=await w();return B&&g(B),p(--u),B};Object.assign(n,{operatorSelf_r:c,operatorSelfLastOnlineInfo_r:_,operatorSelfLastOnlineInfo_Update:S,operatorSelfLastOnline_SetOnlineFlag:async B=>{p(++u);const z=await t.operatorSelf_SetOnlineFlag(B);return z&&g(z),p(--u),z},operatorSelfLastOnlineInfoLoading_r:d});const y=Object.create(null),[T,D]=In(y),L=B=>{!B.length||D(z=>{for(const Y of B)z[Cn(Y)]=Y;return z})},C=B=>L([B]),[O,x]=ft(null);Object.assign(n,{dialogMap_r:T,dialogMap_SetDialogList:L,dialogMap_SetDialog:C,dialogActiveID_r:O,dialogActiveID_Set:x});const G=Object.fromEntries(i==null?void 0:i.lead_StatusList.map(B=>[B.id,B])),J=Object.entries((se=i==null?void 0:i.lead_StatusJumpMap)!=null?se:{}).reduce((B,[z,Y])=>(Y.map(te=>{var oe;return(B[te]=(oe=B[te])!=null?oe:[]).push(z)}),B),{}),re=B=>{var Y,te,oe;const z=V(B);return{id:B,title:(Y=z==null?void 0:z.title)!=null?Y:z!=null&&z.id?`#${z==null?void 0:z.id}`:"*UNK*",bgColor:(te=z==null?void 0:z.bgColor)!=null?te:"#000",color:(oe=z==null?void 0:z.color)!=null?oe:"#fff"}},q=B=>re(B==null?void 0:B.status),Q=B=>{var z;try{return(z=i.lead_StatusGetID(B))!=null?z:null}catch{}return null},$=(B,z)=>{var Y;try{return(Y=i.lead_StatusPrevIDResolve(B,z))!=null?Y:null}catch{}return null},ne=(B,z)=>{try{const Y=J==null?void 0:J[B],te=(Y==null?void 0:Y.length)===1?Y==null?void 0:Y[0]:(Y==null?void 0:Y.length)>1?$(B,z):null,oe=G==null?void 0:G[te];return oe&&!(oe!=null&&oe.stopPrevSearch)?te:null}catch{}return null},F=B=>{let z=Q(B);const Y=[z];for(;z=ne(z,B),B=null,!!z;)Y.unshift(z);return Y.map(re).filter(Boolean)},V=B=>{var z,Y;return(Y=((z=e==null?void 0:e.lead_StatusList)!=null?z:[]).find(te=>te.id===B))!=null?Y:null};return Object.assign(n,{lead_GetStatusOrDefault:q,lead_GetStatusByID:V,lead_GetStatusTitle:B=>{var z,Y;return(Y=(z=V(B))==null?void 0:z.title)!=null?Y:B},lead_GetStatusList:B=>{var z;return((z=e==null?void 0:e.lead_StatusList)!=null?z:[]).filter(Y=>Y.access==="user").filter(Y=>Y.id!==B).filter(Y=>Y.id!=="DL")},lead_GetStatusID:Q,lead_StatusPrevIDResolve:$,lead_GetStatusPrevID:ne,lead_GetStatusHistory:F}),o(it(e.updateIntervals.sync_online_info,S,!1)),Object.freeze(n),n}function Yt(l){let e,t,n;return{c(){e=b("div"),e.textContent="Operators",v(e,"class","item cursor_ptr svelte-vbcb9r"),Z(e,"active",l[0]==="operators"),Z(e,"disabled",l[1].has("operators"))},m(i,s){j(i,e,s),t||(n=le(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&Z(e,"active",i[0]==="operators"),s&2&&Z(e,"disabled",i[1].has("operators"))},d(i){i&&A(e),t=!1,n()}}}function Wt(l){let e,t=l[2].username+"",n,i,s;return{c(){e=b("div"),n=ie(t),v(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),R(e,"max-width","200px")},m(r,o){j(r,e,o),m(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&we(n,t)},i(r){s||(xe(()=>{i||(i=ye(e,Oe,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=ye(e,Oe,{},!1)),i.run(0),s=!1},d(r){r&&A(e),r&&i&&i.end()}}}function En(l){let e,t,n,i,s,r,o=!l[2]&&Yt(l),a=l[2]&&0,f=l[2]&&Wt(l);return{c(){e=b("div"),o&&o.c(),t=E(),a&&a.c(),n=E(),i=b("div"),s=E(),f&&f.c(),v(i,"class","flex flex_grow_1"),v(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(c,_){j(c,e,_),o&&o.m(e,null),m(e,t),a&&a.m(e,null),m(e,n),m(e,i),m(e,s),f&&f.m(e,null),r=!0},p(c,[_]){c[2]?o&&(o.d(1),o=null):o?o.p(c,_):(o=Yt(c),o.c(),o.m(e,t)),c[2],a&&(a.d(1),a=null),c[2]?f?(f.p(c,_),_&4&&P(f,1)):(f=Wt(c),f.c(),P(f,1),f.m(e,null)):f&&(Se(),U(f,1,1,()=>{f=null}),Le())},i(c){r||(P(f),r=!0)},o(c){U(f),r=!1},d(c){c&&A(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function An(l,e,t){let n;ke(l,bt,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>a=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class jn extends ve{constructor(e){super(),he(this,e,An,En,ge,{select:0,disabled:1})}}function Jt(l,e,t){const n=l.slice();return n[4]=e[t],n}function Vt(l,e,t){const n=l.slice();return n[7]=e[t],n}function Xt(l){let e,t=l[7].text+"",n,i;return{c(){e=b("div"),n=ie(t),i=ie("\xA0"),v(e,"class","text svelte-13s1vua"),R(e,"color",l[7].color)},m(s,r){j(s,e,r),m(e,n),j(s,i,r)},p(s,r){r&2&&t!==(t=s[7].text+"")&&we(n,t),r&2&&R(e,"color",s[7].color)},d(s){s&&A(e),s&&A(i)}}}function Kt(l){let e,t,n=l[4].chunks,i=[];for(let s=0;s<n.length;s+=1)i[s]=Xt(Vt(l,n,s));return{c(){e=b("div");for(let s=0;s<i.length;s+=1)i[s].c();t=E(),v(e,"class","flex flex_cy line svelte-13s1vua"),Z(e,"mini",l[4].type==="mini")},m(s,r){j(s,e,r);for(let o=0;o<i.length;o+=1)i[o].m(e,null);m(e,t)},p(s,r){if(r&2){n=s[4].chunks;let o;for(o=0;o<n.length;o+=1){const a=Vt(s,n,o);i[o]?i[o].p(a,r):(i[o]=Xt(a),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}r&2&&Z(e,"mini",s[4].type==="mini")},d(s){s&&A(e),wt(i,s)}}}function Nn(l){let e,t,n,i=l[1],s=[];for(let r=0;r<i.length;r+=1)s[r]=Kt(Jt(l,i,r));return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();v(e,"class","flex flex_clm notify svelte-13s1vua"),Z(e,"normal",l[0]==="normal"),Z(e,"error",l[0]==="error"),Z(e,"debug",l[0]==="debug")},m(r,o){j(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,[o]){if(o&2){i=r[1];let a;for(a=0;a<i.length;a+=1){const f=Jt(r,i,a);s[a]?s[a].p(f,o):(s[a]=Kt(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}(!n||o&1)&&Z(e,"normal",r[0]==="normal"),(!n||o&1)&&Z(e,"error",r[0]==="error"),(!n||o&1)&&Z(e,"debug",r[0]==="debug")},i(r){n||(r&&xe(()=>{t||(t=ye(e,qt,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=ye(e,qt,{},!1)),t.run(0)),n=!1},d(r){r&&A(e),wt(s,r),r&&t&&t.end()}}}function Fn(l,e,t){let{notify:n}=e,i="normal",s=[];const r=()=>{t(0,i=n==null?void 0:n.type),t(1,s=[]),Array.isArray(n==null?void 0:n.data)&&t(1,s=n.data.filter(Boolean).map(o=>{let a="normal",f=[];return typeof o=="string"?f.push({color:"#fff",text:o}):(a=o.type,f=o.chunks?o.chunks:[{color:"#fff",text:o.text}]),f=f.filter(c=>c.text),{type:a,chunks:f}}).filter(o=>o.chunks.length))};return l.$$set=o=>{"notify"in o&&t(2,n=o.notify)},l.$$.update=()=>{l.$$.dirty&4&&r()},[i,s,n]}class Bn extends ve{constructor(e){super(),he(this,e,Fn,Nn,ge,{notify:2})}}function Zt(l,e,t){const n=l.slice();return n[4]=e[t],n}function Qt(l,e){let t,n,i;return n=new Bn({props:{notify:e[4]}}),{key:l,first:null,c(){t=Je(),pe(n.$$.fragment),this.first=t},m(s,r){j(s,t,r),de(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.notify=e[4]),n.$set(o)},i(s){i||(P(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&A(t),_e(n,s)}}}function Pn(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[4].id;for(let o=0;o<s.length;o+=1){let a=Zt(l,s,o),f=r(a);n.set(f,t[o]=Qt(f,a))}return{c(){e=b("div");for(let o=0;o<t.length;o+=1)t[o].c();v(e,"class","pos_abs notify_list svelte-11tn2wf")},m(o,a){j(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],Se(),t=st(t,a,r,1,o,s,n,e,yt,Qt,null,Zt),Le())},i(o){if(!i){for(let a=0;a<s.length;a+=1)P(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)U(t[a]);i=!1},d(o){o&&A(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}const Rn=5e3;function Hn(l,e,t){let{events:n=Ft()}=e,i=1,s=[];const r=o=>a=>{s.push({id:i++,time:Date.now(),type:o,data:a}),t(0,s)};return Pe(it(1e3,()=>{const o=Date.now(),a=s.filter(f=>f.time+Rn>=o);a.length!==s.length&&t(0,s=a)})),Pe(n.on("error",r("error"))),Wl().has("debug")&&Pe(n.on("debug",r("debug"))),l.$$set=o=>{"events"in o&&t(1,n=o.events)},[s,n]}class Gn extends ve{constructor(e){super(),he(this,e,Hn,Pn,ge,{events:1})}}function $t(l){return Object.prototype.toString.call(l)==="[object Date]"}function Ct(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>Ct(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if($t(l)&&$t(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=Ct(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function We(l,e={}){const t=Ge(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let a=n,f=!1,{delay:c=0,duration:_=400,easing:g=xt,interpolate:u=Ct}=Ht(Ht({},e),o);if(_===0)return a&&(a.abort(),a=null),t.set(l=i),Promise.resolve();const d=Hl()+c;let p;return n=zl(w=>{if(w<d)return!0;f||(p=u(l,r),typeof _=="function"&&(_=_(l,r)),f=!0),a&&(a.abort(),a=null);const S=w-d;return S>_?(t.set(l=r),!1):(t.set(l=p(g(S/_))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}function zn(l){let e,t,n,i,s,r,o,a,f;return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=E(),o=b("div"),a=E(),f=b("div"),v(n,"class","pos_abs s1 svelte-fxby3d"),v(s,"class","pos_abs s2 svelte-fxby3d"),v(o,"class","pos_abs s3 svelte-fxby3d"),v(f,"class","pos_abs s4 svelte-fxby3d"),v(t,"class","flex pos_rel ellipsis svelte-fxby3d"),R(t,"transform","scale("+l[1]+")"),v(e,"class","flex"),R(e,"height",l[0]+"px"),R(e,"width",l[2]+"px")},m(c,_){j(c,e,_),m(e,t),m(t,n),m(t,i),m(t,s),m(t,r),m(t,o),m(t,a),m(t,f)},p(c,[_]){_&2&&R(t,"transform","scale("+c[1]+")"),_&1&&R(e,"height",c[0]+"px"),_&4&&R(e,"width",c[2]+"px")},i:ae,o:ae,d(c){c&&A(e)}}}function Un(l,e,t){let n,i,{height:s=5}=e;return l.$$set=r=>{"height"in r&&t(0,s=r.height)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=s/.1625),l.$$.dirty&1&&t(1,i=s/13)},[s,i,n]}class Xl extends ve{constructor(e){super(),he(this,e,Un,zn,ge,{height:0})}}function el(l){let e,t,n,i;return t=new Xl({props:{height:6}}),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","flex pos_abs loading svelte-15wz55f")},m(s,r){j(s,e,r),de(t,e,null),i=!0},i(s){i||(P(t.$$.fragment,s),s&&xe(()=>{n||(n=ye(e,Oe,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=ye(e,Oe,{},!1)),n.run(0)),i=!1},d(s){s&&A(e),_e(t),s&&n&&n.end()}}}function qn(l){let e,t,n,i,s,r,o,a,f,c,_,g,u,d=l[0]&&el();return{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),i.textContent="offline",s=E(),r=b("div"),o=ie(`online\r
		`),a=b("div"),f=ie(l[2]),c=E(),d&&d.c(),v(t,"class","pos_abs h100 onlineProgressTrumb svelte-15wz55f"),R(t,"width",l[1]+"%"),v(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-15wz55f"),Z(i,"hideR",l[1]>=1),v(a,"class","pos_abs onlineProgressTrumbLastTime svelte-15wz55f"),v(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-15wz55f"),Z(r,"hideL",l[1]<1),v(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-15wz55f")},m(p,w){j(p,e,w),m(e,t),m(e,n),m(e,i),m(e,s),m(e,r),m(r,o),m(r,a),m(a,f),m(e,c),d&&d.m(e,null),_=!0,g||(u=le(e,"click",l[8]),g=!0)},p(p,[w]){(!_||w&2)&&R(t,"width",p[1]+"%"),(!_||w&2)&&Z(i,"hideR",p[1]>=1),(!_||w&4)&&we(f,p[2]),(!_||w&2)&&Z(r,"hideL",p[1]<1),p[0]?d?w&1&&P(d,1):(d=el(),d.c(),P(d,1),d.m(e,null)):d&&(Se(),U(d,1,1,()=>{d=null}),Le())},i(p){_||(P(d),_=!0)},o(p){U(d),_=!1},d(p){p&&A(e),d&&d.d(),g=!1,u()}}}function Yn(l,e,t){let n,i,s,{endTime:r=0}=e,{intervalTime:o=1}=e,{loading:a=!1}=e;const f=We(0);ke(l,f,d=>t(7,s=d));let c=0;function _(){const d=Math.max(0,r-Date.now());t(1,c=Math.floor(Fe(0,d/o,1)*100)),Ye(f,s=Math.ceil(d/1e3),s)}Pe(it(1e3,_));const g=d=>{const p=Math.floor(d%60);d/=60;const w=Math.floor(d%60);d/=60;const S=Math.floor(d),h=[];return(h.length||S)&&h.push(`${String(S).padStart(h.length?2:1,"0")}h`),(h.length||w)&&h.push(`${String(w).padStart(h.length?2:1,"0")}m`),(h.length||p)&&h.push(`${String(p).padStart(h.length?2:1,"0")}s`),h.join(" ")};function u(d){mn.call(this,l,d)}return l.$$set=d=>{"endTime"in d&&t(4,r=d.endTime),"intervalTime"in d&&t(5,o=d.intervalTime),"loading"in d&&t(0,a=d.loading)},l.$$.update=()=>{l.$$.dirty&128&&t(6,n=Math.ceil(s)),l.$$.dirty&64&&t(2,i=g(n))},[a,c,i,f,r,o,n,s,u]}class Wn extends ve{constructor(e){super(),he(this,e,Yn,qn,ge,{endTime:4,intervalTime:5,loading:0})}}function Jn(l){let e;return{c(){e=ie("\xA0")},m(t,n){j(t,e,n)},p:ae,d(t){t&&A(e)}}}function Vn(l){let e,t=l[2].username+"",n;return{c(){e=ie("@"),n=ie(t)},m(i,s){j(i,e,s),j(i,n,s)},p(i,s){s&4&&t!==(t=i[2].username+"")&&we(n,t)},d(i){i&&A(e),i&&A(n)}}}function Xn(l){var Q,$;let e,t,n,i,s=((Q=l[2].first_name)!=null?Q:"")+"",r,o,a,f,c,_=(($=l[2].last_name)!=null?$:"")+"",g,u,d,p,w,S,h,y,T,D,L,C,O,x,G;function J(ne,F){return ne[2].username?Vn:Jn}let re=J(l),q=re(l);return D=new Wn({props:{intervalTime:l[1],endTime:l[0],loading:l[3]}}),D.$on("click",l[8]),{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),r=ie(s),o=E(),a=b("div"),f=E(),c=b("div"),g=ie(_),u=ie("\xA0"),d=E(),p=b("div"),q.c(),w=E(),S=b("div"),S.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',h=E(),y=b("div"),T=E(),pe(D.$$.fragment),L=E(),C=b("div"),R(a,"width","8px"),v(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),v(p,"class","nowrap textOverEllipsis username svelte-1qt21qp"),v(S,"class","pos_abs btnLogout svelte-1qt21qp"),v(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),R(y,"height","8px"),R(C,"height","8px"),v(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(ne,F){j(ne,e,F),m(e,t),m(t,n),m(n,i),m(i,r),m(n,o),m(n,a),m(n,f),m(n,c),m(c,g),m(c,u),m(t,d),m(t,p),q.m(p,null),m(t,w),m(t,S),m(e,h),m(e,y),m(e,T),de(D,e,null),m(e,L),m(e,C),O=!0,x||(G=le(S,"click",l[7]),x=!0)},p(ne,[F]){var H,I;(!O||F&4)&&s!==(s=((H=ne[2].first_name)!=null?H:"")+"")&&we(r,s),(!O||F&4)&&_!==(_=((I=ne[2].last_name)!=null?I:"")+"")&&we(g,_),re===(re=J(ne))&&q?q.p(ne,F):(q.d(1),q=re(ne),q&&(q.c(),q.m(p,null)));const V={};F&2&&(V.intervalTime=ne[1]),F&1&&(V.endTime=ne[0]),F&8&&(V.loading=ne[3]),D.$set(V)},i(ne){O||(P(D.$$.fragment,ne),O=!0)},o(ne){U(D.$$.fragment,ne),O=!1},d(ne){ne&&A(e),q.d(),_e(D),x=!1,G()}}}function Kn(l,e,t){let n,i,s,{app:r}=e;const{operatorSelf_r:o,operatorSelfLastOnlineInfo_r:a,operatorSelfLastOnlineInfoLoading_r:f,operatorSelfLastOnline_SetOnlineFlag:c}=r;ke(l,o,S=>t(2,i=S)),ke(l,a,S=>t(10,n=S)),ke(l,f,S=>t(3,s=S));const _=()=>Vl(null);let g=0,u=1;const d=S=>{if(!S){t(0,g=0),t(1,u=1);return}t(0,g=+new Date(S.offline_at)),t(1,u=Fe(1,(S.interval|0)*1e3,1e9))};let p=!1;const w=async()=>{var S;!((S=r.appConfig)!=null&&S.operatorSelf_CanSetOnline)||p||(p=!0,await c(!0),p=!1)};return l.$$set=S=>{"app"in S&&t(9,r=S.app)},l.$$.update=()=>{l.$$.dirty&1024&&d(n)},[g,u,i,s,o,a,f,_,w,r,n]}class Zn extends ve{constructor(e){super(),he(this,e,Kn,Xn,ge,{app:9})}}const kt=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{i&&setTimeout(s,10);const o=l.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||n!==a.height)&&(t=a.width,n=a.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(a))}};return s(),{destroy:()=>i=!1}},Qn=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{r&&setTimeout(o,10);const f=l.getBoundingClientRect();(t!==f.width||n!==f.height||i!==f.x||s!==f.y)&&(t=f.width,n=f.height,i=f.x,s=f.y,e&&e.set(f))};return o(),{destroy:()=>r=!1}};function $n(l){let e,t,n,i,s,r,o,a,f,c,_,g,u,d,p,w,S;return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=E(),o=b("div"),a=E(),f=b("div"),c=E(),_=b("div"),g=E(),u=b("div"),d=E(),p=b("div"),w=E(),S=b("div"),v(n,"class","svelte-1lltvmx"),v(s,"class","svelte-1lltvmx"),v(o,"class","svelte-1lltvmx"),v(f,"class","svelte-1lltvmx"),v(_,"class","svelte-1lltvmx"),v(u,"class","svelte-1lltvmx"),v(p,"class","svelte-1lltvmx"),v(S,"class","svelte-1lltvmx"),v(t,"class","lds-roller svelte-1lltvmx"),R(t,"transform","scale("+l[2]+")"),R(t,"--loadingItemColor",l[1]),v(e,"class","flex"),R(e,"height",l[0]+"px"),R(e,"width",l[0]+"px")},m(h,y){j(h,e,y),m(e,t),m(t,n),m(t,i),m(t,s),m(t,r),m(t,o),m(t,a),m(t,f),m(t,c),m(t,_),m(t,g),m(t,u),m(t,d),m(t,p),m(t,w),m(t,S)},p(h,[y]){y&4&&R(t,"transform","scale("+h[2]+")"),y&2&&R(t,"--loadingItemColor",h[1]),y&1&&R(e,"height",h[0]+"px"),y&1&&R(e,"width",h[0]+"px")},i:ae,o:ae,d(h){h&&A(e)}}}function es(l,e,t){let n,{size:i=80}=e,{color:s="#000"}=e;return l.$$set=r=>{"size"in r&&t(0,i=r.size),"color"in r&&t(1,s=r.color)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=i/80)},[i,s,n]}class Kl extends ve{constructor(e){super(),he(this,e,es,$n,ge,{size:0,color:1})}}function tl(l){let e,t,n,i;return t=new Kl({props:{color:"#fff",size:"32"}}),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","pos_abs loading svelte-1r93skw")},m(s,r){j(s,e,r),de(t,e,null),i=!0},i(s){i||(P(t.$$.fragment,s),s&&xe(()=>{n||(n=ye(e,Oe,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=ye(e,Oe,{},!1)),n.run(0)),i=!1},d(s){s&&A(e),_e(t),s&&n&&n.end()}}}function ll(l){let e,t,n,i;return t=new Kl({props:{color:"#fff",size:"24"}}),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","pos_abs flex flex_cy h100 loading svelte-1r93skw")},m(s,r){j(s,e,r),de(t,e,null),i=!0},i(s){i||(P(t.$$.fragment,s),s&&xe(()=>{n||(n=ye(e,Oe,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=ye(e,Oe,{},!1)),n.run(0)),i=!1},d(s){s&&A(e),_e(t),s&&n&&n.end()}}}function ts(l){var T;let e,t,n,i,s,r,o,a=((T=l[0])!=null?T:0)+"",f,c,_,g,u,d,p,w,S,h=l[1]&&tl(),y=l[2]&&ll();return{c(){e=b("div"),t=b("div"),n=b("div"),n.textContent="New leads",i=E(),h&&h.c(),s=E(),r=b("div"),o=b("div"),f=ie(a),c=E(),_=b("div"),g=E(),u=b("div"),y&&y.c(),d=ie(`\r
		Get one`),v(n,"class","flex mainLabel svelte-1r93skw"),v(o,"class","flex labelCountNum svelte-1r93skw"),v(r,"class","flex flex_cx flex_cy labelCount svelte-1r93skw"),v(t,"class","flex flex_cx flex_cy flex_clm header pos_rel w100 svelte-1r93skw"),R(_,"height","4px"),v(u,"class","flex flex_cx flex_cy cursor_ptr noselect pos_rel bntMain svelte-1r93skw"),Z(u,"disabled",!l[0]&&!l[2]&&!l[3]),Z(u,"btnLoading",l[2]),Z(u,"animationDone",l[3]==="done"),Z(u,"animationFail",l[3]==="fail"),v(e,"class","flex flex_clm wrapMain flex_grow_1 w100 unselect svelte-1r93skw")},m(D,L){j(D,e,L),m(e,t),m(t,n),m(t,i),h&&h.m(t,null),m(t,s),m(t,r),m(r,o),m(o,f),m(e,c),m(e,_),m(e,g),m(e,u),y&&y.m(u,null),m(u,d),p=!0,w||(S=le(u,"click",l[4]),w=!0)},p(D,[L]){var C;D[1]?h?L&2&&P(h,1):(h=tl(),h.c(),P(h,1),h.m(t,s)):h&&(Se(),U(h,1,1,()=>{h=null}),Le()),(!p||L&1)&&a!==(a=((C=D[0])!=null?C:0)+"")&&we(f,a),D[2]?y?L&4&&P(y,1):(y=ll(),y.c(),P(y,1),y.m(u,d)):y&&(Se(),U(y,1,1,()=>{y=null}),Le()),(!p||L&13)&&Z(u,"disabled",!D[0]&&!D[2]&&!D[3]),(!p||L&4)&&Z(u,"btnLoading",D[2]),(!p||L&8)&&Z(u,"animationDone",D[3]==="done"),(!p||L&8)&&Z(u,"animationFail",D[3]==="fail")},i(D){p||(P(h),P(y),p=!0)},o(D){U(h),U(y),p=!1},d(D){D&&A(e),h&&h.d(),y&&y.d(),w=!1,S()}}}function ls(l,e,t){var f,c;let{app:n}=e,i=0,s=!0,r=!1,o=null;const a=async()=>{if(r||o||!i)return;t(2,r=!0);const _=await n.api.lead_AssignOneLead();t(2,r=!1),t(3,o=_?"done":"fail"),await Ot(1e3),t(3,o=null)};return Pe(it(Fe(100,((c=(f=n==null?void 0:n.appConfig)==null?void 0:f.updateIntervals)==null?void 0:c.new_leads_count)|0,36e5),async()=>{var _;t(0,i=((_=await n.api.lead_GetUnassignedLeadCount())==null?void 0:_.count)|0),t(1,s=!1)},!1)),l.$$set=_=>{"app"in _&&t(5,n=_.app)},[i,s,r,o,a,n]}class ns extends ve{constructor(e){super(),he(this,e,ls,ts,ge,{app:5})}}function ss(l){let e,t,n,i,s,r,o,a,f,c,_,g,u,d,p,w,S,h;return{c(){e=b("label"),t=b("input"),n=E(),i=Ne("svg"),s=Ne("symbol"),r=Ne("path"),o=Ne("defs"),a=Ne("mask"),f=Ne("use"),c=Ne("use"),_=Ne("path"),g=E(),u=Ne("svg"),d=Ne("path"),p=Ne("path"),w=Ne("path"),v(t,"type","checkbox"),v(t,"class","svelte-13drl8w"),v(r,"d","M5.22003 7.26C5.72003 7.76 7.57 9.7 8.67 11.45C12.2 6.05 15.65 3.5 19.19 1.69"),v(r,"fill","none"),v(r,"stroke-width","2.25"),v(r,"stroke-linecap","round"),v(r,"stroke-linejoin","round"),v(s,"id","tick-path"),v(s,"viewBox","0 0 21 18"),v(s,"xmlns","http://www.w3.org/2000/svg"),v(f,"class","tick mask svelte-13drl8w"),v(f,"href","#tick-path"),v(a,"id","tick"),v(c,"class","tick svelte-13drl8w"),v(c,"href","#tick-path"),v(c,"stroke","currentColor"),v(_,"fill","white"),v(_,"mask","url(#tick)"),v(_,"d","M18 9C18 10.4464 17.9036 11.8929 17.7589 13.1464C17.5179 15.6054 15.6054 17.5179 13.1625 17.7589C11.8929 17.9036 10.4464 18 9 18C7.55357 18 6.10714 17.9036 4.85357 17.7589C2.39464 17.5179 0.498214 15.6054 0.241071 13.1464C0.0964286 11.8929 0 10.4464 0 9C0 7.55357 0.0964286 6.10714 0.241071 4.8375C0.498214 2.39464 2.39464 0.482143 4.85357 0.241071C6.10714 0.0964286 7.55357 0 9 0C10.4464 0 11.8929 0.0964286 13.1625 0.241071C15.6054 0.482143 17.5179 2.39464 17.7589 4.8375C17.9036 6.10714 18 7.55357 18 9Z"),v(i,"viewBox","0 0 21 18"),v(i,"class","svelte-13drl8w"),v(d,"d","M5.88086 5.89441L9.53504 4.26746"),v(p,"d","M5.5274 8.78838L9.45391 9.55161"),v(w,"d","M3.49371 4.22065L5.55387 0.79198"),v(u,"class","lines svelte-13drl8w"),v(u,"viewBox","0 0 11 11"),v(e,"class","checkbox svelte-13drl8w")},m(y,T){j(y,e,T),m(e,t),t.checked=l[0],m(e,n),m(e,i),m(i,s),m(s,r),m(i,o),m(o,a),m(a,f),m(i,c),m(i,_),m(e,g),m(e,u),m(u,d),m(u,p),m(u,w),S||(h=le(t,"change",l[1]),S=!0)},p(y,[T]){T&1&&(t.checked=y[0])},i:ae,o:ae,d(y){y&&A(e),S=!1,h()}}}function is(l,e,t){let{checked:n=!1}=e;function i(){n=this.checked,t(0,n)}return l.$$set=s=>{"checked"in s&&t(0,n=s.checked)},[n,i]}class rs extends ve{constructor(e){super(),he(this,e,is,ss,ge,{checked:0})}}function nl(l){var i;let e,t=l[12]((i=l[3])==null?void 0:i._lastTime)+"",n;return{c(){e=b("div"),n=ie(t),v(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-n8zo8q")},m(s,r){j(s,e,r),m(e,n)},p(s,r){var o;r&8&&t!==(t=s[12]((o=s[3])==null?void 0:o._lastTime)+"")&&we(n,t)},d(s){s&&A(e)}}}function sl(l){var i;let e,t=((i=l[3])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=b("div"),n=ie(t),v(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-n8zo8q")},m(s,r){j(s,e,r),m(e,n)},p(s,r){var o;r&8&&t!==(t=((o=s[3])==null?void 0:o.unread_messages_count)+"")&&we(n,t)},d(s){s&&A(e)}}}function os(l){var se,B,z,Y,te,oe,Me,Ee,Te,be,ue,Ae;let e,t,n,i,s,r,o=((z=(B=(se=l[3])==null?void 0:se.lead)==null?void 0:B.first_name)!=null?z:"")+"",a,f,c,_,g,u=((oe=(te=(Y=l[3])==null?void 0:Y.lead)==null?void 0:te.last_name)!=null?oe:"")+"",d,p,w,S,h=((Te=(Ee=(Me=l[3])==null?void 0:Me.last_message)==null?void 0:Ee.text)!=null?Te:"")+"",y,T,D,L,C,O,x,G,J=((be=l[4])==null?void 0:be.title)+"",re,q,Q,$,ne,F,V,H=((ue=l[3])==null?void 0:ue._lastTime)&&nl(l),I=((Ae=l[3])==null?void 0:Ae.unread_messages_count)&&sl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),s=E(),r=b("div"),a=ie(o),f=E(),c=b("div"),_=E(),g=b("div"),d=ie(u),p=ie("\xA0"),w=E(),S=b("div"),y=ie(h),T=ie("\xA0"),D=E(),L=b("div"),C=b("div"),O=b("img"),G=E(),re=ie(J),q=E(),Q=b("div"),$=E(),H&&H.c(),ne=E(),I&&I.c(),R(i,"width","8px"),R(c,"width","8px"),v(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-n8zo8q"),v(S,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-n8zo8q"),Xe(O.src,x="assets/icons/status1.png")||v(O,"src",x),v(O,"draggable","false"),v(O,"class","pos_abs statusIcon svelte-n8zo8q"),v(C,"class","flex flex_cy leadStatus pos_rel svelte-n8zo8q"),R(C,"background",l[4].bgColor),R(C,"color",l[4].color),R(Q,"width","4px"),v(L,"class","flex"),v(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-n8zo8q"),R(t,"height",l[0]+"px"),Z(t,"active",l[1]===l[6]),Z(t,"disabled",l[11](l[3])),v(e,"class","pos_abs w100 cntWrapper svelte-n8zo8q"),R(e,"transform","translate3d(0px, "+(l[5]+l[2])+"px, 0px)")},m(M,k){j(M,e,k),m(e,t),m(t,n),m(n,i),m(n,s),m(n,r),m(r,a),m(n,f),m(n,c),m(n,_),m(n,g),m(g,d),m(g,p),m(t,w),m(t,S),m(S,y),m(S,T),m(t,D),m(t,L),m(L,C),m(C,O),m(C,G),m(C,re),m(L,q),m(L,Q),m(t,$),H&&H.m(t,null),m(t,ne),I&&I.m(t,null),F||(V=le(t,"click",l[10]),F=!0)},p(M,[k]){var N,W,X,ee,K,ce,me,fe,De,Ie,ze,Be;k&8&&o!==(o=((X=(W=(N=M[3])==null?void 0:N.lead)==null?void 0:W.first_name)!=null?X:"")+"")&&we(a,o),k&8&&u!==(u=((ce=(K=(ee=M[3])==null?void 0:ee.lead)==null?void 0:K.last_name)!=null?ce:"")+"")&&we(d,u),k&8&&h!==(h=((De=(fe=(me=M[3])==null?void 0:me.last_message)==null?void 0:fe.text)!=null?De:"")+"")&&we(y,h),k&16&&J!==(J=((Ie=M[4])==null?void 0:Ie.title)+"")&&we(re,J),k&16&&R(C,"background",M[4].bgColor),k&16&&R(C,"color",M[4].color),(ze=M[3])!=null&&ze._lastTime?H?H.p(M,k):(H=nl(M),H.c(),H.m(t,ne)):H&&(H.d(1),H=null),(Be=M[3])!=null&&Be.unread_messages_count?I?I.p(M,k):(I=sl(M),I.c(),I.m(t,null)):I&&(I.d(1),I=null),k&1&&R(t,"height",M[0]+"px"),k&66&&Z(t,"active",M[1]===M[6]),k&2056&&Z(t,"disabled",M[11](M[3])),k&36&&R(e,"transform","translate3d(0px, "+(M[5]+M[2])+"px, 0px)")},i:ae,o:ae,d(M){M&&A(e),H&&H.d(),I&&I.d(),F=!1,V()}}}function as(l,e,t){let n,i,s,r,o,{app:a}=e;const{dialogMap_r:f,dialogActiveID_r:c,dialogActiveID_Set:_}=a;ke(l,f,T=>t(15,s=T)),ke(l,c,T=>t(6,o=T));let{height:g=54}=e,{dialog_id:u}=e,{y:d=0}=e,{scrollY:p=0}=e;const w=We(d);ke(l,w,T=>t(5,r=T));const S=T=>{n&&!h(n)&&_(n.id)},h=T=>{var D;return((D=T==null?void 0:T.lead)==null?void 0:D.status)==="DL"},y=T=>{if(!T)return"";const D=C=>String(C).padStart(2,"0"),L=new Date;return T=new Date(T),T.getYear()===L.getYear()&&T.getMonth()===L.getMonth()?T.getDate()===L.getDate()?`${D(T.getHours())}:${D(T.getMinutes())}`:`${D(T.getDate())}d ${D(T.getHours())}:${D(T.getMinutes())}`:`${D(T.getDate())}.${D(T.getMonth())}.${T.getFullYear()}`};return l.$$set=T=>{"app"in T&&t(13,a=T.app),"height"in T&&t(0,g=T.height),"dialog_id"in T&&t(1,u=T.dialog_id),"y"in T&&t(14,d=T.y),"scrollY"in T&&t(2,p=T.scrollY)},l.$$.update=()=>{l.$$.dirty&16384&&Ye(w,r=d,r),l.$$.dirty&32770&&t(3,n=s[u]),l.$$.dirty&8200&&t(4,i=a.lead_GetStatusOrDefault(n==null?void 0:n.lead))},[g,u,p,n,i,r,o,f,c,w,S,h,y,a,d,s]}class fs extends ve{constructor(e){super(),he(this,e,as,os,ge,{app:13,height:0,dialog_id:1,y:14,scrollY:2})}}function cs(l){let e,t,n,i;return{c(){e=b("div"),t=b("div"),v(t,"class","pos_abs thumb w100 svelte-5ca5ia"),R(t,"height",l[1]+"px"),R(t,"transform","translate(0px, "+l[5](l[0],l[2],l[1])+"px)"),Z(t,"active",l[3]),v(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),Z(e,"active",l[3])},m(s,r){j(s,e,r),m(e,t),n||(i=[le(window,"mousemove",l[7]),le(window,"mouseup",l[8]),le(window,"blur",l[8]),le(t,"mousedown",l[6]),nt(Qn.call(null,e,l[4])),le(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&R(t,"height",s[1]+"px"),r&7&&R(t,"transform","translate(0px, "+s[5](s[0],s[2],s[1])+"px)"),r&8&&Z(t,"active",s[3]),r&8&&Z(e,"active",s[3])},i:ae,o:ae,d(s){s&&A(e),n=!1,je(i)}}}function us(l,e,t){let n;const i=y=>Fe(0,Array.isArray(y)?y[0]:y,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:a=null}=e;const f=Ge(null);ke(l,f,y=>t(2,n=y));const c=()=>n?n.height-o:1,_=y=>n?y*c():0,g=()=>{if(!n)return 1;if(a===null)return o;t(1,o=Fe(.1,a,1)*n.height)};let u=null;const d=y=>{!n||t(3,u={y:y.clientY,value_out:r})},p=y=>{if(!n||!u)return;const T=y.clientY-u.y;if(n.height){const D=T/c();t(0,r=Fe(0,u.value_out+D,1))}},w=y=>{t(3,u=null)},S=y=>{!n||u||(t(0,r=Fe(0,(y.clientY-n.y-o/2)/c(),1)),t(3,u={y:y.clientY,value_out:r}))},h=()=>{if(!n)return 0;u||t(0,r=i(s))};return l.$$set=y=>{"value_in"in y&&t(10,s=y.value_in),"value_out"in y&&t(0,r=y.value_out),"thumb_Height"in y&&t(1,o=y.thumb_Height),"thumb_HeightRate"in y&&t(11,a=y.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&g(),l.$$.dirty&1024&&h()},[r,o,n,u,f,_,d,p,w,S,s,a]}class Zl extends ve{constructor(e){super(),he(this,e,us,cs,ge,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:ds}=wn;function il(l,e,t){const n=l.slice();return n[24]=e[t],n}function rl(l,e){let t,n,i;return n=new fs({props:{app:e[0],dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Je(),pe(n.$$.fragment),this.first=t},m(s,r){j(s,t,r),de(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(P(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&A(t),_e(n,s)}}}function ol(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new Zl({props:r}),Re.push(()=>vt(t,"value_out",s)),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,a){j(o,e,a),de(t,e,null),i=!0},p(o,a){const f={};a&32&&(f.value_in=o[5]),a&64&&(f.thumb_HeightRate=o[6]),!n&&a&2&&(n=!0,f.value_out=o[1],ht(()=>n=!1)),t.$set(f)},i(o){i||(P(t.$$.fragment,o),i=!0)},o(o){U(t.$$.fragment,o),i=!1},d(o){o&&A(e),_e(t)}}}function al(l){let e,t,n,i,s;return{c(){e=b("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',v(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){j(r,e,o),n=!0,i||(s=le(e,"click",l[15]),i=!0)},p:ae,i(r){n||(r&&xe(()=>{t||(t=ye(e,Oe,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=ye(e,Oe,{},!1)),t.run(0)),n=!1},d(r){r&&A(e),r&&t&&t.end(),i=!1,s()}}}function _s(l){let e,t,n=[],i=new ds,s,r,o,a,f,c=l[4];const _=d=>d[24].dialog_id;for(let d=0;d<c.length;d+=1){let p=il(l,c,d),w=_(p);i.set(w,n[d]=rl(w,p))}let g=l[6]<1&&ol(l),u=l[6]<1&&l[7]&&al(l);return{c(){e=b("div"),t=b("div");for(let d=0;d<n.length;d+=1)n[d].c();s=E(),g&&g.c(),r=E(),u&&u.c(),v(t,"class","flex overhide pos_rel"),v(e,"class","flex flex_grow_1 pos_rel"),R(e,"--itemHeight",Ve+"px")},m(d,p){j(d,e,p),m(e,t);for(let w=0;w<n.length;w+=1)n[w].m(t,null);m(e,s),g&&g.m(e,null),m(e,r),u&&u.m(e,null),o=!0,a||(f=[nt(kt.call(null,t,l[8])),le(e,"wheel",l[10],{passive:!0})],a=!0)},p(d,[p]){p&21&&(c=d[4],Se(),n=st(n,p,_,1,d,c,i,t,yt,rl,null,il),Le()),d[6]<1?g?(g.p(d,p),p&64&&P(g,1)):(g=ol(d),g.c(),P(g,1),g.m(e,r)):g&&(Se(),U(g,1,1,()=>{g=null}),Le()),d[6]<1&&d[7]?u?(u.p(d,p),p&192&&P(u,1)):(u=al(d),u.c(),P(u,1),u.m(e,null)):u&&(Se(),U(u,1,1,()=>{u=null}),Le())},i(d){if(!o){for(let p=0;p<c.length;p+=1)P(n[p]);P(g),P(u),o=!0}},o(d){for(let p=0;p<n.length;p+=1)U(n[p]);U(g),U(u),o=!1},d(d){d&&A(e);for(let p=0;p<n.length;p+=1)n[p].d();g&&g.d(),u&&u.d(),a=!1,je(f)}}}const Ve=54;function ms(l,e,t){let n,i,s=ae,r=()=>(s(),s=Et(d,q=>t(13,i=q)),d),o;l.$$.on_destroy.push(()=>s());let{app:a}=e;const{dialogMap_SetDialogList:f}=a;let{filter:c={}}=e;const _=q=>{var Q,$;return[c.filterUnreadFirst?1:0,(Q=c.filterTag)!=null?Q:"",($=c.filterStatus)!=null?$:""].join("/")};let g={},u=null,d=Ge(null);r();function p(){const q={...c},Q=_();g[Q]||(g[Q]=Tn({fLoad:$=>($={unread_first:q.filterUnreadFirst?1:0,...$},q.filterTag&&($.tag=q.filterTag),q.filterStatus&&($.status=q.filterStatus),a.api.dialog_GetList($)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:f})),u!==g[Q]&&([...Object.values(g)].map($=>$.pause()),u=g[Q],u.resume(),console.log({filterHash:Q}),r(t(3,d=u.getData_r())))}Pe(()=>[...Object.values(g)].map(q=>q.destroy()));let w=[];const S=Ge(null);ke(l,S,q=>t(12,n=q));let h=0,y=0,T=1,D=0,L=We(D,{duration:200});ke(l,L,q=>t(2,o=q));function C(){if(!n||!i)return;const q=Math.max(1,Math.floor(n.height)),Q=i.total*Ve,$=Q-q;t(6,T=Q?Fe(0,q/Q,1):1),$<0?D=0:D=y*$,Ye(L,o=D,o)}let O=!1;function x(){if(!n||!i)return;const q=i,Q=Math.max(1,Math.floor(n.height)),$=Math.ceil(Q/Ve);i.total*Ve;let F=Math.max(0,Math.floor(o/Ve)-1);const V=$+2;F>q.total&&(F=Math.max(0,q.total-V)),u&&u.setRange(F,V);const H=[];for(let I=F,se=0;se<V&&I<q.total;se++,I++){const B=q.list[I];H.push({index:I,item:B,y:I*Ve})}t(4,w=[...new Map(H.filter(I=>I.item).map(I=>[I.item.id,I]))].map(([I,se])=>({dialog_id:se.item.id,y:se.y}))),t(7,O=F>1)}const G=q=>{if(!n||!i)return;const Q=i,$=Math.max(1,Math.floor(n.height)),F=Q.total*Ve-$;if(F<0)return;const V=q.deltaY>0?1:-1;t(5,h=[y+Ve/F*V])};function J(q){y=q,t(1,y)}const re=()=>t(5,h=[0]);return l.$$set=q=>{"app"in q&&t(0,a=q.app),"filter"in q&&t(11,c=q.filter)},l.$$.update=()=>{l.$$.dirty&2048&&p(),l.$$.dirty&12290&&C(),l.$$.dirty&12292&&x()},[a,y,o,d,w,h,T,O,S,L,G,c,n,i,J,re]}class ps extends ve{constructor(e){super(),he(this,e,ms,_s,ge,{app:0,filter:11})}}function fl(l,e,t){const n=l.slice();return n[6]=e[t],n}function cl(l){let e,t,n,i,s=[],r=new Map,o=l[0];const a=f=>f[6].id;for(let f=0;f<o.length;f+=1){let c=fl(l,o,f),_=a(c);r.set(_,s[f]=ul(_,c))}return{c(){e=b("div"),t=b("div"),t.textContent="Filter status",n=E(),i=b("div");for(let f=0;f<s.length;f+=1)s[f].c();v(t,"class","flex label svelte-1ovi0to"),v(i,"class","flex unselect"),v(e,"class","flex flex_clm")},m(f,c){j(f,e,c),m(e,t),m(e,n),m(e,i);for(let _=0;_<s.length;_+=1)s[_].m(i,null)},p(f,c){c&3&&(o=f[0],s=st(s,c,a,1,f,o,r,i,yn,ul,null,fl))},d(f){f&&A(e);for(let c=0;c<s.length;c+=1)s[c].d()}}}function ul(l,e){let t,n=e[6].title+"",i,s,r;return{key:l,first:null,c(){var o,a,f,c;t=b("div"),i=ie(n),v(t,"class","flex flex_cx flex_cy nowrap cursor_ptr statusItem svelte-1ovi0to"),R(t,"background",(a=(o=e[6])==null?void 0:o.bgColor)!=null?a:"#000"),R(t,"color",(c=(f=e[6])==null?void 0:f.color)!=null?c:"#fff"),Z(t,"select",e[6]._select),this.first=t},m(o,a){j(o,t,a),m(t,i),s||(r=le(t,"click",function(){He(e[1](e[6]))&&e[1](e[6]).apply(this,arguments)}),s=!0)},p(o,a){var f,c,_,g;e=o,a&1&&n!==(n=e[6].title+"")&&we(i,n),a&1&&R(t,"background",(c=(f=e[6])==null?void 0:f.bgColor)!=null?c:"#000"),a&1&&R(t,"color",(g=(_=e[6])==null?void 0:_.color)!=null?g:"#fff"),a&1&&Z(t,"select",e[6]._select)},d(o){o&&A(t),s=!1,r()}}}function gs(l){let e,t=l[0].length>1&&cl(l);return{c(){t&&t.c(),e=Je()},m(n,i){t&&t.m(n,i),j(n,e,i)},p(n,[i]){n[0].length>1?t?t.p(n,i):(t=cl(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ae,o:ae,d(n){t&&t.d(n),n&&A(e)}}}const dl="__ALL__";function hs(l,e,t){var a,f;let{app:n}=e,{filterStatus:i=null}=e,s=[{title:"ALL",id:dl,color:"#000",bgColor:"#fff",_select:!0},...((f=(a=n==null?void 0:n.appConfig)==null?void 0:a.lead_StatusFilterList)!=null?f:[]).map(n.lead_GetStatusByID).map(c=>({...c,_select:!1}))];const r=()=>{var c,_;t(0,s),t(2,i=s.length?s[0]._select?null:(_=(c=s.find(g=>g._select))==null?void 0:c.id)!=null?_:null:null)},o=c=>{const _=!c._select;return _?(s.map(g=>g._select=!1),c._select=_,r()):c.id===dl?void 0:(t(0,s[0]._select=!0,s),c._select=_,r())};return r(),l.$$set=c=>{"app"in c&&t(3,n=c.app),"filterStatus"in c&&t(2,i=c.filterStatus)},[s,o,i,n]}class vs extends ve{constructor(e){super(),he(this,e,hs,gs,ge,{app:3,filterStatus:2})}}function _l(l){let e,t,n,i,s,r,o,a,f;return{c(){e=b("img"),n=E(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',r=E(),o=b("div"),o.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/fullscreen.png"/>',v(e,"class","a_img svelte-1m8yuzj"),Xe(e.src,t=l[2].url)||v(e,"src",t),R(e,"max-height",l[4]+"px"),v(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),v(o,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),v(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(c,_){j(c,e,_),j(c,n,_),j(c,i,_),m(i,s),m(i,r),m(i,o),a||(f=[le(s,"click",function(){He(l[5](l[2]))&&l[5](l[2]).apply(this,arguments)}),le(o,"click",function(){He(l[6](l[2]))&&l[6](l[2]).apply(this,arguments)})],a=!0)},p(c,_){l=c,_&4&&!Xe(e.src,t=l[2].url)&&v(e,"src",t),_&16&&R(e,"max-height",l[4]+"px")},d(c){c&&A(e),c&&A(n),c&&A(i),a=!1,je(f)}}}function ml(l){let e,t,n,i,s,r,o;return{c(){e=b("img"),n=E(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',v(e,"class","a_img fileIcon svelte-1m8yuzj"),Xe(e.src,t="assets/icons/folder.png")||v(e,"src",t),R(e,"max-height",l[4]+"px"),v(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),v(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(a,f){j(a,e,f),j(a,n,f),j(a,i,f),m(i,s),r||(o=le(s,"click",l[13]),r=!0)},p(a,f){f&16&&R(e,"max-height",a[4]+"px")},d(a){a&&A(e),a&&A(n),a&&A(i),r=!1,o()}}}function pl(l){var i;let e,t=((i=l[0])==null?void 0:i.text)+"",n;return{c(){e=b("pre"),n=ie(t),v(e,"class","w100 text textPre svelte-1m8yuzj")},m(s,r){j(s,e,r),m(e,n)},p(s,r){var o;r&1&&t!==(t=((o=s[0])==null?void 0:o.text)+"")&&we(n,t)},d(s){s&&A(e)}}}function bs(l){var _,g;let e,t,n,i,s,r=l[7]((_=l[0])==null?void 0:_.received_at)+"",o,a=l[2]&&_l(l),f=l[3]&&ml(l),c=((g=l[0])==null?void 0:g.text)&&pl(l);return{c(){var u,d,p,w;e=b("div"),a&&a.c(),t=E(),f&&f.c(),n=E(),c&&c.c(),i=E(),s=b("div"),o=ie(r),v(s,"class","flex pos_abs unselect date svelte-1m8yuzj"),Z(s,"attachment_mode",l[2]&&!((u=l[0])!=null&&u.text)),v(e,"class","flex flex_clm overhide pos_abs chat_item svelte-1m8yuzj"),Z(e,"chat_item_other",(d=l[0])==null?void 0:d.incoming),Z(e,"chat_item_self",!((p=l[0])!=null&&p.incoming)),Z(e,"has_text",(w=l[0])==null?void 0:w.text)},m(u,d){j(u,e,d),a&&a.m(e,null),m(e,t),f&&f.m(e,null),m(e,n),c&&c.m(e,null),m(e,i),m(e,s),m(s,o),l[14](e)},p(u,[d]){var p,w,S,h,y,T;u[2]?a?a.p(u,d):(a=_l(u),a.c(),a.m(e,t)):a&&(a.d(1),a=null),u[3]?f?f.p(u,d):(f=ml(u),f.c(),f.m(e,n)):f&&(f.d(1),f=null),(p=u[0])!=null&&p.text?c?c.p(u,d):(c=pl(u),c.c(),c.m(e,i)):c&&(c.d(1),c=null),d&1&&r!==(r=u[7]((w=u[0])==null?void 0:w.received_at)+"")&&we(o,r),d&5&&Z(s,"attachment_mode",u[2]&&!((S=u[0])!=null&&S.text)),d&1&&Z(e,"chat_item_other",(h=u[0])==null?void 0:h.incoming),d&1&&Z(e,"chat_item_self",!((y=u[0])!=null&&y.incoming)),d&1&&Z(e,"has_text",(T=u[0])==null?void 0:T.text)},i:ae,o:ae,d(u){u&&A(e),a&&a.d(),f&&f.d(),c&&c.d(),l[14](null)}}}function ws(l,e,t){let{app:n}=e,{bbox:i=null}=e,{message:s=null}=e,{render_Width:r=1}=e,{render_X:o=-r*2}=e,a=null,f=null,c=null,_=null,g=[],u=[],d=1;function p(L){var O;g=[],u=[],L&&(O=L.attachments)!=null&&O.length&&(g=L.attachments.filter(x=>x.file_type==="IM").map(x=>({url:x.url})),u=L.attachments.filter(x=>x.file_type==="DC").map(x=>({url:x.url})));const C=i.height*.7;i.width,t(4,d=C),t(2,c=g==null?void 0:g[0]),t(3,_=u==null?void 0:u[0])}function w(L){if(!L||!Array.isArray(L.attachments)){t(0,f=null);return}if(!f){t(0,f=L);return}if(f.text!==L.text||f.incoming!==L.incoming||f.received_at!==L.received_at||f.attachments.length!==L.attachments.length){t(0,f=L);return}if(!f.attachments.map((C,O)=>[C,L.attachments[O]]).every(([C,O])=>C.file_type===O.file_type&&C.url===O.url)){t(0,f=L);return}}const S=L=>C=>{L&&L.url&&It(L.url)},h=L=>C=>{L&&L.url&&n.events.emit("openOverlayImageView",L.url)},y=L=>{if(L===null)return"";const C=x=>String(x).padStart(2,"0"),O=new Date;return L=new Date(L),L.getYear()===O.getYear()&&L.getMonth()===O.getMonth()&&L.getDate()===O.getDate()?`${C(L.getHours())}:${C(L.getMinutes())}`:`${C(L.getDate())}.${C(L.getMonth())}.${L.getFullYear()} ${C(L.getHours())}:${C(L.getMinutes())}`},T=()=>Jl(_.url);function D(L){Re[L?"unshift":"push"](()=>{a=L,t(1,a)})}return l.$$set=L=>{"app"in L&&t(8,n=L.app),"bbox"in L&&t(9,i=L.bbox),"message"in L&&t(10,s=L.message),"render_Width"in L&&t(11,r=L.render_Width),"render_X"in L&&t(12,o=L.render_X)},l.$$.update=()=>{l.$$.dirty&1024&&w(s),l.$$.dirty&1&&p(f)},[f,a,c,_,d,S,h,y,n,i,s,r,o,T,D]}class ys extends ve{constructor(e){super(),he(this,e,ws,bs,ge,{app:8,bbox:9,message:10,render_Width:11,render_X:12})}}function ks(l){let e;return{c(){e=b("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,v(e,"class","lds-roller svelte-j15bjw")},m(t,n){j(t,e,n)},p:ae,i:ae,o:ae,d(t){t&&A(e)}}}class Ql extends ve{constructor(e){super(),he(this,e,null,ks,ge,{})}}const gl=(l,{delay:e=0,duration:t=400,easing:n=Yl}={})=>{const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.width),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),_=parseFloat(i.borderTopWidth),g=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*s};width: ${u*r}px;padding-top: ${u*o}px;padding-bottom: ${u*a}px;margin-top: ${u*f}px;margin-bottom: ${u*c}px;border-top-width: ${u*_}px;border-bottom-width: ${u*g}px;`}};function hl(l){let e;return{c(){e=b("div"),e.textContent=">",v(e,"class","flex flex_cx flex_cy statusItemDlm svelte-1pt3u5i")},m(t,n){j(t,e,n)},d(t){t&&A(e)}}}function Ss(l){var f,c,_,g;let e,t,n,i,s=((g=(f=l[2])==null?void 0:f.title)!=null?g:(c=l[2])!=null&&c.id?`#${(_=l[2])==null?void 0:_.id}`:"*UNK*")+"",r,o,a=l[0]&&hl();return{c(){var u,d,p,w;e=b("div"),t=b("div"),a&&a.c(),n=E(),i=b("div"),r=ie(s),v(i,"class","flex flex_cx flex_cy nowrap statusItem svelte-1pt3u5i"),R(i,"background",(d=(u=l[2])==null?void 0:u.bgColor)!=null?d:"#000"),R(i,"color",(w=(p=l[2])==null?void 0:p.color)!=null?w:"#fff"),v(t,"class","flex"),v(e,"class","flex flex_cy h100 overhide itemWrapper svelte-1pt3u5i"),v(e,"style",o=l[1]?"width: 0px;":"")},m(u,d){j(u,e,d),m(e,t),a&&a.m(t,null),m(t,n),m(t,i),m(i,r),l[5](t),l[6](e)},p(u,[d]){var p,w,S,h,y,T,D,L;u[0]?a||(a=hl(),a.c(),a.m(t,n)):a&&(a.d(1),a=null),d&4&&s!==(s=((h=(p=u[2])==null?void 0:p.title)!=null?h:(w=u[2])!=null&&w.id?`#${(S=u[2])==null?void 0:S.id}`:"*UNK*")+"")&&we(r,s),d&4&&R(i,"background",(T=(y=u[2])==null?void 0:y.bgColor)!=null?T:"#000"),d&4&&R(i,"color",(L=(D=u[2])==null?void 0:D.color)!=null?L:"#fff"),d&2&&o!==(o=u[1]?"width: 0px;":"")&&v(e,"style",o)},i:ae,o:ae,d(u){u&&A(e),a&&a.d(),l[5](null),l[6](null)}}}function Ls(l,e,t){let{beforeDlm:n=!1}=e,{hide:i=!1}=e,{status:s={}}=e,r,o;dn(()=>{r&&o&&t(3,r.style.width=o.offsetWidth+"px",r)});function a(c){Re[c?"unshift":"push"](()=>{o=c,t(4,o)})}function f(c){Re[c?"unshift":"push"](()=>{r=c,t(3,r)})}return l.$$set=c=>{"beforeDlm"in c&&t(0,n=c.beforeDlm),"hide"in c&&t(1,i=c.hide),"status"in c&&t(2,s=c.status)},[n,i,s,r,o,a,f]}class Ms extends ve{constructor(e){super(),he(this,e,Ls,Ss,ge,{beforeDlm:0,hide:1,status:2})}}function vl(l,e,t){const n=l.slice();return n[8]=e[t],n[10]=t,n}function bl(l,e){var s;let t,n,i;return n=new Ms({props:{beforeDlm:(s=e[8].status)==null?void 0:s.beforeDlm,status:e[8].status,hide:e[8].hide}}),{key:l,first:null,c(){t=Je(),pe(n.$$.fragment),this.first=t},m(r,o){j(r,t,o),de(n,r,o),i=!0},p(r,o){var f;e=r;const a={};o&1&&(a.beforeDlm=(f=e[8].status)==null?void 0:f.beforeDlm),o&1&&(a.status=e[8].status),o&1&&(a.hide=e[8].hide),n.$set(a)},i(r){i||(P(n.$$.fragment,r),i=!0)},o(r){U(n.$$.fragment,r),i=!1},d(r){r&&A(t),_e(n,r)}}}function Ts(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[8].rID;for(let o=0;o<s.length;o+=1){let a=vl(l,s,o),f=r(a);n.set(f,t[o]=bl(f,a))}return{c(){e=b("div");for(let o=0;o<t.length;o+=1)t[o].c();v(e,"class","flex h100")},m(o,a){j(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],Se(),t=st(t,a,r,1,o,s,n,e,yt,bl,null,vl),Le())},i(o){if(!i){for(let a=0;a<s.length;a+=1)P(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)U(t[a]);i=!1},d(o){o&&A(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Os(l,e,t){let{app:n}=e,{statusList:i=[]}=e,{statusSelectList:s=[]}=e,r=[],o=1;Pe(it(1e3,()=>{const f=Date.now();t(0,r=r.filter(c=>!c.hide||c.hide<=f))}));const a=()=>{r.forEach(f=>{f.hide||i.find(c=>{var _;return((_=f==null?void 0:f.status)==null?void 0:_.id)===(c==null?void 0:c.id)})||(f.hide=Date.now()+1e3)}),i.forEach(f=>{r.find(c=>{var _;return!c.hide&&((_=c==null?void 0:c.status)==null?void 0:_.id)===(f==null?void 0:f.id)})||r.push({rID:o++,status:f,hide:!1})}),t(0,r)};return l.$$set=f=>{"app"in f&&t(1,n=f.app),"statusList"in f&&t(2,i=f.statusList),"statusSelectList"in f&&t(3,s=f.statusSelectList)},l.$$.update=()=>{l.$$.dirty&4&&a()},[r,n,i,s]}class Ds extends ve{constructor(e){super(),he(this,e,Os,Ts,ge,{app:1,statusList:2,statusSelectList:3})}}function wl(l,e,t){const n=l.slice();return n[29]=e[t],n[31]=t,n}function yl(l){let e,t,n,i,s,r,o,a,f,c,_,g,u,d;f=new Ds({props:{statusList:l[7]}});let p=l[2]&&!l[3]&&kl(l),w=l[3]&&Ll();return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("img"),o=E(),a=b("div"),pe(f.$$.fragment),c=E(),p&&p.c(),_=E(),w&&w.c(),v(n,"class","pos_abs w100 h100 deleteProgress svelte-socr2e"),R(n,"width",l[1]+"%"),v(t,"class","pos_abs w100 h100 overhide bg svelte-socr2e"),Xe(s.src,r="assets/icons/status1.png")||v(s,"src",r),v(s,"draggable","false"),v(s,"class","pos_abs statusIcon svelte-socr2e"),v(a,"class","flex flex_cy "),R(a,"z-index","200"),v(e,"class","flex flex_cx flex_cy unselect statusCnt pos_rel svelte-socr2e"),Z(e,"loading",l[3])},m(S,h){j(S,e,h),m(e,t),m(t,n),m(e,i),m(e,s),m(e,o),m(e,a),de(f,a,null),m(e,c),p&&p.m(e,null),m(e,_),w&&w.m(e,null),l[16](e),g=!0,u||(d=[le(e,"mouseenter",l[17]),le(e,"mouseleave",l[18]),le(e,"click",l[19])],u=!0)},p(S,h){(!g||h[0]&2)&&R(n,"width",S[1]+"%");const y={};h[0]&128&&(y.statusList=S[7]),f.$set(y),S[2]&&!S[3]?p?(p.p(S,h),h[0]&12&&P(p,1)):(p=kl(S),p.c(),P(p,1),p.m(e,_)):p&&(Se(),U(p,1,1,()=>{p=null}),Le()),S[3]?w?h[0]&8&&P(w,1):(w=Ll(),w.c(),P(w,1),w.m(e,null)):w&&(Se(),U(w,1,1,()=>{w=null}),Le()),(!g||h[0]&8)&&Z(e,"loading",S[3])},i(S){g||(P(f.$$.fragment,S),P(p),P(w),g=!0)},o(S){U(f.$$.fragment,S),U(p),U(w),g=!1},d(S){S&&A(e),_e(f),p&&p.d(),w&&w.d(),l[16](null),u=!1,je(d)}}}function kl(l){let e,t,n,i=l[6],s=[];for(let r=0;r<i.length;r+=1)s[r]=Sl(wl(l,i,r));return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();v(e,"class","flex flex_cy"),R(e,"z-index","100")},m(r,o){j(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,o){if(o[0]&3137){i=r[6];let a;for(a=0;a<i.length;a+=1){const f=wl(r,i,a);s[a]?s[a].p(f,o):(s[a]=Sl(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}},i(r){n||(r&&xe(()=>{t||(t=ye(e,gl,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=ye(e,gl,{},!1)),t.run(0)),n=!1},d(r){r&&A(e),wt(s,r),r&&t&&t.end()}}}function Is(l){let e;return{c(){e=b("div"),R(e,"min-width","4px")},m(t,n){j(t,e,n)},d(t){t&&A(e)}}}function Cs(l){let e;return{c(){e=b("div"),e.textContent=">",v(e,"class","flex flex_cx flex_cy statusItemDlm svelte-socr2e")},m(t,n){j(t,e,n)},d(t){t&&A(e)}}}function Sl(l){let e,t,n=l[29].title+"",i,s,r;function o(c,_){return c[31]===0?Cs:Is}let f=o(l)(l);return{c(){f.c(),e=E(),t=b("div"),i=ie(n),v(t,"class","flex flex_cx flex_cy nowrap statusItem cursor_ptr select svelte-socr2e"),R(t,"background",l[29].bgColor),R(t,"color",l[29].color)},m(c,_){f.m(c,_),j(c,e,_),j(c,t,_),m(t,i),s||(r=[le(t,"click",function(){He(l[10](l[0],l[29]))&&l[10](l[0],l[29]).apply(this,arguments)}),le(t,"mousedown",function(){He(l[11](l[0],l[29]))&&l[11](l[0],l[29]).apply(this,arguments)})],s=!0)},p(c,_){l=c,_[0]&64&&n!==(n=l[29].title+"")&&we(i,n),_[0]&64&&R(t,"background",l[29].bgColor),_[0]&64&&R(t,"color",l[29].color)},d(c){f.d(c),c&&A(e),c&&A(t),s=!1,je(r)}}}function Ll(l){let e,t,n,i;return t=new Xl({props:{height:"6"}}),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","flex pos_abs flex_cy h100 loadingInd svelte-socr2e"),R(e,"filter","invert(0)")},m(s,r){j(s,e,r),de(t,e,null),i=!0},i(s){i||(P(t.$$.fragment,s),s&&xe(()=>{n||(n=ye(e,Oe,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=ye(e,Oe,{},!1)),n.run(0)),i=!1},d(s){s&&A(e),_e(t),s&&n&&n.end()}}}function xs(l){let e,t,n,i,s=l[0]&&l[0].lead&&yl(l);return{c(){s&&s.c(),e=Je()},m(r,o){s&&s.m(r,o),j(r,e,o),t=!0,n||(i=[le(window,"mouseup",l[12]),le(window,"mousedown",l[9]),le(window,"blur",l[9])],n=!0)},p(r,o){r[0]&&r[0].lead?s?(s.p(r,o),o[0]&1&&P(s,1)):(s=yl(r),s.c(),P(s,1),s.m(e.parentNode,e)):s&&(Se(),U(s,1,1,()=>{s=null}),Le())},i(r){t||(P(s),t=!0)},o(r){U(s),t=!1},d(r){s&&s.d(r),r&&A(e),n=!1,je(i)}}}function Es(l,e,t){let n,i,s,r,o,a=ae,f=()=>(a(),a=Et(C,F=>t(1,o=F)),C);l.$$.on_destroy.push(()=>a());let{app:c}=e;const{dialogMap_r:_,dialogMap_SetDialog:g}=c;ke(l,_,F=>t(15,r=F));let{dialog_id:u}=e,d=!1,p=!1;const w=()=>{var F;return!(!n||!n.lead||((F=n==null?void 0:n.lead)==null?void 0:F.status)==="DL"||p)};let S;const h=F=>{let V=F.target;for(;V;){if(V===S)return;V=V.parentNode}t(2,d=!1)},y=(F,V,H=!1)=>async I=>{if(!w()||!H&&V.protection)return;const se=V.id;if(t(2,d=!1),J({status:se}).length||t(6,s=[]),t(3,p=!0),F){const B=await c.api.lead_SetStatus(F.lead.tg_id,se);B&&F&&F.lead&&F.lead.tg_id===B.tg_id&&(F.lead=B,g(F))}t(3,p=!1)};let T=null,D=null,L=Number.POSITIVE_INFINITY,C=We(0,{duration:2e3});f();const O=(F,V)=>H=>{var I;!V.protection||(T=(I=F==null?void 0:F.lead)==null?void 0:I.tg_id,L=Date.now(),D=V,f(t(5,C=We(o,{duration:2e3}))),Ye(C,o=100,o))},x=F=>{t(2,d=!1),T=null,L=Number.POSITIVE_INFINITY,f(t(5,C=We(o,{duration:200}))),Ye(C,o=0,o)},G=async()=>{var F;!w()||(D&&L+1200<Date.now()&&T===((F=n==null?void 0:n.lead)==null?void 0:F.tg_id)&&await y(n,D,!0)(),x())},J=F=>{var V,H,I,se;try{const B=c.lead_GetStatusID(F);return(c.lead_GetStatusByID(B)?(H=(V=c==null?void 0:c.appConfig)==null?void 0:V.lead_StatusJumpMap)==null?void 0:H[B]:(se=(I=c==null?void 0:c.appConfig)==null?void 0:I.lead_StatusNextListForUnkStatus)!=null?se:[]).map(c==null?void 0:c.lead_GetStatusByID).filter(Boolean)}catch{}return[]},re=F=>c.lead_GetStatusHistory(F).map((V,H)=>({...V,beforeDlm:H!==0}));function q(F){Re[F?"unshift":"push"](()=>{S=F,t(4,S)})}const Q=()=>t(2,d=!0),$=()=>t(2,d=!1),ne=()=>t(2,d=!0);return l.$$set=F=>{"app"in F&&t(13,c=F.app),"dialog_id"in F&&t(14,u=F.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&2&&o>=100&&G(),l.$$.dirty[0]&49152&&t(0,n=r[u]),l.$$.dirty[0]&1&&t(7,i=re(n==null?void 0:n.lead)),l.$$.dirty[0]&1&&t(6,s=J(n==null?void 0:n.lead))},[n,o,d,p,S,C,s,i,_,h,y,O,x,c,u,r,q,Q,$,ne]}class As extends ve{constructor(e){super(),he(this,e,Es,xs,ge,{app:13,dialog_id:14},null,[-1,-1])}}function Ml(l){var x,G,J,re,q,Q,$,ne,F,V;let e,t,n,i,s=((J=(G=(x=l[2])==null?void 0:x.lead)==null?void 0:G.first_name)!=null?J:"")+"",r,o,a,f,c,_=((Q=(q=(re=l[2])==null?void 0:re.lead)==null?void 0:q.last_name)!=null?Q:"")+"",g,u,d,p,w,S,h,y,T,D,L,C=((ne=($=l[2])==null?void 0:$.lead)==null?void 0:ne.username)&&Tl(l),O=((V=(F=l[2])==null?void 0:F.lead)==null?void 0:V.ref_link)&&Ol(l);return y=new As({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),r=ie(s),o=E(),a=b("div"),f=E(),c=b("div"),g=ie(_),u=ie("\xA0"),d=E(),p=b("div"),C&&C.c(),w=E(),O&&O.c(),S=E(),h=b("div"),pe(y.$$.fragment),T=E(),D=b("div"),R(t,"width","8px"),R(a,"width","8px"),v(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),v(p,"class","nowrap textOverEllipsis username svelte-qywc37"),v(h,"class","flex"),R(D,"height","4px")},m(H,I){j(H,e,I),m(e,t),m(e,n),m(e,i),m(i,r),m(e,o),m(e,a),m(e,f),m(e,c),m(c,g),m(c,u),j(H,d,I),j(H,p,I),C&&C.m(p,null),j(H,w,I),O&&O.m(H,I),j(H,S,I),j(H,h,I),de(y,h,null),j(H,T,I),j(H,D,I),L=!0},p(H,I){var B,z,Y,te,oe,Me,Ee,Te,be,ue;(!L||I&4)&&s!==(s=((Y=(z=(B=H[2])==null?void 0:B.lead)==null?void 0:z.first_name)!=null?Y:"")+"")&&we(r,s),(!L||I&4)&&_!==(_=((Me=(oe=(te=H[2])==null?void 0:te.lead)==null?void 0:oe.last_name)!=null?Me:"")+"")&&we(g,_),(Te=(Ee=H[2])==null?void 0:Ee.lead)!=null&&Te.username?C?C.p(H,I):(C=Tl(H),C.c(),C.m(p,null)):C&&(C.d(1),C=null),(ue=(be=H[2])==null?void 0:be.lead)!=null&&ue.ref_link?O?O.p(H,I):(O=Ol(H),O.c(),O.m(S.parentNode,S)):O&&(O.d(1),O=null);const se={};I&1&&(se.app=H[0]),I&4&&(se.dialog_id=H[2].id),y.$set(se)},i(H){L||(P(y.$$.fragment,H),L=!0)},o(H){U(y.$$.fragment,H),L=!1},d(H){H&&A(e),H&&A(d),H&&A(p),C&&C.d(),H&&A(w),O&&O.d(H),H&&A(S),H&&A(h),_e(y),H&&A(T),H&&A(D)}}}function Tl(l){let e,t=l[2].lead.username+"",n;return{c(){e=ie("@"),n=ie(t)},m(i,s){j(i,e,s),j(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&we(n,t)},d(i){i&&A(e),i&&A(n)}}}function Ol(l){var _,g;let e,t,n,i,s=((g=(_=l[2])==null?void 0:_.lead)==null?void 0:g.ref_link)+"",r,o,a,f,c;return{c(){e=b("div"),t=b("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=E(),i=b("div"),r=ie(s),o=E(),a=b("div"),v(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),v(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),v(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),R(a,"height","4px")},m(u,d){j(u,e,d),m(e,t),m(e,n),m(e,i),m(i,r),j(u,o,d),j(u,a,d),f||(c=le(e,"click",l[6]),f=!0)},p(u,d){var p,w;d&4&&s!==(s=((w=(p=u[2])==null?void 0:p.lead)==null?void 0:w.ref_link)+"")&&we(r,s)},d(u){u&&A(e),u&&A(o),u&&A(a),f=!1,c()}}}function Dl(l){let e,t,n,i;return t=new Ql({}),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","pos_abs loading svelte-qywc37")},m(s,r){j(s,e,r),de(t,e,null),i=!0},i(s){i||(P(t.$$.fragment,s),s&&xe(()=>{n||(n=ye(e,Oe,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=ye(e,Oe,{},!1)),n.run(0)),i=!1},d(s){s&&A(e),_e(t),s&&n&&n.end()}}}function js(l){let e,t,n,i,s=l[2]&&Ml(l),r=l[1]&&Dl();return{c(){e=b("div"),t=b("div"),s&&s.c(),n=E(),r&&r.c(),v(t,"class","flex flex_clm flex_cx flex_grow_1"),v(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,a){j(o,e,a),m(e,t),s&&s.m(t,null),m(e,n),r&&r.m(e,null),i=!0},p(o,[a]){o[2]?s?(s.p(o,a),a&4&&P(s,1)):(s=Ml(o),s.c(),P(s,1),s.m(t,null)):s&&(Se(),U(s,1,1,()=>{s=null}),Le()),o[1]?r?a&2&&P(r,1):(r=Dl(),r.c(),P(r,1),r.m(e,null)):r&&(Se(),U(r,1,1,()=>{r=null}),Le())},i(o){i||(P(s),P(r),i=!0)},o(o){U(s),U(r),i=!1},d(o){o&&A(e),s&&s.d(),r&&r.d()}}}function Ns(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;ke(l,r,c=>t(5,i=c));let{dialog_id:o=null}=e,{loading:a=!1}=e;const f=()=>{var c;return On((c=n==null?void 0:n.lead)==null?void 0:c.ref_link)};return l.$$set=c=>{"app"in c&&t(0,s=c.app),"dialog_id"in c&&t(4,o=c.dialog_id),"loading"in c&&t(1,a=c.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,a,n,r,o,i,f]}class Fs extends ve{constructor(e){super(),he(this,e,Ns,js,ge,{app:0,dialog_id:4,loading:1})}}function Il(l,e,t){const n=l.slice();return n[36]=e[t],n}function Cl(l,e){let t,n,i;return n=new ys({props:{app:e[0],bbox:e[9],message:e[36],render_Width:e[8]}}),{key:l,first:null,c(){t=Je(),pe(n.$$.fragment),this.first=t},m(s,r){j(s,t,r),de(n,s,r),i=!0},p(s,r){e=s;const o={};r[0]&1&&(o.app=e[0]),r[0]&512&&(o.bbox=e[9]),r[0]&4&&(o.message=e[36]),r[0]&256&&(o.render_Width=e[8]),n.$set(o)},i(s){i||(P(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&A(t),_e(n,s)}}}function Bs(l){let e,t,n,i,s,r,o,a=[],f=new Map,c,_,g,u,d,p,w,S,h,y;t=new Fs({props:{app:l[0],dialog_id:l[1],loading:l[3]}});let T=l[2];const D=O=>O[36].index;for(let O=0;O<T.length;O+=1){let x=Il(l,T,O),G=D(x);f.set(G,a[O]=Cl(G,x))}function L(O){l[17](O)}let C={value_in:l[4]};return l[5]!==void 0&&(C.value_out=l[5]),g=new Zl({props:C}),Re.push(()=>vt(g,"value_out",L)),{c(){e=b("div"),pe(t.$$.fragment),n=E(),i=b("div"),s=b("div"),r=b("div"),o=b("div");for(let O=0;O<a.length;O+=1)a[O].c();c=E(),_=b("div"),pe(g.$$.fragment),d=E(),p=b("div"),w=b("textarea"),v(o,"class","pos_rel w100 h100"),v(_,"class","pos_abs h100 chatScroll svelte-1khz9us"),v(r,"class","pos_rel w100 h100"),v(s,"class","flex pos_abs overhide"),v(i,"class","flex flex_grow_1 pos_rel overhide"),v(w,"class","flex flex_grow_1 chat_input_textarea svelte-1khz9us"),v(p,"class","flex chat_input svelte-1khz9us"),v(e,"class","flex flex_clm flex_grow_1 overhide cnt svelte-1khz9us")},m(O,x){j(O,e,x),de(t,e,null),m(e,n),m(e,i),m(i,s),m(s,r),m(r,o);for(let G=0;G<a.length;G+=1)a[G].m(o,null);l[16](o),m(r,c),m(r,_),de(g,_,null),m(e,d),m(e,p),m(p,w),zt(w,l[7]),S=!0,h||(y=[le(r,"wheel",l[13],{passive:!0}),nt(kt.call(null,s,l[11])),le(w,"input",l[18]),le(w,"keyup",l[12]),le(w,"keydown",l[12])],h=!0)},p(O,x){const G={};x[0]&1&&(G.app=O[0]),x[0]&2&&(G.dialog_id=O[1]),x[0]&8&&(G.loading=O[3]),t.$set(G),x[0]&773&&(T=O[2],Se(),a=st(a,x,D,1,O,T,f,o,yt,Cl,null,Il),Le());const J={};x[0]&16&&(J.value_in=O[4]),!u&&x[0]&32&&(u=!0,J.value_out=O[5],ht(()=>u=!1)),g.$set(J),x[0]&128&&zt(w,O[7])},i(O){if(!S){P(t.$$.fragment,O);for(let x=0;x<T.length;x+=1)P(a[x]);P(g.$$.fragment,O),S=!0}},o(O){U(t.$$.fragment,O);for(let x=0;x<a.length;x+=1)U(a[x]);U(g.$$.fragment,O),S=!1},d(O){O&&A(e),_e(t);for(let x=0;x<a.length;x+=1)a[x].d();l[16](null),_e(g),h=!1,je(y)}}}const xl=10,ct=4;function Ps(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;ke(l,o,I=>t(15,i=I));let{dialog_id:a=null}=e,f=[],c=[],_=new Set,g=0,u=0,d=1,p=1,w=null;const S=Ge(null);ke(l,S,I=>t(9,s=I)),new Date().toJSON();let h=-1;async function y(I,se=0,B=20){const z=await r.api.message_GetList({dialog_id:I,offset:se,limit:B});if(!!z&&n&&n.id===I){for(g=z.count;f.length<g;){const te=f.length;f.push({id:h--,index:te,_isFakeMsg:!0})}const Y=z.results.map(te=>{var oe;return(oe=te==null?void 0:te.attachments)!=null&&oe.length&&te.attachments.map(Me=>{var Ee,Te,be,ue,Ae,M,k,N;if((Te=(Ee=r==null?void 0:r.appConfig)==null?void 0:Ee.api)!=null&&Te.attachments_OverwriteApiHostProtocol)try{const W=new URL(Me.url);W.protocol=(Ae=(ue=(be=r==null?void 0:r.appConfig)==null?void 0:be.api)==null?void 0:ue.protocol)!=null?Ae:location.protocol,W.host=(N=(k=(M=r==null?void 0:r.appConfig)==null?void 0:M.api)==null?void 0:k.host)!=null?N:location.host,Me.url=String(W)}catch{}}),te});Y.map((te,oe)=>te.index=se+oe),Y.map(te=>f[te.index]=te)}}let T="";const D=async I=>{if(I.which===13&&!I.shiftKey&&!I.ctrlKey&&(I.preventDefault(),t(7,T=T.trim()),T)){const se=T;t(7,T=""),n&&await r.api.message_Create(n.id,se)}};function L(){f=[],t(2,c=[]),_=new Set,g=0,console.log("clear all")}let C=null,O=null;async function x(I){if(!I){if(!C)return;C=null,L();return}O!==I.id&&(C=I,O=I.id,L(),f=[],t(2,c=[]),g=0,t(3,u++,u),await y(I.id),g&&await y(I.id,Math.max(g-20,0),20),await r.api.dialog_SetReadFlagAllMessages(I.id),t(3,u--,u))}let G=1,J=!0;function re(){if(J&&requestAnimationFrame(re),!s||!w||!f.length)return;s.width;const I=s.height,se=s.width-xl*2,B=xl;t(8,G=se-Math.max(120,Math.floor(se*.1)));const z=1+p*(f.length-1);let Y=Math.floor(z),te=z-Y;Y>=f.length&&(Y=f.length-1,te=1);const oe=[],Me=[];let Ee=null;t(2,c=[]);for(let be=Y-100,ue=0,Ae=!0;be<Y+100;be++)be<0||be>=f.length||(f[be]._isFakeMsg&&_.add(be),c[ue]!==f[be]&&(Ae&&(Ae=!1,c.splice(ue,1e9)),t(2,c[ue]=f[be],c),t(2,c)),t(2,c[ue]._drawIndex=ue,c),be<Y&&oe.push(c[ue]),be>Y&&Me.push(c[ue]),be===Y&&(Ee=c[ue]),ue++);const Te=[...w.children];if(Te.length===c.length){Te.map((k,N)=>{const W=c[N];if(!W||k._remove)return;const X=k.getBoundingClientRect();k._bbox=X;const ee=Math.floor(B+(W.incoming?0:Math.max(100,s.width*.05)));k.__cacheWidth!==G&&(k.__cacheWidth=G,k.style.maxWidth=G+"px"),k.__cacheLeft!==ee&&(k.__cacheLeft=ee,k.style.left=ee+"px")});const be=(k,N,W=1)=>(k.__cacheTop!==N&&(k.__cacheTop=N,k.style.transform=`translate3d(0px, ${N}px, 0px)`),N+(k._bbox.height+ct)*W);let ue=0,Ae=0;const M=Te[Ee._drawIndex];if(M){const k=M;ue=I+ct-(k._bbox.height+ct)*te,Ae=ue,ue=be(k,ue,1)}Me.map((k,N)=>{const W=Te[k._drawIndex];ue=be(W,ue,1)}),ue=Ae,oe.reverse().map((k,N)=>{const W=Te[k._drawIndex];ue-=W._bbox.height+ct,be(W,ue,0)})}}requestAnimationFrame(re),Pe(()=>J=!1);async function q(){if(_.size){const I=[..._].sort((z,Y)=>z-Y);_.clear();const se=[];let B={offset:null,limit:0};for(const z of I){if(B.offset!==null){if(B.limit<=500&&B.offset+B.limit===z){B.limit++;continue}se.push(B)}B={offset:z,limit:1}}B.offset!==null&&se.push(B),n&&(t(3,u++,u),await Promise.all(se.map(z=>y(n.id,z.offset,z.limit))),t(3,u--,u))}J&&setTimeout(q,500)}q();async function Q(){n&&await r.api.dialog_SetReadFlagAllMessages(n.id),J&&setTimeout(Q,5e3)}Q();async function $(){n&&await y(n.id,g,20),J&&setTimeout($,500)}$();const ne=I=>{t(4,d=f.length?p+Math.sign(I.deltaY)/(f.length-1):0)};function F(I){Re[I?"unshift":"push"](()=>{w=I,t(6,w)})}function V(I){p=I,t(5,p)}function H(){T=this.value,t(7,T)}return l.$$set=I=>{"app"in I&&t(0,r=I.app),"dialog_id"in I&&t(1,a=I.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&32770&&t(14,n=i[a]),l.$$.dirty[0]&16384&&x(n)},[r,a,c,u,d,p,w,T,G,s,o,S,D,ne,n,i,F,V,H]}class Rs extends ve{constructor(e){super(),he(this,e,Ps,Bs,ge,{app:0,dialog_id:1},null,[-1,-1])}}function Hs(l){let e,t,n,i,s,r,o,a,f,c,_,g,u,d,p,w,S,h,y,T,D;function L(G){l[5](G)}let C={};l[2]!==void 0&&(C.checked=l[2]),c=new rs({props:C}),Re.push(()=>vt(c,"checked",L));function O(G){l[6](G)}let x={app:l[0]};return l[1]!==void 0&&(x.filterStatus=l[1]),u=new vs({props:x}),Re.push(()=>vt(u,"filterStatus",O)),h=new ps({props:{app:l[0],filter:{filterTag:El,filterStatus:l[1],filterUnreadFirst:l[2]}}}),T=new Rs({props:{app:l[0],dialog_id:l[3]}}),{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=b("label"),o=ie(`First unread \r
				`),a=b("div"),f=E(),pe(c.$$.fragment),g=E(),pe(u.$$.fragment),p=E(),w=b("div"),S=E(),pe(h.$$.fragment),y=E(),pe(T.$$.fragment),R(n,"height","2px"),R(a,"width","4px"),v(r,"class","flex flex_cy cursor_ptr unselect firstUnread svelte-14xikx8"),v(s,"class","flex flex_clm flex_cx header pos_rel svelte-14xikx8"),R(w,"min-height","20px"),v(t,"class","flex flex_clm list svelte-14xikx8"),v(e,"class","flex flex_grow_1")},m(G,J){j(G,e,J),m(e,t),m(t,n),m(t,i),m(t,s),m(s,r),m(r,o),m(r,a),m(r,f),de(c,r,null),m(s,g),de(u,s,null),m(t,p),m(t,w),m(t,S),de(h,t,null),m(e,y),de(T,e,null),D=!0},p(G,[J]){const re={};!_&&J&4&&(_=!0,re.checked=G[2],ht(()=>_=!1)),c.$set(re);const q={};J&1&&(q.app=G[0]),!d&&J&2&&(d=!0,q.filterStatus=G[1],ht(()=>d=!1)),u.$set(q);const Q={};J&1&&(Q.app=G[0]),J&6&&(Q.filter={filterTag:El,filterStatus:G[1],filterUnreadFirst:G[2]}),h.$set(Q);const $={};J&1&&($.app=G[0]),J&8&&($.dialog_id=G[3]),T.$set($)},i(G){D||(P(c.$$.fragment,G),P(u.$$.fragment,G),P(h.$$.fragment,G),P(T.$$.fragment,G),D=!0)},o(G){U(c.$$.fragment,G),U(u.$$.fragment,G),U(h.$$.fragment,G),U(T.$$.fragment,G),D=!1},d(G){G&&A(e),_e(c),_e(u),_e(h),_e(T)}}}let El=null;function Gs(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;ke(l,s,c=>t(3,n=c));let r=null,o=1;function a(c){o=c,t(2,o)}function f(c){r=c,t(1,r)}return l.$$set=c=>{"app"in c&&t(0,i=c.app)},[i,r,o,n,s,a,f]}class zs extends ve{constructor(e){super(),he(this,e,Gs,Hs,ge,{app:0})}}function Us(l){let e,t,n,i,s,r,o,a,f,c,_,g,u,d,p,w;return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("img"),r=E(),o=b("div"),a=b("div"),a.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/rotate.png"/>',f=E(),c=b("div"),c.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/download.png"/>',_=E(),g=b("div"),g.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/close.png"/>',v(i,"class","img svelte-d45see"),v(i,"draggable","false"),Xe(i.src,s=l[0])||v(i,"src",s),R(i,"transform","rotate("+l[3]+"deg)"),v(n,"class","pos_abs flex flex_cx flex_cy pad svelte-d45see"),R(n,"width",l[5]+"px"),R(n,"height",l[4]+"px"),v(t,"class","pos_abs flex flex_cx flex_cy pos_abs w100 h100 "),R(t,"transform","translate("+l[1]+"px, "+l[2]+"px)"),v(a,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),v(c,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),v(g,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),v(o,"class","flex pos_abs imgCtrlBtnGroup svelte-d45see"),v(e,"class","pos_abs w100 h100 unselect cnt layer_bg svelte-d45see")},m(S,h){j(S,e,h),m(e,t),m(t,n),m(n,i),m(e,r),m(e,o),m(o,a),m(o,f),m(o,c),m(o,_),m(o,g),d=!0,p||(w=[le(window,"mousemove",l[14]),le(window,"mouseup",l[13]),le(window,"blur",l[13]),le(window,"keydown",l[16]),le(i,"mousedown",l[12]),nt(kt.call(null,t,l[6])),le(a,"click",l[10]),le(c,"click",function(){He(It(l[0]))&&It(l[0]).apply(this,arguments)}),le(g,"click",l[15]),le(e,"wheel",l[11])],p=!0)},p(S,[h]){l=S,(!d||h&1&&!Xe(i.src,s=l[0]))&&v(i,"src",s),(!d||h&8)&&R(i,"transform","rotate("+l[3]+"deg)"),(!d||h&32)&&R(n,"width",l[5]+"px"),(!d||h&16)&&R(n,"height",l[4]+"px"),(!d||h&6)&&R(t,"transform","translate("+l[1]+"px, "+l[2]+"px)")},i(S){d||(xe(()=>{u||(u=ye(e,Oe,{duration:100},!0)),u.run(1)}),d=!0)},o(S){u||(u=ye(e,Oe,{duration:100},!1)),u.run(0),d=!1},d(S){S&&A(e),S&&u&&u.end(),p=!1,je(w)}}}function qs(l,e,t){let n,i,s,r,{url:o=null}=e;const a=_n(),f=Ge(null);ke(l,f,x=>t(18,n=x));const c=We(0);ke(l,c,x=>t(3,i=x));const _=We(0);ke(l,_,x=>t(5,r=x));const g=We(0);ke(l,g,x=>t(4,s=x));let u=0,d=0,p={rotate:0,scale:1,whInverse:!1};const w=()=>{if(!n||!p)return;const x=p.whInverse?n.height:n.width,G=p.whInverse?n.width:n.height;Ye(_,r=x*p.scale,r),Ye(g,s=G*p.scale,s),Ye(c,i=p.rotate,i)},S=()=>{!n||!p||(t(17,p.rotate+=90,p),t(17,p.whInverse=!p.whInverse,p),t(17,p))},h=x=>{t(17,p.scale=Fe(.1,p.scale+Math.sign(x.deltaY)*.1,10),p)};let y=null;const T=x=>y=[x.clientX,x.clientY,u,d],D=x=>y=null,L=x=>{!y||t(1,[u,d]=[x.clientX,x.clientY].map((G,J)=>G-y[J]+y[J+2]),u,t(2,d))},C=x=>a("close"),O=x=>x.which===27&&C();return l.$$set=x=>{"url"in x&&t(0,o=x.url)},l.$$.update=()=>{l.$$.dirty&393216&&w()},[o,u,d,i,s,r,f,c,_,g,S,h,T,D,L,C,O,p,n]}class Ys extends ve{constructor(e){super(),he(this,e,qs,Us,ge,{url:0})}}function Al(l){let e=l[0],t,n,i=jl(l);return{c(){i.c(),t=Je()},m(s,r){i.m(s,r),j(s,t,r),n=!0},p(s,r){r&1&&ge(e,e=s[0])?(Se(),U(i,1,1,ae),Le(),i=jl(s),i.c(),P(i,1),i.m(t.parentNode,t)):i.p(s,r)},i(s){n||(P(i),n=!0)},o(s){U(i),n=!1},d(s){s&&A(t),i.d(s)}}}function jl(l){let e,t;return e=new Ys({props:{url:l[1]}}),e.$on("close",l[3]),{c(){pe(e.$$.fragment)},m(n,i){de(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.url=n[1]),e.$set(s)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){U(e.$$.fragment,n),t=!1},d(n){_e(e,n)}}}function Ws(l){let e,t,n=l[1]&&Al(l);return{c(){n&&n.c(),e=Je()},m(i,s){n&&n.m(i,s),j(i,e,s),t=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&P(n,1)):(n=Al(i),n.c(),P(n,1),n.m(e.parentNode,e)):n&&(Se(),U(n,1,1,()=>{n=null}),Le())},i(i){t||(P(n),t=!0)},o(i){U(n),t=!1},d(i){n&&n.d(i),i&&A(e)}}}function Js(l,e,t){let n=1,i=null,{events:s}=e;Pe(s.on("openOverlayImageView",o=>{t(0,n++,n),t(1,i=o)}));const r=()=>t(1,i=null);return l.$$set=o=>{"events"in o&&t(2,s=o.events)},[n,i,s,r]}class Vs extends ve{constructor(e){super(),he(this,e,Js,Ws,ge,{events:2})}}function Xs(l){let e,t,n,i,s,r,o,a,f,c,_,g=Ks;return i=new Zn({props:{app:l[0]}}),r=new ns({props:{app:l[0]}}),a=new zs({props:{app:l[0]}}),c=new Vs({props:{events:l[0].events}}),{c(){e=b("div"),t=E(),n=b("div"),pe(i.$$.fragment),s=E(),pe(r.$$.fragment),o=E(),pe(a.$$.fragment),f=E(),pe(c.$$.fragment),v(n,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),v(e,"class","flex w100 h100 pos_rel")},m(u,d){j(u,e,d),m(e,t),m(e,n),de(i,n,null),m(n,s),de(r,n,null),m(e,o),de(a,e,null),m(e,f),de(c,e,null),_=!0},p(u,[d]){},i(u){_||(P(g),P(i.$$.fragment,u),P(r.$$.fragment,u),P(a.$$.fragment,u),P(c.$$.fragment,u),_=!0)},o(u){U(g),U(i.$$.fragment,u),U(r.$$.fragment,u),U(a.$$.fragment,u),U(c.$$.fragment,u),_=!1},d(u){u&&A(e),_e(i),_e(r),_e(a),_e(c)}}}const Ks=!1;function Zs(l,e,t){let{operatorSelf:n}=e,{config:i}=e,{notifyEvents:s}=e,{createApi:r}=e;const o=r(n.username),a=xn(n,i,o);return Pe(a.destroy),l.$$set=f=>{"operatorSelf"in f&&t(1,n=f.operatorSelf),"config"in f&&t(2,i=f.config),"notifyEvents"in f&&t(3,s=f.notifyEvents),"createApi"in f&&t(4,r=f.createApi)},[a,n,i,s,r]}class Qs extends ve{constructor(e){super(),he(this,e,Zs,Xs,ge,{operatorSelf:1,config:2,notifyEvents:3,createApi:4})}}function Nl(l,e,t){const n=l.slice();return n[6]=e[t],n}function $s(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=Bl(Nl(l,n,r));const s=r=>U(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Je()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);j(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let a;for(a=0;a<n.length;a+=1){const f=Nl(r,n,a);i[a]?(i[a].p(f,o),P(i[a],1)):(i[a]=Bl(f),i[a].c(),P(i[a],1),i[a].m(e.parentNode,e))}for(Se(),a=n.length;a<i.length;a+=1)s(a);Le()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)P(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)U(i[o]);t=!1},d(r){wt(i,r),r&&A(e)}}}function ei(l){let e,t,n,i,s;return i=new Ql({}),{c(){e=b("div"),t=b("div"),n=E(),pe(i.$$.fragment),R(t,"height","20px"),v(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){j(r,e,o),m(e,t),m(e,n),de(i,e,null),s=!0},p:ae,i(r){s||(P(i.$$.fragment,r),s=!0)},o(r){U(i.$$.fragment,r),s=!1},d(r){r&&A(e),_e(i)}}}function Fl(l){let e,t,n=l[6].username+"",i;return{c(){e=b("div"),t=ie("@"),i=ie(n),v(e,"class","nowrap textOverEllipsis")},m(s,r){j(s,e,r),m(e,t),m(e,i)},p(s,r){r&1&&n!==(n=s[6].username+"")&&we(i,n)},d(s){s&&A(e)}}}function Bl(l){var y,T;let e,t,n,i=((y=l[6].first_name)!=null?y:"")+"",s,r,o,a,f,c=((T=l[6].last_name)!=null?T:"")+"",_,g,u,d,p,w,S,h=l[6].username&&Fl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),s=ie(i),r=E(),o=b("div"),a=E(),f=b("div"),_=ie(c),g=E(),h&&h.c(),u=E(),R(o,"width","8px"),v(t,"class","flex nowrap textOverEllipsis"),v(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(D,L){j(D,e,L),m(e,t),m(t,n),m(n,s),m(t,r),m(t,o),m(t,a),m(t,f),m(f,_),m(e,g),h&&h.m(e,null),m(e,u),p=!0,w||(S=le(e,"click",function(){He(l[2](l[6]))&&l[2](l[6]).apply(this,arguments)}),w=!0)},p(D,L){var C,O;l=D,(!p||L&1)&&i!==(i=((C=l[6].first_name)!=null?C:"")+"")&&we(s,i),(!p||L&1)&&c!==(c=((O=l[6].last_name)!=null?O:"")+"")&&we(_,c),l[6].username?h?h.p(l,L):(h=Fl(l),h.c(),h.m(e,u)):h&&(h.d(1),h=null)},i(D){p||(D&&xe(()=>{d||(d=ye(e,Oe,{},!0)),d.run(1)}),p=!0)},o(D){D&&(d||(d=ye(e,Oe,{},!1)),d.run(0)),p=!1},d(D){D&&A(e),h&&h.d(),D&&d&&d.end(),w=!1,S()}}}function ti(l){let e,t,n,i;const s=[ei,$s],r=[];function o(a,f){return a[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=b("div"),n.c(),v(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){j(a,e,f),r[t].m(e,null),i=!0},p(a,[f]){let c=t;t=o(a),t===c?r[t].p(a,f):(Se(),U(r[c],1,1,()=>{r[c]=null}),Le(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),P(n,1),n.m(e,null))},i(a){i||(P(n),i=!0)},o(a){U(n),i=!1},d(a){a&&A(e),r[t].d()}}}function li(l,e,t){let{api:n}=e,i=[],s=!1;const r=async()=>{var f,c;t(1,s=!0),t(0,i=(c=(f=await n.operator_GetList())==null?void 0:f.results)!=null?c:[]),t(1,s=!1)};let o=!1;const a=f=>c=>{o||(Vl(f),o=!0)};return r(),l.$$set=f=>{"api"in f&&t(3,n=f.api)},[i,s,a,n]}class ni extends ve{constructor(e){super(),he(this,e,li,ti,ge,{api:3})}}const si=l=>typeof l=="number"&&String(l|0)===String(l);class $l extends Error{}const Ue=async(l,e=null)=>{try{return await l()}catch{}return e},Bt=l=>async e=>{if(await Ue(()=>e.response.status===l))return e;throw new Error(`Invalid response status, expected ${l}`)},ii=Bt(200),ri=Bt(201),oi=Bt(204),ai=async l=>{if(await Ue(()=>si(l.result.count)&&Array.isArray(l.result.results)))return l;throw new Error("Invalid result, expected list container")},ut=async l=>{if(await Ue(()=>l.result.detail==="Authentication credentials were not provided.")===!0)throw new $l("Not authorized");return l},dt=async l=>({...l,result:l.response.status===204?null:await l.response.json()}),fi=(l,e)=>{var a,f,c;const t=(a=l==null?void 0:l.protocol)!=null?a:location.protocol,n=(f=l==null?void 0:l.host)!=null?f:location.host,i=(c=l==null?void 0:l.path_base)!=null?c:"/",s=`${t}//${n}/${i}`,r=new Set(["POST","PATCH","PUT"]),o={...e!=null?e:{},"content-type":"application/json"};return(_,g,u)=>{const d=_.toUpperCase().trim(),p=g!=null?g:"",w=u!=null?u:{},S=new URL(s);d==="GET"&&Object.entries(w).map(([y,T])=>S.searchParams.append(y,T)),S.pathname=[S.pathname,p].join("/").split("/").filter(Boolean).concat(" ").filter(Boolean).join("/").trim();const h=r.has(d)?JSON.stringify(w):null;return new Request(S,{method:d,headers:o,body:h})}},ci=(l,e,t)=>{var p,w,S;const n=fi(l,e.operator?{"x-username":e.operator}:{}),i=(p=e.onerror)!=null?p:tt,s=(w=e.onnotify)!=null?w:tt,r=(S=e.onNotAuthorizedError)!=null?S:tt,o=t!=null?t:(h,y)=>y(),a=async([h,y,T],D)=>{let L=null,C=null,O={},x=null,G=!1;try{O.request=L=n(h,y,T),O.response=C=await o({request:L,method:h,path:y,options:T},()=>fetch(L));for(const re of D)O=await re(O)}catch(re){x=re,G=!0}await Ue(()=>{x instanceof $l&&r()});const J=[];return J.push(...await Ue(async()=>{const re=new URL(L.url);return[{type:"normal",chunks:[{color:"#fff",text:L.method},{color:"#000",text:`${re.pathname}${String(re.searchParams)?"?"+re.searchParams:""}`},{color:"#f00",text:await Ue(()=>C.status,"")}]},{type:"mini",text:`${re.protocol}//${re.host}`}]},[`${h} ${y}`])),J.push(await Ue(()=>L.body?"Body: "+JSON.stringify(T).slice(0,100):"")),J.push(await Ue(()=>O.result.detail?`Detail: ${O.result.detail}`:"")),J.push(Dn(x)),G?i(J):s(J),!G&&O.hasOwnProperty("result")?O.result:null},f=[dt,ut],c=[dt,ut,ri],_=[dt,ut,ii],g=[dt,ut,oi],u=[..._,ai],d={};return d.message_GetList=h=>a(["GET","messages",h],u),d.message_Create=(h,y)=>a(["POST","messages",{dialog:h,text:y,is_read:!0}],c),d.dialog_GetList=h=>a(["GET","dialogs",h],u),d.dialog_SetTags=(h,y)=>a(["PATCH",`dialogs/${h}`,{tag:y}],_),d.dialog_SetReadFlagAllMessages=h=>a(["POST",`dialogs/${h}/read`,{}],g),d.lead_GetUnassignedList=h=>a(["GET","leads/unassigned",h],u),d.lead_AssignOperatorSelft=h=>a(["POST",`leads/${h}/assign`,{}],_),d.lead_SetStatus=(h,y)=>a(["PATCH",`leads/${h}`,{status:y}],_),d.lead_GetUnassignedLeadCount=()=>a(["GET","leads/count_free",{}],_),d.lead_AssignOneLead=()=>a(["POST","leads/get_one",{}],[...f,async h=>await Ue(()=>{var y;return h.result=(y={200:!0,400:!1}[h.response.status])!=null?y:null,h})]),d.operatorSelf_GetOnlineInfo=()=>a(["GET","online",{}],_),d.operatorSelf_SetOnlineFlag=h=>a(["PUT","online",{online:!!h}],_),d.operator_GetList=h=>a(["GET","operators",h],u),d},ui=()=>{const l=()=>!0,e=M=>new Promise(k=>setTimeout(k,M)),t=(M,k)=>e(M+Math.round(Math.random()*(k-M))),n=(M,k,N)=>Math.min(N,Math.max(M,k)),i=(M=0)=>new Date(Date.now()+(M!=null?M:0)).toJSON(),s=(M,k)=>{var K;const N=Math.max(0,(k==null?void 0:k.offset)|0),W=n(1,((K=k==null?void 0:k.limit)!=null?K:20)|0,1e6),X=M.length,ee=M.slice(N,N+W);return{count:X,results:ee}};let r=1;const o=M=>(M!=null?M:[]).map(k=>({...k,id:r++}));let a=1;const f=[],c={},_=M=>{var k;return(k=c[M])!=null?k:null},g=()=>f,u=M=>{var N,W,X;const k={operator_id:a++,username:(N=M.username)!=null?N:null,first_name:(W=M.first_name)!=null?W:null,last_name:(X=M.last_name)!=null?X:null};return f.push(k),c[k.username]=k,te(k.username),k};let d=123123124;const p=[],w={},S=M=>{var k;return(k=w[M])!=null?k:null},h=()=>p.filter(M=>!M.hasOperator).sort((M,k)=>M._date_joined_msec-k._date_joined_msec),y=()=>({count:p.filter(M=>!M.hasOperator).length}),T=M=>{var W,X,ee;const k=d++,N={tg_id:k,username:(W=M.username)!=null?W:null,first_name:(X=M.first_name)!=null?X:null,last_name:(ee=M.last_name)!=null?ee:null,date_joined:i(M.timeDelta),esub:null,pub_id:null,refcode:null,subpub:null,hasOperator:!1,status:"NW",ref_link:`https://ref.global.com/getRef?tg_id=${k}`};return N._date_joined_msec=+new Date(N.date_joined),p.push(N),w[N.tg_id]=N,N},D=(M,k)=>{const N=S(k);return!N||!_(M)||N.hasOperator?!1:(q(M,k),N.hasOperator=!0,!0)},L=M=>{const k=h();let N=!1;return k.length&&(N=D(M,k[0].tg_id)),N?{status:"lead connected",__status:200}:{status:"error: there is no free leads",__status:400}},C=(M,k,N)=>{const W=S(k);return W?(N.status&&(W.status=N.status),W):null};let O=1;const x=[],G={},J=M=>{var k;return(k=G[M])!=null?k:null},re=(M,k=[])=>{M.tag||(M.tag=[],M._tagSearch=new Set);const N=o(k);M.tag.splice(0,1e9),M._tagSearch.clear(),N.map(W=>{M.tag.push(W),M._tagSearch.add(W.title)})},q=(M,k)=>{const N=S(k);if(!N||!_(M))return null;const X={id:O++,lead_id:k,lead:N,operator:M,unread_messages_count:0,last_message:null};return re(X),x.push(X),G[X.id]=X,N.hasOperator=!0,X},Q=(M,k,N)=>{const W=J(k);return W?(N.tag&&re(W,N.tag),W):null},$=(M,k,N)=>{const W=J(k);return W?(se(M,{dialog_id:+k}).map(ee=>ee.is_read=!1),W.unread_messages_count=0,!0):null},ne=(M,k={})=>{const N=fe=>fe.last_message?fe.last_message._received_at_msec:fe.lead?fe.lead._date_joined_msec:0,W=(fe,De)=>De-fe,X=(fe,De)=>{let Ie=W(N(fe),N(De));return Ie===0&&(Ie=W(fe.id,De.id)),Ie},ee=k.status?new Set(k.status.split(",")):null,K=x.filter(fe=>fe.operator===M).filter(k.tag?fe=>fe._tagSearch.has(k.tag):l).filter(ee?fe=>ee.has(fe.lead.status):l).filter(fe=>{var De;return((De=fe==null?void 0:fe.lead)==null?void 0:De.status)!=="DL"});let ce=[],me=[];return k.unread_first?(ce=K.filter(fe=>fe.unread_messages_count!==0),me=K.filter(fe=>fe.unread_messages_count===0)):ce=K,ce.sort(X),me.sort(X),ce.concat(me)};let F=1;const V=[],H={},I=(M,k={})=>{var K,ce,me;const N=+k.dialog,W=k.text,X=J(N);if(!X)return null;const ee={id:F++,dialog:N,text:W,is_read:(K=k.is_read)!=null?K:!0,incoming:(ce=k.incoming)!=null?ce:!1,attachments:(me=k.attachments)!=null?me:[],received_at:i(k.timeDelta)};return ee._received_at_msec=+new Date(ee.received_at),V.push(ee),H[ee.id]=ee,X.last_message=ee,ee.is_read||X.unread_messages_count++,ee},se=(M,k={})=>V.filter(k.dialog_id?N=>N.dialog===k.dialog_id:l),B=5*60*1e3,z={},Y=M=>{var k;return(k=z[M])!=null?k:null},te=(M,k={})=>{const W={online:!!k.online,offline_at:i(B),interval:Math.round(B/1e3)};return z[M]=W,W},oe=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.webp","9.webp","10.png","11.png","13.png","12.webp"],Me=`\u0414\u0430, \u043C\u0451\u0440\u0442\u0432.
\u0411\u0435\u0434\u0441\u0442\u0432\u0438\u0435, \u0443\u0433\u0440\u043E\u0436\u0430\u044E\u0449\u0435\u0435 \u0436\u0438\u0437\u043D\u0438 \u0434\u0435\u0432\u0443\u0448\u043A\u0438, \u0438\u0441\u0447\u0435\u0437\u043B\u043E, \u0441\u043B\u043E\u0432\u043D\u043E \u044D\u0442\u043E \u0431\u044B\u043B\u0430 \u043A\u0430\u043A\u0430\u044F-\u0442\u043E \u0448\u0443\u0442\u043A\u0430. \u041D\u043E \u043E\u043D\u0430 \u043D\u0435 \u043C\u043E\u0433\u043B\u0430 \u0440\u0430\u0434\u043E\u0432\u0430\u0442\u044C\u0441\u044F, \u0432\u0435\u0434\u044C \u0421\u043C\u0435\u0440\u0442\u044C \u0441\u043C\u0435\u043D\u0438\u043B\u0430 \u0441\u0432\u043E\u044E \u0444\u043E\u0440\u043C\u0443 \u0438 \u043F\u0440\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432 \u0431\u043E\u043B\u0435\u0435 \u044F\u0432\u043D\u043E\u043C \u0432\u0438\u0434\u0435.
\u041F\u043E\u0434 \u0432\u0437\u0433\u043B\u044F\u0434\u043E\u043C \u043D\u0430\u043F\u0443\u0433\u0430\u043D\u043D\u043E\u0439 \u0434\u0435\u0432\u0443\u0448\u043A\u0438 \u0421\u043C\u0435\u0440\u0442\u044C \u0434\u0432\u0438\u043D\u0443\u043B\u0430\u0441\u044C \u0432 \u0435\u0451 \u0441\u0442\u043E\u0440\u043E\u043D\u0443. \u0422\u044C\u043C\u0430 \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439 \u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0433\u0443\u0449\u0430\u0442\u044C\u0441\u044F.
\u0422\u044C\u043C\u0430... \u043E\u043D\u0430 \u0441\u0435\u0439\u0447\u0430\u0441 \u043C\u0435\u043D\u044F \u043F\u0440\u043E\u0433\u043B\u043E\u0442\u0438\u0442, \u2014 \u043F\u043E\u0434\u0443\u043C\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430 \u0438 \u0435\u0449\u0451 \u043A\u0440\u0435\u043F\u0447\u0435 \u043E\u0431\u043D\u044F\u043B\u0430 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443. \u041E\u043D\u0430 \u0443\u0436\u0435 \u0434\u0430\u0436\u0435 \u0438 \u043D\u0435 \u0434\u0443\u043C\u0430\u043B\u0430 \u0431\u0435\u0436\u0430\u0442\u044C. \u0411\u0443\u0434\u044C \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u043E\u043C, \u043E\u043D\u0430 \u0431\u044B \u0435\u0449\u0435 \u043C\u043E\u0433\u043B\u0430 \u043D\u0430 \u0447\u0442\u043E-\u0442\u043E \u043D\u0430\u0434\u0435\u044F\u0442\u044C\u0441\u044F. \u041D\u043E \u043D\u0435\u0447\u0442\u043E, \u0432\u043E\u0437\u0432\u044B\u0448\u0430\u044E\u0449\u0435\u0435\u0441\u044F \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439, \u0441 \u043B\u0435\u0433\u043A\u043E\u0441\u0442\u044C\u044E \u0440\u0430\u0437\u0432\u0435\u044F\u043B\u043E \u0442\u0430\u043A\u0438\u0435 \u043C\u044B\u0441\u043B\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0445\u043E\u0442\u044F \u0431\u044B \u0434\u0430\u0440\u0443\u0439 \u043C\u043D\u0435 \u0431\u0435\u0437\u0431\u043E\u043B\u0435\u0437\u043D\u0435\u043D\u043D\u0443\u044E \u0441\u043C\u0435\u0440\u0442\u044C.
\u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u043C\u043E\u043B\u0438\u0442\u044C\u0441\u044F.
\u041C\u0430\u043B\u044B\u0448\u043A\u0430 \u0443\u0446\u0435\u043F\u0438\u043B\u0430\u0441\u044C \u0437\u0430 \u0435\u0451 \u0442\u0430\u043B\u0438\u044E, \u0434\u0440\u043E\u0436\u0430 \u043E\u0442 \u0443\u0436\u0430\u0441\u0430. \u0421\u043F\u0430\u0441\u0442\u0438 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443... \u043D\u043E \u044D\u0442\u043E \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E. \u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u0438\u0437\u0432\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u0437\u0430 \u0441\u0432\u043E\u0451 \u0431\u0435\u0441\u0441\u0438\u043B\u0438\u0435. \u0421\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0430, \u0442\u044B \u043D\u0435 \u0431\u0443\u0434\u0435\u0448\u044C \u043E\u0434\u0438\u043D\u043E\u043A\u0430, \u044F \u043F\u043E\u0439\u0434\u0443 \u0441 \u0442\u043E\u0431\u043E\u0439.
\u0418 \u0442\u043E\u0433\u0434\u0430...`;let Ee=1;const Te=(M=null,k=null)=>(M=M!=null?M:Math.random()*oe.length|0,k=k!=null?k:k=["IM","DC"][Math.random()*2|0],{file:Ee++,file_type:k,url:`assets/img-test/${oe[M]}`});(async()=>{const M=(X,ee)=>{const K=ee/X;let ce=-(ee+K);return()=>(ce+=K,ce)};let k=1;const N=(X=0)=>{let ee=Math.random()<.5,K=Math.random()<.5,ce=Math.random()<.5;!ee&&!K&&!ce&&(ee=!0),ee=K=ce=!0;const me=(k++).toString(36);return T({username:ee?`test_lead_${me}`:null,first_name:K?`F${me}`:null,last_name:ce?`L${me}`:null,timeDelta:X})},W=(X,ee,K=0)=>{I(X,{dialog:ee,text:`\u041F\u0440\u0438\u0432\u0435\u0442 @${X}. \u042F \u043D\u043E\u0432\u044B\u0439 \u043B\u0438\u0434, \u0432\u043E\u0442.`,is_read:!1,incoming:!0,timeDelta:K});for(let ce=0;ce<Math.round(Math.random()*oe.length);ce++){const me=Te(ce);I(X,{dialog:ee,text:`${me.file_type==="IM"?"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430":"\u0424\u0430\u0439\u043B"} ${ce+1}.`,is_read:!1,incoming:!0,attachments:[me],timeDelta:K+ce*1e3})}};for(let X=0;X<10;X++){const K=[10,100,1e3,5e3,7e3,1e4,1e4,1e5,2,3,5,7,8,10][X],ce=`op_test_${X}`;u({username:ce,first_name:"OpNumDlgs",last_name:K+""});let me=0;const fe=M(K,6e4*K);for(let De=0;De<K;De++){const Ie=fe(),ze=N(Ie),Be=q(ce,ze.tg_id);Math.random()<.5&&me++<5&&W(ce,Be.id,Ie)}}for(;;)await t(1e3,1e4),N()})();const ue=(M,k,N)=>{const W=K=>{K&&te(N)},X=async K=>{await t(1e3,1e4);const ce=k.text.match(/without_text/i),me=k.text.match(/long_text/i),fe=k.text.match(/allimg|allfile/i),De=ce?"":me?Me:`\u042D\u0445\u043E \u043E\u0442\u0432\u0435\u0442 \u0434\u043B\u044F @${N}.
"${k.text}"`;if(fe){const ze=k.text.match(/allimg/i)?"IM":"DC";for(let Be=0;Be<oe.length;Be++)I(N,{dialog:k.dialog,text:De,is_read:!1,incoming:!0,attachments:[Te(Be,ze)]});return}const Ie=[];k.text.match(/img/i)?Ie.push(Te(null,"IM")):k.text.match(/file/i)&&Ie.push(Te(null,"DC")),I(N,{dialog:k.dialog,text:De,is_read:!1,incoming:!0,attachments:Ie})},ee=K=>{var ce;return(ce=K==null?void 0:K.__status)!=null?ce:200};M("GET","operators",200,()=>s(g(),k)),M("GET","online",200,()=>Y(N)),M("PUT","online",200,()=>te(N,k)),M("GET","leads/unassigned",200,()=>s(h(),k)),M("GET","leads/count_free",200,()=>y()),M("POST","leads/get_one",ee,()=>L(N)),M("POST",/^leads\/(\d+)\/assign$/,200,K=>D(N,K),[W]),M("PATCH",/^leads\/(\d+)$/,200,K=>C(N,K,k),[W]),M("GET","dialogs",200,()=>s(ne(N,k),k)),M("POST",/^dialogs\/(\d+)\/read$/,204,K=>$(N,K)),M("PATCH",/^dialogs\/(\d+)$/,200,K=>Q(N,K,k),[W]),M("GET","messages",200,()=>s(se(N,k),k)),M("POST","messages",201,()=>I(N,k),[W,X])},Ae=M=>{var Ie,ze,Be,Pt,Rt;const k=((Ie=M==null?void 0:M.method)!=null?Ie:"").toUpperCase().trim(),N=((ze=M==null?void 0:M.path)!=null?ze:"").split("/").map(Ce=>Ce.trim()).filter(Boolean).join("/"),W=Object.fromEntries(Object.entries((Be=M==null?void 0:M.headers)!=null?Be:{}).map(Ce=>[Ce[0].toLowerCase(),Ce[1]])),X=(Pt=M==null?void 0:M.options)!=null?Pt:{},ee=(Rt=W["x-username"])!=null?Rt:null,K=[];ue((Ce,rt,en,tn,ln=[])=>K.push({method:Ce,pathPattern:rt,cb:tn,status:en,mwList:ln}),X,ee);const me=K.map(Ce=>{if(Ce.method===k){if(Ce.pathPattern instanceof RegExp){const rt=N.match(Ce.pathPattern);return rt?{...Ce,args:rt.slice(1)}:!1}return Ce.pathPattern===N?{...Ce,args:[]}:!1}}).filter(Boolean)[0];if(!me)return null;const fe=me.cb(...me.args);return me.mwList&&me.mwList.map(Ce=>Ce(fe,ee,X)),{status:typeof me.status=="function"?me.status(fe):me.status,result:fe}};try{self.addEventListener("message",({data:{rpcID:M,data:k}})=>{let N,W;try{N=Ae(k)}catch(X){W=X.message}self.postMessage({rpcID:M,result:N,error:W})})}catch{}return{request:Ae}},di=()=>{const l=`( ${ui.toString()} )()`,e=new Blob([l],{type:"text/javascript"}),t=new Worker(window.URL.createObjectURL(e));let n=1;const i={};return t.addEventListener("message",({data:{rpcID:o,result:a,error:f}})=>{const c=i[o];delete i[o],f&&c.reject(new Error(f)),c.resolve(a)}),{request:o=>{const a=n++,f=i[a]=Nt();return t.postMessage({rpcID:a,data:o}),f.promise},destroy:()=>t.terminate()}};function _i(l){let e,t,n,i,s;return t=new Qs({props:{operatorSelf:l[0],config:l[2],notifyEvents:l[1],createApi:l[3]}}),{c(){e=b("div"),pe(t.$$.fragment),v(e,"class","pos_rel flex")},m(r,o){j(r,e,o),de(t,e,null),n=!0,i||(s=nt(kt.call(null,e)),i=!0)},p(r,o){const a={};o&1&&(a.operatorSelf=r[0]),t.$set(a)},i(r){n||(P(t.$$.fragment,r),n=!0)},o(r){U(t.$$.fragment,r),n=!1},d(r){r&&A(e),_e(t),i=!1,s()}}}function mi(l){let e,t,n,i,s;return e=new jn({props:{select:"operators"}}),i=new ni({props:{api:l[4]}}),{c(){pe(e.$$.fragment),t=E(),n=b("div"),pe(i.$$.fragment),v(n,"class","flex")},m(r,o){de(e,r,o),j(r,t,o),j(r,n,o),de(i,n,null),s=!0},p:ae,i(r){s||(P(e.$$.fragment,r),P(i.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),U(i.$$.fragment,r),s=!1},d(r){_e(e,r),r&&A(t),r&&A(n),_e(i)}}}function pi(l){let e,t,n,i,s,r;const o=[mi,_i],a=[];function f(c,_){return c[0]?1:0}return t=f(l),n=a[t]=o[t](l),s=new Gn({props:{events:l[1]}}),{c(){e=b("main"),n.c(),i=E(),pe(s.$$.fragment),v(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-l8w6xt")},m(c,_){j(c,e,_),a[t].m(e,null),m(e,i),de(s,e,null),r=!0},p(c,[_]){let g=t;t=f(c),t===g?a[t].p(c,_):(Se(),U(a[g],1,1,()=>{a[g]=null}),Le(),n=a[t],n?n.p(c,_):(n=a[t]=o[t](c),n.c()),P(n,1),n.m(e,i))},i(c){r||(P(n),P(s.$$.fragment,c),r=!0)},o(c){U(n),U(s.$$.fragment,c),r=!1},d(c){c&&A(e),a[t].d(),_e(s)}}}function gi(l,e,t){let n;ke(l,bt,f=>t(0,n=f));const i=Ft(),s=g_Config,o=(f=>{var u;const c=((u=f.testMode)!=null?u:!0)&&!Wl().has("real-api");let _=()=>null,g=f.api;if(c){const d=di();Pe(d.destroy),g={protocol:"https:",host:"test.mode.dev",path_base:"api/"},_=()=>async({method:p,path:w,options:S,request:h})=>{const y=Object.fromEntries([...h.headers]),{status:T,result:D}=await d.request({method:p,path:w,options:S,headers:y});return{status:T,json:()=>D}}}return(d=null)=>ci(g,{onerror:p=>i.emit("error",p),onnotify:p=>i.emit("debug",p),onNotAuthorizedError:()=>Ye(bt,n=null,n),operator:d},_())})(s),a=o();return[n,i,s,o,a]}class hi extends ve{constructor(e){super(),he(this,e,gi,pi,ge,{})}}new hi({target:document.getElementById("app")});
