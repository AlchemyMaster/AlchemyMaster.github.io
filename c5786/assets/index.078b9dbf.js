(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function z(){}const St=n=>n;function Tt(n){return n()}function et(){return Object.create(null)}function pe(n){n.forEach(Tt)}function Le(n){return typeof n=="function"}function ie(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Bt(n){return Object.keys(n).length===0}function Ct(n,...e){if(n==null)return z;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function xe(n,e,t){n.$$.on_destroy.push(Ct(e,t))}function Pe(n){return n&&Le(n.destroy)?n.destroy:z}const Et=typeof window<"u";let Pt=Et?()=>window.performance.now():()=>Date.now(),Ue=Et?n=>requestAnimationFrame(n):z;const ke=new Set;function Ot(n){ke.forEach(e=>{e.c(n)||(ke.delete(e),e.f())}),ke.size!==0&&Ue(Ot)}function Yt(n){let e;return ke.size===0&&Ue(Ot),{promise:new Promise(t=>{ke.add(e={c:n,f:t})}),abort(){ke.delete(e)}}}function g(n,e){n.appendChild(e)}function Ft(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Rt(n,e){return g(n.head||n,e),e.sheet}function $(n,e,t){n.insertBefore(e,t||null)}function D(n){n.parentNode.removeChild(n)}function Wt(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function k(n){return document.createElement(n)}function P(n){return document.createTextNode(n)}function A(){return P(" ")}function Je(){return P("")}function Q(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function T(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Gt(n){return Array.from(n.childNodes)}function X(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function tt(n,e){n.value=e==null?"":e}function W(n,e,t,l){t===null?n.style.removeProperty(e):n.style.setProperty(e,t,l?"important":"")}function J(n,e,t){n.classList[t?"add":"remove"](e)}function qt(n,e,{bubbles:t=!1,cancelable:l=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(n,t,l,e),s}const Be=new Map;let Ce=0;function zt(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Ut(n){const e={style_element:k("style"),rules:{}};return Be.set(n,e),e}function nt(n,e,t,l,s,r,i,o=0){const a=16.666/l;let u=`{
`;for(let c=0;c<=1;c+=a){const p=e+(t-e)*r(c);u+=c*100+`%{${i(p,1-p)}}
`}const _=u+`100% {${i(t,1-t)}}
}`,m=`__svelte_${zt(_)}_${o}`,f=Ft(n),{style_element:d,rules:h}=Be.get(f)||Ut(f);if(!h[m]){const c=Rt(f,d);h[m]=!0,c.insertRule(`@keyframes ${m} ${_}`,c.cssRules.length)}const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${m} ${l}ms linear ${s}ms 1 both`,Ce+=1,m}function Jt(n,e){const t=(n.style.animation||"").split(", "),l=t.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),s=t.length-l.length;s&&(n.style.animation=l.join(", "),Ce-=s,Ce||Xt())}function Xt(){Ue(()=>{Ce||(Be.forEach(n=>{const{style_element:e}=n;D(e)}),Be.clear())})}let De;function Ae(n){De=n}function Kt(){if(!De)throw new Error("Function called outside component initialization");return De}function At(n){Kt().$$.on_destroy.push(n)}const Oe=[],we=[],Ne=[],qe=[],Zt=Promise.resolve();let ze=!1;function Qt(){ze||(ze=!0,Zt.then(jt))}function ae(n){Ne.push(n)}function Dt(n){qe.push(n)}const Fe=new Set;let $e=0;function jt(){const n=De;do{for(;$e<Oe.length;){const e=Oe[$e];$e++,Ae(e),Vt(e.$$)}for(Ae(null),Oe.length=0,$e=0;we.length;)we.pop()();for(let e=0;e<Ne.length;e+=1){const t=Ne[e];Fe.has(t)||(Fe.add(t),t())}Ne.length=0}while(Oe.length);for(;qe.length;)qe.pop()();ze=!1,Fe.clear(),Ae(n)}function Vt(n){if(n.fragment!==null){n.update(),pe(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ae)}}let Ee;function en(){return Ee||(Ee=Promise.resolve(),Ee.then(()=>{Ee=null})),Ee}function Re(n,e,t){n.dispatchEvent(qt(`${e?"intro":"outro"}${t}`))}const He=new Set;let oe;function _e(){oe={r:0,c:[],p:oe}}function me(){oe.r||pe(oe.c),oe=oe.p}function N(n,e){n&&n.i&&(He.delete(n),n.i(e))}function C(n,e,t,l){if(n&&n.o){if(He.has(n))return;He.add(n),oe.c.push(()=>{He.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}const tn={duration:0};function le(n,e,t,l){let s=e(n,t),r=l?0:1,i=null,o=null,a=null;function u(){a&&Jt(n,a)}function _(f,d){const h=f.b-r;return d*=Math.abs(h),{a:r,b:f.b,d:h,duration:d,start:f.start,end:f.start+d,group:f.group}}function m(f){const{delay:d=0,duration:h=300,easing:b=St,tick:c=z,css:p}=s||tn,v={start:Pt()+d,b:f};f||(v.group=oe,oe.r+=1),i||o?o=v:(p&&(u(),a=nt(n,r,f,h,d,b,p)),f&&c(0,1),i=_(v,h),ae(()=>Re(n,f,"start")),Yt(O=>{if(o&&O>o.start&&(i=_(o,h),o=null,Re(n,i.b,"start"),p&&(u(),a=nt(n,r,i.b,i.duration,0,b,s.css))),i){if(O>=i.end)c(r=i.b,1-r),Re(n,i.b,"end"),o||(i.b?u():--i.group.r||pe(i.group.c)),i=null;else if(O>=i.start){const E=O-i.start;r=i.a+i.d*b(E/i.duration),c(r,1-r)}}return!!(i||o)}))}return{run(f){Le(s)?en().then(()=>{s=s(),m(f)}):m(f)},end(){u(),i=o=null}}}const nn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ln(n,e){n.d(1),e.delete(n.key)}function $t(n,e){C(n,1,1,()=>{e.delete(n.key)})}function Xe(n,e,t,l,s,r,i,o,a,u,_,m){let f=n.length,d=r.length,h=f;const b={};for(;h--;)b[n[h].key]=h;const c=[],p=new Map,v=new Map;for(h=d;h--;){const w=m(s,r,h),L=t(w);let S=i.get(L);S?l&&S.p(w,e):(S=u(L,w),S.c()),p.set(L,c[h]=S),L in b&&v.set(L,Math.abs(h-b[L]))}const O=new Set,E=new Set;function y(w){N(w,1),w.m(o,_),i.set(w.key,w),_=w.first,d--}for(;f&&d;){const w=c[d-1],L=n[f-1],S=w.key,H=L.key;w===L?(_=w.first,f--,d--):p.has(H)?!i.has(S)||O.has(S)?y(w):E.has(H)?f--:v.get(S)>v.get(H)?(E.add(S),y(w)):(O.add(H),f--):(a(L,i),f--)}for(;f--;){const w=n[f];p.has(w.key)||a(w,i)}for(;d;)y(c[d-1]);return c}function It(n,e,t){const l=n.$$.props[e];l!==void 0&&(n.$$.bound[l]=t,t(n.$$.ctx[l]))}function se(n){n&&n.c()}function ee(n,e,t,l){const{fragment:s,on_mount:r,on_destroy:i,after_update:o}=n.$$;s&&s.m(e,t),l||ae(()=>{const a=r.map(Tt).filter(Le);i?i.push(...a):pe(a),n.$$.on_mount=[]}),o.forEach(ae)}function te(n,e){const t=n.$$;t.fragment!==null&&(pe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function sn(n,e){n.$$.dirty[0]===-1&&(Oe.push(n),Qt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function fe(n,e,t,l,s,r,i,o=[-1]){const a=De;Ae(n);const u=n.$$={fragment:null,ctx:null,props:r,update:z,not_equal:s,bound:et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:et(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};i&&i(u.root);let _=!1;if(u.ctx=t?t(n,e.props||{},(m,f,...d)=>{const h=d.length?d[0]:f;return u.ctx&&s(u.ctx[m],u.ctx[m]=h)&&(!u.skip_bound&&u.bound[m]&&u.bound[m](h),_&&sn(n,m)),f}):[],u.update(),_=!0,pe(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const m=Gt(e.target);u.fragment&&u.fragment.l(m),m.forEach(D)}else u.fragment&&u.fragment.c();e.intro&&N(n.$$.fragment),ee(n,e.target,e.anchor,e.customElement),jt()}Ae(a)}class ue{$destroy(){te(this,1),this.$destroy=z}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const s=l.indexOf(t);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!Bt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function rn(n){const e=n-1;return e*e*e+1}function he(n,{delay:e=0,duration:t=400,easing:l=St}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:l,css:r=>`opacity: ${r*s}`}}function lt(n,{delay:e=0,duration:t=400,easing:l=rn}={}){const s=getComputedStyle(n),r=+s.opacity,i=parseFloat(s.height),o=parseFloat(s.paddingTop),a=parseFloat(s.paddingBottom),u=parseFloat(s.marginTop),_=parseFloat(s.marginBottom),m=parseFloat(s.borderTopWidth),f=parseFloat(s.borderBottomWidth);return{delay:e,duration:t,easing:l,css:d=>`overflow: hidden;opacity: ${Math.min(d*20,1)*r};height: ${d*i}px;padding-top: ${d*o}px;padding-bottom: ${d*a}px;margin-top: ${d*u}px;margin-bottom: ${d*_}px;border-top-width: ${d*m}px;border-bottom-width: ${d*f}px;`}}const ye=[];function Ke(n,e=z){let t;const l=new Set;function s(o){if(ie(n,o)&&(n=o,t)){const a=!ye.length;for(const u of l)u[1](),ye.push(u,n);if(a){for(let u=0;u<ye.length;u+=2)ye[u][0](ye[u+1]);ye.length=0}}}function r(o){s(o(n))}function i(o,a=z){const u=[o,a];return l.add(u),l.size===1&&(t=e(s)||z),o(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:s,update:r,subscribe:i}}const je=Ke(null),on=n=>{je.set(n),g_Api.setHeader("x-username",n.username)};function st(n){let e,t,l;return{c(){e=k("div"),e.textContent="Operators",T(e,"class","item cursor_ptr svelte-vbcb9r"),J(e,"active",n[0]==="operators"),J(e,"disabled",n[1].has("operators"))},m(s,r){$(s,e,r),t||(l=Q(e,"click",n[3]("operators")),t=!0)},p(s,r){r&1&&J(e,"active",s[0]==="operators"),r&2&&J(e,"disabled",s[1].has("operators"))},d(s){s&&D(e),t=!1,l()}}}function it(n){let e,t=n[2].username+"",l,s,r;return{c(){e=k("div"),l=P(t),T(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),W(e,"max-width","200px")},m(i,o){$(i,e,o),g(e,l),r=!0},p(i,o){(!r||o&4)&&t!==(t=i[2].username+"")&&X(l,t)},i(i){r||(ae(()=>{s||(s=le(e,he,{},!0)),s.run(1)}),r=!0)},o(i){s||(s=le(e,he,{},!1)),s.run(0),r=!1},d(i){i&&D(e),i&&s&&s.end()}}}function an(n){let e,t,l,s,r,i,o=!n[2]&&st(n),a=n[2]&&0,u=n[2]&&it(n);return{c(){e=k("div"),o&&o.c(),t=A(),a&&a.c(),l=A(),s=k("div"),r=A(),u&&u.c(),T(s,"class","flex flex_grow_1"),T(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(_,m){$(_,e,m),o&&o.m(e,null),g(e,t),a&&a.m(e,null),g(e,l),g(e,s),g(e,r),u&&u.m(e,null),i=!0},p(_,[m]){_[2]?o&&(o.d(1),o=null):o?o.p(_,m):(o=st(_),o.c(),o.m(e,t)),_[2],a&&(a.d(1),a=null),_[2]?u?(u.p(_,m),m&4&&N(u,1)):(u=it(_),u.c(),N(u,1),u.m(e,null)):u&&(_e(),C(u,1,1,()=>{u=null}),me())},i(_){i||(N(u),i=!0)},o(_){C(u),i=!1},d(_){_&&D(e),o&&o.d(),a&&a.d(),u&&u.d()}}}function fn(n,e,t){let l;xe(n,je,o=>t(2,l=o));let{select:s=""}=e,{disabled:r=new Set}=e;r.add("newLeads"),r.add("myLeads");const i=o=>a=>{r.has(o)||t(0,s=o)};return n.$$set=o=>{"select"in o&&t(0,s=o.select),"disabled"in o&&t(1,r=o.disabled)},[s,r,l,i]}class un extends ue{constructor(e){super(),fe(this,e,fn,an,ie,{select:0,disabled:1})}}function cn(n){let e;return{c(){e=k("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,T(e,"class","lds-roller svelte-j15bjw")},m(t,l){$(t,e,l)},p:z,i:z,o:z,d(t){t&&D(e)}}}class Ze extends ue{constructor(e){super(),fe(this,e,null,cn,ie,{})}}function rt(n,e,t){const l=n.slice();return l[5]=e[t],l}function dn(n){let e,t,l=n[0],s=[];for(let i=0;i<l.length;i+=1)s[i]=at(rt(n,l,i));const r=i=>C(s[i],1,1,()=>{s[i]=null});return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=Je()},m(i,o){for(let a=0;a<s.length;a+=1)s[a].m(i,o);$(i,e,o),t=!0},p(i,o){if(o&5){l=i[0];let a;for(a=0;a<l.length;a+=1){const u=rt(i,l,a);s[a]?(s[a].p(u,o),N(s[a],1)):(s[a]=at(u),s[a].c(),N(s[a],1),s[a].m(e.parentNode,e))}for(_e(),a=l.length;a<s.length;a+=1)r(a);me()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)N(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)C(s[o]);t=!1},d(i){Wt(s,i),i&&D(e)}}}function _n(n){let e,t,l,s,r;return s=new Ze({}),{c(){e=k("div"),t=k("div"),l=A(),se(s.$$.fragment),W(t,"height","20px"),T(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(i,o){$(i,e,o),g(e,t),g(e,l),ee(s,e,null),r=!0},p:z,i(i){r||(N(s.$$.fragment,i),r=!0)},o(i){C(s.$$.fragment,i),r=!1},d(i){i&&D(e),te(s)}}}function ot(n){let e,t,l=n[5].username+"",s;return{c(){e=k("div"),t=P("@"),s=P(l),T(e,"class","nowrap textOverEllipsis")},m(r,i){$(r,e,i),g(e,t),g(e,s)},p(r,i){i&1&&l!==(l=r[5].username+"")&&X(s,l)},d(r){r&&D(e)}}}function at(n){var O,E;let e,t,l,s=((O=n[5].first_name)!=null?O:"")+"",r,i,o,a,u,_=((E=n[5].last_name)!=null?E:"")+"",m,f,d,h,b,c,p,v=n[5].username&&ot(n);return{c(){e=k("div"),t=k("div"),l=k("div"),r=P(s),i=A(),o=k("div"),a=A(),u=k("div"),m=P(_),f=A(),v&&v.c(),d=A(),W(o,"width","8px"),T(t,"class","flex nowrap textOverEllipsis"),T(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(y,w){$(y,e,w),g(e,t),g(t,l),g(l,r),g(t,i),g(t,o),g(t,a),g(t,u),g(u,m),g(e,f),v&&v.m(e,null),g(e,d),b=!0,c||(p=Q(e,"click",function(){Le(n[2](n[5]))&&n[2](n[5]).apply(this,arguments)}),c=!0)},p(y,w){var L,S;n=y,(!b||w&1)&&s!==(s=((L=n[5].first_name)!=null?L:"")+"")&&X(r,s),(!b||w&1)&&_!==(_=((S=n[5].last_name)!=null?S:"")+"")&&X(m,_),n[5].username?v?v.p(n,w):(v=ot(n),v.c(),v.m(e,d)):v&&(v.d(1),v=null)},i(y){b||(y&&ae(()=>{h||(h=le(e,he,{},!0)),h.run(1)}),b=!0)},o(y){y&&(h||(h=le(e,he,{},!1)),h.run(0)),b=!1},d(y){y&&D(e),v&&v.d(),y&&h&&h.end(),c=!1,p()}}}function mn(n){let e,t,l,s;const r=[_n,dn],i=[];function o(a,u){return a[1]?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=k("div"),l.c(),T(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,u){$(a,e,u),i[t].m(e,null),s=!0},p(a,[u]){let _=t;t=o(a),t===_?i[t].p(a,u):(_e(),C(i[_],1,1,()=>{i[_]=null}),me(),l=i[t],l?l.p(a,u):(l=i[t]=r[t](a),l.c()),N(l,1),l.m(e,null))},i(a){s||(N(l),s=!0)},o(a){C(l),s=!1},d(a){a&&D(e),i[t].d()}}}function hn(n,e,t){let l=[],s=!1;const r=async()=>{t(1,s=!0);const a=await g_Api("GET","operators");t(0,l=a.results),t(1,s=!1)};let i=!1;const o=a=>u=>{i||(on(a),i=!0)};return r(),[l,s,o]}class pn extends ue{constructor(e){super(),fe(this,e,hn,mn,ie,{})}}const Nt=n=>new Promise(e=>setTimeout(e,n)),We=(n,e,t)=>Math.min(t,Math.max(n,e)),Qe=(n,e)=>{let t=null,l=null,s=!0;const r=()=>{s&&setTimeout(r,10);const o=n.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||l!==a.height)&&(t=a.width,l=a.height,n.style.width=`${t}px`,n.style.height=`${l}px`,e&&e.set(a))}};return r(),{destroy:()=>s=!1}},gn=(n,e)=>{let t=null,l=null,s=null,r=null,i=!0;const o=()=>{i&&setTimeout(o,10);const u=n.getBoundingClientRect();(t!==u.width||l!==u.height||s!==u.x||r!==u.y)&&(t=u.width,l=u.height,s=u.x,r=u.y,e&&e.set(u))};return o(),{destroy:()=>i=!1}};const{Map:vn}=nn;function ft(n,e,t){const l=n.slice();return l[13]=e[t],l}function ut(n){let e,t,l,s;return t=new Ze({}),{c(){e=k("div"),se(t.$$.fragment),T(e,"class","pos_abs loading svelte-1395xne")},m(r,i){$(r,e,i),ee(t,e,null),s=!0},i(r){s||(N(t.$$.fragment,r),r&&ae(()=>{l||(l=le(e,he,{},!0)),l.run(1)}),s=!0)},o(r){C(t.$$.fragment,r),r&&(l||(l=le(e,he,{},!1)),l.run(0)),s=!1},d(r){r&&D(e),te(t),r&&l&&l.end()}}}function ct(n){let e,t,l=n[13].username+"",s;return{c(){e=k("div"),t=P("@"),s=P(l),T(e,"class","nowrap textOverEllipsis username svelte-1395xne")},m(r,i){$(r,e,i),g(e,t),g(e,s)},p(r,i){i&2&&l!==(l=r[13].username+"")&&X(s,l)},d(r){r&&D(e)}}}function dt(n,e){var v,O;let t,l,s,r=((v=e[13].first_name)!=null?v:"")+"",i,o,a,u,_,m=((O=e[13].last_name)!=null?O:"")+"",f,d,h,b,c,p=e[13].username&&ct(e);return{key:n,first:null,c(){t=k("div"),l=k("div"),s=k("div"),i=P(r),o=A(),a=k("div"),u=A(),_=k("div"),f=P(m),d=A(),p&&p.c(),h=A(),W(a,"width","8px"),T(l,"class","flex nowrap textOverEllipsis userAttr svelte-1395xne"),T(t,"class","flex flex_clm cursor_ptr item unselect pos_abs svelte-1395xne"),W(t,"left",e[13].x+"px"),W(t,"top",e[13].y+"px"),J(t,"disabled",e[3].has(e[13].tg_id)),this.first=t},m(E,y){$(E,t,y),g(t,l),g(l,s),g(s,i),g(l,o),g(l,a),g(l,u),g(l,_),g(_,f),g(t,d),p&&p.m(t,null),g(t,h),b||(c=Q(t,"click",function(){Le(e[4](e[13]))&&e[4](e[13]).apply(this,arguments)}),b=!0)},p(E,y){var w,L;e=E,y&2&&r!==(r=((w=e[13].first_name)!=null?w:"")+"")&&X(i,r),y&2&&m!==(m=((L=e[13].last_name)!=null?L:"")+"")&&X(f,m),e[13].username?p?p.p(e,y):(p=ct(e),p.c(),p.m(t,h)):p&&(p.d(1),p=null),y&2&&W(t,"left",e[13].x+"px"),y&2&&W(t,"top",e[13].y+"px"),y&10&&J(t,"disabled",e[3].has(e[13].tg_id))},d(E){E&&D(t),p&&p.d(),b=!1,c()}}}function bn(n){let e,t,l,s,r,i,o,a=[],u=new vn,_,m,f,d=n[2]&&ut(),h=n[1];const b=c=>c[13].tg_id;for(let c=0;c<h.length;c+=1){let p=ft(n,h,c),v=b(p);u.set(v,a[c]=dt(v,p))}return{c(){e=k("div"),t=k("div"),l=P(`New leads\r
		\r
		`),d&&d.c(),s=A(),r=k("div"),i=k("div"),o=k("div");for(let c=0;c<a.length;c+=1)a[c].c();T(t,"class","flex flex_cx flex_cy header pos_rel svelte-1395xne"),T(o,"class","flex list h100 svelte-1395xne"),T(i,"class","pos_abs"),W(i,"overflow","hidden"),T(r,"class","flex cnt h100 pos_rel svelte-1395xne"),T(e,"class","flex flex_clm wrapMain svelte-1395xne")},m(c,p){$(c,e,p),g(e,t),g(t,l),d&&d.m(t,null),g(e,s),g(e,r),g(r,i),g(i,o);for(let v=0;v<a.length;v+=1)a[v].m(o,null);n[6](i),_=!0,m||(f=Pe(Qe.call(null,i)),m=!0)},p(c,[p]){c[2]?d?p&4&&N(d,1):(d=ut(),d.c(),N(d,1),d.m(t,null)):d&&(_e(),C(d,1,1,()=>{d=null}),me()),p&26&&(h=c[1],a=Xe(a,p,b,1,c,h,u,o,ln,dt,null,ft))},i(c){_||(N(d),_=!0)},o(c){C(d),_=!1},d(c){c&&D(e),d&&d.d();for(let p=0;p<a.length;p+=1)a[p].d();n[6](null),m=!1,f()}}}const wn=160,yn=33,Ge=0;async function _t(){var t;const n=await g_Api("GET","leads/unassigned",{offset:0,limit:20});return((t=n.results)!=null?t:n).map(l=>({...l,date_joined:+new Date(l.date_joined)})).sort((l,s)=>s.date_joined-l.date_joined)}function kn(n,e,t){let l;xe(n,je,c=>t(9,l=c));let s=[],r=new Map,i=[],o=null;function a(){if(!o)return;const c=o.getBoundingClientRect(),p=wn+Ge*2,v=yn+Ge*2,O=Math.max(1,Math.floor(c.width/p)),E=(c.width-O*p)/2,y=Ge;t(1,i=s.map((w,L)=>{const S={...w};return S.x=L%O*p+E,S.y=y+Math.floor(L/O)*v,S}))}let u=!1;async function _(){t(2,u=!0),t(5,s=await _t()),t(2,u=!1),f()}let m=!0;async function f(){for(;m;){await Nt(1e3);const c=new Set(s.map(L=>L.tg_id)),p=await _t(),v=new Set(p.map(L=>L.tg_id)),O=p.filter(L=>!c.has(L.tg_id)),E=s.filter(L=>!v.has(L.tg_id)),y=Date.now();E.map(L=>r.has(L.tg_id)||r.set(L.tg_id,y)),O.length===0&&E.length===0||t(5,s=[...s,...O].sort((L,S)=>S.date_joined-L.date_joined));const w=new Set;[...r].map(L=>{L[1]+2e3<=y&&w.add(L[0]),L[1]+1e4<=y&&r.delete(L[0])}),w.size&&t(5,s=s.filter(L=>!w.has(L.tg_id)))}}At(()=>m=!1);let d=!1;const h=c=>async p=>{if(!l||d)return;d=!0;const v=await g_Api("POST",`leads/${c.tg_id}/assign`);v&&(r.set(c.tg_id,Date.now()),t(5,s)),console.log({result:v},s.length,i.length,r.size),d=!1};_();function b(c){we[c?"unshift":"push"](()=>{o=c,t(0,o)})}return n.$$.update=()=>{n.$$.dirty&33&&a()},[o,i,u,r,h,s,b]}class Ln extends ue{constructor(e){super(),fe(this,e,kn,bn,ie,{})}}function mt(n){let e,t;return{c(){e=k("div"),t=P(n[1]),T(e,"class","username svelte-10cuqsv")},m(l,s){$(l,e,s),g(e,t)},p(l,s){s&2&&X(t,l[1])},d(l){l&&D(e)}}}function xn(n){let e,t,l,s,r,i=n[0]&&n[1]&&mt(n);return{c(){e=k("div"),i&&i.c(),t=A(),l=k("div"),s=k("pre"),r=P(n[2]),T(s,"class","text svelte-10cuqsv"),T(l,"class","flex"),T(e,"class","flex flex_clm chat_item pos_abs svelte-10cuqsv"),J(e,"chat_item_other",n[0]),J(e,"chat_item_self",!n[0])},m(o,a){$(o,e,a),i&&i.m(e,null),g(e,t),g(e,l),g(l,s),g(s,r),n[6](e)},p(o,[a]){o[0]&&o[1]?i?i.p(o,a):(i=mt(o),i.c(),i.m(e,t)):i&&(i.d(1),i=null),a&4&&X(r,o[2]),a&1&&J(e,"chat_item_other",o[0]),a&1&&J(e,"chat_item_self",!o[0])},i:z,o:z,d(o){o&&D(e),i&&i.d(),n[6](null)}}}function Mn(n,e,t){let{incoming:l=!1}=e,{username:s=null}=e,{text:r=null}=e,{render_Width:i=1}=e,{render_X:o=-i*2}=e,a=null;function u(_){we[_?"unshift":"push"](()=>{a=_,t(3,a)})}return n.$$set=_=>{"incoming"in _&&t(0,l=_.incoming),"username"in _&&t(1,s=_.username),"text"in _&&t(2,r=_.text),"render_Width"in _&&t(4,i=_.render_Width),"render_X"in _&&t(5,o=_.render_X)},[l,s,r,a,i,o,u]}class Sn extends ue{constructor(e){super(),fe(this,e,Mn,xn,ie,{incoming:0,username:1,text:2,render_Width:4,render_X:5})}}function Tn(n){let e,t,l,s;return{c(){e=k("div"),t=k("div"),T(t,"class","pos_abs thumb w100 svelte-1un6dgr"),W(t,"height",n[1]+"px"),W(t,"top",n[5](n[0],n[3])+"px"),J(t,"active",n[2]),T(e,"class","pos_rel h100 unselect line svelte-1un6dgr"),J(e,"active",n[2])},m(r,i){$(r,e,i),g(e,t),l||(s=[Q(window,"mousemove",n[7]),Q(window,"mouseup",n[8]),Q(window,"blur",n[8]),Q(t,"mousedown",n[6]),Pe(gn.call(null,e,n[4])),Q(e,"mousedown",n[9])],l=!0)},p(r,[i]){i&2&&W(t,"height",r[1]+"px"),i&9&&W(t,"top",r[5](r[0],r[3])+"px"),i&4&&J(t,"active",r[2]),i&4&&J(e,"active",r[2])},i:z,o:z,d(r){r&&D(e),l=!1,pe(s)}}}function En(n,e,t){let l,{value_in:s=0}=e,{value_out:r=s}=e,{thumb_Height:i=20}=e;const o=Ke(null);xe(n,o,c=>t(3,l=c));const a=()=>l?l.height-i:1,u=c=>l?c*a():0;let _=null;const m=c=>{!l||t(2,_={y:c.clientY,value_out:r})},f=c=>{if(!l||!_)return;const p=c.clientY-_.y;if(l.height){const v=p/a();t(0,r=We(0,_.value_out+v,1))}},d=c=>{t(2,_=null)},h=c=>{!l||(t(0,r=We(0,(c.clientY-l.y-i/2)/a(),1)),t(2,_={y:c.clientY,value_out:r}))},b=()=>{_||t(0,r=We(0,s,1))};return n.$$set=c=>{"value_in"in c&&t(10,s=c.value_in),"value_out"in c&&t(0,r=c.value_out),"thumb_Height"in c&&t(1,i=c.thumb_Height)},n.$$.update=()=>{n.$$.dirty&1024&&b()},[r,i,_,l,o,u,m,f,d,h,s]}class On extends ue{constructor(e){super(),fe(this,e,En,Tn,ie,{value_in:10,value_out:0,thumb_Height:1})}}function ht(n,e,t){const l=n.slice();return l[32]=e[t],l}function pt(n){var c,p,v,O,E,y,w,L;let e,t,l,s,r=((v=(p=(c=n[0])==null?void 0:c.lead)==null?void 0:p.first_name)!=null?v:"")+"",i,o,a,u,_,m=((y=(E=(O=n[0])==null?void 0:O.lead)==null?void 0:E.last_name)!=null?y:"")+"",f,d,h,b=((L=(w=n[0])==null?void 0:w.lead)==null?void 0:L.username)&&gt(n);return{c(){e=k("div"),t=k("div"),l=A(),s=k("div"),i=P(r),o=A(),a=k("div"),u=A(),_=k("div"),f=P(m),d=A(),b&&b.c(),h=Je(),W(t,"width","8px"),W(a,"width","8px"),T(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-ffie4h")},m(S,H){$(S,e,H),g(e,t),g(e,l),g(e,s),g(s,i),g(e,o),g(e,a),g(e,u),g(e,_),g(_,f),$(S,d,H),b&&b.m(S,H),$(S,h,H)},p(S,H){var F,M,x,I,V,ne,ge,ve;H[0]&1&&r!==(r=((x=(M=(F=S[0])==null?void 0:F.lead)==null?void 0:M.first_name)!=null?x:"")+"")&&X(i,r),H[0]&1&&m!==(m=((ne=(V=(I=S[0])==null?void 0:I.lead)==null?void 0:V.last_name)!=null?ne:"")+"")&&X(f,m),(ve=(ge=S[0])==null?void 0:ge.lead)!=null&&ve.username?b?b.p(S,H):(b=gt(S),b.c(),b.m(h.parentNode,h)):b&&(b.d(1),b=null)},d(S){S&&D(e),S&&D(d),b&&b.d(S),S&&D(h)}}}function gt(n){let e,t,l=n[0].lead.username+"",s;return{c(){e=k("div"),t=P("@"),s=P(l),T(e,"class","nowrap textOverEllipsis username svelte-ffie4h")},m(r,i){$(r,e,i),g(e,t),g(e,s)},p(r,i){i[0]&1&&l!==(l=r[0].lead.username+"")&&X(s,l)},d(r){r&&D(e)}}}function vt(n){let e,t,l,s;return t=new Ze({}),{c(){e=k("div"),se(t.$$.fragment),T(e,"class","pos_abs loading svelte-ffie4h")},m(r,i){$(r,e,i),ee(t,e,null),s=!0},i(r){s||(N(t.$$.fragment,r),r&&ae(()=>{l||(l=le(e,he,{},!0)),l.run(1)}),s=!0)},o(r){C(t.$$.fragment,r),r&&(l||(l=le(e,he,{},!1)),l.run(0)),s=!1},d(r){r&&D(e),te(t),r&&l&&l.end()}}}function bt(n,e){var r,i,o,a,u,_;let t,l,s;return l=new Sn({props:{render_Width:e[7],incoming:(r=e[32])==null?void 0:r.incoming,username:(a=(o=(i=e[0])==null?void 0:i.lead)==null?void 0:o.username)!=null?a:"",text:(_=(u=e[32])==null?void 0:u.text)!=null?_:""}}),{key:n,first:null,c(){t=Je(),se(l.$$.fragment),this.first=t},m(m,f){$(m,t,f),ee(l,m,f),s=!0},p(m,f){var h,b,c,p,v,O;e=m;const d={};f[0]&128&&(d.render_Width=e[7]),f[0]&2&&(d.incoming=(h=e[32])==null?void 0:h.incoming),f[0]&1&&(d.username=(p=(c=(b=e[0])==null?void 0:b.lead)==null?void 0:c.username)!=null?p:""),f[0]&2&&(d.text=(O=(v=e[32])==null?void 0:v.text)!=null?O:""),l.$set(d)},i(m){s||(N(l.$$.fragment,m),s=!0)},o(m){C(l.$$.fragment,m),s=!1},d(m){m&&D(t),te(l,m)}}}function An(n){let e,t,l,s,r,i,o,a,u=[],_=new Map,m,f,d,h,b,c,p,v,O,E,y=n[0]&&pt(n),w=n[2]&&vt(),L=n[1];const S=M=>M[32].index;for(let M=0;M<L.length;M+=1){let x=ht(n,L,M),I=S(x);_.set(I,u[M]=bt(I,x))}function H(M){n[12](M)}let F={value_in:n[3]};return n[4]!==void 0&&(F.value_out=n[4]),d=new On({props:F}),we.push(()=>It(d,"value_out",H)),{c(){e=k("div"),t=k("div"),y&&y.c(),l=A(),w&&w.c(),s=A(),r=k("div"),i=k("div"),o=k("div"),a=k("div");for(let M=0;M<u.length;M+=1)u[M].c();m=A(),f=k("div"),se(d.$$.fragment),b=A(),c=k("div"),p=k("textarea"),T(t,"class","flex flex_clm flex_cx header pos_rel svelte-ffie4h"),T(a,"class","pos_rel w100 h100"),T(f,"class","pos_abs h100"),W(f,"width","10px"),W(f,"right","0px"),W(f,"height","calc( 100% - 10px )"),W(f,"top","5px"),T(o,"class","pos_rel w100 h100"),T(i,"class","flex pos_abs overhide"),T(r,"class","flex flex_grow_1 pos_rel overhide"),T(p,"class","flex flex_grow_1 chat_input_textarea svelte-ffie4h"),T(c,"class","flex chat_input svelte-ffie4h"),T(e,"class","flex flex_clm flex_grow_1 overhide")},m(M,x){$(M,e,x),g(e,t),y&&y.m(t,null),g(t,l),w&&w.m(t,null),g(e,s),g(e,r),g(r,i),g(i,o),g(o,a);for(let I=0;I<u.length;I+=1)u[I].m(a,null);n[11](a),g(o,m),g(o,f),ee(d,f,null),g(e,b),g(e,c),g(c,p),tt(p,n[6]),v=!0,O||(E=[Q(o,"wheel",n[10]),Pe(Qe.call(null,i,n[8])),Q(p,"input",n[13]),Q(p,"keyup",n[9])],O=!0)},p(M,x){M[0]?y?y.p(M,x):(y=pt(M),y.c(),y.m(t,l)):y&&(y.d(1),y=null),M[2]?w?x[0]&4&&N(w,1):(w=vt(),w.c(),N(w,1),w.m(t,null)):w&&(_e(),C(w,1,1,()=>{w=null}),me()),x[0]&131&&(L=M[1],_e(),u=Xe(u,x,S,1,M,L,_,a,$t,bt,null,ht),me());const I={};x[0]&8&&(I.value_in=M[3]),!h&&x[0]&16&&(h=!0,I.value_out=M[4],Dt(()=>h=!1)),d.$set(I),x[0]&64&&tt(p,M[6])},i(M){if(!v){N(w);for(let x=0;x<L.length;x+=1)N(u[x]);N(d.$$.fragment,M),v=!0}},o(M){C(w);for(let x=0;x<u.length;x+=1)C(u[x]);C(d.$$.fragment,M),v=!1},d(M){M&&D(e),y&&y.d(),w&&w.d();for(let x=0;x<u.length;x+=1)u[x].d();n[11](null),te(d),O=!1,pe(E)}}}const wt=10,Ie=4;async function yt(n){try{await g_Api("POST",`dialogs/${n}/read`)}catch(e){console.log(e.message)}}function Dn(n,e,t){let l,{dialog:s=null}=e,r=[],i=[],o=[],a=new Set,u=0,_=0,m=1,f=1,d=null;const h=Ke(null);xe(n,h,j=>t(22,l=j));const b={id:1,text:"",received_at:new Date().toJSON(),is_read:!0,incoming:!0,dialog:1};let c=-1;async function p(j,K=0,B=20){const Y=await g_Api("GET","messages",{dialog_id:j,offset:K,limit:B});if(s&&s.id===j){for(u=Y.count;i.length<u;){const Z=i.length;i.push({id:c--,index:Z,_isFakeMsg:!0})}const G=Y.results;G.map((Z,be)=>Z.index=K+be),G.map(Z=>i[Z.index]=Z)}}let v="";const O=async j=>{if(j.which===13&&(t(6,v=v.trim()),v)){const K={...b};K.id=Math.random()*1e9|0,K.text=v,K.incoming=!1,s&&g_Api("POST","messages",{dialog:s.id,text:v,is_read:!0}),r.push(K),r=r,t(6,v="")}};function E(){r=[],i=[],t(1,o=[]),a=new Set,u=0,console.log("clear all")}let y=null,w=null;async function L(j){if(!j){if(!y)return;y=null,E();return}w!==j.id&&(y=j,w=j.id,E(),r=[],i=[],t(1,o=[]),u=0,t(2,_++,_),await p(j.id),u&&await p(j.id,Math.max(u-20,0),20),await yt(j.id),t(2,_--,_))}let S=1,H=!0;function F(){if(H&&requestAnimationFrame(F),!l||!d||!i.length)return;l.width;const j=l.height,K=l.width-wt*2,B=wt;t(7,S=Math.floor(K*.9));const Y=1+f*(i.length-1);let G=Math.floor(Y),Z=Y-G;G>=i.length&&(G=i.length-1,Z=1);const be=[],Me=[];let Se=null;t(1,o=[]);for(let U=G-22,q=0,Te=!0;U<G+2;U++)U<0||U>=i.length||(i[U]._isFakeMsg&&a.add(U),o[q]!==i[U]&&(Te&&(Te=!1,o.splice(q,1e9)),t(1,o[q]=i[U],o),t(1,o)),t(1,o[q]._drawIndex=q,o),U<G&&be.push(o[q]),U>G&&Me.push(o[q]),U===G&&(Se=o[q]),q++);const ce=[...d.children];if(ce.length===o.length){ce.map((R,de)=>{const re=o[de];if(!re||R._remove)return;const Ht=R.getBoundingClientRect();R._bbox=Ht;const Ye=Math.floor(B+(re.incoming?0:l.width*.05));R.__cacheWidth!==S&&(R.__cacheWidth=S,R.style.width=S+"px"),R.__cacheLeft!==Ye&&(R.__cacheLeft=Ye,R.style.left=Ye+"px")});const U=(R,de,re=1)=>(R.__cacheTop!==de&&(R.__cacheTop=de,R.style.top=de+"px"),de+(R._bbox.height+Ie)*re);let q=0,Te=0;const Ve=ce[Se._drawIndex];if(Ve){const R=Ve;q=j+Ie-(R._bbox.height+Ie)*Z,Te=q,q=U(R,q,1)}Me.map((R,de)=>{const re=ce[R._drawIndex];q=U(re,q,1)}),q=Te,be.reverse().map((R,de)=>{const re=ce[R._drawIndex];q-=re._bbox.height+Ie,U(re,q,0)})}}requestAnimationFrame(F),At(()=>H=!1);async function M(){if(a.size){const j=[...a].sort((Y,G)=>Y-G);a.clear();const K=[];let B={offset:null,limit:0};for(const Y of j){if(B.offset!==null){if(B.limit<=500&&B.offset+B.limit===Y){B.limit++;continue}K.push(B)}B={offset:Y,limit:1}}B.offset!==null&&K.push(B),s&&(t(2,_++,_),await Promise.all(K.map(Y=>p(s.id,Y.offset,Y.limit))),t(2,_--,_))}setTimeout(M,500)}M();async function x(){s&&await yt(s.id),setTimeout(x,5e3)}x();async function I(){s&&await p(s.id,u,20),setTimeout(I,500)}I();const V=j=>{j.deltaY>0?t(3,m=f+1/(i.length-1)):t(3,m=f-1/(i.length-1))};function ne(j){we[j?"unshift":"push"](()=>{d=j,t(5,d)})}function ge(j){f=j,t(4,f)}function ve(){v=this.value,t(6,v)}return n.$$set=j=>{"dialog"in j&&t(0,s=j.dialog)},n.$$.update=()=>{n.$$.dirty[0]&1&&L(s)},[s,o,_,m,f,d,v,S,h,O,V,ne,ge,ve]}class jn extends ue{constructor(e){super(),fe(this,e,Dn,An,ie,{dialog:0},null,[-1,-1])}}function kt(n,e,t){const l=n.slice();return l[11]=e[t],l}function $n(n){let e;return{c(){e=P("\xA0")},m(t,l){$(t,e,l)},p:z,d(t){t&&D(e)}}}function In(n){var l,s;let e=((s=(l=n[11])==null?void 0:l.last_message)==null?void 0:s.text)+"",t;return{c(){t=P(e)},m(r,i){$(r,t,i)},p(r,i){var o,a;i&1&&e!==(e=((a=(o=r[11])==null?void 0:o.last_message)==null?void 0:a.text)+"")&&X(t,e)},d(r){r&&D(t)}}}function Lt(n){let e,t=n[3](n[11]._lastTime)+"",l;return{c(){e=k("div"),l=P(t),T(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-1tl47rw")},m(s,r){$(s,e,r),g(e,l)},p(s,r){r&1&&t!==(t=s[3](s[11]._lastTime)+"")&&X(l,t)},d(s){s&&D(e)}}}function xt(n){var s;let e,t=((s=n[11])==null?void 0:s.unread_messages_count)+"",l;return{c(){e=k("div"),l=P(t),T(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-1tl47rw")},m(r,i){$(r,e,i),g(e,l)},p(r,i){var o;i&1&&t!==(t=((o=r[11])==null?void 0:o.unread_messages_count)+"")&&X(l,t)},d(r){r&&D(e)}}}function Mt(n,e){var I,V,ne,ge,ve,j,K;let t,l,s,r,i,o=((ne=(V=(I=e[11])==null?void 0:I.lead)==null?void 0:V.first_name)!=null?ne:"")+"",a,u,_,m,f,d=((j=(ve=(ge=e[11])==null?void 0:ge.lead)==null?void 0:ve.last_name)!=null?j:"")+"",h,b,c,p,v,O,E,y,w,L;function S(B,Y){var G,Z;return(Z=(G=B[11])==null?void 0:G.last_message)!=null&&Z.text?In:$n}let H=S(e),F=H(e),M=e[11]._lastTime&&Lt(e),x=((K=e[11])==null?void 0:K.unread_messages_count)&&xt(e);return{key:n,first:null,c(){t=k("div"),l=k("div"),s=k("div"),r=A(),i=k("div"),a=P(o),u=A(),_=k("div"),m=A(),f=k("div"),h=P(d),b=A(),c=k("div"),F.c(),p=A(),M&&M.c(),v=A(),x&&x.c(),O=A(),W(s,"width","8px"),W(_,"width","8px"),T(l,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-1tl47rw"),T(c,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-1tl47rw"),T(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-1tl47rw"),J(t,"active",e[1]&&e[11].id===e[1].id),this.first=t},m(B,Y){$(B,t,Y),g(t,l),g(l,s),g(l,r),g(l,i),g(i,a),g(l,u),g(l,_),g(l,m),g(l,f),g(f,h),g(t,b),g(t,c),F.m(c,null),g(t,p),M&&M.m(t,null),g(t,v),x&&x.m(t,null),g(t,O),y=!0,w||(L=Q(t,"click",function(){Le(e[2](e[11]))&&e[2](e[11]).apply(this,arguments)}),w=!0)},p(B,Y){var G,Z,be,Me,Se,ce,U;e=B,(!y||Y&1)&&o!==(o=((be=(Z=(G=e[11])==null?void 0:G.lead)==null?void 0:Z.first_name)!=null?be:"")+"")&&X(a,o),(!y||Y&1)&&d!==(d=((ce=(Se=(Me=e[11])==null?void 0:Me.lead)==null?void 0:Se.last_name)!=null?ce:"")+"")&&X(h,d),H===(H=S(e))&&F?F.p(e,Y):(F.d(1),F=H(e),F&&(F.c(),F.m(c,null))),e[11]._lastTime?M?M.p(e,Y):(M=Lt(e),M.c(),M.m(t,v)):M&&(M.d(1),M=null),(U=e[11])!=null&&U.unread_messages_count?x?x.p(e,Y):(x=xt(e),x.c(),x.m(t,O)):x&&(x.d(1),x=null),(!y||Y&3)&&J(t,"active",e[1]&&e[11].id===e[1].id)},i(B){y||(B&&ae(()=>{E||(E=le(t,lt,{},!0)),E.run(1)}),y=!0)},o(B){B&&(E||(E=le(t,lt,{},!1)),E.run(0)),y=!1},d(B){B&&D(t),F.d(),M&&M.d(),x&&x.d(),B&&E&&E.end(),w=!1,L()}}}function Nn(n){let e,t,l,s,r=[],i=new Map,o,a,u,_=n[0];const m=f=>f[11].id;for(let f=0;f<_.length;f+=1){let d=kt(n,_,f),h=m(d);i.set(h,r[f]=Mt(h,d))}return a=new jn({props:{dialog:n[1]}}),{c(){e=k("div"),t=k("div"),l=k("div"),l.textContent="My leads",s=A();for(let f=0;f<r.length;f+=1)r[f].c();o=A(),se(a.$$.fragment),T(l,"class","flex flex_cx flex_cy header pos_rel svelte-1tl47rw"),T(t,"class","flex flex_clm list svelte-1tl47rw"),T(e,"class","flex flex_grow_1 ")},m(f,d){$(f,e,d),g(e,t),g(t,l),g(t,s);for(let h=0;h<r.length;h+=1)r[h].m(t,null);g(e,o),ee(a,e,null),u=!0},p(f,[d]){d&15&&(_=f[0],_e(),r=Xe(r,d,m,1,f,_,i,t,$t,Mt,null,kt),me());const h={};d&2&&(h.dialog=f[1]),a.$set(h)},i(f){if(!u){for(let d=0;d<_.length;d+=1)N(r[d]);N(a.$$.fragment,f),u=!0}},o(f){for(let d=0;d<r.length;d+=1)C(r[d]);C(a.$$.fragment,f),u=!1},d(f){f&&D(e);for(let d=0;d<r.length;d+=1)r[d].d();te(a)}}}function Hn(n,e,t){let l;xe(n,je,m=>t(6,l=m));let s=[],r=null;const i={id:1,text:"",received_at:new Date().toJSON(),is_read:!0,incoming:!0,dialog:1};for(let m=0;m<10;m++){const f={...i};f.id=m+1,f.text="Text...",f.incoming=Math.random()<.5}const o=m=>f=>{t(1,r=m)};async function a(){if(!l)return;const m=await g_Api("GET","dialogs",{unread_first:1,offset:0,limit:20});t(0,s=m.results),s.map(f=>{var h,b,c;const d=(c=(h=f==null?void 0:f.last_message)==null?void 0:h.received_at)!=null?c:(b=f==null?void 0:f.lead)==null?void 0:b.date_joined;f._lastTime=d?+new Date(d):null})}a();async function u(){for(;;){const m=await g_Api("GET","dialogs",{unread_first:1,offset:0,limit:20});t(0,s=m.results),s.map(f=>{var h,b,c;const d=(c=(h=f==null?void 0:f.last_message)==null?void 0:h.received_at)!=null?c:(b=f==null?void 0:f.lead)==null?void 0:b.date_joined;f._lastTime=d?+new Date(d):null}),await Nt(1e3)}}return u(),[s,r,o,m=>{const f=h=>String(h).padStart(2,"0"),d=new Date;return m=new Date(m),m.getYear()===d.getYear()&&m.getMonth()===d.getMonth()?m.getDate()===d.getDate()?`${f(m.getHours())}:${f(m.getMinutes())}`:`${f(m.getDate())}d ${f(m.getHours())}:${f(m.getMinutes())}`:`${f(m.getDate())}.${f(m.getMonth())}.${m.getFullYear()}`}]}class Bn extends ue{constructor(e){super(),fe(this,e,Hn,Nn,ie,{})}}function Cn(n){let e,t,l,s,r,i,o;return t=new Ln({}),s=new Bn({}),{c(){e=k("div"),se(t.$$.fragment),l=A(),se(s.$$.fragment),T(e,"class","pos_abs content flex svelte-116f09r"),J(e,"contentHideL__",n[1]!=="newLeads")},m(a,u){$(a,e,u),ee(t,e,null),g(e,l),ee(s,e,null),r=!0,i||(o=Pe(Qe.call(null,e)),i=!0)},p(a,u){(!r||u&2)&&J(e,"contentHideL__",a[1]!=="newLeads")},i(a){r||(N(t.$$.fragment,a),N(s.$$.fragment,a),r=!0)},o(a){C(t.$$.fragment,a),C(s.$$.fragment,a),r=!1},d(a){a&&D(e),te(t),te(s),i=!1,o()}}}function Pn(n){let e,t;return e=new pn({}),{c(){se(e.$$.fragment)},m(l,s){ee(e,l,s),t=!0},p:z,i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Yn(n){let e,t,l,s,r,i,o,a;function u(h){n[2](h)}let _={};n[1]!==void 0&&(_.select=n[1]),t=new un({props:_}),we.push(()=>It(t,"select",u));const m=[Pn,Cn],f=[];function d(h,b){return h[0]?1:0}return i=d(n),o=f[i]=m[i](n),{c(){e=k("main"),se(t.$$.fragment),s=A(),r=k("div"),o.c(),T(r,"class","flex flex_grow_1 pos_rel overhide"),T(e,"class","flex flex_clm svelte-116f09r")},m(h,b){$(h,e,b),ee(t,e,null),g(e,s),g(e,r),f[i].m(r,null),a=!0},p(h,[b]){const c={};!l&&b&2&&(l=!0,c.select=h[1],Dt(()=>l=!1)),t.$set(c);let p=i;i=d(h),i===p?f[i].p(h,b):(_e(),C(f[p],1,1,()=>{f[p]=null}),me(),o=f[i],o?o.p(h,b):(o=f[i]=m[i](h),o.c()),N(o,1),o.m(r,null))},i(h){a||(N(t.$$.fragment,h),N(o),a=!0)},o(h){C(t.$$.fragment,h),C(o),a=!1},d(h){h&&D(e),te(t),f[i].d()}}}function Fn(){const n=c=>new Promise(p=>setTimeout(p,c)),e=()=>n(200+(Math.random()*200|0)),t={id:1};let l=0;const s={tg_id:123123124,username:"123124123",first_name:"test",last_name:"ewr",date_joined:"2022-10-27T13:48:51.054781Z",esub:"123123",pub_id:"2312",refcode:"123123",subpub:"23123"};let r=[];const i=c=>r.find(p=>String(p.tg_id)===String(c)),o=()=>{const c={...s};c.tg_id+=l,c.first_name+=" "+l,c.last_name+=" "+l,c.date_joined=new Date().toJSON(),c.username=[c.first_name,c.last_name].map(p=>p.trim()).filter(Boolean).join(" ").replace(/\s/g,"_"),l++,r.push(c)},a=()=>[...r],u=()=>a().filter(c=>!c.hasOperator),_=(c,p)=>{var w;const v=p.offset|0,O=Math.max(1,Math.min(1e6,((w=p.limit)!=null?w:20)|0)),E=c.length,y=c.slice(v).slice(0,O);return{count:E,results:y}},m={},f={};let d=1;Array(10).fill().map(o),setInterval(()=>{},2400),setInterval(()=>{},3e3),setInterval(()=>{const c=Object.keys(f),p=c[c.length*Math.random()|0],v=f[p];if(v){const O=v.length?0:1e5;for(let E=0;E<O;E++)v.push({id:d++,dialog:p,text:Math.random()<.5?"Hi. And short message "+(d-1)+" ...":"Hi. And long message "+(d-1)+" ..."+`
 Long!`.repeat(20),is_read:!1,incoming:!0,received_at:new Date().toJSON()})}},1e3);const h={},b=async(c,p,v={})=>{var L,S,H,F,M;if(!location.hash.match(/real\-api/)){if(c==="GET"&&p==="operators")return await e(),{results:[{username:"stan18k",first_name:"Stanislav",last_name:"Kulakov"},{username:"dmodev",first_name:"Demon",last_name:"Dev"},{username:"idandrey",first_name:"Andrey",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer ".repeat(1e3),first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer ".repeat(1e3),first_name:"YEHA ".repeat(1e3),last_name:"D sf  ".repeat(1e3)}]};if(c==="GET"&&p==="leads/unassigned")return await e(),_(u(),v);if(c==="POST"&&/leads\/\d+\/assign/.test(p)){const x=(L=p.match(/leads\/(\d+)\/assign/))==null?void 0:L[1],I=h["x-username"];if(!x||!I)return!1;const V=i(x);if(!V||V.hasOperator)return!1;V.hasOperator=!0,t.id++;const ne={...t,lead_id:x,operator:I};return m[I]=(S=m[I])!=null?S:[],m[I].push(ne),f[ne.id]=[],!0}if(c==="GET"&&p==="dialogs"){const x=[...(H=m[h["x-username"]])!=null?H:[]].map(I=>({...I,lead:i(I.lead_id)}));return _(x,v)}if(c==="GET"&&p==="messages"){await e();const x=f[v.dialog_id]=(F=f[v.dialog_id])!=null?F:[];return _(x,v)}if(c==="POST"&&p==="messages")return f[v.dialog]=(M=f[v.dialog])!=null?M:[],f[v.dialog].push({id:d++,dialog:v.dialog,text:v.text,is_read:!!v.is_read,incoming:!1,received_at:new Date().toJSON()}),!0}const O="https://92.255.108.70/",E=new URL(O);c==="GET"&&Object.entries(v).map(([x,I])=>E.searchParams.append(x,I)),E.pathname=p+"/";let y;const w={...h};return c==="POST"&&(w["Content-Type"]="application/json",y=JSON.stringify(v)),await(await fetch(E,{method:c,headers:w,body:y})).json()};return b.setHeader=(c,p)=>h[c]=p,b}function Rn(n,e,t){let l;xe(n,je,o=>t(0,l=o));let s="operators";function r(o){o&&t(1,s="newLeads")}globalThis.g_Api=Fn();function i(o){s=o,t(1,s)}return n.$$.update=()=>{n.$$.dirty&1&&r(l)},[l,s,i]}class Wn extends ue{constructor(e){super(),fe(this,e,Rn,Yn,ie,{})}}new Wn({target:document.getElementById("app")});
