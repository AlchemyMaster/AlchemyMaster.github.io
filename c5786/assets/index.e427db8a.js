(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function se(){}const xt=l=>l;function zt(l,e){for(const t in e)l[t]=e[t];return l}function Gl(l){return l()}function Ut(){return Object.create(null)}function He(l){l.forEach(Gl)}function Ye(l){return typeof l=="function"}function de(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let ft;function Xe(l,e){return ft||(ft=document.createElement("a")),ft.href=e,l===ft.href}function fn(l){return Object.keys(l).length===0}function Et(l,...e){if(l==null)return se;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Se(l,e,t){l.$$.on_destroy.push(Et(e,t))}function Je(l,e,t){return l.set(t),e}function rt(l){return l&&Ye(l.destroy)?l.destroy:se}const Rl=typeof window<"u";let zl=Rl?()=>window.performance.now():()=>Date.now(),jt=Rl?l=>requestAnimationFrame(l):se;const Ze=new Set;function Ul(l){Ze.forEach(e=>{e.c(l)||(Ze.delete(e),e.f())}),Ze.size!==0&&jt(Ul)}function ql(l){let e;return Ze.size===0&&jt(Ul),{promise:new Promise(t=>{Ze.add(e={c:l,f:t})}),abort(){Ze.delete(e)}}}function m(l,e){l.appendChild(e)}function cn(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function un(l,e){return m(l.head||l,e),e.sheet}function H(l,e,t){l.insertBefore(e,t||null)}function j(l){l.parentNode.removeChild(l)}function Nt(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function b(l){return document.createElement(l)}function Be(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function ne(l){return document.createTextNode(l)}function E(){return ne(" ")}function Re(){return ne("")}function le(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function w(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function dn(l){return Array.from(l.childNodes)}function be(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function qt(l,e){l.value=e==null?"":e}function R(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function X(l,e,t){l.classList[t?"add":"remove"](e)}function Wl(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const ht=new Map;let vt=0;function _n(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function mn(l){const e={style_element:b("style"),rules:{}};return ht.set(l,e),e}function Wt(l,e,t,n,i,s,r,o=0){const a=16.666/n;let f=`{
`;for(let h=0;h<=1;h+=a){const L=e+(t-e)*s(h);f+=h*100+`%{${r(L,1-L)}}
`}const c=f+`100% {${r(t,1-t)}}
}`,g=`__svelte_${_n(c)}_${o}`,_=cn(l),{style_element:d,rules:u}=ht.get(_)||mn(_);if(!u[g]){const h=un(_,d);u[g]=!0,h.insertRule(`@keyframes ${g} ${c}`,h.cssRules.length)}const p=l.style.animation||"";return l.style.animation=`${p?`${p}, `:""}${g} ${n}ms linear ${i}ms 1 both`,vt+=1,g}function gn(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),vt-=i,vt||pn())}function pn(){jt(()=>{vt||(ht.forEach(l=>{const{style_element:e}=l;j(e)}),ht.clear())})}let it;function nt(l){it=l}function Ht(){if(!it)throw new Error("Function called outside component initialization");return it}function Ft(l){Ht().$$.on_mount.push(l)}function je(l){Ht().$$.on_destroy.push(l)}function Yl(){const l=Ht();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=Wl(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function Jl(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const lt=[],Fe=[],gt=[],Ot=[],Vl=Promise.resolve();let Tt=!1;function Xl(){Tt||(Tt=!0,Vl.then(Kl))}function hn(){return Xl(),Vl}function Ne(l){gt.push(l)}function wt(l){Ot.push(l)}const Lt=new Set;let ct=0;function Kl(){const l=it;do{for(;ct<lt.length;){const e=lt[ct];ct++,nt(e),vn(e.$$)}for(nt(null),lt.length=0,ct=0;Fe.length;)Fe.pop()();for(let e=0;e<gt.length;e+=1){const t=gt[e];Lt.has(t)||(Lt.add(t),t())}gt.length=0}while(lt.length);for(;Ot.length;)Ot.pop()();Tt=!1,Lt.clear(),nt(l)}function vn(l){if(l.fragment!==null){l.update(),He(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Ne)}}let tt;function wn(){return tt||(tt=Promise.resolve(),tt.then(()=>{tt=null})),tt}function Mt(l,e,t){l.dispatchEvent(Wl(`${e?"intro":"outro"}${t}`))}const pt=new Set;let qe;function Le(){qe={r:0,c:[],p:qe}}function Me(){qe.r||He(qe.c),qe=qe.p}function F(l,e){l&&l.i&&(pt.delete(l),l.i(e))}function U(l,e,t,n){if(l&&l.o){if(pt.has(l))return;pt.add(l),qe.c.push(()=>{pt.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const bn={duration:0};function De(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,a=null;function f(){a&&gn(l,a)}function c(_,d){const u=_.b-s;return d*=Math.abs(u),{a:s,b:_.b,d:u,duration:d,start:_.start,end:_.start+d,group:_.group}}function g(_){const{delay:d=0,duration:u=300,easing:p=xt,tick:h=se,css:L}=i||bn,v={start:zl()+d,b:_};_||(v.group=qe,qe.r+=1),r||o?o=v:(L&&(f(),a=Wt(l,s,_,u,d,p,L)),_&&h(0,1),r=c(v,u),Ne(()=>Mt(l,_,"start")),ql(y=>{if(o&&y>o.start&&(r=c(o,u),o=null,Mt(l,r.b,"start"),L&&(f(),a=Wt(l,s,r.b,r.duration,0,p,i.css))),r){if(y>=r.end)h(s=r.b,1-s),Mt(l,r.b,"end"),o||(r.b?f():--r.group.r||He(r.group.c)),r=null;else if(y>=r.start){const D=y-r.start;s=r.a+r.d*p(D/r.duration),h(s,1-s)}}return!!(r||o)}))}return{run(_){Ye(i)?wn().then(()=>{i=i(),g(_)}):g(_)},end(){f(),r=o=null}}}const yn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function kn(l,e){l.d(1),e.delete(l.key)}function ot(l,e){U(l,1,1,()=>{e.delete(l.key)})}function $e(l,e,t,n,i,s,r,o,a,f,c,g){let _=l.length,d=s.length,u=_;const p={};for(;u--;)p[l[u].key]=u;const h=[],L=new Map,v=new Map;for(u=d;u--;){const S=g(i,s,u),C=t(S);let O=r.get(C);O?n&&O.p(S,e):(O=f(C,S),O.c()),L.set(C,h[u]=O),C in p&&v.set(C,Math.abs(u-p[C]))}const y=new Set,D=new Set;function T(S){F(S,1),S.m(o,c),r.set(S.key,S),c=S.first,d--}for(;_&&d;){const S=h[d-1],C=l[_-1],O=S.key,I=C.key;S===C?(c=S.first,_--,d--):L.has(I)?!r.has(O)||y.has(O)?T(S):D.has(I)?_--:v.get(O)>v.get(I)?(D.add(O),T(S)):(y.add(I),_--):(a(C,r),_--)}for(;_--;){const S=l[_];L.has(S.key)||a(S,r)}for(;d;)T(h[d-1]);return h}function bt(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function ce(l){l&&l.c()}function oe(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||Ne(()=>{const a=s.map(Gl).filter(Ye);r?r.push(...a):He(a),l.$$.on_mount=[]}),o.forEach(Ne)}function ae(l,e){const t=l.$$;t.fragment!==null&&(He(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Sn(l,e){l.$$.dirty[0]===-1&&(lt.push(l),Xl(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function he(l,e,t,n,i,s,r,o=[-1]){const a=it;nt(l);const f=l.$$={fragment:null,ctx:null,props:s,update:se,not_equal:i,bound:Ut(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Ut(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(f.root);let c=!1;if(f.ctx=t?t(l,e.props||{},(g,_,...d)=>{const u=d.length?d[0]:_;return f.ctx&&i(f.ctx[g],f.ctx[g]=u)&&(!f.skip_bound&&f.bound[g]&&f.bound[g](u),c&&Sn(l,g)),_}):[],f.update(),c=!0,He(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const g=dn(e.target);f.fragment&&f.fragment.l(g),g.forEach(j)}else f.fragment&&f.fragment.c();e.intro&&F(l.$$.fragment),oe(l,e.target,e.anchor,e.customElement),Kl()}nt(a)}class ve{$destroy(){ae(this,1),this.$destroy=se}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!fn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Ln(l){const e=l-1;return e*e*e+1}function Te(l,{delay:e=0,duration:t=400,easing:n=xt}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function Yt(l,{delay:e=0,duration:t=400,easing:n=Ln}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),g=parseFloat(i.borderTopWidth),_=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:d=>`overflow: hidden;opacity: ${Math.min(d*20,1)*s};height: ${d*r}px;padding-top: ${d*o}px;padding-bottom: ${d*a}px;margin-top: ${d*f}px;margin-bottom: ${d*c}px;border-top-width: ${d*g}px;border-bottom-width: ${d*_}px;`}}const Ke=[];function Ge(l,e=se){let t;const n=new Set;function i(o){if(de(l,o)&&(l=o,t)){const a=!Ke.length;for(const f of n)f[1](),Ke.push(f,l);if(a){for(let f=0;f<Ke.length;f+=2)Ke[f][0](Ke[f+1]);Ke.length=0}}}function s(o){i(o(l))}function r(o,a=se){const f=[o,a];return n.add(f),n.size===1&&(t=e(i)||se),o(l),()=>{n.delete(f),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const st=()=>{},Qe=l=>new Promise(e=>setTimeout(e,l)),Ee=(l,e,t)=>Math.min(t,Math.max(l,e)),kt=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),It=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,a)=>It(o,e[a]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,a])=>!(!r.has(o)||!It(a,r.get(o))))}catch{}return!1},Mn=l=>{let e=!1,t=[];const n=async i=>{e=!0;let s,r,o;try{s=await l()}catch(a){o=!0,r=a}if(i.map(a=>{o&&a.reject(r),a.resolve(s)}),t.length){const a=t;return t=[],n(a)}e=!1};return()=>{const i=kt();return e?t.push(i):(e=!0,n([i])),i.promise}},Dn=l=>{const e=kt();return setTimeout(e.resolve,l),e},On=Symbol("RangeLoadList_ItemLastUpdateTime"),Tn=l=>{var G,Z,K,Q;const e=Ee(1,((G=l.updateInterval)!=null?G:1e3)|0,36e5),t=Ee(1,((Z=l.maxLimit)!=null?Z:50)|0,1e3);let n=l.fLoad;const i=(K=l.onUpdateItem)!=null?K:st,s=(Q=l.onUpdateItemList)!=null?Q:st,r=!!l.isLoadEnd,o=On,a={},f=Ge(null),c={subscribe:f.subscribe};let g=0,_=t,d=null;const u=J=>n=J,p=async(J,ie)=>{try{const q=await n({offset:J,limit:ie});if(typeof q.count=="number"&&Array.isArray(q.results))return q}catch{}return null},h=async(J,ie)=>{const q=await p(J,ie);if(q){const A=q.results,ue=Math.max(0,q.count|0),me=d!==ue,we=Date.now();d=ue;const z=[];for(let P=0,Y=J;P<A.length&&Y<d;P++,Y++){const ge=A[P];a[Y]!==void 0&&It(a[Y],ge)||(ge[o]=we,a[Y]=ge,i(ge),z.push(ge))}z.length&&s(z),(me||z.length)&&f.set({total:d,list:a})}},L=async J=>{const ie=[];ie.push(h(g,_)),d!==null&&g+_<d&&r&&ie.push(h(d,t)),await Promise.all(ie),d!==null&&g+_<d&&r&&J&&await h(d,t)};let v=!1,y=!0,D,T=1;return(async()=>{let J=0;for(;y;){for(;y&&!v;){const ie=T;if(await L(J++===0),ie===T)break}D=Dn(e),await D.promise}})(),{setFLoad:u,update:()=>{T++,D&&D.resolve()},setRange:(J,ie)=>{g=Math.max(0,J|0),_=Ee(0,ie|0,t)},destroy:()=>y=!1,getData_r:()=>c,symbolUpdateTime:o,pause:()=>v=!0,resume:()=>v=!1}},In=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},et=(l,e,t=!0)=>{let n=!0;return(async()=>{for(t&&await Qe(l);n;){try{await e()}catch(i){console.error("setIntervalAwait error",i)}await Qe(l)}})(),()=>n=!1},Cn=(l,e=!0)=>{let t=!0;const n=()=>{!t||(l(),requestAnimationFrame(n))};return e?requestAnimationFrame(n):n(),()=>t=!1},Zl=()=>{let l=new Map;try{l=new Map([...new URLSearchParams(location.hash.replace(/^\#/,""))])}catch{}return l},Bt=()=>{const l={};return{on:(n,i)=>{var o;const s={event:n,cb:i},r=l[n]=(o=l[n])!=null?o:[];return r.push(s),()=>{const a=r.findIndex(f=>f===s);a!==-1&&r.splice(a,1)}},emit:(n,...i)=>{var s;return((s=l[n])!=null?s:[]).map(r=>r.cb(...i))}}},An=()=>{const l={};return l.addModule=(e,t)=>l[e]=t,l},Ql=(l,e="file-")=>{const t=document.createElement("a");t.href=l;const n=e+t.pathname.split(/[^a-zA-Z0-9\.\-_]/).pop();t.download=n,t.target="blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},Ct=l=>Ql(l,"image-"),xn=l=>{try{if(typeof l.message=="string")return l.message}catch{}return""},yt=Ge(null),$l=yt.set,ut=(l,e)=>{const{subscribe:t,set:n,update:i}=Ge(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},En=(l,e)=>{const{subscribe:t,set:n,update:i}=Ge(l);return[{subscribe:t},i]},jn=l=>parseInt(l.id);function Nn(l,e,t,n){var me,we;const i={},s={...e};Object.assign(i,{appConfig:s}),Object.assign(i,{api:t}),Object.assign(i,{moduleMgr:n});const r=Bt();Object.assign(i,{events:r});const o=[],a=z=>o.push(z);Object.assign(i,{destroy:()=>o.map(z=>z())});const c=l,[g]=ut(c),[_,d]=ut(null);let u=0;const[p,h]=ut(u),L=Mn(t.operatorSelf_GetOnlineInfo),v=async()=>{h(++u);const z=await L();return z&&d(z),h(--u),z};Object.assign(i,{operatorSelf_r:g,operatorSelfLastOnlineInfo_r:_,operatorSelfLastOnlineInfo_Update:v,operatorSelfLastOnline_SetOnlineFlag:async z=>{h(++u);const P=await t.operatorSelf_SetOnlineFlag(z);return P&&d(P),h(--u),P},operatorSelfLastOnlineInfoLoading_r:p});const D=Object.create(null),[T,S]=En(D),C=z=>{!z.length||S(P=>{for(const Y of z)P[jn(Y)]=Y;return P})},O=z=>C([z]),[I,B]=ut(null);Object.assign(i,{dialogMap_r:T,dialogMap_SetDialogList:C,dialogMap_SetDialog:O,dialogActiveID_r:I,dialogActiveID_Set:B});const x=new Map(((me=s==null?void 0:s.lead_StatusList)!=null?me:[]).map(z=>[z.id,z])),V=Object.entries((we=s==null?void 0:s.lead_StatusJumpMap)!=null?we:{}).reduce((z,[P,Y])=>(Y.map(ge=>{var ye;return(z[ge]=(ye=z[ge])!=null?ye:[]).push(P)}),z),{}),G=z=>{var P;return(P=x.get(z))!=null?P:null},Z=z=>{var P;try{return(P=s.lead_StatusGetID(z))!=null?P:null}catch{}return null},K=z=>{var Y,ge,ye;const P=G(z);return{id:z,title:(Y=P==null?void 0:P.title)!=null?Y:P!=null&&P.id?`#${P==null?void 0:P.id}`:"*UNK*",bgColor:(ge=P==null?void 0:P.bgColor)!=null?ge:"#000",color:(ye=P==null?void 0:P.color)!=null?ye:"#fff"}},Q=z=>K(Z(z)),J=(z,P)=>{var Y;try{return(Y=s.lead_StatusPrevIDResolve(z,P))!=null?Y:null}catch{}return null},ie=(z,P)=>{try{const Y=V==null?void 0:V[z],ge=(Y==null?void 0:Y.length)===1?Y==null?void 0:Y[0]:(Y==null?void 0:Y.length)>1?J(z,P):null,ye=G(ge);return ye&&!(ye!=null&&ye.stopPrevSearch)?ge:null}catch{}return null};return Object.assign(i,{lead_GetStatusOrDefault:Q,lead_GetStatusByID:G,lead_GetStatusTitle:z=>{var P,Y;return(Y=(P=G(z))==null?void 0:P.title)!=null?Y:z},lead_GetStatusList:z=>{var P;return((P=e==null?void 0:e.lead_StatusList)!=null?P:[]).filter(Y=>Y.access==="user").filter(Y=>Y.id!==z).filter(Y=>Y.id!=="DL")},lead_GetStatusID:Z,lead_StatusPrevIDResolve:J,lead_GetStatusPrevID:ie,lead_GetStatusHistory:z=>{let P=Z(z);const Y=[P];for(;P=ie(P,z),z=null,!!P;)Y.unshift(P);return Y.map(K).filter(Boolean)}}),a(et(e.updateIntervals.sync_online_info,v,!1)),Object.freeze(i),i}function Jt(l){let e,t,n;return{c(){e=b("div"),e.textContent="Operators",w(e,"class","item cursor_ptr svelte-vbcb9r"),X(e,"active",l[0]==="operators"),X(e,"disabled",l[1].has("operators"))},m(i,s){H(i,e,s),t||(n=le(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&X(e,"active",i[0]==="operators"),s&2&&X(e,"disabled",i[1].has("operators"))},d(i){i&&j(e),t=!1,n()}}}function Vt(l){let e,t=l[2].username+"",n,i,s;return{c(){e=b("div"),n=ne(t),w(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),R(e,"max-width","200px")},m(r,o){H(r,e,o),m(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&be(n,t)},i(r){s||(Ne(()=>{i||(i=De(e,Te,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=De(e,Te,{},!1)),i.run(0),s=!1},d(r){r&&j(e),r&&i&&i.end()}}}function Hn(l){let e,t,n,i,s,r,o=!l[2]&&Jt(l),a=l[2]&&0,f=l[2]&&Vt(l);return{c(){e=b("div"),o&&o.c(),t=E(),a&&a.c(),n=E(),i=b("div"),s=E(),f&&f.c(),w(i,"class","flex flex_grow_1"),w(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(c,g){H(c,e,g),o&&o.m(e,null),m(e,t),a&&a.m(e,null),m(e,n),m(e,i),m(e,s),f&&f.m(e,null),r=!0},p(c,[g]){c[2]?o&&(o.d(1),o=null):o?o.p(c,g):(o=Jt(c),o.c(),o.m(e,t)),c[2],a&&(a.d(1),a=null),c[2]?f?(f.p(c,g),g&4&&F(f,1)):(f=Vt(c),f.c(),F(f,1),f.m(e,null)):f&&(Le(),U(f,1,1,()=>{f=null}),Me())},i(c){r||(F(f),r=!0)},o(c){U(f),r=!1},d(c){c&&j(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function Fn(l,e,t){let n;Se(l,yt,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>a=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class Bn extends ve{constructor(e){super(),he(this,e,Fn,Hn,de,{select:0,disabled:1})}}function Xt(l,e,t){const n=l.slice();return n[4]=e[t],n}function Kt(l,e,t){const n=l.slice();return n[7]=e[t],n}function Zt(l){let e,t=l[7].text+"",n,i;return{c(){e=b("div"),n=ne(t),i=ne("\xA0"),w(e,"class","text svelte-13s1vua"),R(e,"color",l[7].color)},m(s,r){H(s,e,r),m(e,n),H(s,i,r)},p(s,r){r&2&&t!==(t=s[7].text+"")&&be(n,t),r&2&&R(e,"color",s[7].color)},d(s){s&&j(e),s&&j(i)}}}function Qt(l){let e,t,n=l[4].chunks,i=[];for(let s=0;s<n.length;s+=1)i[s]=Zt(Kt(l,n,s));return{c(){e=b("div");for(let s=0;s<i.length;s+=1)i[s].c();t=E(),w(e,"class","flex flex_cy line svelte-13s1vua"),X(e,"mini",l[4].type==="mini")},m(s,r){H(s,e,r);for(let o=0;o<i.length;o+=1)i[o].m(e,null);m(e,t)},p(s,r){if(r&2){n=s[4].chunks;let o;for(o=0;o<n.length;o+=1){const a=Kt(s,n,o);i[o]?i[o].p(a,r):(i[o]=Zt(a),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}r&2&&X(e,"mini",s[4].type==="mini")},d(s){s&&j(e),Nt(i,s)}}}function Pn(l){let e,t,n,i=l[1],s=[];for(let r=0;r<i.length;r+=1)s[r]=Qt(Xt(l,i,r));return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();w(e,"class","flex flex_clm notify svelte-13s1vua"),X(e,"normal",l[0]==="normal"),X(e,"error",l[0]==="error"),X(e,"debug",l[0]==="debug")},m(r,o){H(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,[o]){if(o&2){i=r[1];let a;for(a=0;a<i.length;a+=1){const f=Xt(r,i,a);s[a]?s[a].p(f,o):(s[a]=Qt(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}(!n||o&1)&&X(e,"normal",r[0]==="normal"),(!n||o&1)&&X(e,"error",r[0]==="error"),(!n||o&1)&&X(e,"debug",r[0]==="debug")},i(r){n||(r&&Ne(()=>{t||(t=De(e,Yt,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=De(e,Yt,{},!1)),t.run(0)),n=!1},d(r){r&&j(e),Nt(s,r),r&&t&&t.end()}}}function Gn(l,e,t){let{notify:n}=e,i="normal",s=[];const r=()=>{t(0,i=n==null?void 0:n.type),t(1,s=[]),Array.isArray(n==null?void 0:n.data)&&t(1,s=n.data.filter(Boolean).map(o=>{let a="normal",f=[];return typeof o=="string"?f.push({color:"#fff",text:o}):(a=o.type,f=o.chunks?o.chunks:[{color:"#fff",text:o.text}]),f=f.filter(c=>c.text),{type:a,chunks:f}}).filter(o=>o.chunks.length))};return l.$$set=o=>{"notify"in o&&t(2,n=o.notify)},l.$$.update=()=>{l.$$.dirty&4&&r()},[i,s,n]}class Rn extends ve{constructor(e){super(),he(this,e,Gn,Pn,de,{notify:2})}}function $t(l,e,t){const n=l.slice();return n[4]=e[t],n}function el(l,e){let t,n,i;return n=new Rn({props:{notify:e[4]}}),{key:l,first:null,c(){t=Re(),ce(n.$$.fragment),this.first=t},m(s,r){H(s,t,r),oe(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.notify=e[4]),n.$set(o)},i(s){i||(F(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&j(t),ae(n,s)}}}function zn(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[4].id;for(let o=0;o<s.length;o+=1){let a=$t(l,s,o),f=r(a);n.set(f,t[o]=el(f,a))}return{c(){e=b("div");for(let o=0;o<t.length;o+=1)t[o].c();w(e,"class","pos_abs notify_list svelte-11tn2wf")},m(o,a){H(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],Le(),t=$e(t,a,r,1,o,s,n,e,ot,el,null,$t),Me())},i(o){if(!i){for(let a=0;a<s.length;a+=1)F(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)U(t[a]);i=!1},d(o){o&&j(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}const Un=5e3;function qn(l,e,t){let{events:n=Bt()}=e,i=1,s=[];const r=o=>a=>{s.push({id:i++,time:Date.now(),type:o,data:a}),t(0,s)};return je(et(1e3,()=>{const o=Date.now(),a=s.filter(f=>f.time+Un>=o);a.length!==s.length&&t(0,s=a)})),je(n.on("error",r("error"))),Zl().has("debug")&&je(n.on("debug",r("debug"))),l.$$set=o=>{"events"in o&&t(1,n=o.events)},[s,n]}class Wn extends ve{constructor(e){super(),he(this,e,qn,zn,de,{events:1})}}function tl(l){return Object.prototype.toString.call(l)==="[object Date]"}function At(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>At(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if(tl(l)&&tl(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=At(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function Ve(l,e={}){const t=Ge(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let a=n,f=!1,{delay:c=0,duration:g=400,easing:_=xt,interpolate:d=At}=zt(zt({},e),o);if(g===0)return a&&(a.abort(),a=null),t.set(l=i),Promise.resolve();const u=zl()+c;let p;return n=ql(h=>{if(h<u)return!0;f||(p=d(l,r),typeof g=="function"&&(g=g(l,r)),f=!0),a&&(a.abort(),a=null);const L=h-u;return L>g?(t.set(l=r),!1):(t.set(l=p(_(L/g))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}function Yn(l){let e,t,n,i,s;var r=l[0].svelteComponent;function o(a){return{props:{options:a[0].options,abort_wr:a[0].abort_wr,result:a[0].result,close:a[7]}}}return r&&(n=new r(o(l))),{c(){e=b("div"),t=b("div"),n&&ce(n.$$.fragment),w(t,"class","flex pos_abs wrapper2 svelte-1c0izo5"),R(t,"max-width",l[2]+"px"),w(e,"class","flex flex_cx wrapper svelte-1c0izo5"),w(e,"style",i=""+(l[6]("left",l[3])+l[6]("top",l[4]))),X(e,"show",l[5])},m(a,f){H(a,e,f),m(e,t),n&&oe(n,t,null),l[8](t),s=!0},p(a,[f]){const c={};if(f&1&&(c.options=a[0].options),f&1&&(c.abort_wr=a[0].abort_wr),f&1&&(c.result=a[0].result),r!==(r=a[0].svelteComponent)){if(n){Le();const g=n;U(g.$$.fragment,1,0,()=>{ae(g,1)}),Me()}r?(n=new r(o(a)),ce(n.$$.fragment),F(n.$$.fragment,1),oe(n,t,null)):n=null}else r&&n.$set(c);(!s||f&4)&&R(t,"max-width",a[2]+"px"),(!s||f&24&&i!==(i=""+(a[6]("left",a[3])+a[6]("top",a[4]))))&&w(e,"style",i),(!s||f&32)&&X(e,"show",a[5])},i(a){s||(n&&F(n.$$.fragment,a),s=!0)},o(a){n&&U(n.$$.fragment,a),s=!1},d(a){a&&j(e),n&&ae(n),l[8](null)}}}const Dt=10,ll=10,nl=4;function Jn(l,e,t){let{modalContext:n={}}=e,i,s=2e4,r=null,o=null,a=!1,f=!1;const c=(u,p,h=L=>L)=>p===null?"":`${u}: ${h(p)};`,g=(u,p)=>c(u,p,h=>`${h}px`),_=async()=>{a||(a=!0,t(5,f=!1),await Qe(1e3),t(3,r=null),t(4,o=null),t(0,n._needDestroy=!0,n))};Ft(async()=>{await hn(),await Qe(10),t(5,f=!a)}),je(Cn(()=>{var S,C,O,I;if(!i)return;const u=window.innerWidth,p=window.innerHeight;t(2,s=u-Dt*2);const h=i.offsetWidth,L=i.offsetHeight,v=h/2,y=L/2;let D=u/2,T=50+y;try{const B=(S=n==null?void 0:n.options)!=null?S:{};if(B!=null&&B.position&&(C=B.position)!=null&&C.target){const x=B.position.target.getBoundingClientRect();((O=B.position)==null?void 0:O.stick)==="bottom"&&(T=x.bottom+nl),((I=B.position)==null?void 0:I.stick)==="top"&&(T=x.top-nl-L),D=x.width/2+x.left}}catch{}D=Ee(v+Dt,D,u-v-Dt),T=Ee(ll,T,p-L-ll),t(3,r=Math.round(D)),t(4,o=Math.round(T))}));function d(u){Fe[u?"unshift":"push"](()=>{i=u,t(1,i)})}return l.$$set=u=>{"modalContext"in u&&t(0,n=u.modalContext)},[n,i,s,r,o,f,g,_,d]}class Vn extends ve{constructor(e){super(),he(this,e,Jn,Yn,de,{modalContext:0})}}function Xn(l){var u,p;let e,t,n=((p=(u=l[0])==null?void 0:u.text)!=null?p:"")+"",i,s,r,o,a,f,c,g,_,d;return{c(){e=b("div"),t=b("div"),i=ne(n),s=E(),r=b("div"),o=b("button"),o.textContent="cancel",a=E(),f=b("div"),c=E(),g=b("button"),g.textContent="continue",w(t,"class","flex text"),w(o,"class","flex nowrap cursor_ptr unselect btn cancel svelte-1dvmulk"),R(f,"width","4px"),w(g,"class","flex nowrap cursor_ptr unselect btn continue svelte-1dvmulk"),w(r,"class","flex btnGroup svelte-1dvmulk"),w(e,"class","flex flex_clm modal svelte-1dvmulk")},m(h,L){H(h,e,L),m(e,t),m(t,i),m(e,s),m(e,r),m(r,o),l[8](o),m(r,a),m(r,f),m(r,c),m(r,g),_||(d=[le(o,"click",l[3]),le(g,"click",l[4])],_=!0)},p(h,[L]){var v,y;L&1&&n!==(n=((y=(v=h[0])==null?void 0:v.text)!=null?y:"")+"")&&be(i,n)},i:se,o:se,d(h){h&&j(e),l[8](null),_=!1,He(d)}}}function Kn(l,e,t){let n,i=se,s=()=>(i(),i=Et(o,u=>t(7,n=u)),o);l.$$.on_destroy.push(()=>i());let{options:r={}}=e,{abort_wr:o}=e;s();let{result:a}=e,{close:f}=e,c;const g=()=>{a.resolve(!1),f()},_=()=>{a.resolve(!0),f()};Ft(()=>c.focus());function d(u){Fe[u?"unshift":"push"](()=>{c=u,t(2,c)})}return l.$$set=u=>{"options"in u&&t(0,r=u.options),"abort_wr"in u&&s(t(1,o=u.abort_wr)),"result"in u&&t(5,a=u.result),"close"in u&&t(6,f=u.close)},l.$$.update=()=>{l.$$.dirty&128&&n&&g()},[r,o,c,g,_,a,f,n,d]}class Zn extends ve{constructor(e){super(),he(this,e,Kn,Xn,de,{options:0,abort_wr:1,result:5,close:6})}}function sl(l,e,t){const n=l.slice();return n[5]=e[t],n}function il(l,e){let t,n,i;return n=new Vn({props:{modalContext:e[5]}}),{key:l,first:null,c(){t=Re(),ce(n.$$.fragment),this.first=t},m(s,r){H(s,t,r),oe(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.modalContext=e[5]),n.$set(o)},i(s){i||(F(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&j(t),ae(n,s)}}}function Qn(l){let e=[],t=new Map,n,i,s=l[0];const r=o=>o[5].id;for(let o=0;o<s.length;o+=1){let a=sl(l,s,o),f=r(a);t.set(f,e[o]=il(f,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();n=Re()},m(o,a){for(let f=0;f<e.length;f+=1)e[f].m(o,a);H(o,n,a),i=!0},p(o,[a]){a&1&&(s=o[0],Le(),e=$e(e,a,r,1,o,s,t,n.parentNode,ot,il,n,sl),Me())},i(o){if(!i){for(let a=0;a<s.length;a+=1)F(e[a]);i=!0}},o(o){for(let a=0;a<e.length;a+=1)U(e[a]);i=!1},d(o){for(let a=0;a<e.length;a+=1)e[a].d(o);o&&j(n)}}}function $n(l,e,t){let{modules:n}=e,i=[],s=1;const r=a=>{i.push(a),t(0,i)},o=(a,f)=>{const c={type:a,options:f,id:s++,result:kt(),abort_wr:Ge(!1)};switch(a){case"cancel/continue":c.svelteComponent=Zn;break}return c.svelteComponent?(r(c),{abort:()=>c.abort_wr.set(!0),result:c.result.promise}):null};return je(et(1e3,()=>{const a=i.filter(f=>!f._needDestroy);a.length!==i.length&&t(0,i=a)})),n.addModule("modal",{createModal:o}),l.$$set=a=>{"modules"in a&&t(1,n=a.modules)},[i,n]}class es extends ve{constructor(e){super(),he(this,e,$n,Qn,de,{modules:1})}}function ts(l){let e,t,n,i,s,r,o,a,f;return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=E(),o=b("div"),a=E(),f=b("div"),w(n,"class","pos_abs s1 svelte-fxby3d"),w(s,"class","pos_abs s2 svelte-fxby3d"),w(o,"class","pos_abs s3 svelte-fxby3d"),w(f,"class","pos_abs s4 svelte-fxby3d"),w(t,"class","flex pos_rel ellipsis svelte-fxby3d"),R(t,"transform","scale("+l[1]+")"),w(e,"class","flex"),R(e,"height",l[0]+"px"),R(e,"width",l[2]+"px")},m(c,g){H(c,e,g),m(e,t),m(t,n),m(t,i),m(t,s),m(t,r),m(t,o),m(t,a),m(t,f)},p(c,[g]){g&2&&R(t,"transform","scale("+c[1]+")"),g&1&&R(e,"height",c[0]+"px"),g&4&&R(e,"width",c[2]+"px")},i:se,o:se,d(c){c&&j(e)}}}function ls(l,e,t){let n,i,{height:s=5}=e;return l.$$set=r=>{"height"in r&&t(0,s=r.height)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=s/.1625),l.$$.dirty&1&&t(1,i=s/13)},[s,i,n]}class en extends ve{constructor(e){super(),he(this,e,ls,ts,de,{height:0})}}function rl(l){let e,t,n,i;return t=new en({props:{height:6}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","flex pos_abs loading svelte-15wz55f")},m(s,r){H(s,e,r),oe(t,e,null),i=!0},i(s){i||(F(t.$$.fragment,s),s&&Ne(()=>{n||(n=De(e,Te,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=De(e,Te,{},!1)),n.run(0)),i=!1},d(s){s&&j(e),ae(t),s&&n&&n.end()}}}function ns(l){let e,t,n,i,s,r,o,a,f,c,g,_,d,u=l[0]&&rl();return{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),i.textContent="offline",s=E(),r=b("div"),o=ne(`online\r
		`),a=b("div"),f=ne(l[2]),c=E(),u&&u.c(),w(t,"class","pos_abs h100 onlineProgressTrumb svelte-15wz55f"),R(t,"width",l[1]+"%"),w(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-15wz55f"),X(i,"hideR",l[1]>=1),w(a,"class","pos_abs onlineProgressTrumbLastTime svelte-15wz55f"),w(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-15wz55f"),X(r,"hideL",l[1]<1),w(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-15wz55f")},m(p,h){H(p,e,h),m(e,t),m(e,n),m(e,i),m(e,s),m(e,r),m(r,o),m(r,a),m(a,f),m(e,c),u&&u.m(e,null),g=!0,_||(d=le(e,"click",l[8]),_=!0)},p(p,[h]){(!g||h&2)&&R(t,"width",p[1]+"%"),(!g||h&2)&&X(i,"hideR",p[1]>=1),(!g||h&4)&&be(f,p[2]),(!g||h&2)&&X(r,"hideL",p[1]<1),p[0]?u?h&1&&F(u,1):(u=rl(),u.c(),F(u,1),u.m(e,null)):u&&(Le(),U(u,1,1,()=>{u=null}),Me())},i(p){g||(F(u),g=!0)},o(p){U(u),g=!1},d(p){p&&j(e),u&&u.d(),_=!1,d()}}}function ss(l,e,t){let n,i,s,{endTime:r=0}=e,{intervalTime:o=1}=e,{loading:a=!1}=e;const f=Ve(0);Se(l,f,u=>t(7,s=u));let c=0;function g(){const u=Math.max(0,r-Date.now());t(1,c=Math.floor(Ee(0,u/o,1)*100)),Je(f,s=Math.ceil(u/1e3),s)}je(et(1e3,g));const _=u=>{const p=Math.floor(u%60);u/=60;const h=Math.floor(u%60);u/=60;const L=Math.floor(u),v=[];return(v.length||L)&&v.push(`${String(L).padStart(v.length?2:1,"0")}h`),(v.length||h)&&v.push(`${String(h).padStart(v.length?2:1,"0")}m`),(v.length||p)&&v.push(`${String(p).padStart(v.length?2:1,"0")}s`),v.join(" ")};function d(u){Jl.call(this,l,u)}return l.$$set=u=>{"endTime"in u&&t(4,r=u.endTime),"intervalTime"in u&&t(5,o=u.intervalTime),"loading"in u&&t(0,a=u.loading)},l.$$.update=()=>{l.$$.dirty&128&&t(6,n=Math.ceil(s)),l.$$.dirty&64&&t(2,i=_(n))},[a,c,i,f,r,o,n,s,d]}class is extends ve{constructor(e){super(),he(this,e,ss,ns,de,{endTime:4,intervalTime:5,loading:0})}}function rs(l){let e;return{c(){e=ne("\xA0")},m(t,n){H(t,e,n)},p:se,d(t){t&&j(e)}}}function os(l){let e,t=l[2].username+"",n;return{c(){e=ne("@"),n=ne(t)},m(i,s){H(i,e,s),H(i,n,s)},p(i,s){s&4&&t!==(t=i[2].username+"")&&be(n,t)},d(i){i&&j(e),i&&j(n)}}}function as(l){var Z,K;let e,t,n,i,s=((Z=l[2].first_name)!=null?Z:"")+"",r,o,a,f,c,g=((K=l[2].last_name)!=null?K:"")+"",_,d,u,p,h,L,v,y,D,T,S,C,O,I,B;function x(Q,J){return Q[2].username?os:rs}let V=x(l),G=V(l);return T=new is({props:{intervalTime:l[1],endTime:l[0],loading:l[3]}}),T.$on("click",l[8]),{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),r=ne(s),o=E(),a=b("div"),f=E(),c=b("div"),_=ne(g),d=ne("\xA0"),u=E(),p=b("div"),G.c(),h=E(),L=b("div"),L.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',v=E(),y=b("div"),D=E(),ce(T.$$.fragment),S=E(),C=b("div"),R(a,"width","8px"),w(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),w(p,"class","nowrap textOverEllipsis username svelte-1qt21qp"),w(L,"class","pos_abs btnLogout svelte-1qt21qp"),w(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),R(y,"height","8px"),R(C,"height","8px"),w(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(Q,J){H(Q,e,J),m(e,t),m(t,n),m(n,i),m(i,r),m(n,o),m(n,a),m(n,f),m(n,c),m(c,_),m(c,d),m(t,u),m(t,p),G.m(p,null),m(t,h),m(t,L),m(e,v),m(e,y),m(e,D),oe(T,e,null),m(e,S),m(e,C),O=!0,I||(B=le(L,"click",l[7]),I=!0)},p(Q,[J]){var q,A;(!O||J&4)&&s!==(s=((q=Q[2].first_name)!=null?q:"")+"")&&be(r,s),(!O||J&4)&&g!==(g=((A=Q[2].last_name)!=null?A:"")+"")&&be(_,g),V===(V=x(Q))&&G?G.p(Q,J):(G.d(1),G=V(Q),G&&(G.c(),G.m(p,null)));const ie={};J&2&&(ie.intervalTime=Q[1]),J&1&&(ie.endTime=Q[0]),J&8&&(ie.loading=Q[3]),T.$set(ie)},i(Q){O||(F(T.$$.fragment,Q),O=!0)},o(Q){U(T.$$.fragment,Q),O=!1},d(Q){Q&&j(e),G.d(),ae(T),I=!1,B()}}}function fs(l,e,t){let n,i,s,{app:r}=e;const{operatorSelf_r:o,operatorSelfLastOnlineInfo_r:a,operatorSelfLastOnlineInfoLoading_r:f,operatorSelfLastOnline_SetOnlineFlag:c}=r;Se(l,o,L=>t(2,i=L)),Se(l,a,L=>t(10,n=L)),Se(l,f,L=>t(3,s=L));const g=()=>$l(null);let _=0,d=1;const u=L=>{if(!L){t(0,_=0),t(1,d=1);return}t(0,_=+new Date(L.offline_at)),t(1,d=Ee(1,(L.interval|0)*1e3,1e9))};let p=!1;const h=async()=>{var L;!((L=r.appConfig)!=null&&L.operatorSelf_CanSetOnline)||p||(p=!0,await c(!0),p=!1)};return l.$$set=L=>{"app"in L&&t(9,r=L.app)},l.$$.update=()=>{l.$$.dirty&1024&&u(n)},[_,d,i,s,o,a,f,g,h,r,n]}class cs extends ve{constructor(e){super(),he(this,e,fs,as,de,{app:9})}}const St=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{i&&setTimeout(s,10);const o=l.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||n!==a.height)&&(t=a.width,n=a.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(a))}};return s(),{destroy:()=>i=!1}},us=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{r&&setTimeout(o,10);const f=l.getBoundingClientRect();(t!==f.width||n!==f.height||i!==f.x||s!==f.y)&&(t=f.width,n=f.height,i=f.x,s=f.y,e&&e.set(f))};return o(),{destroy:()=>r=!1}};function ds(l){let e,t,n,i,s,r,o,a,f,c,g,_,d,u,p,h,L;return{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=E(),o=b("div"),a=E(),f=b("div"),c=E(),g=b("div"),_=E(),d=b("div"),u=E(),p=b("div"),h=E(),L=b("div"),w(n,"class","svelte-1lltvmx"),w(s,"class","svelte-1lltvmx"),w(o,"class","svelte-1lltvmx"),w(f,"class","svelte-1lltvmx"),w(g,"class","svelte-1lltvmx"),w(d,"class","svelte-1lltvmx"),w(p,"class","svelte-1lltvmx"),w(L,"class","svelte-1lltvmx"),w(t,"class","lds-roller svelte-1lltvmx"),R(t,"transform","scale("+l[2]+")"),R(t,"--loadingItemColor",l[1]),w(e,"class","flex"),R(e,"height",l[0]+"px"),R(e,"width",l[0]+"px")},m(v,y){H(v,e,y),m(e,t),m(t,n),m(t,i),m(t,s),m(t,r),m(t,o),m(t,a),m(t,f),m(t,c),m(t,g),m(t,_),m(t,d),m(t,u),m(t,p),m(t,h),m(t,L)},p(v,[y]){y&4&&R(t,"transform","scale("+v[2]+")"),y&2&&R(t,"--loadingItemColor",v[1]),y&1&&R(e,"height",v[0]+"px"),y&1&&R(e,"width",v[0]+"px")},i:se,o:se,d(v){v&&j(e)}}}function _s(l,e,t){let n,{size:i=80}=e,{color:s="#000"}=e;return l.$$set=r=>{"size"in r&&t(0,i=r.size),"color"in r&&t(1,s=r.color)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=i/80)},[i,s,n]}class tn extends ve{constructor(e){super(),he(this,e,_s,ds,de,{size:0,color:1})}}function ol(l){let e,t,n,i;return t=new tn({props:{color:"#fff",size:"32"}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs loading svelte-1r93skw")},m(s,r){H(s,e,r),oe(t,e,null),i=!0},i(s){i||(F(t.$$.fragment,s),s&&Ne(()=>{n||(n=De(e,Te,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=De(e,Te,{},!1)),n.run(0)),i=!1},d(s){s&&j(e),ae(t),s&&n&&n.end()}}}function al(l){let e,t,n,i;return t=new tn({props:{color:"#fff",size:"24"}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs flex flex_cy h100 loading svelte-1r93skw")},m(s,r){H(s,e,r),oe(t,e,null),i=!0},i(s){i||(F(t.$$.fragment,s),s&&Ne(()=>{n||(n=De(e,Te,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=De(e,Te,{},!1)),n.run(0)),i=!1},d(s){s&&j(e),ae(t),s&&n&&n.end()}}}function ms(l){var D;let e,t,n,i,s,r,o,a=((D=l[0])!=null?D:0)+"",f,c,g,_,d,u,p,h,L,v=l[1]&&ol(),y=l[2]&&al();return{c(){e=b("div"),t=b("div"),n=b("div"),n.textContent="New leads",i=E(),v&&v.c(),s=E(),r=b("div"),o=b("div"),f=ne(a),c=E(),g=b("div"),_=E(),d=b("div"),y&&y.c(),u=ne(`\r
		Get one`),w(n,"class","flex mainLabel svelte-1r93skw"),w(o,"class","flex labelCountNum svelte-1r93skw"),w(r,"class","flex flex_cx flex_cy labelCount svelte-1r93skw"),w(t,"class","flex flex_cx flex_cy flex_clm header pos_rel w100 svelte-1r93skw"),R(g,"height","4px"),w(d,"class","flex flex_cx flex_cy cursor_ptr noselect pos_rel bntMain svelte-1r93skw"),X(d,"disabled",!l[0]&&!l[2]&&!l[3]),X(d,"btnLoading",l[2]),X(d,"animationDone",l[3]==="done"),X(d,"animationFail",l[3]==="fail"),w(e,"class","flex flex_clm wrapMain flex_grow_1 w100 unselect svelte-1r93skw")},m(T,S){H(T,e,S),m(e,t),m(t,n),m(t,i),v&&v.m(t,null),m(t,s),m(t,r),m(r,o),m(o,f),m(e,c),m(e,g),m(e,_),m(e,d),y&&y.m(d,null),m(d,u),p=!0,h||(L=le(d,"click",l[4]),h=!0)},p(T,[S]){var C;T[1]?v?S&2&&F(v,1):(v=ol(),v.c(),F(v,1),v.m(t,s)):v&&(Le(),U(v,1,1,()=>{v=null}),Me()),(!p||S&1)&&a!==(a=((C=T[0])!=null?C:0)+"")&&be(f,a),T[2]?y?S&4&&F(y,1):(y=al(),y.c(),F(y,1),y.m(d,u)):y&&(Le(),U(y,1,1,()=>{y=null}),Me()),(!p||S&13)&&X(d,"disabled",!T[0]&&!T[2]&&!T[3]),(!p||S&4)&&X(d,"btnLoading",T[2]),(!p||S&8)&&X(d,"animationDone",T[3]==="done"),(!p||S&8)&&X(d,"animationFail",T[3]==="fail")},i(T){p||(F(v),F(y),p=!0)},o(T){U(v),U(y),p=!1},d(T){T&&j(e),v&&v.d(),y&&y.d(),h=!1,L()}}}function gs(l,e,t){var f,c;let{app:n}=e,i=0,s=!0,r=!1,o=null;const a=async()=>{if(r||o||!i)return;t(2,r=!0);const g=await n.api.lead_AssignOneLead();t(2,r=!1),t(3,o=g?"done":"fail"),await Qe(1e3),t(3,o=null)};return je(et(Ee(100,((c=(f=n==null?void 0:n.appConfig)==null?void 0:f.updateIntervals)==null?void 0:c.new_leads_count)|0,36e5),async()=>{var g;t(0,i=((g=await n.api.lead_GetUnassignedLeadCount())==null?void 0:g.count)|0),t(1,s=!1)},!1)),l.$$set=g=>{"app"in g&&t(5,n=g.app)},[i,s,r,o,a,n]}class ps extends ve{constructor(e){super(),he(this,e,gs,ms,de,{app:5})}}function hs(l){let e,t,n,i,s,r,o,a,f,c,g,_,d,u,p,h,L,v;return{c(){e=b("label"),t=b("input"),n=E(),i=Be("svg"),s=Be("symbol"),r=Be("path"),o=Be("defs"),a=Be("mask"),f=Be("use"),c=Be("use"),g=Be("path"),_=E(),d=Be("svg"),u=Be("path"),p=Be("path"),h=Be("path"),w(t,"type","checkbox"),w(t,"class","svelte-13drl8w"),w(r,"d","M5.22003 7.26C5.72003 7.76 7.57 9.7 8.67 11.45C12.2 6.05 15.65 3.5 19.19 1.69"),w(r,"fill","none"),w(r,"stroke-width","2.25"),w(r,"stroke-linecap","round"),w(r,"stroke-linejoin","round"),w(s,"id","tick-path"),w(s,"viewBox","0 0 21 18"),w(s,"xmlns","http://www.w3.org/2000/svg"),w(f,"class","tick mask svelte-13drl8w"),w(f,"href","#tick-path"),w(a,"id","tick"),w(c,"class","tick svelte-13drl8w"),w(c,"href","#tick-path"),w(c,"stroke","currentColor"),w(g,"fill","white"),w(g,"mask","url(#tick)"),w(g,"d","M18 9C18 10.4464 17.9036 11.8929 17.7589 13.1464C17.5179 15.6054 15.6054 17.5179 13.1625 17.7589C11.8929 17.9036 10.4464 18 9 18C7.55357 18 6.10714 17.9036 4.85357 17.7589C2.39464 17.5179 0.498214 15.6054 0.241071 13.1464C0.0964286 11.8929 0 10.4464 0 9C0 7.55357 0.0964286 6.10714 0.241071 4.8375C0.498214 2.39464 2.39464 0.482143 4.85357 0.241071C6.10714 0.0964286 7.55357 0 9 0C10.4464 0 11.8929 0.0964286 13.1625 0.241071C15.6054 0.482143 17.5179 2.39464 17.7589 4.8375C17.9036 6.10714 18 7.55357 18 9Z"),w(i,"viewBox","0 0 21 18"),w(i,"class","svelte-13drl8w"),w(u,"d","M5.88086 5.89441L9.53504 4.26746"),w(p,"d","M5.5274 8.78838L9.45391 9.55161"),w(h,"d","M3.49371 4.22065L5.55387 0.79198"),w(d,"class","lines svelte-13drl8w"),w(d,"viewBox","0 0 11 11"),w(e,"class","checkbox svelte-13drl8w")},m(y,D){H(y,e,D),m(e,t),t.checked=l[0],m(e,n),m(e,i),m(i,s),m(s,r),m(i,o),m(o,a),m(a,f),m(i,c),m(i,g),m(e,_),m(e,d),m(d,u),m(d,p),m(d,h),L||(v=le(t,"change",l[1]),L=!0)},p(y,[D]){D&1&&(t.checked=y[0])},i:se,o:se,d(y){y&&j(e),L=!1,v()}}}function vs(l,e,t){let{checked:n=!1}=e;function i(){n=this.checked,t(0,n)}return l.$$set=s=>{"checked"in s&&t(0,n=s.checked)},[n,i]}class ws extends ve{constructor(e){super(),he(this,e,vs,hs,de,{checked:0})}}function fl(l){var i;let e,t=l[12]((i=l[3])==null?void 0:i._lastTime)+"",n;return{c(){e=b("div"),n=ne(t),w(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-n8zo8q")},m(s,r){H(s,e,r),m(e,n)},p(s,r){var o;r&8&&t!==(t=s[12]((o=s[3])==null?void 0:o._lastTime)+"")&&be(n,t)},d(s){s&&j(e)}}}function cl(l){var i;let e,t=((i=l[3])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=b("div"),n=ne(t),w(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-n8zo8q")},m(s,r){H(s,e,r),m(e,n)},p(s,r){var o;r&8&&t!==(t=((o=s[3])==null?void 0:o.unread_messages_count)+"")&&be(n,t)},d(s){s&&j(e)}}}function bs(l){var ue,me,we,z,P,Y,ge,ye,Oe,ke,_e,xe;let e,t,n,i,s,r,o=((we=(me=(ue=l[3])==null?void 0:ue.lead)==null?void 0:me.first_name)!=null?we:"")+"",a,f,c,g,_,d=((Y=(P=(z=l[3])==null?void 0:z.lead)==null?void 0:P.last_name)!=null?Y:"")+"",u,p,h,L,v=((Oe=(ye=(ge=l[3])==null?void 0:ge.last_message)==null?void 0:ye.text)!=null?Oe:"")+"",y,D,T,S,C,O,I,B,x=((ke=l[4])==null?void 0:ke.title)+"",V,G,Z,K,Q,J,ie,q=((_e=l[3])==null?void 0:_e._lastTime)&&fl(l),A=((xe=l[3])==null?void 0:xe.unread_messages_count)&&cl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("div"),s=E(),r=b("div"),a=ne(o),f=E(),c=b("div"),g=E(),_=b("div"),u=ne(d),p=ne("\xA0"),h=E(),L=b("div"),y=ne(v),D=ne("\xA0"),T=E(),S=b("div"),C=b("div"),O=b("img"),B=E(),V=ne(x),G=E(),Z=b("div"),K=E(),q&&q.c(),Q=E(),A&&A.c(),R(i,"width","8px"),R(c,"width","8px"),w(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-n8zo8q"),w(L,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-n8zo8q"),Xe(O.src,I="assets/icons/status1.png")||w(O,"src",I),w(O,"draggable","false"),w(O,"class","pos_abs statusIcon svelte-n8zo8q"),w(C,"class","flex flex_cy leadStatus pos_rel svelte-n8zo8q"),R(C,"background",l[4].bgColor),R(C,"color",l[4].color),R(Z,"width","4px"),w(S,"class","flex"),w(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-n8zo8q"),R(t,"height",l[0]+"px"),X(t,"active",l[1]===l[6]),X(t,"disabled",l[11](l[3])),w(e,"class","pos_abs w100 cntWrapper svelte-n8zo8q"),R(e,"transform","translate3d(0px, "+(l[5]+l[2])+"px, 0px)")},m(M,k){H(M,e,k),m(e,t),m(t,n),m(n,i),m(n,s),m(n,r),m(r,a),m(n,f),m(n,c),m(n,g),m(n,_),m(_,u),m(_,p),m(t,h),m(t,L),m(L,y),m(L,D),m(t,T),m(t,S),m(S,C),m(C,O),m(C,B),m(C,V),m(S,G),m(S,Z),m(t,K),q&&q.m(t,null),m(t,Q),A&&A.m(t,null),J||(ie=le(t,"click",l[10]),J=!0)},p(M,[k]){var N,W,$,te,ee,fe,pe,re,Ie,Ce,ze,Pe;k&8&&o!==(o=(($=(W=(N=M[3])==null?void 0:N.lead)==null?void 0:W.first_name)!=null?$:"")+"")&&be(a,o),k&8&&d!==(d=((fe=(ee=(te=M[3])==null?void 0:te.lead)==null?void 0:ee.last_name)!=null?fe:"")+"")&&be(u,d),k&8&&v!==(v=((Ie=(re=(pe=M[3])==null?void 0:pe.last_message)==null?void 0:re.text)!=null?Ie:"")+"")&&be(y,v),k&16&&x!==(x=((Ce=M[4])==null?void 0:Ce.title)+"")&&be(V,x),k&16&&R(C,"background",M[4].bgColor),k&16&&R(C,"color",M[4].color),(ze=M[3])!=null&&ze._lastTime?q?q.p(M,k):(q=fl(M),q.c(),q.m(t,Q)):q&&(q.d(1),q=null),(Pe=M[3])!=null&&Pe.unread_messages_count?A?A.p(M,k):(A=cl(M),A.c(),A.m(t,null)):A&&(A.d(1),A=null),k&1&&R(t,"height",M[0]+"px"),k&66&&X(t,"active",M[1]===M[6]),k&2056&&X(t,"disabled",M[11](M[3])),k&36&&R(e,"transform","translate3d(0px, "+(M[5]+M[2])+"px, 0px)")},i:se,o:se,d(M){M&&j(e),q&&q.d(),A&&A.d(),J=!1,ie()}}}function ys(l,e,t){let n,i,s,r,o,{app:a}=e;const{dialogMap_r:f,dialogActiveID_r:c,dialogActiveID_Set:g}=a;Se(l,f,D=>t(15,s=D)),Se(l,c,D=>t(6,o=D));let{height:_=54}=e,{dialog_id:d}=e,{y:u=0}=e,{scrollY:p=0}=e;const h=Ve(u);Se(l,h,D=>t(5,r=D));const L=D=>{n&&!v(n)&&g(n.id)},v=D=>{var T;return((T=D==null?void 0:D.lead)==null?void 0:T.status)==="DL"},y=D=>{if(!D)return"";const T=C=>String(C).padStart(2,"0"),S=new Date;return D=new Date(D),D.getYear()===S.getYear()&&D.getMonth()===S.getMonth()?D.getDate()===S.getDate()?`${T(D.getHours())}:${T(D.getMinutes())}`:`${T(D.getDate())}d ${T(D.getHours())}:${T(D.getMinutes())}`:`${T(D.getDate())}.${T(D.getMonth())}.${D.getFullYear()}`};return l.$$set=D=>{"app"in D&&t(13,a=D.app),"height"in D&&t(0,_=D.height),"dialog_id"in D&&t(1,d=D.dialog_id),"y"in D&&t(14,u=D.y),"scrollY"in D&&t(2,p=D.scrollY)},l.$$.update=()=>{l.$$.dirty&16384&&Je(h,r=u,r),l.$$.dirty&32770&&t(3,n=s[d]),l.$$.dirty&8200&&t(4,i=a.lead_GetStatusOrDefault(n==null?void 0:n.lead))},[_,d,p,n,i,r,o,f,c,h,L,v,y,a,u,s]}class ks extends ve{constructor(e){super(),he(this,e,ys,bs,de,{app:13,height:0,dialog_id:1,y:14,scrollY:2})}}function Ss(l){let e,t,n,i;return{c(){e=b("div"),t=b("div"),w(t,"class","pos_abs thumb w100 svelte-5ca5ia"),R(t,"height",l[1]+"px"),R(t,"transform","translate(0px, "+l[5](l[0],l[2],l[1])+"px)"),X(t,"active",l[3]),w(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),X(e,"active",l[3])},m(s,r){H(s,e,r),m(e,t),n||(i=[le(window,"mousemove",l[7]),le(window,"mouseup",l[8]),le(window,"blur",l[8]),le(t,"mousedown",l[6]),rt(us.call(null,e,l[4])),le(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&R(t,"height",s[1]+"px"),r&7&&R(t,"transform","translate(0px, "+s[5](s[0],s[2],s[1])+"px)"),r&8&&X(t,"active",s[3]),r&8&&X(e,"active",s[3])},i:se,o:se,d(s){s&&j(e),n=!1,He(i)}}}function Ls(l,e,t){let n;const i=y=>Ee(0,Array.isArray(y)?y[0]:y,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:a=null}=e;const f=Ge(null);Se(l,f,y=>t(2,n=y));const c=()=>n?n.height-o:1,g=y=>n?y*c():0,_=()=>{if(!n)return 1;if(a===null)return o;t(1,o=Ee(.1,a,1)*n.height)};let d=null;const u=y=>{!n||t(3,d={y:y.clientY,value_out:r})},p=y=>{if(!n||!d)return;const D=y.clientY-d.y;if(n.height){const T=D/c();t(0,r=Ee(0,d.value_out+T,1))}},h=y=>{t(3,d=null)},L=y=>{!n||d||(t(0,r=Ee(0,(y.clientY-n.y-o/2)/c(),1)),t(3,d={y:y.clientY,value_out:r}))},v=()=>{if(!n)return 0;d||t(0,r=i(s))};return l.$$set=y=>{"value_in"in y&&t(10,s=y.value_in),"value_out"in y&&t(0,r=y.value_out),"thumb_Height"in y&&t(1,o=y.thumb_Height),"thumb_HeightRate"in y&&t(11,a=y.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&_(),l.$$.dirty&1024&&v()},[r,o,n,d,f,g,u,p,h,L,s,a]}class ln extends ve{constructor(e){super(),he(this,e,Ls,Ss,de,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:Ms}=yn;function ul(l,e,t){const n=l.slice();return n[24]=e[t],n}function dl(l,e){let t,n,i;return n=new ks({props:{app:e[0],dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Re(),ce(n.$$.fragment),this.first=t},m(s,r){H(s,t,r),oe(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(F(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&j(t),ae(n,s)}}}function _l(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new ln({props:r}),Fe.push(()=>bt(t,"value_out",s)),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,a){H(o,e,a),oe(t,e,null),i=!0},p(o,a){const f={};a&32&&(f.value_in=o[5]),a&64&&(f.thumb_HeightRate=o[6]),!n&&a&2&&(n=!0,f.value_out=o[1],wt(()=>n=!1)),t.$set(f)},i(o){i||(F(t.$$.fragment,o),i=!0)},o(o){U(t.$$.fragment,o),i=!1},d(o){o&&j(e),ae(t)}}}function ml(l){let e,t,n,i,s;return{c(){e=b("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',w(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){H(r,e,o),n=!0,i||(s=le(e,"click",l[15]),i=!0)},p:se,i(r){n||(r&&Ne(()=>{t||(t=De(e,Te,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=De(e,Te,{},!1)),t.run(0)),n=!1},d(r){r&&j(e),r&&t&&t.end(),i=!1,s()}}}function Ds(l){let e,t,n=[],i=new Ms,s,r,o,a,f,c=l[4];const g=u=>u[24].dialog_id;for(let u=0;u<c.length;u+=1){let p=ul(l,c,u),h=g(p);i.set(h,n[u]=dl(h,p))}let _=l[6]<1&&_l(l),d=l[6]<1&&l[7]&&ml(l);return{c(){e=b("div"),t=b("div");for(let u=0;u<n.length;u+=1)n[u].c();s=E(),_&&_.c(),r=E(),d&&d.c(),w(t,"class","flex overhide pos_rel"),w(e,"class","flex flex_grow_1 pos_rel"),R(e,"--itemHeight",We+"px")},m(u,p){H(u,e,p),m(e,t);for(let h=0;h<n.length;h+=1)n[h].m(t,null);m(e,s),_&&_.m(e,null),m(e,r),d&&d.m(e,null),o=!0,a||(f=[rt(St.call(null,t,l[8])),le(e,"wheel",l[10],{passive:!0})],a=!0)},p(u,[p]){p&21&&(c=u[4],Le(),n=$e(n,p,g,1,u,c,i,t,ot,dl,null,ul),Me()),u[6]<1?_?(_.p(u,p),p&64&&F(_,1)):(_=_l(u),_.c(),F(_,1),_.m(e,r)):_&&(Le(),U(_,1,1,()=>{_=null}),Me()),u[6]<1&&u[7]?d?(d.p(u,p),p&192&&F(d,1)):(d=ml(u),d.c(),F(d,1),d.m(e,null)):d&&(Le(),U(d,1,1,()=>{d=null}),Me())},i(u){if(!o){for(let p=0;p<c.length;p+=1)F(n[p]);F(_),F(d),o=!0}},o(u){for(let p=0;p<n.length;p+=1)U(n[p]);U(_),U(d),o=!1},d(u){u&&j(e);for(let p=0;p<n.length;p+=1)n[p].d();_&&_.d(),d&&d.d(),a=!1,He(f)}}}const We=54;function Os(l,e,t){let n,i,s=se,r=()=>(s(),s=Et(u,G=>t(13,i=G)),u),o;l.$$.on_destroy.push(()=>s());let{app:a}=e;const{dialogMap_SetDialogList:f}=a;let{filter:c={}}=e;const g=G=>{var Z,K;return[c.filterUnreadFirst?1:0,(Z=c.filterTag)!=null?Z:"",(K=c.filterStatus)!=null?K:""].join("/")};let _={},d=null,u=Ge(null);r();function p(){const G={...c},Z=g();_[Z]||(_[Z]=Tn({fLoad:K=>(K={unread_first:G.filterUnreadFirst?1:0,...K},G.filterTag&&(K.tag=G.filterTag),G.filterStatus&&(K.status=G.filterStatus),a.api.dialog_GetList(K)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:f})),d!==_[Z]&&([...Object.values(_)].map(K=>K.pause()),d=_[Z],d.resume(),console.log({filterHash:Z}),r(t(3,u=d.getData_r())))}je(()=>[...Object.values(_)].map(G=>G.destroy()));let h=[];const L=Ge(null);Se(l,L,G=>t(12,n=G));let v=0,y=0,D=1,T=0,S=Ve(T,{duration:200});Se(l,S,G=>t(2,o=G));function C(){if(!n||!i)return;const G=Math.max(1,Math.floor(n.height)),Z=i.total*We,K=Z-G;t(6,D=Z?Ee(0,G/Z,1):1),K<0?T=0:T=y*K,Je(S,o=T,o)}let O=!1;function I(){if(!n||!i)return;const G=i,Z=Math.max(1,Math.floor(n.height)),K=Math.ceil(Z/We);i.total*We;let J=Math.max(0,Math.floor(o/We)-1);const ie=K+2;J>G.total&&(J=Math.max(0,G.total-ie)),d&&d.setRange(J,ie);const q=[];for(let A=J,ue=0;ue<ie&&A<G.total;ue++,A++){const me=G.list[A];q.push({index:A,item:me,y:A*We})}t(4,h=[...new Map(q.filter(A=>A.item).map(A=>[A.item.id,A]))].map(([A,ue])=>({dialog_id:ue.item.id,y:ue.y}))),t(7,O=J>1)}const B=G=>{if(!n||!i)return;const Z=i,K=Math.max(1,Math.floor(n.height)),J=Z.total*We-K;if(J<0)return;const ie=G.deltaY>0?1:-1;t(5,v=[y+We/J*ie])};function x(G){y=G,t(1,y)}const V=()=>t(5,v=[0]);return l.$$set=G=>{"app"in G&&t(0,a=G.app),"filter"in G&&t(11,c=G.filter)},l.$$.update=()=>{l.$$.dirty&2048&&p(),l.$$.dirty&12290&&C(),l.$$.dirty&12292&&I()},[a,y,o,u,h,v,D,O,L,S,B,c,n,i,x,V]}class Ts extends ve{constructor(e){super(),he(this,e,Os,Ds,de,{app:0,filter:11})}}function gl(l,e,t){const n=l.slice();return n[6]=e[t],n}function pl(l){let e,t,n,i,s=[],r=new Map,o=l[0];const a=f=>f[6].id;for(let f=0;f<o.length;f+=1){let c=gl(l,o,f),g=a(c);r.set(g,s[f]=hl(g,c))}return{c(){e=b("div"),t=b("div"),t.textContent="Filter status",n=E(),i=b("div");for(let f=0;f<s.length;f+=1)s[f].c();w(t,"class","flex label svelte-1ovi0to"),w(i,"class","flex unselect"),w(e,"class","flex flex_clm")},m(f,c){H(f,e,c),m(e,t),m(e,n),m(e,i);for(let g=0;g<s.length;g+=1)s[g].m(i,null)},p(f,c){c&3&&(o=f[0],s=$e(s,c,a,1,f,o,r,i,kn,hl,null,gl))},d(f){f&&j(e);for(let c=0;c<s.length;c+=1)s[c].d()}}}function hl(l,e){let t,n=e[6].title+"",i,s,r;return{key:l,first:null,c(){var o,a,f,c;t=b("div"),i=ne(n),w(t,"class","flex flex_cx flex_cy nowrap cursor_ptr statusItem svelte-1ovi0to"),R(t,"background",(a=(o=e[6])==null?void 0:o.bgColor)!=null?a:"#000"),R(t,"color",(c=(f=e[6])==null?void 0:f.color)!=null?c:"#fff"),X(t,"select",e[6]._select),this.first=t},m(o,a){H(o,t,a),m(t,i),s||(r=le(t,"click",function(){Ye(e[1](e[6]))&&e[1](e[6]).apply(this,arguments)}),s=!0)},p(o,a){var f,c,g,_;e=o,a&1&&n!==(n=e[6].title+"")&&be(i,n),a&1&&R(t,"background",(c=(f=e[6])==null?void 0:f.bgColor)!=null?c:"#000"),a&1&&R(t,"color",(_=(g=e[6])==null?void 0:g.color)!=null?_:"#fff"),a&1&&X(t,"select",e[6]._select)},d(o){o&&j(t),s=!1,r()}}}function Is(l){let e,t=l[0].length>1&&pl(l);return{c(){t&&t.c(),e=Re()},m(n,i){t&&t.m(n,i),H(n,e,i)},p(n,[i]){n[0].length>1?t?t.p(n,i):(t=pl(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:se,o:se,d(n){t&&t.d(n),n&&j(e)}}}const vl="__ALL__";function Cs(l,e,t){var a,f;let{app:n}=e,{filterStatus:i=null}=e,s=[{title:"ALL",id:vl,color:"#000",bgColor:"#fff",_select:!0},...((f=(a=n==null?void 0:n.appConfig)==null?void 0:a.lead_StatusFilterList)!=null?f:[]).map(n.lead_GetStatusByID).map(c=>({...c,_select:!1}))];const r=()=>{var c,g;t(0,s),t(2,i=s.length?s[0]._select?null:(g=(c=s.find(_=>_._select))==null?void 0:c.id)!=null?g:null:null)},o=c=>{const g=!c._select;return g?(s.map(_=>_._select=!1),c._select=g,r()):c.id===vl?void 0:(t(0,s[0]._select=!0,s),c._select=g,r())};return r(),l.$$set=c=>{"app"in c&&t(3,n=c.app),"filterStatus"in c&&t(2,i=c.filterStatus)},[s,o,i,n]}class As extends ve{constructor(e){super(),he(this,e,Cs,Is,de,{app:3,filterStatus:2})}}function wl(l){let e,t,n,i,s,r,o,a,f;return{c(){e=b("img"),n=E(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',r=E(),o=b("div"),o.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/fullscreen.png"/>',w(e,"class","a_img svelte-1m8yuzj"),Xe(e.src,t=l[2].url)||w(e,"src",t),R(e,"max-height",l[4]+"px"),w(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(o,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(c,g){H(c,e,g),H(c,n,g),H(c,i,g),m(i,s),m(i,r),m(i,o),a||(f=[le(s,"click",function(){Ye(l[5](l[2]))&&l[5](l[2]).apply(this,arguments)}),le(o,"click",function(){Ye(l[6](l[2]))&&l[6](l[2]).apply(this,arguments)})],a=!0)},p(c,g){l=c,g&4&&!Xe(e.src,t=l[2].url)&&w(e,"src",t),g&16&&R(e,"max-height",l[4]+"px")},d(c){c&&j(e),c&&j(n),c&&j(i),a=!1,He(f)}}}function bl(l){let e,t,n,i,s,r,o;return{c(){e=b("img"),n=E(),i=b("div"),s=b("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',w(e,"class","a_img fileIcon svelte-1m8yuzj"),Xe(e.src,t="assets/icons/folder.png")||w(e,"src",t),R(e,"max-height",l[4]+"px"),w(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),w(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(a,f){H(a,e,f),H(a,n,f),H(a,i,f),m(i,s),r||(o=le(s,"click",l[13]),r=!0)},p(a,f){f&16&&R(e,"max-height",a[4]+"px")},d(a){a&&j(e),a&&j(n),a&&j(i),r=!1,o()}}}function yl(l){var i;let e,t=((i=l[0])==null?void 0:i.text)+"",n;return{c(){e=b("pre"),n=ne(t),w(e,"class","w100 text textPre svelte-1m8yuzj")},m(s,r){H(s,e,r),m(e,n)},p(s,r){var o;r&1&&t!==(t=((o=s[0])==null?void 0:o.text)+"")&&be(n,t)},d(s){s&&j(e)}}}function xs(l){var g,_;let e,t,n,i,s,r=l[7]((g=l[0])==null?void 0:g.received_at)+"",o,a=l[2]&&wl(l),f=l[3]&&bl(l),c=((_=l[0])==null?void 0:_.text)&&yl(l);return{c(){var d,u,p,h;e=b("div"),a&&a.c(),t=E(),f&&f.c(),n=E(),c&&c.c(),i=E(),s=b("div"),o=ne(r),w(s,"class","flex pos_abs unselect date svelte-1m8yuzj"),X(s,"attachment_mode",l[2]&&!((d=l[0])!=null&&d.text)),w(e,"class","flex flex_clm overhide pos_abs chat_item svelte-1m8yuzj"),X(e,"chat_item_other",(u=l[0])==null?void 0:u.incoming),X(e,"chat_item_self",!((p=l[0])!=null&&p.incoming)),X(e,"has_text",(h=l[0])==null?void 0:h.text)},m(d,u){H(d,e,u),a&&a.m(e,null),m(e,t),f&&f.m(e,null),m(e,n),c&&c.m(e,null),m(e,i),m(e,s),m(s,o),l[14](e)},p(d,[u]){var p,h,L,v,y,D;d[2]?a?a.p(d,u):(a=wl(d),a.c(),a.m(e,t)):a&&(a.d(1),a=null),d[3]?f?f.p(d,u):(f=bl(d),f.c(),f.m(e,n)):f&&(f.d(1),f=null),(p=d[0])!=null&&p.text?c?c.p(d,u):(c=yl(d),c.c(),c.m(e,i)):c&&(c.d(1),c=null),u&1&&r!==(r=d[7]((h=d[0])==null?void 0:h.received_at)+"")&&be(o,r),u&5&&X(s,"attachment_mode",d[2]&&!((L=d[0])!=null&&L.text)),u&1&&X(e,"chat_item_other",(v=d[0])==null?void 0:v.incoming),u&1&&X(e,"chat_item_self",!((y=d[0])!=null&&y.incoming)),u&1&&X(e,"has_text",(D=d[0])==null?void 0:D.text)},i:se,o:se,d(d){d&&j(e),a&&a.d(),f&&f.d(),c&&c.d(),l[14](null)}}}function Es(l,e,t){let{app:n}=e,{bbox:i=null}=e,{message:s=null}=e,{render_Width:r=1}=e,{render_X:o=-r*2}=e,a=null,f=null,c=null,g=null,_=[],d=[],u=1;function p(S){var O;_=[],d=[],S&&(O=S.attachments)!=null&&O.length&&(_=S.attachments.filter(I=>I.file_type==="IM").map(I=>({url:I.url})),d=S.attachments.filter(I=>I.file_type==="DC").map(I=>({url:I.url})));const C=i.height*.7;i.width,t(4,u=C),t(2,c=_==null?void 0:_[0]),t(3,g=d==null?void 0:d[0])}function h(S){if(!S||!Array.isArray(S.attachments)){t(0,f=null);return}if(!f){t(0,f=S);return}if(f.text!==S.text||f.incoming!==S.incoming||f.received_at!==S.received_at||f.attachments.length!==S.attachments.length){t(0,f=S);return}if(!f.attachments.map((C,O)=>[C,S.attachments[O]]).every(([C,O])=>C.file_type===O.file_type&&C.url===O.url)){t(0,f=S);return}}const L=S=>C=>{S&&S.url&&Ct(S.url)},v=S=>C=>{S&&S.url&&n.events.emit("openOverlayImageView",S.url)},y=S=>{if(S===null)return"";const C=I=>String(I).padStart(2,"0"),O=new Date;return S=new Date(S),S.getYear()===O.getYear()&&S.getMonth()===O.getMonth()&&S.getDate()===O.getDate()?`${C(S.getHours())}:${C(S.getMinutes())}`:`${C(S.getDate())}.${C(S.getMonth())}.${S.getFullYear()} ${C(S.getHours())}:${C(S.getMinutes())}`},D=()=>Ql(g.url);function T(S){Fe[S?"unshift":"push"](()=>{a=S,t(1,a)})}return l.$$set=S=>{"app"in S&&t(8,n=S.app),"bbox"in S&&t(9,i=S.bbox),"message"in S&&t(10,s=S.message),"render_Width"in S&&t(11,r=S.render_Width),"render_X"in S&&t(12,o=S.render_X)},l.$$.update=()=>{l.$$.dirty&1024&&h(s),l.$$.dirty&1&&p(f)},[f,a,c,g,u,L,v,y,n,i,s,r,o,D,T]}class js extends ve{constructor(e){super(),he(this,e,Es,xs,de,{app:8,bbox:9,message:10,render_Width:11,render_X:12})}}function Ns(l){let e;return{c(){e=b("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,w(e,"class","lds-roller svelte-j15bjw")},m(t,n){H(t,e,n)},p:se,i:se,o:se,d(t){t&&j(e)}}}class nn extends ve{constructor(e){super(),he(this,e,null,Ns,de,{})}}function kl(l){let e,t=l[0]===">"?">":"",n;return{c(){e=b("div"),n=ne(t),w(e,"class","flex flex_cx flex_cy statusItemDlm svelte-1h7gd9r")},m(i,s){H(i,e,s),m(e,n)},p(i,s){s&1&&t!==(t=i[0]===">"?">":"")&&be(n,t)},d(i){i&&j(e)}}}function Hs(l){var c,g,_,d;let e,t,n,i,s=((d=(c=l[1])==null?void 0:c.title)!=null?d:(g=l[1])!=null&&g.id?`#${(_=l[1])==null?void 0:_.id}`:"*UNK*")+"",r,o,a,f=l[0]&&kl(l);return{c(){var u,p,h,L,v;e=b("div"),t=b("div"),f&&f.c(),n=E(),i=b("div"),r=ne(s),w(i,"class","flex flex_cx flex_cy nowrap statusItem svelte-1h7gd9r"),R(i,"background",(p=(u=l[1])==null?void 0:u.bgColor)!=null?p:"#000"),R(i,"color",(L=(h=l[1])==null?void 0:h.color)!=null?L:"#fff"),X(i,"select",l[1].canSelect),w(t,"class","flex"),w(e,"class","flex flex_cy h100 overhide itemWrapper svelte-1h7gd9r"),R(e,"width",l[5]+"px"),X(e,"overhide",l[5]<l[4]&&l[4]>0),X(e,"cursor_ptr",(v=l[1])==null?void 0:v.canSelect)},m(u,p){H(u,e,p),m(e,t),f&&f.m(t,null),m(t,n),m(t,i),m(i,r),l[10](t),l[11](e),o||(a=le(i,"click",l[9]),o=!0)},p(u,[p]){var h,L,v,y,D,T,S,C,O;u[0]?f?f.p(u,p):(f=kl(u),f.c(),f.m(t,n)):f&&(f.d(1),f=null),p&2&&s!==(s=((y=(h=u[1])==null?void 0:h.title)!=null?y:(L=u[1])!=null&&L.id?`#${(v=u[1])==null?void 0:v.id}`:"*UNK*")+"")&&be(r,s),p&2&&R(i,"background",(T=(D=u[1])==null?void 0:D.bgColor)!=null?T:"#000"),p&2&&R(i,"color",(C=(S=u[1])==null?void 0:S.color)!=null?C:"#fff"),p&2&&X(i,"select",u[1].canSelect),p&32&&R(e,"width",u[5]+"px"),p&48&&X(e,"overhide",u[5]<u[4]&&u[4]>0),p&2&&X(e,"cursor_ptr",(O=u[1])==null?void 0:O.canSelect)},i:se,o:se,d(u){u&&j(e),f&&f.d(),l[10](null),l[11](null),o=!1,a()}}}function Fs(l,e,t){let n,{beforeDlm:i=!1}=e,{hide:s=!1}=e,{status:r={}}=e;const o=Yl();let a,f,c=0;const g=Ve(0,{duration:200});Se(l,g,h=>t(5,n=h));const _=()=>{a&&f&&g.set(s?0:c)};Ft(()=>{a&&f&&(t(4,c=f.offsetWidth),_())});const d=()=>r.canSelect&&o("click",r);function u(h){Fe[h?"unshift":"push"](()=>{f=h,t(3,f)})}function p(h){Fe[h?"unshift":"push"](()=>{a=h,t(2,a)})}return l.$$set=h=>{"beforeDlm"in h&&t(0,i=h.beforeDlm),"hide"in h&&t(8,s=h.hide),"status"in h&&t(1,r=h.status)},l.$$.update=()=>{l.$$.dirty&256&&_()},[i,r,a,f,c,n,o,g,s,d,u,p]}class Bs extends ve{constructor(e){super(),he(this,e,Fs,Hs,de,{beforeDlm:0,hide:8,status:1})}}function Sl(l,e,t){const n=l.slice();return n[8]=e[t],n[10]=t,n}function Ll(l,e){var s;let t,n,i;return n=new Bs({props:{beforeDlm:(s=e[8].status)==null?void 0:s.beforeDlm,status:e[8].status,hide:e[8].hide}}),n.$on("click",e[3]),{key:l,first:null,c(){t=Re(),ce(n.$$.fragment),this.first=t},m(r,o){H(r,t,o),oe(n,r,o),i=!0},p(r,o){var f;e=r;const a={};o&1&&(a.beforeDlm=(f=e[8].status)==null?void 0:f.beforeDlm),o&1&&(a.status=e[8].status),o&1&&(a.hide=e[8].hide),n.$set(a)},i(r){i||(F(n.$$.fragment,r),i=!0)},o(r){U(n.$$.fragment,r),i=!1},d(r){r&&j(t),ae(n,r)}}}function Ps(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[8].rID;for(let o=0;o<s.length;o+=1){let a=Sl(l,s,o),f=r(a);n.set(f,t[o]=Ll(f,a))}return{c(){e=b("div");for(let o=0;o<t.length;o+=1)t[o].c();w(e,"class","flex h100")},m(o,a){H(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],Le(),t=$e(t,a,r,1,o,s,n,e,ot,Ll,null,Sl),Me())},i(o){if(!i){for(let a=0;a<s.length;a+=1)F(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)U(t[a]);i=!1},d(o){o&&j(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Gs(l,e,t){let{statusList:n=[]}=e,{statusSelectList:i=[]}=e,s=[],r=1;je(et(1e3,()=>{const f=Date.now();t(0,s=s.filter(c=>!c.hide||c.hide<=f))}));const o=()=>{const f=[...n];let c=-1;const g=r++;for(;f.length;){const _=f.shift(),d=s.findIndex(u=>{var p,h;return((p=u==null?void 0:u.status)==null?void 0:p.id)===(_==null?void 0:_.id)&&((h=u==null?void 0:u.status)==null?void 0:h.beforeDlm)===(_==null?void 0:_.beforeDlm)});if(d>c)c=d,t(0,s[d].seq=g,s),t(0,s[d].status=_,s);else{const u={rID:r++,seq:g,status:_,hide:!1};s.splice(c+1,0,u),c++}}s.filter(_=>_.seq===g).map(_=>_.hide=!1),s.filter(_=>_.seq!==g).map(_=>_.hide=Date.now()+1e3),t(0,s)};function a(f){Jl.call(this,l,f)}return l.$$set=f=>{"statusList"in f&&t(1,n=f.statusList),"statusSelectList"in f&&t(2,i=f.statusSelectList)},l.$$.update=()=>{l.$$.dirty&2&&o()},[s,n,i,a]}class Rs extends ve{constructor(e){super(),he(this,e,Gs,Ps,de,{statusList:1,statusSelectList:2})}}function Ml(l){var d;let e,t,n,i,s,r,o,a,f,c,g;o=new Rs({props:{statusList:l[7]((d=l[0])==null?void 0:d.lead,l[2])}}),o.$on("click",l[12]);let _=l[1]&&Dl();return{c(){e=b("div"),t=b("div"),n=E(),i=b("img"),r=E(),ce(o.$$.fragment),a=E(),_&&_.c(),w(t,"class","pos_abs w100 h100 overhide bg svelte-socr2e"),Xe(i.src,s="assets/icons/status1.png")||w(i,"src",s),w(i,"draggable","false"),w(i,"class","pos_abs statusIcon svelte-socr2e"),w(e,"class","flex flex_cx flex_cy unselect statusCnt pos_rel svelte-socr2e"),X(e,"loading",l[1])},m(u,p){H(u,e,p),m(e,t),m(e,n),m(e,i),m(e,r),oe(o,e,null),m(e,a),_&&_.m(e,null),l[13](e),f=!0,c||(g=[le(e,"mouseenter",l[14]),le(e,"mouseleave",l[15]),le(e,"click",l[16])],c=!0)},p(u,p){var L;const h={};p&5&&(h.statusList=u[7]((L=u[0])==null?void 0:L.lead,u[2])),o.$set(h),u[1]?_?p&2&&F(_,1):(_=Dl(),_.c(),F(_,1),_.m(e,null)):_&&(Le(),U(_,1,1,()=>{_=null}),Me()),(!f||p&2)&&X(e,"loading",u[1])},i(u){f||(F(o.$$.fragment,u),F(_),f=!0)},o(u){U(o.$$.fragment,u),U(_),f=!1},d(u){u&&j(e),ae(o),_&&_.d(),l[13](null),c=!1,He(g)}}}function Dl(l){let e,t,n,i;return t=new en({props:{height:"6"}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","flex pos_abs flex_cy h100 loadingInd svelte-socr2e"),R(e,"filter","invert(0)")},m(s,r){H(s,e,r),oe(t,e,null),i=!0},i(s){i||(F(t.$$.fragment,s),s&&Ne(()=>{n||(n=De(e,Te,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=De(e,Te,{},!1)),n.run(0)),i=!1},d(s){s&&j(e),ae(t),s&&n&&n.end()}}}function zs(l){let e,t,n,i,s=l[0]&&l[0].lead&&Ml(l);return{c(){s&&s.c(),e=Re()},m(r,o){s&&s.m(r,o),H(r,e,o),t=!0,n||(i=[le(window,"mousedown",l[5]),le(window,"blur",l[5])],n=!0)},p(r,[o]){r[0]&&r[0].lead?s?(s.p(r,o),o&1&&F(s,1)):(s=Ml(r),s.c(),F(s,1),s.m(e.parentNode,e)):s&&(Le(),U(s,1,1,()=>{s=null}),Me())},i(r){t||(F(s),t=!0)},o(r){U(s),t=!1},d(r){s&&s.d(r),r&&j(e),n=!1,He(i)}}}function Us(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o,dialogMap_SetDialog:a}=r;Se(l,o,x=>t(11,s=x));let{dialog_id:f}=e,c=!1,g=!1,_=!1,d;const u=()=>!(!n||!(n!=null&&n.lead)||c||_);let p;const h=x=>{if(x!=null&&x.target){let V=x.target;for(;V;){if(V===p)return;V=V.parentNode}}_||t(2,g=!1)},L=()=>{d&&d(),t(2,g=!1),_=!1},v=(x,V)=>async G=>{var K,Q;if(!u())return;_=!0;const Z=V.id;if(V.protectionModal){const J=(Q=(K=r.moduleMgr)==null?void 0:K.modal)==null?void 0:Q.createModal("cancel/continue",{...V.protectionModal,position:{target:p,stick:"bottom"}});if(J&&(d=J.abort,!await J.result))return L()}if(t(1,c=!0),x){await Qe(1e3);const J=await r.api.lead_SetStatus(x.lead.tg_id,Z);J&&x&&x.lead&&x.lead.tg_id===J.tg_id&&(x.lead=J,a(x))}t(1,c=!1),L()},y=x=>{var V,G,Z,K;try{const Q=r.lead_GetStatusID(x);return(r.lead_GetStatusByID(Q)?(G=(V=r==null?void 0:r.appConfig)==null?void 0:V.lead_StatusJumpMap)==null?void 0:G[Q]:(K=(Z=r==null?void 0:r.appConfig)==null?void 0:Z.lead_StatusNextListForUnkStatus)!=null?K:[]).map(r==null?void 0:r.lead_GetStatusByID).filter(Boolean)}catch{}return[]},D=x=>r.lead_GetStatusHistory(x).map((V,G)=>({...V,beforeDlm:G!==0})),T=(x,V=!1)=>{const G=D(x).map((K,Q)=>({...K,beforeDlm:Q!==0?">":!1})),Z=V?y(x).map((K,Q)=>({...K,beforeDlm:Q===0?">":!0,canSelect:!0})):[];return[...G,...Z]};je(L);const S=x=>v(n,x.detail)();function C(x){Fe[x?"unshift":"push"](()=>{p=x,t(3,p)})}const O=()=>t(2,g=!0),I=()=>h(),B=()=>t(2,g=!0);return l.$$set=x=>{"app"in x&&t(8,r=x.app),"dialog_id"in x&&t(9,f=x.dialog_id)},l.$$.update=()=>{var x;l.$$.dirty&2560&&t(0,n=s[f]),l.$$.dirty&1&&t(10,i=(x=n==null?void 0:n.lead)==null?void 0:x.status),l.$$.dirty&1&&T(n==null?void 0:n.lead),l.$$.dirty&1536&&L()},[n,c,g,p,o,h,v,T,r,f,i,s,S,C,O,I,B]}class qs extends ve{constructor(e){super(),he(this,e,Us,zs,de,{app:8,dialog_id:9})}}function Ol(l){var I,B,x,V,G,Z,K,Q,J,ie;let e,t,n,i,s=((x=(B=(I=l[2])==null?void 0:I.lead)==null?void 0:B.first_name)!=null?x:"")+"",r,o,a,f,c,g=((Z=(G=(V=l[2])==null?void 0:V.lead)==null?void 0:G.last_name)!=null?Z:"")+"",_,d,u,p,h,L,v,y,D,T,S,C=((Q=(K=l[2])==null?void 0:K.lead)==null?void 0:Q.username)&&Tl(l),O=((ie=(J=l[2])==null?void 0:J.lead)==null?void 0:ie.ref_link)&&Il(l);return y=new qs({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=b("div"),t=b("div"),n=E(),i=b("div"),r=ne(s),o=E(),a=b("div"),f=E(),c=b("div"),_=ne(g),d=ne("\xA0"),u=E(),p=b("div"),C&&C.c(),h=E(),O&&O.c(),L=E(),v=b("div"),ce(y.$$.fragment),D=E(),T=b("div"),R(t,"width","8px"),R(a,"width","8px"),w(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),w(p,"class","nowrap textOverEllipsis username svelte-qywc37"),w(v,"class","flex"),R(T,"height","4px")},m(q,A){H(q,e,A),m(e,t),m(e,n),m(e,i),m(i,r),m(e,o),m(e,a),m(e,f),m(e,c),m(c,_),m(c,d),H(q,u,A),H(q,p,A),C&&C.m(p,null),H(q,h,A),O&&O.m(q,A),H(q,L,A),H(q,v,A),oe(y,v,null),H(q,D,A),H(q,T,A),S=!0},p(q,A){var me,we,z,P,Y,ge,ye,Oe,ke,_e;(!S||A&4)&&s!==(s=((z=(we=(me=q[2])==null?void 0:me.lead)==null?void 0:we.first_name)!=null?z:"")+"")&&be(r,s),(!S||A&4)&&g!==(g=((ge=(Y=(P=q[2])==null?void 0:P.lead)==null?void 0:Y.last_name)!=null?ge:"")+"")&&be(_,g),(Oe=(ye=q[2])==null?void 0:ye.lead)!=null&&Oe.username?C?C.p(q,A):(C=Tl(q),C.c(),C.m(p,null)):C&&(C.d(1),C=null),(_e=(ke=q[2])==null?void 0:ke.lead)!=null&&_e.ref_link?O?O.p(q,A):(O=Il(q),O.c(),O.m(L.parentNode,L)):O&&(O.d(1),O=null);const ue={};A&1&&(ue.app=q[0]),A&4&&(ue.dialog_id=q[2].id),y.$set(ue)},i(q){S||(F(y.$$.fragment,q),S=!0)},o(q){U(y.$$.fragment,q),S=!1},d(q){q&&j(e),q&&j(u),q&&j(p),C&&C.d(),q&&j(h),O&&O.d(q),q&&j(L),q&&j(v),ae(y),q&&j(D),q&&j(T)}}}function Tl(l){let e,t=l[2].lead.username+"",n;return{c(){e=ne("@"),n=ne(t)},m(i,s){H(i,e,s),H(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&be(n,t)},d(i){i&&j(e),i&&j(n)}}}function Il(l){var g,_;let e,t,n,i,s=((_=(g=l[2])==null?void 0:g.lead)==null?void 0:_.ref_link)+"",r,o,a,f,c;return{c(){e=b("div"),t=b("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=E(),i=b("div"),r=ne(s),o=E(),a=b("div"),w(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),w(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),w(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),R(a,"height","4px")},m(d,u){H(d,e,u),m(e,t),m(e,n),m(e,i),m(i,r),H(d,o,u),H(d,a,u),f||(c=le(e,"click",l[6]),f=!0)},p(d,u){var p,h;u&4&&s!==(s=((h=(p=d[2])==null?void 0:p.lead)==null?void 0:h.ref_link)+"")&&be(r,s)},d(d){d&&j(e),d&&j(o),d&&j(a),f=!1,c()}}}function Cl(l){let e,t,n,i;return t=new nn({}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_abs loading svelte-qywc37")},m(s,r){H(s,e,r),oe(t,e,null),i=!0},i(s){i||(F(t.$$.fragment,s),s&&Ne(()=>{n||(n=De(e,Te,{},!0)),n.run(1)}),i=!0)},o(s){U(t.$$.fragment,s),s&&(n||(n=De(e,Te,{},!1)),n.run(0)),i=!1},d(s){s&&j(e),ae(t),s&&n&&n.end()}}}function Ws(l){let e,t,n,i,s=l[2]&&Ol(l),r=l[1]&&Cl();return{c(){e=b("div"),t=b("div"),s&&s.c(),n=E(),r&&r.c(),w(t,"class","flex flex_clm flex_cx flex_grow_1"),w(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,a){H(o,e,a),m(e,t),s&&s.m(t,null),m(e,n),r&&r.m(e,null),i=!0},p(o,[a]){o[2]?s?(s.p(o,a),a&4&&F(s,1)):(s=Ol(o),s.c(),F(s,1),s.m(t,null)):s&&(Le(),U(s,1,1,()=>{s=null}),Me()),o[1]?r?a&2&&F(r,1):(r=Cl(),r.c(),F(r,1),r.m(e,null)):r&&(Le(),U(r,1,1,()=>{r=null}),Me())},i(o){i||(F(s),F(r),i=!0)},o(o){U(s),U(r),i=!1},d(o){o&&j(e),s&&s.d(),r&&r.d()}}}function Ys(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;Se(l,r,c=>t(5,i=c));let{dialog_id:o=null}=e,{loading:a=!1}=e;const f=()=>{var c;return In((c=n==null?void 0:n.lead)==null?void 0:c.ref_link)};return l.$$set=c=>{"app"in c&&t(0,s=c.app),"dialog_id"in c&&t(4,o=c.dialog_id),"loading"in c&&t(1,a=c.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,a,n,r,o,i,f]}class Js extends ve{constructor(e){super(),he(this,e,Ys,Ws,de,{app:0,dialog_id:4,loading:1})}}function Al(l,e,t){const n=l.slice();return n[36]=e[t],n}function xl(l,e){let t,n,i;return n=new js({props:{app:e[0],bbox:e[9],message:e[36],render_Width:e[8]}}),{key:l,first:null,c(){t=Re(),ce(n.$$.fragment),this.first=t},m(s,r){H(s,t,r),oe(n,s,r),i=!0},p(s,r){e=s;const o={};r[0]&1&&(o.app=e[0]),r[0]&512&&(o.bbox=e[9]),r[0]&4&&(o.message=e[36]),r[0]&256&&(o.render_Width=e[8]),n.$set(o)},i(s){i||(F(n.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),i=!1},d(s){s&&j(t),ae(n,s)}}}function Vs(l){let e,t,n,i,s,r,o,a=[],f=new Map,c,g,_,d,u,p,h,L,v,y;t=new Js({props:{app:l[0],dialog_id:l[1],loading:l[3]}});let D=l[2];const T=O=>O[36].index;for(let O=0;O<D.length;O+=1){let I=Al(l,D,O),B=T(I);f.set(B,a[O]=xl(B,I))}function S(O){l[17](O)}let C={value_in:l[4]};return l[5]!==void 0&&(C.value_out=l[5]),_=new ln({props:C}),Fe.push(()=>bt(_,"value_out",S)),{c(){e=b("div"),ce(t.$$.fragment),n=E(),i=b("div"),s=b("div"),r=b("div"),o=b("div");for(let O=0;O<a.length;O+=1)a[O].c();c=E(),g=b("div"),ce(_.$$.fragment),u=E(),p=b("div"),h=b("textarea"),w(o,"class","pos_rel w100 h100"),w(g,"class","pos_abs h100 chatScroll svelte-1khz9us"),w(r,"class","pos_rel w100 h100"),w(s,"class","flex pos_abs overhide"),w(i,"class","flex flex_grow_1 pos_rel overhide"),w(h,"class","flex flex_grow_1 chat_input_textarea svelte-1khz9us"),w(p,"class","flex chat_input svelte-1khz9us"),w(e,"class","flex flex_clm flex_grow_1 overhide cnt svelte-1khz9us")},m(O,I){H(O,e,I),oe(t,e,null),m(e,n),m(e,i),m(i,s),m(s,r),m(r,o);for(let B=0;B<a.length;B+=1)a[B].m(o,null);l[16](o),m(r,c),m(r,g),oe(_,g,null),m(e,u),m(e,p),m(p,h),qt(h,l[7]),L=!0,v||(y=[le(r,"wheel",l[13],{passive:!0}),rt(St.call(null,s,l[11])),le(h,"input",l[18]),le(h,"keyup",l[12]),le(h,"keydown",l[12])],v=!0)},p(O,I){const B={};I[0]&1&&(B.app=O[0]),I[0]&2&&(B.dialog_id=O[1]),I[0]&8&&(B.loading=O[3]),t.$set(B),I[0]&773&&(D=O[2],Le(),a=$e(a,I,T,1,O,D,f,o,ot,xl,null,Al),Me());const x={};I[0]&16&&(x.value_in=O[4]),!d&&I[0]&32&&(d=!0,x.value_out=O[5],wt(()=>d=!1)),_.$set(x),I[0]&128&&qt(h,O[7])},i(O){if(!L){F(t.$$.fragment,O);for(let I=0;I<D.length;I+=1)F(a[I]);F(_.$$.fragment,O),L=!0}},o(O){U(t.$$.fragment,O);for(let I=0;I<a.length;I+=1)U(a[I]);U(_.$$.fragment,O),L=!1},d(O){O&&j(e),ae(t);for(let I=0;I<a.length;I+=1)a[I].d();l[16](null),ae(_),v=!1,He(y)}}}const El=10,dt=4;function Xs(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;Se(l,o,A=>t(15,i=A));let{dialog_id:a=null}=e,f=[],c=[],g=new Set,_=0,d=0,u=1,p=1,h=null;const L=Ge(null);Se(l,L,A=>t(9,s=A)),new Date().toJSON();let v=-1;async function y(A,ue=0,me=20){const we=await r.api.message_GetList({dialog_id:A,offset:ue,limit:me});if(!!we&&n&&n.id===A){for(_=we.count;f.length<_;){const P=f.length;f.push({id:v--,index:P,_isFakeMsg:!0})}const z=we.results.map(P=>{var Y;return(Y=P==null?void 0:P.attachments)!=null&&Y.length&&P.attachments.map(ge=>{var ye,Oe,ke,_e,xe,M,k,N;if((Oe=(ye=r==null?void 0:r.appConfig)==null?void 0:ye.api)!=null&&Oe.attachments_OverwriteApiHostProtocol)try{const W=new URL(ge.url);W.protocol=(xe=(_e=(ke=r==null?void 0:r.appConfig)==null?void 0:ke.api)==null?void 0:_e.protocol)!=null?xe:location.protocol,W.host=(N=(k=(M=r==null?void 0:r.appConfig)==null?void 0:M.api)==null?void 0:k.host)!=null?N:location.host,ge.url=String(W)}catch{}}),P});z.map((P,Y)=>P.index=ue+Y),z.map(P=>f[P.index]=P)}}let D="";const T=async A=>{if(A.which===13&&!A.shiftKey&&!A.ctrlKey&&(A.preventDefault(),t(7,D=D.trim()),D)){const ue=D;t(7,D=""),n&&await r.api.message_Create(n.id,ue)}};function S(){f=[],t(2,c=[]),g=new Set,_=0,console.log("clear all")}let C=null,O=null;async function I(A){if(!A){if(!C)return;C=null,S();return}O!==A.id&&(C=A,O=A.id,S(),f=[],t(2,c=[]),_=0,t(3,d++,d),await y(A.id),_&&await y(A.id,Math.max(_-20,0),20),await r.api.dialog_SetReadFlagAllMessages(A.id),t(3,d--,d))}let B=1,x=!0;function V(){if(x&&requestAnimationFrame(V),!s||!h||!f.length)return;s.width;const A=s.height,ue=s.width-El*2,me=El;t(8,B=ue-Math.max(120,Math.floor(ue*.1)));const we=1+p*(f.length-1);let z=Math.floor(we),P=we-z;z>=f.length&&(z=f.length-1,P=1);const Y=[],ge=[];let ye=null;t(2,c=[]);for(let ke=z-100,_e=0,xe=!0;ke<z+100;ke++)ke<0||ke>=f.length||(f[ke]._isFakeMsg&&g.add(ke),c[_e]!==f[ke]&&(xe&&(xe=!1,c.splice(_e,1e9)),t(2,c[_e]=f[ke],c),t(2,c)),t(2,c[_e]._drawIndex=_e,c),ke<z&&Y.push(c[_e]),ke>z&&ge.push(c[_e]),ke===z&&(ye=c[_e]),_e++);const Oe=[...h.children];if(Oe.length===c.length){Oe.map((k,N)=>{const W=c[N];if(!W||k._remove)return;const $=k.getBoundingClientRect();k._bbox=$;const te=Math.floor(me+(W.incoming?0:Math.max(100,s.width*.05)));k.__cacheWidth!==B&&(k.__cacheWidth=B,k.style.maxWidth=B+"px"),k.__cacheLeft!==te&&(k.__cacheLeft=te,k.style.left=te+"px")});const ke=(k,N,W=1)=>(k.__cacheTop!==N&&(k.__cacheTop=N,k.style.transform=`translate3d(0px, ${N}px, 0px)`),N+(k._bbox.height+dt)*W);let _e=0,xe=0;const M=Oe[ye._drawIndex];if(M){const k=M;_e=A+dt-(k._bbox.height+dt)*P,xe=_e,_e=ke(k,_e,1)}ge.map((k,N)=>{const W=Oe[k._drawIndex];_e=ke(W,_e,1)}),_e=xe,Y.reverse().map((k,N)=>{const W=Oe[k._drawIndex];_e-=W._bbox.height+dt,ke(W,_e,0)})}}requestAnimationFrame(V),je(()=>x=!1);async function G(){if(g.size){const A=[...g].sort((we,z)=>we-z);g.clear();const ue=[];let me={offset:null,limit:0};for(const we of A){if(me.offset!==null){if(me.limit<=500&&me.offset+me.limit===we){me.limit++;continue}ue.push(me)}me={offset:we,limit:1}}me.offset!==null&&ue.push(me),n&&(t(3,d++,d),await Promise.all(ue.map(we=>y(n.id,we.offset,we.limit))),t(3,d--,d))}x&&setTimeout(G,500)}G();async function Z(){n&&await r.api.dialog_SetReadFlagAllMessages(n.id),x&&setTimeout(Z,5e3)}Z();async function K(){n&&await y(n.id,_,20),x&&setTimeout(K,500)}K();const Q=A=>{t(4,u=f.length?p+Math.sign(A.deltaY)/(f.length-1):0)};function J(A){Fe[A?"unshift":"push"](()=>{h=A,t(6,h)})}function ie(A){p=A,t(5,p)}function q(){D=this.value,t(7,D)}return l.$$set=A=>{"app"in A&&t(0,r=A.app),"dialog_id"in A&&t(1,a=A.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&32770&&t(14,n=i[a]),l.$$.dirty[0]&16384&&I(n)},[r,a,c,d,u,p,h,D,B,s,o,L,T,Q,n,i,J,ie,q]}class Ks extends ve{constructor(e){super(),he(this,e,Xs,Vs,de,{app:0,dialog_id:1},null,[-1,-1])}}function Zs(l){let e,t,n,i,s,r,o,a,f,c,g,_,d,u,p,h,L,v,y,D,T;function S(B){l[5](B)}let C={};l[2]!==void 0&&(C.checked=l[2]),c=new ws({props:C}),Fe.push(()=>bt(c,"checked",S));function O(B){l[6](B)}let I={app:l[0]};return l[1]!==void 0&&(I.filterStatus=l[1]),d=new As({props:I}),Fe.push(()=>bt(d,"filterStatus",O)),v=new Ts({props:{app:l[0],filter:{filterTag:jl,filterStatus:l[1],filterUnreadFirst:l[2]}}}),D=new Ks({props:{app:l[0],dialog_id:l[3]}}),{c(){e=b("div"),t=b("div"),n=b("div"),i=E(),s=b("div"),r=b("label"),o=ne(`First unread \r
				`),a=b("div"),f=E(),ce(c.$$.fragment),_=E(),ce(d.$$.fragment),p=E(),h=b("div"),L=E(),ce(v.$$.fragment),y=E(),ce(D.$$.fragment),R(n,"height","2px"),R(a,"width","4px"),w(r,"class","flex flex_cy cursor_ptr unselect firstUnread svelte-14xikx8"),w(s,"class","flex flex_clm flex_cx header pos_rel svelte-14xikx8"),R(h,"min-height","20px"),w(t,"class","flex flex_clm list svelte-14xikx8"),w(e,"class","flex flex_grow_1")},m(B,x){H(B,e,x),m(e,t),m(t,n),m(t,i),m(t,s),m(s,r),m(r,o),m(r,a),m(r,f),oe(c,r,null),m(s,_),oe(d,s,null),m(t,p),m(t,h),m(t,L),oe(v,t,null),m(e,y),oe(D,e,null),T=!0},p(B,[x]){const V={};!g&&x&4&&(g=!0,V.checked=B[2],wt(()=>g=!1)),c.$set(V);const G={};x&1&&(G.app=B[0]),!u&&x&2&&(u=!0,G.filterStatus=B[1],wt(()=>u=!1)),d.$set(G);const Z={};x&1&&(Z.app=B[0]),x&6&&(Z.filter={filterTag:jl,filterStatus:B[1],filterUnreadFirst:B[2]}),v.$set(Z);const K={};x&1&&(K.app=B[0]),x&8&&(K.dialog_id=B[3]),D.$set(K)},i(B){T||(F(c.$$.fragment,B),F(d.$$.fragment,B),F(v.$$.fragment,B),F(D.$$.fragment,B),T=!0)},o(B){U(c.$$.fragment,B),U(d.$$.fragment,B),U(v.$$.fragment,B),U(D.$$.fragment,B),T=!1},d(B){B&&j(e),ae(c),ae(d),ae(v),ae(D)}}}let jl=null;function Qs(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;Se(l,s,c=>t(3,n=c));let r=null,o=1;function a(c){o=c,t(2,o)}function f(c){r=c,t(1,r)}return l.$$set=c=>{"app"in c&&t(0,i=c.app)},[i,r,o,n,s,a,f]}class $s extends ve{constructor(e){super(),he(this,e,Qs,Zs,de,{app:0})}}function ei(l){let e,t,n,i,s,r,o,a,f,c,g,_,d,u,p,h;return{c(){e=b("div"),t=b("div"),n=b("div"),i=b("img"),r=E(),o=b("div"),a=b("div"),a.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/rotate.png"/>',f=E(),c=b("div"),c.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/download.png"/>',g=E(),_=b("div"),_.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/close.png"/>',w(i,"class","img svelte-d45see"),w(i,"draggable","false"),Xe(i.src,s=l[0])||w(i,"src",s),R(i,"transform","rotate("+l[3]+"deg)"),w(n,"class","pos_abs flex flex_cx flex_cy pad svelte-d45see"),R(n,"width",l[5]+"px"),R(n,"height",l[4]+"px"),w(t,"class","pos_abs flex flex_cx flex_cy pos_abs w100 h100 "),R(t,"transform","translate("+l[1]+"px, "+l[2]+"px)"),w(a,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(c,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(_,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),w(o,"class","flex pos_abs imgCtrlBtnGroup svelte-d45see"),w(e,"class","pos_abs w100 h100 unselect cnt layer_bg svelte-d45see")},m(L,v){H(L,e,v),m(e,t),m(t,n),m(n,i),m(e,r),m(e,o),m(o,a),m(o,f),m(o,c),m(o,g),m(o,_),u=!0,p||(h=[le(window,"mousemove",l[14]),le(window,"mouseup",l[13]),le(window,"blur",l[13]),le(window,"keydown",l[16]),le(i,"mousedown",l[12]),rt(St.call(null,t,l[6])),le(a,"click",l[10]),le(c,"click",function(){Ye(Ct(l[0]))&&Ct(l[0]).apply(this,arguments)}),le(_,"click",l[15]),le(e,"wheel",l[11])],p=!0)},p(L,[v]){l=L,(!u||v&1&&!Xe(i.src,s=l[0]))&&w(i,"src",s),(!u||v&8)&&R(i,"transform","rotate("+l[3]+"deg)"),(!u||v&32)&&R(n,"width",l[5]+"px"),(!u||v&16)&&R(n,"height",l[4]+"px"),(!u||v&6)&&R(t,"transform","translate("+l[1]+"px, "+l[2]+"px)")},i(L){u||(Ne(()=>{d||(d=De(e,Te,{duration:100},!0)),d.run(1)}),u=!0)},o(L){d||(d=De(e,Te,{duration:100},!1)),d.run(0),u=!1},d(L){L&&j(e),L&&d&&d.end(),p=!1,He(h)}}}function ti(l,e,t){let n,i,s,r,{url:o=null}=e;const a=Yl(),f=Ge(null);Se(l,f,I=>t(18,n=I));const c=Ve(0);Se(l,c,I=>t(3,i=I));const g=Ve(0);Se(l,g,I=>t(5,r=I));const _=Ve(0);Se(l,_,I=>t(4,s=I));let d=0,u=0,p={rotate:0,scale:1,whInverse:!1};const h=()=>{if(!n||!p)return;const I=p.whInverse?n.height:n.width,B=p.whInverse?n.width:n.height;Je(g,r=I*p.scale,r),Je(_,s=B*p.scale,s),Je(c,i=p.rotate,i)},L=()=>{!n||!p||(t(17,p.rotate+=90,p),t(17,p.whInverse=!p.whInverse,p),t(17,p))},v=I=>{t(17,p.scale=Ee(.1,p.scale+Math.sign(I.deltaY)*.1,10),p)};let y=null;const D=I=>y=[I.clientX,I.clientY,d,u],T=I=>y=null,S=I=>{!y||t(1,[d,u]=[I.clientX,I.clientY].map((B,x)=>B-y[x]+y[x+2]),d,t(2,u))},C=I=>a("close"),O=I=>I.which===27&&C();return l.$$set=I=>{"url"in I&&t(0,o=I.url)},l.$$.update=()=>{l.$$.dirty&393216&&h()},[o,d,u,i,s,r,f,c,g,_,L,v,D,T,S,C,O,p,n]}class li extends ve{constructor(e){super(),he(this,e,ti,ei,de,{url:0})}}function Nl(l){let e=l[0],t,n,i=Hl(l);return{c(){i.c(),t=Re()},m(s,r){i.m(s,r),H(s,t,r),n=!0},p(s,r){r&1&&de(e,e=s[0])?(Le(),U(i,1,1,se),Me(),i=Hl(s),i.c(),F(i,1),i.m(t.parentNode,t)):i.p(s,r)},i(s){n||(F(i),n=!0)},o(s){U(i),n=!1},d(s){s&&j(t),i.d(s)}}}function Hl(l){let e,t;return e=new li({props:{url:l[1]}}),e.$on("close",l[3]),{c(){ce(e.$$.fragment)},m(n,i){oe(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.url=n[1]),e.$set(s)},i(n){t||(F(e.$$.fragment,n),t=!0)},o(n){U(e.$$.fragment,n),t=!1},d(n){ae(e,n)}}}function ni(l){let e,t,n=l[1]&&Nl(l);return{c(){n&&n.c(),e=Re()},m(i,s){n&&n.m(i,s),H(i,e,s),t=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&F(n,1)):(n=Nl(i),n.c(),F(n,1),n.m(e.parentNode,e)):n&&(Le(),U(n,1,1,()=>{n=null}),Me())},i(i){t||(F(n),t=!0)},o(i){U(n),t=!1},d(i){n&&n.d(i),i&&j(e)}}}function si(l,e,t){let n=1,i=null,{events:s}=e;je(s.on("openOverlayImageView",o=>{t(0,n++,n),t(1,i=o)}));const r=()=>t(1,i=null);return l.$$set=o=>{"events"in o&&t(2,s=o.events)},[n,i,s,r]}class ii extends ve{constructor(e){super(),he(this,e,si,ni,de,{events:2})}}function ri(l){let e,t,n,i,s,r,o,a,f,c,g,_=oi;return i=new cs({props:{app:l[0]}}),r=new ps({props:{app:l[0]}}),a=new $s({props:{app:l[0]}}),c=new ii({props:{events:l[0].events}}),{c(){e=b("div"),t=E(),n=b("div"),ce(i.$$.fragment),s=E(),ce(r.$$.fragment),o=E(),ce(a.$$.fragment),f=E(),ce(c.$$.fragment),w(n,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),w(e,"class","flex w100 h100 pos_rel")},m(d,u){H(d,e,u),m(e,t),m(e,n),oe(i,n,null),m(n,s),oe(r,n,null),m(e,o),oe(a,e,null),m(e,f),oe(c,e,null),g=!0},p(d,[u]){},i(d){g||(F(_),F(i.$$.fragment,d),F(r.$$.fragment,d),F(a.$$.fragment,d),F(c.$$.fragment,d),g=!0)},o(d){U(_),U(i.$$.fragment,d),U(r.$$.fragment,d),U(a.$$.fragment,d),U(c.$$.fragment,d),g=!1},d(d){d&&j(e),ae(i),ae(r),ae(a),ae(c)}}}const oi=!1;function ai(l,e,t){let{operatorSelf:n}=e,{config:i}=e,{notifyEvents:s}=e,{moduleMgr:r}=e,{createApi:o}=e;const a=o(n.username),f=Nn(n,i,a,r);return je(f.destroy),l.$$set=c=>{"operatorSelf"in c&&t(1,n=c.operatorSelf),"config"in c&&t(2,i=c.config),"notifyEvents"in c&&t(3,s=c.notifyEvents),"moduleMgr"in c&&t(4,r=c.moduleMgr),"createApi"in c&&t(5,o=c.createApi)},[f,n,i,s,r,o]}class fi extends ve{constructor(e){super(),he(this,e,ai,ri,de,{operatorSelf:1,config:2,notifyEvents:3,moduleMgr:4,createApi:5})}}function Fl(l,e,t){const n=l.slice();return n[6]=e[t],n}function ci(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=Pl(Fl(l,n,r));const s=r=>U(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Re()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);H(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let a;for(a=0;a<n.length;a+=1){const f=Fl(r,n,a);i[a]?(i[a].p(f,o),F(i[a],1)):(i[a]=Pl(f),i[a].c(),F(i[a],1),i[a].m(e.parentNode,e))}for(Le(),a=n.length;a<i.length;a+=1)s(a);Me()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)F(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)U(i[o]);t=!1},d(r){Nt(i,r),r&&j(e)}}}function ui(l){let e,t,n,i,s;return i=new nn({}),{c(){e=b("div"),t=b("div"),n=E(),ce(i.$$.fragment),R(t,"height","20px"),w(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){H(r,e,o),m(e,t),m(e,n),oe(i,e,null),s=!0},p:se,i(r){s||(F(i.$$.fragment,r),s=!0)},o(r){U(i.$$.fragment,r),s=!1},d(r){r&&j(e),ae(i)}}}function Bl(l){let e,t,n=l[6].username+"",i;return{c(){e=b("div"),t=ne("@"),i=ne(n),w(e,"class","nowrap textOverEllipsis")},m(s,r){H(s,e,r),m(e,t),m(e,i)},p(s,r){r&1&&n!==(n=s[6].username+"")&&be(i,n)},d(s){s&&j(e)}}}function Pl(l){var y,D;let e,t,n,i=((y=l[6].first_name)!=null?y:"")+"",s,r,o,a,f,c=((D=l[6].last_name)!=null?D:"")+"",g,_,d,u,p,h,L,v=l[6].username&&Bl(l);return{c(){e=b("div"),t=b("div"),n=b("div"),s=ne(i),r=E(),o=b("div"),a=E(),f=b("div"),g=ne(c),_=E(),v&&v.c(),d=E(),R(o,"width","8px"),w(t,"class","flex nowrap textOverEllipsis"),w(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(T,S){H(T,e,S),m(e,t),m(t,n),m(n,s),m(t,r),m(t,o),m(t,a),m(t,f),m(f,g),m(e,_),v&&v.m(e,null),m(e,d),p=!0,h||(L=le(e,"click",function(){Ye(l[2](l[6]))&&l[2](l[6]).apply(this,arguments)}),h=!0)},p(T,S){var C,O;l=T,(!p||S&1)&&i!==(i=((C=l[6].first_name)!=null?C:"")+"")&&be(s,i),(!p||S&1)&&c!==(c=((O=l[6].last_name)!=null?O:"")+"")&&be(g,c),l[6].username?v?v.p(l,S):(v=Bl(l),v.c(),v.m(e,d)):v&&(v.d(1),v=null)},i(T){p||(T&&Ne(()=>{u||(u=De(e,Te,{},!0)),u.run(1)}),p=!0)},o(T){T&&(u||(u=De(e,Te,{},!1)),u.run(0)),p=!1},d(T){T&&j(e),v&&v.d(),T&&u&&u.end(),h=!1,L()}}}function di(l){let e,t,n,i;const s=[ui,ci],r=[];function o(a,f){return a[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=b("div"),n.c(),w(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){H(a,e,f),r[t].m(e,null),i=!0},p(a,[f]){let c=t;t=o(a),t===c?r[t].p(a,f):(Le(),U(r[c],1,1,()=>{r[c]=null}),Me(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),F(n,1),n.m(e,null))},i(a){i||(F(n),i=!0)},o(a){U(n),i=!1},d(a){a&&j(e),r[t].d()}}}function _i(l,e,t){let{api:n}=e,i=[],s=!1;const r=async()=>{var f,c;t(1,s=!0),t(0,i=(c=(f=await n.operator_GetList())==null?void 0:f.results)!=null?c:[]),t(1,s=!1)};let o=!1;const a=f=>c=>{o||($l(f),o=!0)};return r(),l.$$set=f=>{"api"in f&&t(3,n=f.api)},[i,s,a,n]}class mi extends ve{constructor(e){super(),he(this,e,_i,di,de,{api:3})}}const gi=l=>typeof l=="number"&&String(l|0)===String(l);class sn extends Error{}const Ue=async(l,e=null)=>{try{return await l()}catch{}return e},Pt=l=>async e=>{if(await Ue(()=>e.response.status===l))return e;throw new Error(`Invalid response status, expected ${l}`)},pi=Pt(200),hi=Pt(201),vi=Pt(204),wi=async l=>{if(await Ue(()=>gi(l.result.count)&&Array.isArray(l.result.results)))return l;throw new Error("Invalid result, expected list container")},_t=async l=>{if(await Ue(()=>l.result.detail==="Authentication credentials were not provided.")===!0)throw new sn("Not authorized");return l},mt=async l=>({...l,result:l.response.status===204?null:await l.response.json()}),bi=(l,e)=>{var a,f,c;const t=(a=l==null?void 0:l.protocol)!=null?a:location.protocol,n=(f=l==null?void 0:l.host)!=null?f:location.host,i=(c=l==null?void 0:l.path_base)!=null?c:"/",s=`${t}//${n}/${i}`,r=new Set(["POST","PATCH","PUT"]),o={...e!=null?e:{},"content-type":"application/json"};return(g,_,d)=>{const u=g.toUpperCase().trim(),p=_!=null?_:"",h=d!=null?d:{},L=new URL(s);u==="GET"&&Object.entries(h).map(([y,D])=>L.searchParams.append(y,D)),L.pathname=[L.pathname,p].join("/").split("/").filter(Boolean).concat(" ").filter(Boolean).join("/").trim();const v=r.has(u)?JSON.stringify(h):null;return new Request(L,{method:u,headers:o,body:v})}},yi=(l,e,t)=>{var p,h,L;const n=bi(l,e.operator?{"x-username":e.operator}:{}),i=(p=e.onerror)!=null?p:st,s=(h=e.onnotify)!=null?h:st,r=(L=e.onNotAuthorizedError)!=null?L:st,o=t!=null?t:(v,y)=>y(),a=async([v,y,D],T)=>{let S=null,C=null,O={},I=null,B=!1;try{O.request=S=n(v,y,D),O.response=C=await o({request:S,method:v,path:y,options:D},()=>fetch(S));for(const V of T)O=await V(O)}catch(V){I=V,B=!0}await Ue(()=>{I instanceof sn&&r()});const x=[];return x.push(...await Ue(async()=>{const V=new URL(S.url);return[{type:"normal",chunks:[{color:"#fff",text:S.method},{color:"#000",text:`${V.pathname}${String(V.searchParams)?"?"+V.searchParams:""}`},{color:"#f00",text:await Ue(()=>C.status,"")}]},{type:"mini",text:`${V.protocol}//${V.host}`}]},[`${v} ${y}`])),x.push(await Ue(()=>S.body?"Body: "+JSON.stringify(D).slice(0,100):"")),x.push(await Ue(()=>O.result.detail?`Detail: ${O.result.detail}`:"")),x.push(xn(I)),B?i(x):s(x),!B&&O.hasOwnProperty("result")?O.result:null},f=[mt,_t],c=[mt,_t,hi],g=[mt,_t,pi],_=[mt,_t,vi],d=[...g,wi],u={};return u.message_GetList=v=>a(["GET","messages",v],d),u.message_Create=(v,y)=>a(["POST","messages",{dialog:v,text:y,is_read:!0}],c),u.dialog_GetList=v=>a(["GET","dialogs",v],d),u.dialog_SetTags=(v,y)=>a(["PATCH",`dialogs/${v}`,{tag:y}],g),u.dialog_SetReadFlagAllMessages=v=>a(["POST",`dialogs/${v}/read`,{}],_),u.lead_GetUnassignedList=v=>a(["GET","leads/unassigned",v],d),u.lead_AssignOperatorSelft=v=>a(["POST",`leads/${v}/assign`,{}],g),u.lead_SetStatus=(v,y)=>a(["PATCH",`leads/${v}`,{status:y}],g),u.lead_GetUnassignedLeadCount=()=>a(["GET","leads/count_free",{}],g),u.lead_AssignOneLead=()=>a(["POST","leads/get_one",{}],[...f,async v=>await Ue(()=>{var y;return v.result=(y={200:!0,400:!1}[v.response.status])!=null?y:null,v})]),u.operatorSelf_GetOnlineInfo=()=>a(["GET","online",{}],g),u.operatorSelf_SetOnlineFlag=v=>a(["PUT","online",{online:!!v}],g),u.operator_GetList=v=>a(["GET","operators",v],d),u},ki=()=>{const l=()=>!0,e=M=>new Promise(k=>setTimeout(k,M)),t=(M,k)=>e(M+Math.round(Math.random()*(k-M))),n=(M,k,N)=>Math.min(N,Math.max(M,k)),i=(M=0)=>new Date(Date.now()+(M!=null?M:0)).toJSON(),s=(M,k)=>{var ee;const N=Math.max(0,(k==null?void 0:k.offset)|0),W=n(1,((ee=k==null?void 0:k.limit)!=null?ee:20)|0,1e6),$=M.length,te=M.slice(N,N+W);return{count:$,results:te}};let r=1;const o=M=>(M!=null?M:[]).map(k=>({...k,id:r++}));let a=1;const f=[],c={},g=M=>{var k;return(k=c[M])!=null?k:null},_=()=>f,d=M=>{var N,W,$;const k={operator_id:a++,username:(N=M.username)!=null?N:null,first_name:(W=M.first_name)!=null?W:null,last_name:($=M.last_name)!=null?$:null};return f.push(k),c[k.username]=k,P(k.username),k};let u=123123124;const p=[],h={},L=M=>{var k;return(k=h[M])!=null?k:null},v=()=>p.filter(M=>!M.hasOperator).sort((M,k)=>M._date_joined_msec-k._date_joined_msec),y=()=>({count:p.filter(M=>!M.hasOperator).length}),D=M=>{var W,$,te;const k=u++,N={tg_id:k,username:(W=M.username)!=null?W:null,first_name:($=M.first_name)!=null?$:null,last_name:(te=M.last_name)!=null?te:null,date_joined:i(M.timeDelta),esub:null,pub_id:null,refcode:null,subpub:null,hasOperator:!1,status:"NW",is_fail:!1,ref_link:`https://ref.global.com/getRef?tg_id=${k}`};return N._date_joined_msec=+new Date(N.date_joined),p.push(N),h[N.tg_id]=N,N},T=(M,k)=>{const N=L(k);return!N||!g(M)||N.hasOperator?!1:(G(M,k),N.hasOperator=!0,!0)},S=M=>{const k=v();let N=!1;return k.length&&(N=T(M,k[0].tg_id)),N?{status:"lead connected",__status:200}:{status:"error: there is no free leads",__status:400}},C=(M,k,N)=>{const W=L(k);return W?(N.status&&(N.status==="FL"?W.is_fail=!0:W.status=N.status),W):null};let O=1;const I=[],B={},x=M=>{var k;return(k=B[M])!=null?k:null},V=(M,k=[])=>{M.tag||(M.tag=[],M._tagSearch=new Set);const N=o(k);M.tag.splice(0,1e9),M._tagSearch.clear(),N.map(W=>{M.tag.push(W),M._tagSearch.add(W.title)})},G=(M,k)=>{const N=L(k);if(!N||!g(M))return null;const $={id:O++,lead_id:k,lead:N,operator:M,unread_messages_count:0,last_message:null};return V($),I.push($),B[$.id]=$,N.hasOperator=!0,$},Z=(M,k,N)=>{const W=x(k);return W?(N.tag&&V(W,N.tag),W):null},K=(M,k,N)=>{const W=x(k);return W?(ue(M,{dialog_id:+k}).map(te=>te.is_read=!1),W.unread_messages_count=0,!0):null},Q=(M,k={})=>{const N=re=>re.last_message?re.last_message._received_at_msec:re.lead?re.lead._date_joined_msec:0,W=(re,Ie)=>Ie-re,$=(re,Ie)=>{let Ce=W(N(re),N(Ie));return Ce===0&&(Ce=W(re.id,Ie.id)),Ce},te=k.status?new Set(k.status.split(",")):null,ee=I.filter(re=>re.operator===M).filter(k.tag?re=>re._tagSearch.has(k.tag):l).filter(te?re=>te.has(re.lead.status):l).filter(re=>{var Ie;return((Ie=re==null?void 0:re.lead)==null?void 0:Ie.status)!=="DL"});let fe=[],pe=[];return k.unread_first?(fe=ee.filter(re=>re.unread_messages_count!==0),pe=ee.filter(re=>re.unread_messages_count===0)):fe=ee,fe.sort($),pe.sort($),fe.concat(pe)};let J=1;const ie=[],q={},A=(M,k={})=>{var ee,fe,pe;const N=+k.dialog,W=k.text,$=x(N);if(!$)return null;const te={id:J++,dialog:N,text:W,is_read:(ee=k.is_read)!=null?ee:!0,incoming:(fe=k.incoming)!=null?fe:!1,attachments:(pe=k.attachments)!=null?pe:[],received_at:i(k.timeDelta)};return te._received_at_msec=+new Date(te.received_at),ie.push(te),q[te.id]=te,$.last_message=te,te.is_read||$.unread_messages_count++,te},ue=(M,k={})=>ie.filter(k.dialog_id?N=>N.dialog===k.dialog_id:l),me=5*60*1e3,we={},z=M=>{var k;return(k=we[M])!=null?k:null},P=(M,k={})=>{const W={online:!!k.online,offline_at:i(me),interval:Math.round(me/1e3)};return we[M]=W,W},Y=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.webp","9.webp","10.png","11.png","13.png","12.webp"],ge=`\u0414\u0430, \u043C\u0451\u0440\u0442\u0432.
\u0411\u0435\u0434\u0441\u0442\u0432\u0438\u0435, \u0443\u0433\u0440\u043E\u0436\u0430\u044E\u0449\u0435\u0435 \u0436\u0438\u0437\u043D\u0438 \u0434\u0435\u0432\u0443\u0448\u043A\u0438, \u0438\u0441\u0447\u0435\u0437\u043B\u043E, \u0441\u043B\u043E\u0432\u043D\u043E \u044D\u0442\u043E \u0431\u044B\u043B\u0430 \u043A\u0430\u043A\u0430\u044F-\u0442\u043E \u0448\u0443\u0442\u043A\u0430. \u041D\u043E \u043E\u043D\u0430 \u043D\u0435 \u043C\u043E\u0433\u043B\u0430 \u0440\u0430\u0434\u043E\u0432\u0430\u0442\u044C\u0441\u044F, \u0432\u0435\u0434\u044C \u0421\u043C\u0435\u0440\u0442\u044C \u0441\u043C\u0435\u043D\u0438\u043B\u0430 \u0441\u0432\u043E\u044E \u0444\u043E\u0440\u043C\u0443 \u0438 \u043F\u0440\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432 \u0431\u043E\u043B\u0435\u0435 \u044F\u0432\u043D\u043E\u043C \u0432\u0438\u0434\u0435.
\u041F\u043E\u0434 \u0432\u0437\u0433\u043B\u044F\u0434\u043E\u043C \u043D\u0430\u043F\u0443\u0433\u0430\u043D\u043D\u043E\u0439 \u0434\u0435\u0432\u0443\u0448\u043A\u0438 \u0421\u043C\u0435\u0440\u0442\u044C \u0434\u0432\u0438\u043D\u0443\u043B\u0430\u0441\u044C \u0432 \u0435\u0451 \u0441\u0442\u043E\u0440\u043E\u043D\u0443. \u0422\u044C\u043C\u0430 \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439 \u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0433\u0443\u0449\u0430\u0442\u044C\u0441\u044F.
\u0422\u044C\u043C\u0430... \u043E\u043D\u0430 \u0441\u0435\u0439\u0447\u0430\u0441 \u043C\u0435\u043D\u044F \u043F\u0440\u043E\u0433\u043B\u043E\u0442\u0438\u0442, \u2014 \u043F\u043E\u0434\u0443\u043C\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430 \u0438 \u0435\u0449\u0451 \u043A\u0440\u0435\u043F\u0447\u0435 \u043E\u0431\u043D\u044F\u043B\u0430 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443. \u041E\u043D\u0430 \u0443\u0436\u0435 \u0434\u0430\u0436\u0435 \u0438 \u043D\u0435 \u0434\u0443\u043C\u0430\u043B\u0430 \u0431\u0435\u0436\u0430\u0442\u044C. \u0411\u0443\u0434\u044C \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u043E\u043C, \u043E\u043D\u0430 \u0431\u044B \u0435\u0449\u0435 \u043C\u043E\u0433\u043B\u0430 \u043D\u0430 \u0447\u0442\u043E-\u0442\u043E \u043D\u0430\u0434\u0435\u044F\u0442\u044C\u0441\u044F. \u041D\u043E \u043D\u0435\u0447\u0442\u043E, \u0432\u043E\u0437\u0432\u044B\u0448\u0430\u044E\u0449\u0435\u0435\u0441\u044F \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439, \u0441 \u043B\u0435\u0433\u043A\u043E\u0441\u0442\u044C\u044E \u0440\u0430\u0437\u0432\u0435\u044F\u043B\u043E \u0442\u0430\u043A\u0438\u0435 \u043C\u044B\u0441\u043B\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0445\u043E\u0442\u044F \u0431\u044B \u0434\u0430\u0440\u0443\u0439 \u043C\u043D\u0435 \u0431\u0435\u0437\u0431\u043E\u043B\u0435\u0437\u043D\u0435\u043D\u043D\u0443\u044E \u0441\u043C\u0435\u0440\u0442\u044C.
\u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u043C\u043E\u043B\u0438\u0442\u044C\u0441\u044F.
\u041C\u0430\u043B\u044B\u0448\u043A\u0430 \u0443\u0446\u0435\u043F\u0438\u043B\u0430\u0441\u044C \u0437\u0430 \u0435\u0451 \u0442\u0430\u043B\u0438\u044E, \u0434\u0440\u043E\u0436\u0430 \u043E\u0442 \u0443\u0436\u0430\u0441\u0430. \u0421\u043F\u0430\u0441\u0442\u0438 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443... \u043D\u043E \u044D\u0442\u043E \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E. \u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u0438\u0437\u0432\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u0437\u0430 \u0441\u0432\u043E\u0451 \u0431\u0435\u0441\u0441\u0438\u043B\u0438\u0435. \u0421\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0430, \u0442\u044B \u043D\u0435 \u0431\u0443\u0434\u0435\u0448\u044C \u043E\u0434\u0438\u043D\u043E\u043A\u0430, \u044F \u043F\u043E\u0439\u0434\u0443 \u0441 \u0442\u043E\u0431\u043E\u0439.
\u0418 \u0442\u043E\u0433\u0434\u0430...`;let ye=1;const Oe=(M=null,k=null)=>(M=M!=null?M:Math.random()*Y.length|0,k=k!=null?k:k=["IM","DC"][Math.random()*2|0],{file:ye++,file_type:k,url:`assets/img-test/${Y[M]}`});(async()=>{const M=($,te)=>{const ee=te/$;let fe=-(te+ee);return()=>(fe+=ee,fe)};let k=1;const N=($=0)=>{let te=Math.random()<.5,ee=Math.random()<.5,fe=Math.random()<.5;!te&&!ee&&!fe&&(te=!0),te=ee=fe=!0;const pe=(k++).toString(36);return D({username:te?`test_lead_${pe}`:null,first_name:ee?`F${pe}`:null,last_name:fe?`L${pe}`:null,timeDelta:$})},W=($,te,ee=0)=>{A($,{dialog:te,text:`\u041F\u0440\u0438\u0432\u0435\u0442 @${$}. \u042F \u043D\u043E\u0432\u044B\u0439 \u043B\u0438\u0434, \u0432\u043E\u0442.`,is_read:!1,incoming:!0,timeDelta:ee});for(let fe=0;fe<Math.round(Math.random()*Y.length);fe++){const pe=Oe(fe);A($,{dialog:te,text:`${pe.file_type==="IM"?"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430":"\u0424\u0430\u0439\u043B"} ${fe+1}.`,is_read:!1,incoming:!0,attachments:[pe],timeDelta:ee+fe*1e3})}};for(let $=0;$<10;$++){const ee=[10,100,1e3,5e3,7e3,1e4,1e4,1e5,2,3,5,7,8,10][$],fe=`op_test_${$}`;d({username:fe,first_name:"OpNumDlgs",last_name:ee+""});let pe=0;const re=M(ee,6e4*ee);for(let Ie=0;Ie<ee;Ie++){const Ce=re(),ze=N(Ce),Pe=G(fe,ze.tg_id);Math.random()<.5&&pe++<5&&W(fe,Pe.id,Ce)}}for(;;)await t(1e3,1e4),N()})();const _e=(M,k,N)=>{const W=ee=>{ee&&P(N)},$=async ee=>{await t(1e3,1e4);const fe=k.text.match(/without_text/i),pe=k.text.match(/long_text/i),re=k.text.match(/allimg|allfile/i),Ie=fe?"":pe?ge:`\u042D\u0445\u043E \u043E\u0442\u0432\u0435\u0442 \u0434\u043B\u044F @${N}.
"${k.text}"`;if(re){const ze=k.text.match(/allimg/i)?"IM":"DC";for(let Pe=0;Pe<Y.length;Pe++)A(N,{dialog:k.dialog,text:Ie,is_read:!1,incoming:!0,attachments:[Oe(Pe,ze)]});return}const Ce=[];k.text.match(/img/i)?Ce.push(Oe(null,"IM")):k.text.match(/file/i)&&Ce.push(Oe(null,"DC")),A(N,{dialog:k.dialog,text:Ie,is_read:!1,incoming:!0,attachments:Ce})},te=ee=>{var fe;return(fe=ee==null?void 0:ee.__status)!=null?fe:200};M("GET","operators",200,()=>s(_(),k)),M("GET","online",200,()=>z(N)),M("PUT","online",200,()=>P(N,k)),M("GET","leads/unassigned",200,()=>s(v(),k)),M("GET","leads/count_free",200,()=>y()),M("POST","leads/get_one",te,()=>S(N)),M("POST",/^leads\/(\d+)\/assign$/,200,ee=>T(N,ee),[W]),M("PATCH",/^leads\/(\d+)$/,200,ee=>C(N,ee,k),[W]),M("GET","dialogs",200,()=>s(Q(N,k),k)),M("POST",/^dialogs\/(\d+)\/read$/,204,ee=>K(N,ee)),M("PATCH",/^dialogs\/(\d+)$/,200,ee=>Z(N,ee,k),[W]),M("GET","messages",200,()=>s(ue(N,k),k)),M("POST","messages",201,()=>A(N,k),[W,$])},xe=M=>{var Ce,ze,Pe,Gt,Rt;const k=((Ce=M==null?void 0:M.method)!=null?Ce:"").toUpperCase().trim(),N=((ze=M==null?void 0:M.path)!=null?ze:"").split("/").map(Ae=>Ae.trim()).filter(Boolean).join("/"),W=Object.fromEntries(Object.entries((Pe=M==null?void 0:M.headers)!=null?Pe:{}).map(Ae=>[Ae[0].toLowerCase(),Ae[1]])),$=(Gt=M==null?void 0:M.options)!=null?Gt:{},te=(Rt=W["x-username"])!=null?Rt:null,ee=[];_e((Ae,at,rn,on,an=[])=>ee.push({method:Ae,pathPattern:at,cb:on,status:rn,mwList:an}),$,te);const pe=ee.map(Ae=>{if(Ae.method===k){if(Ae.pathPattern instanceof RegExp){const at=N.match(Ae.pathPattern);return at?{...Ae,args:at.slice(1)}:!1}return Ae.pathPattern===N?{...Ae,args:[]}:!1}}).filter(Boolean)[0];if(!pe)return null;const re=pe.cb(...pe.args);return pe.mwList&&pe.mwList.map(Ae=>Ae(re,te,$)),{status:typeof pe.status=="function"?pe.status(re):pe.status,result:re}};try{self.addEventListener("message",({data:{rpcID:M,data:k}})=>{let N,W;try{N=xe(k)}catch($){W=$.message}self.postMessage({rpcID:M,result:N,error:W})})}catch{}return{request:xe}},Si=()=>{const l=`( ${ki.toString()} )()`,e=new Blob([l],{type:"text/javascript"}),t=new Worker(window.URL.createObjectURL(e));let n=1;const i={};return t.addEventListener("message",({data:{rpcID:o,result:a,error:f}})=>{const c=i[o];delete i[o],f&&c.reject(new Error(f)),c.resolve(a)}),{request:o=>{const a=n++,f=i[a]=kt();return t.postMessage({rpcID:a,data:o}),f.promise},destroy:()=>t.terminate()}};function Li(l){let e,t,n,i,s;return t=new fi({props:{operatorSelf:l[0],config:l[3],notifyEvents:l[1],moduleMgr:l[2],createApi:l[4]}}),{c(){e=b("div"),ce(t.$$.fragment),w(e,"class","pos_rel flex")},m(r,o){H(r,e,o),oe(t,e,null),n=!0,i||(s=rt(St.call(null,e)),i=!0)},p(r,o){const a={};o&1&&(a.operatorSelf=r[0]),t.$set(a)},i(r){n||(F(t.$$.fragment,r),n=!0)},o(r){U(t.$$.fragment,r),n=!1},d(r){r&&j(e),ae(t),i=!1,s()}}}function Mi(l){let e,t,n,i,s;return e=new Bn({props:{select:"operators"}}),i=new mi({props:{api:l[5]}}),{c(){ce(e.$$.fragment),t=E(),n=b("div"),ce(i.$$.fragment),w(n,"class","flex")},m(r,o){oe(e,r,o),H(r,t,o),H(r,n,o),oe(i,n,null),s=!0},p:se,i(r){s||(F(e.$$.fragment,r),F(i.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),U(i.$$.fragment,r),s=!1},d(r){ae(e,r),r&&j(t),r&&j(n),ae(i)}}}function Di(l){let e,t,n,i,s,r,o,a;const f=[Mi,Li],c=[];function g(_,d){return _[0]?1:0}return t=g(l),n=c[t]=f[t](l),s=new es({props:{modules:l[2]}}),o=new Wn({props:{events:l[1]}}),{c(){e=b("main"),n.c(),i=E(),ce(s.$$.fragment),r=E(),ce(o.$$.fragment),w(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-l8w6xt")},m(_,d){H(_,e,d),c[t].m(e,null),m(e,i),oe(s,e,null),m(e,r),oe(o,e,null),a=!0},p(_,[d]){let u=t;t=g(_),t===u?c[t].p(_,d):(Le(),U(c[u],1,1,()=>{c[u]=null}),Me(),n=c[t],n?n.p(_,d):(n=c[t]=f[t](_),n.c()),F(n,1),n.m(e,i))},i(_){a||(F(n),F(s.$$.fragment,_),F(o.$$.fragment,_),a=!0)},o(_){U(n),U(s.$$.fragment,_),U(o.$$.fragment,_),a=!1},d(_){_&&j(e),c[t].d(),ae(s),ae(o)}}}function Oi(l,e,t){let n;Se(l,yt,c=>t(0,n=c));const i=Bt(),s=An(),r=window==null?void 0:window.g_Config;r||alert(`Fatal error
Config not found`);const a=(c=>{var u;const g=((u=c.testMode)!=null?u:!0)&&!Zl().has("real-api");let _=()=>null,d=c.api;if(g){const p=Si();je(p.destroy),d={protocol:"https:",host:"test.mode.dev",path_base:"api/"},_=()=>async({method:h,path:L,options:v,request:y})=>{const D=Object.fromEntries([...y.headers]),{status:T,result:S}=await p.request({method:h,path:L,options:v,headers:D});return{status:T,json:()=>S}}}return(p=null)=>yi(d,{onerror:h=>i.emit("error",h),onnotify:h=>i.emit("debug",h),onNotAuthorizedError:()=>Je(yt,n=null,n),operator:p},_())})(r),f=a();return[n,i,s,r,a,f]}class Ti extends ve{constructor(e){super(),he(this,e,Oi,Di,de,{})}}new Ti({target:document.getElementById("app")});
