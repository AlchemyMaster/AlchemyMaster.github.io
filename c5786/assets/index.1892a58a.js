(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function J(){}const ot=l=>l;function gt(l,e){for(const t in e)l[t]=e[t];return l}function cl(l){return l()}function pt(){return Object.create(null)}function Te(l){l.forEach(cl)}function Ee(l){return typeof l=="function"}function ce(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let We;function Ll(l,e){return We||(We=document.createElement("a")),We.href=e,l===We.href}function Tl(l){return Object.keys(l).length===0}function ul(l,...e){if(l==null)return J;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function me(l,e,t){l.$$.on_destroy.push(ul(e,t))}function at(l,e,t){return l.set(t),e}function Ye(l){return l&&Ee(l.destroy)?l.destroy:J}const dl=typeof window<"u";let _l=dl?()=>window.performance.now():()=>Date.now(),ft=dl?l=>requestAnimationFrame(l):J;const He=new Set;function gl(l){He.forEach(e=>{e.c(l)||(He.delete(e),e.f())}),He.size!==0&&ft(gl)}function pl(l){let e;return He.size===0&&ft(gl),{promise:new Promise(t=>{He.add(e={c:l,f:t})}),abort(){He.delete(e)}}}function h(l,e){l.appendChild(e)}function Ml(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function Sl(l,e){return h(l.head||l,e),e.sheet}function I(l,e,t){l.insertBefore(e,t||null)}function D(l){l.parentNode.removeChild(l)}function ml(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function y(l){return document.createElement(l)}function W(l){return document.createTextNode(l)}function j(){return W(" ")}function Be(){return W("")}function ne(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function S(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Al(l){return Array.from(l.childNodes)}function $(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function mt(l,e){l.value=e==null?"":e}function B(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function V(l,e,t){l.classList[t?"add":"remove"](e)}function Ol(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const Ke=new Map;let Ve=0;function Dl(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function Il(l){const e={style_element:y("style"),rules:{}};return Ke.set(l,e),e}function ht(l,e,t,n,i,s,r,o=0){const a=16.666/n;let f=`{
`;for(let w=0;w<=1;w+=a){const k=e+(t-e)*s(w);f+=w*100+`%{${r(k,1-k)}}
`}const u=f+`100% {${r(t,1-t)}}
}`,m=`__svelte_${Dl(u)}_${o}`,c=Ml(l),{style_element:d,rules:_}=Ke.get(c)||Il(c);if(!_[m]){const w=Sl(c,d);_[m]=!0,w.insertRule(`@keyframes ${m} ${u}`,w.cssRules.length)}const g=l.style.animation||"";return l.style.animation=`${g?`${g}, `:""}${m} ${n}ms linear ${i}ms 1 both`,Ve+=1,m}function El(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),Ve-=i,Ve||jl())}function jl(){ft(()=>{Ve||(Ke.forEach(l=>{const{style_element:e}=l;D(e)}),Ke.clear())})}let Fe;function Re(l){Fe=l}function Cl(){if(!Fe)throw new Error("Function called outside component initialization");return Fe}function Ze(l){Cl().$$.on_destroy.push(l)}const Ne=[],Ae=[],Xe=[],nt=[],Hl=Promise.resolve();let it=!1;function ql(){it||(it=!0,Hl.then(hl))}function ke(l){Xe.push(l)}function ct(l){nt.push(l)}const et=new Set;let ze=0;function hl(){const l=Fe;do{for(;ze<Ne.length;){const e=Ne[ze];ze++,Re(e),Pl(e.$$)}for(Re(null),Ne.length=0,ze=0;Ae.length;)Ae.pop()();for(let e=0;e<Xe.length;e+=1){const t=Xe[e];et.has(t)||(et.add(t),t())}Xe.length=0}while(Ne.length);for(;nt.length;)nt.pop()();it=!1,et.clear(),Re(l)}function Pl(l){if(l.fragment!==null){l.update(),Te(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(ke)}}let Pe;function Nl(){return Pe||(Pe=Promise.resolve(),Pe.then(()=>{Pe=null})),Pe}function tt(l,e,t){l.dispatchEvent(Ol(`${e?"intro":"outro"}${t}`))}const Je=new Set;let Me;function de(){Me={r:0,c:[],p:Me}}function _e(){Me.r||Te(Me.c),Me=Me.p}function E(l,e){l&&l.i&&(Je.delete(l),l.i(e))}function H(l,e,t,n){if(l&&l.o){if(Je.has(l))return;Je.add(l),Me.c.push(()=>{Je.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const Rl={duration:0};function we(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,a=null;function f(){a&&El(l,a)}function u(c,d){const _=c.b-s;return d*=Math.abs(_),{a:s,b:c.b,d:_,duration:d,start:c.start,end:c.start+d,group:c.group}}function m(c){const{delay:d=0,duration:_=300,easing:g=ot,tick:w=J,css:k}=i||Rl,p={start:_l()+d,b:c};c||(p.group=Me,Me.r+=1),r||o?o=p:(k&&(f(),a=ht(l,s,c,_,d,g,k)),c&&w(0,1),r=u(p,_),ke(()=>tt(l,c,"start")),pl(v=>{if(o&&v>o.start&&(r=u(o,_),o=null,tt(l,r.b,"start"),k&&(f(),a=ht(l,s,r.b,r.duration,0,g,i.css))),r){if(v>=r.end)w(s=r.b,1-s),tt(l,r.b,"end"),o||(r.b?f():--r.group.r||Te(r.group.c)),r=null;else if(v>=r.start){const T=v-r.start;s=r.a+r.d*g(T/r.duration),w(s,1-s)}}return!!(r||o)}))}return{run(c){Ee(i)?Nl().then(()=>{i=i(),m(c)}):m(c)},end(){f(),r=o=null}}}const vl=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function bl(l,e){l.d(1),e.delete(l.key)}function Ue(l,e){H(l,1,1,()=>{e.delete(l.key)})}function je(l,e,t,n,i,s,r,o,a,f,u,m){let c=l.length,d=s.length,_=c;const g={};for(;_--;)g[l[_].key]=_;const w=[],k=new Map,p=new Map;for(_=d;_--;){const L=m(i,s,_),A=t(L);let M=r.get(A);M?n&&M.p(L,e):(M=f(A,L),M.c()),k.set(A,w[_]=M),A in g&&p.set(A,Math.abs(_-g[A]))}const v=new Set,T=new Set;function b(L){E(L,1),L.m(o,u),r.set(L.key,L),u=L.first,d--}for(;c&&d;){const L=w[d-1],A=l[c-1],M=L.key,O=A.key;L===A?(u=L.first,c--,d--):k.has(O)?!r.has(M)||v.has(M)?b(L):T.has(O)?c--:p.get(M)>p.get(O)?(T.add(M),b(L)):(v.add(O),c--):(a(A,r),c--)}for(;c--;){const L=l[c];k.has(L.key)||a(L,r)}for(;d;)b(w[d-1]);return w}function ut(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function re(l){l&&l.c()}function ie(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||ke(()=>{const a=s.map(cl).filter(Ee);r?r.push(...a):Te(a),l.$$.on_mount=[]}),o.forEach(ke)}function se(l,e){const t=l.$$;t.fragment!==null&&(Te(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Fl(l,e){l.$$.dirty[0]===-1&&(Ne.push(l),ql(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ge(l,e,t,n,i,s,r,o=[-1]){const a=Fe;Re(l);const f=l.$$={fragment:null,ctx:null,props:s,update:J,not_equal:i,bound:pt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:pt(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(f.root);let u=!1;if(f.ctx=t?t(l,e.props||{},(m,c,...d)=>{const _=d.length?d[0]:c;return f.ctx&&i(f.ctx[m],f.ctx[m]=_)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](_),u&&Fl(l,m)),c}):[],f.update(),u=!0,Te(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const m=Al(e.target);f.fragment&&f.fragment.l(m),m.forEach(D)}else f.fragment&&f.fragment.c();e.intro&&E(l.$$.fragment),ie(l,e.target,e.anchor,e.customElement),hl()}Re(a)}class pe{$destroy(){se(this,1),this.$destroy=J}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Tl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Yl(l){const e=l-1;return e*e*e+1}function Le(l,{delay:e=0,duration:t=400,easing:n=ot}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function vt(l,{delay:e=0,duration:t=400,easing:n=Yl}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),u=parseFloat(i.marginBottom),m=parseFloat(i.borderTopWidth),c=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:d=>`overflow: hidden;opacity: ${Math.min(d*20,1)*s};height: ${d*r}px;padding-top: ${d*o}px;padding-bottom: ${d*a}px;margin-top: ${d*f}px;margin-bottom: ${d*u}px;border-top-width: ${d*m}px;border-bottom-width: ${d*c}px;`}}const Ce=[];function Oe(l,e=J){let t;const n=new Set;function i(o){if(ce(l,o)&&(l=o,t)){const a=!Ce.length;for(const f of n)f[1](),Ce.push(f,l);if(a){for(let f=0;f<Ce.length;f+=2)Ce[f][0](Ce[f+1]);Ce.length=0}}}function s(o){i(o(l))}function r(o,a=J){const f=[o,a];return n.add(f),n.size===1&&(t=e(i)||J),o(l),()=>{n.delete(f),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const dt=Oe(null),wl=l=>{var e;dt.set(l),g_Api.setHeader("x-username",(e=l==null?void 0:l.username)!=null?e:void 0)},bt=(l,e)=>{const{subscribe:t,set:n,update:i}=Oe(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},Bl=(l,e)=>{const{subscribe:t,set:n,update:i}=Oe(l);return[{subscribe:t},i]},Ul=l=>parseInt(l.id);function xl(l){const e={},t=l;[e.operatorSelf_r]=bt(t);const n=Object.create(null),[i,s]=Bl(n),r=u=>{!u.length||s(m=>{for(const c of u)m[Ul(c)]=c;return m})},o=u=>r([u]),[a,f]=bt(null);return Object.assign(e,{dialogMap_r:i,dialogMap_SetDialogList:r,dialogMap_SetDialog:o,dialogActiveID_r:a,dialogActiveID_Set:f}),Object.freeze(e),e}function wt(l){let e,t,n;return{c(){e=y("div"),e.textContent="Operators",S(e,"class","item cursor_ptr svelte-vbcb9r"),V(e,"active",l[0]==="operators"),V(e,"disabled",l[1].has("operators"))},m(i,s){I(i,e,s),t||(n=ne(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&V(e,"active",i[0]==="operators"),s&2&&V(e,"disabled",i[1].has("operators"))},d(i){i&&D(e),t=!1,n()}}}function yt(l){let e,t=l[2].username+"",n,i,s;return{c(){e=y("div"),n=W(t),S(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),B(e,"max-width","200px")},m(r,o){I(r,e,o),h(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&$(n,t)},i(r){s||(ke(()=>{i||(i=we(e,Le,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=we(e,Le,{},!1)),i.run(0),s=!1},d(r){r&&D(e),r&&i&&i.end()}}}function Wl(l){let e,t,n,i,s,r,o=!l[2]&&wt(l),a=l[2]&&0,f=l[2]&&yt(l);return{c(){e=y("div"),o&&o.c(),t=j(),a&&a.c(),n=j(),i=y("div"),s=j(),f&&f.c(),S(i,"class","flex flex_grow_1"),S(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(u,m){I(u,e,m),o&&o.m(e,null),h(e,t),a&&a.m(e,null),h(e,n),h(e,i),h(e,s),f&&f.m(e,null),r=!0},p(u,[m]){u[2]?o&&(o.d(1),o=null):o?o.p(u,m):(o=wt(u),o.c(),o.m(e,t)),u[2],a&&(a.d(1),a=null),u[2]?f?(f.p(u,m),m&4&&E(f,1)):(f=yt(u),f.c(),E(f,1),f.m(e,null)):f&&(de(),H(f,1,1,()=>{f=null}),_e())},i(u){r||(E(f),r=!0)},o(u){H(f),r=!1},d(u){u&&D(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function zl(l,e,t){let n;me(l,dt,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>a=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class Gl extends pe{constructor(e){super(),ge(this,e,zl,Wl,ce,{select:0,disabled:1})}}function Xl(l){let e;return{c(){e=y("div"),S(e,"class","pos_abs notify_list svelte-bjfmev")},m(t,n){I(t,e,n)},p:J,i:J,o:J,d(t){t&&D(e)}}}class Jl extends pe{constructor(e){super(),ge(this,e,null,Xl,ce,{})}}function kt(l){return Object.prototype.toString.call(l)==="[object Date]"}function st(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>st(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if(kt(l)&&kt(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=st(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function _t(l,e={}){const t=Oe(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let a=n,f=!1,{delay:u=0,duration:m=400,easing:c=ot,interpolate:d=st}=gt(gt({},e),o);if(m===0)return a&&(a.abort(),a=null),t.set(l=i),Promise.resolve();const _=_l()+u;let g;return n=pl(w=>{if(w<_)return!0;f||(g=d(l,r),typeof m=="function"&&(m=m(l,r)),f=!0),a&&(a.abort(),a=null);const k=w-_;return k>m?(t.set(l=r),!1):(t.set(l=g(c(k/m))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}const Lt=()=>{},Kl=l=>new Promise(e=>setTimeout(e,l)),Se=(l,e,t)=>Math.min(t,Math.max(l,e)),rt=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,a)=>rt(o,e[a]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,a])=>!(!r.has(o)||!rt(a,r.get(o))))}catch{}return!1},Vl=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),Zl=l=>{const e=Vl();return setTimeout(e.resolve,l),e},Ql=Symbol("RangeLoadList_ItemLastUpdateTime"),$l=l=>{var P,U,x,z;const e=Se(1,((P=l.updateInterval)!=null?P:1e3)|0,36e5),t=Se(1,((U=l.maxLimit)!=null?U:50)|0,1e3);let n=l.fLoad;const i=(x=l.onUpdateItem)!=null?x:Lt,s=(z=l.onUpdateItemList)!=null?z:Lt,r=!!l.isLoadEnd,o=Ql,a={},f=Oe(null),u={subscribe:f.subscribe};let m=0,c=t,d=null;const _=F=>n=F,g=async(F,X)=>{try{const Z=await n({offset:F,limit:X});if(typeof Z.count=="number"&&Array.isArray(Z.results))return Z}catch{}return null},w=async(F,X)=>{const Z=await g(F,X);if(Z){const N=Z.results,ee=Math.max(0,Z.count|0),C=d!==ee,G=Date.now();d=ee;const te=[];for(let fe=0,Y=F;fe<N.length&&Y<d;fe++,Y++){const K=N[fe];a[Y]!==void 0&&rt(a[Y],K)||(K[o]=G,a[Y]=K,i(K),te.push(K))}te.length&&s(te),(C||te.length)&&f.set({total:d,list:a})}},k=async F=>{const X=[];X.push(w(m,c)),d!==null&&m+c<d&&r&&X.push(w(d,t)),await Promise.all(X),d!==null&&m+c<d&&r&&F&&await w(d,t)};let p=!1,v=!0,T,b=1;return(async()=>{let F=0;for(;v;){for(;v&&!p;){const X=b;if(await k(F++===0),X===b)break}T=Zl(e),await T.promise}})(),{setFLoad:_,update:()=>{b++,T&&T.resolve()},setRange:(F,X)=>{m=Math.max(0,F|0),c=Se(0,X|0,t)},destroy:()=>v=!1,getData_r:()=>u,symbolUpdateTime:o,pause:()=>p=!0,resume:()=>p=!1}},en=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},tn=(l,e)=>{const t=setInterval(e,l);return()=>clearInterval(t)};function ln(l){let e,t,n,i,s,r,o,a,f,u,m;return{c(){e=y("div"),t=y("div"),n=j(),i=y("div"),i.textContent="offline",s=j(),r=y("div"),o=W(`online\r
		`),a=y("div"),f=W(l[1]),S(t,"class","pos_abs h100 onlineProgressTrumb svelte-1hq79ac"),B(t,"width",l[0]+"%"),S(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-1hq79ac"),V(i,"hideR",l[0]>=1),S(a,"class","pos_abs onlineProgressTrumbLastTime svelte-1hq79ac"),S(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-1hq79ac"),V(r,"hideL",l[0]<1),S(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-1hq79ac")},m(c,d){I(c,e,d),h(e,t),h(e,n),h(e,i),h(e,s),h(e,r),h(r,o),h(r,a),h(a,f),u||(m=ne(e,"click",l[3]),u=!0)},p(c,[d]){d&1&&B(t,"width",c[0]+"%"),d&1&&V(i,"hideR",c[0]>=1),d&2&&$(f,c[1]),d&1&&V(r,"hideL",c[0]<1)},i:J,o:J,d(c){c&&D(e),u=!1,m()}}}const Tt=25e3;function nn(l,e,t){let n,i,s,r=0;const o=_t(0);me(l,o,d=>t(5,s=d));let a=Date.now(),f=0;function u(){f=Math.max(0,a+Tt-Date.now()),t(0,r=Math.floor(Se(0,f/Tt,1)*100)),at(o,s=Math.ceil(f/1e3),s)}const m=()=>{a=Date.now(),u()};Ze(tn(1e3,u));const c=d=>{const _=Math.floor(d%60);d/=60;const g=Math.floor(d%60);d/=60;const w=Math.floor(d),k=[];return(k.length||w)&&k.push(`${String(w).padStart(k.length?2:1,"0")}h`),(k.length||g)&&k.push(`${String(g).padStart(k.length?2:1,"0")}m`),(k.length||_)&&k.push(`${String(_).padStart(k.length?2:1,"0")}s`),k.join(" ")};return l.$$.update=()=>{l.$$.dirty&32&&t(4,n=Math.ceil(s)),l.$$.dirty&16&&t(1,i=c(n))},[r,i,o,m,n,s]}class sn extends pe{constructor(e){super(),ge(this,e,nn,ln,ce,{})}}function rn(l){let e;return{c(){e=W("\xA0")},m(t,n){I(t,e,n)},p:J,d(t){t&&D(e)}}}function on(l){let e,t=l[0].username+"",n;return{c(){e=W("@"),n=W(t)},m(i,s){I(i,e,s),I(i,n,s)},p(i,s){s&1&&t!==(t=i[0].username+"")&&$(n,t)},d(i){i&&D(e),i&&D(n)}}}function an(l){var U,x;let e,t,n,i,s=((U=l[0].first_name)!=null?U:"")+"",r,o,a,f,u,m=((x=l[0].last_name)!=null?x:"")+"",c,d,_,g,w,k,p,v,T,b,L,A,M,O,q;function R(z,F){return z[0].username?on:rn}let oe=R(l),P=oe(l);return b=new sn({}),{c(){e=y("div"),t=y("div"),n=y("div"),i=y("div"),r=W(s),o=j(),a=y("div"),f=j(),u=y("div"),c=W(m),d=W("\xA0"),_=j(),g=y("div"),P.c(),w=j(),k=y("div"),k.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',p=j(),v=y("div"),T=j(),re(b.$$.fragment),L=j(),A=y("div"),B(a,"width","8px"),S(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),S(g,"class","nowrap textOverEllipsis username svelte-1qt21qp"),S(k,"class","pos_abs btnLogout svelte-1qt21qp"),S(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),B(v,"height","8px"),B(A,"height","8px"),S(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(z,F){I(z,e,F),h(e,t),h(t,n),h(n,i),h(i,r),h(n,o),h(n,a),h(n,f),h(n,u),h(u,c),h(u,d),h(t,_),h(t,g),P.m(g,null),h(t,w),h(t,k),h(e,p),h(e,v),h(e,T),ie(b,e,null),h(e,L),h(e,A),M=!0,O||(q=ne(k,"click",l[2]),O=!0)},p(z,[F]){var X,Z;(!M||F&1)&&s!==(s=((X=z[0].first_name)!=null?X:"")+"")&&$(r,s),(!M||F&1)&&m!==(m=((Z=z[0].last_name)!=null?Z:"")+"")&&$(c,m),oe===(oe=R(z))&&P?P.p(z,F):(P.d(1),P=oe(z),P&&(P.c(),P.m(g,null)))},i(z){M||(E(b.$$.fragment,z),M=!0)},o(z){H(b.$$.fragment,z),M=!1},d(z){z&&D(e),P.d(),se(b),O=!1,q()}}}function fn(l,e,t){let n,{app:i}=e;const{operatorSelf_r:s}=i;me(l,s,o=>t(0,n=o));const r=()=>wl(null);return l.$$set=o=>{"app"in o&&t(3,i=o.app)},[n,s,r,i]}class cn extends pe{constructor(e){super(),ge(this,e,fn,an,ce,{app:3})}}const Qe=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{i&&setTimeout(s,10);const o=l.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||n!==a.height)&&(t=a.width,n=a.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(a))}};return s(),{destroy:()=>i=!1}},un=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{r&&setTimeout(o,10);const f=l.getBoundingClientRect();(t!==f.width||n!==f.height||i!==f.x||s!==f.y)&&(t=f.width,n=f.height,i=f.x,s=f.y,e&&e.set(f))};return o(),{destroy:()=>r=!1}};function dn(l){let e;return{c(){e=y("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,S(e,"class","lds-roller svelte-j15bjw")},m(t,n){I(t,e,n)},p:J,i:J,o:J,d(t){t&&D(e)}}}class qe extends pe{constructor(e){super(),ge(this,e,null,dn,ce,{})}}const{Map:_n}=vl;function Mt(l,e,t){const n=l.slice();return n[15]=e[t],n}function St(l){let e,t,n;return{c(){e=W("("),t=W(l[4]),n=W(")")},m(i,s){I(i,e,s),I(i,t,s),I(i,n,s)},p(i,s){s&16&&$(t,i[4])},d(i){i&&D(e),i&&D(t),i&&D(n)}}}function At(l){let e,t,n,i;return t=new qe({}),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_abs loading svelte-nqr5he")},m(s,r){I(s,e,r),ie(t,e,null),i=!0},i(s){i||(E(t.$$.fragment,s),s&&ke(()=>{n||(n=we(e,Le,{},!0)),n.run(1)}),i=!0)},o(s){H(t.$$.fragment,s),s&&(n||(n=we(e,Le,{},!1)),n.run(0)),i=!1},d(s){s&&D(e),se(t),s&&n&&n.end()}}}function Ot(l){let e,t,n=l[15].username+"",i;return{c(){e=y("div"),t=W("@"),i=W(n),S(e,"class","nowrap textOverEllipsis username svelte-nqr5he")},m(s,r){I(s,e,r),h(e,t),h(e,i)},p(s,r){r&8&&n!==(n=s[15].username+"")&&$(i,n)},d(s){s&&D(e)}}}function Dt(l){let e,t,n;return t=new qe({}),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_abs loadingLead svelte-nqr5he")},m(i,s){I(i,e,s),ie(t,e,null),n=!0},i(i){n||(E(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){i&&D(e),se(t)}}}function It(l,e){var L,A;let t,n,i,s=((L=e[15].first_name)!=null?L:"")+"",r,o,a,f,u,m=((A=e[15].last_name)!=null?A:"")+"",c,d,_,g=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id),w,k,p,v,T=e[15].username&&Ot(e),b=g&&Dt();return{key:l,first:null,c(){t=y("div"),n=y("div"),i=y("div"),r=W(s),o=j(),a=y("div"),f=j(),u=y("div"),c=W(m),d=j(),T&&T.c(),_=j(),b&&b.c(),w=j(),B(a,"width","8px"),S(n,"class","flex nowrap textOverEllipsis userAttr svelte-nqr5he"),S(t,"class","flex flex_clm cursor_ptr w100 item unselect pos_abs svelte-nqr5he"),B(t,"top",e[15].y+"px"),B(t,"height",yl+"px"),V(t,"disabled",e[1].has(e[15].tg_id)),this.first=t},m(M,O){I(M,t,O),h(t,n),h(n,i),h(i,r),h(n,o),h(n,a),h(n,f),h(n,u),h(u,c),h(t,d),T&&T.m(t,null),h(t,_),b&&b.m(t,null),h(t,w),k=!0,p||(v=ne(t,"click",function(){Ee(e[6](e[15].tg_id))&&e[6](e[15].tg_id).apply(this,arguments)}),p=!0)},p(M,O){var q,R;e=M,(!k||O&8)&&s!==(s=((q=e[15].first_name)!=null?q:"")+"")&&$(r,s),(!k||O&8)&&m!==(m=((R=e[15].last_name)!=null?R:"")+"")&&$(c,m),e[15].username?T?T.p(e,O):(T=Ot(e),T.c(),T.m(t,_)):T&&(T.d(1),T=null),O&14&&(g=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id)),g?b?O&14&&E(b,1):(b=Dt(),b.c(),E(b,1),b.m(t,w)):b&&(de(),H(b,1,1,()=>{b=null}),_e()),(!k||O&8)&&B(t,"top",e[15].y+"px"),(!k||O&10)&&V(t,"disabled",e[1].has(e[15].tg_id))},i(M){k||(E(b),k=!0)},o(M){H(b),k=!1},d(M){M&&D(t),T&&T.d(),b&&b.d(),p=!1,v()}}}function gn(l){let e,t,n,i,s,r,o,a,f=[],u=new _n,m,c,d,_=l[4]!==null&&St(l),g=l[5]&&At(),w=l[3];const k=p=>p[15].tg_id;for(let p=0;p<w.length;p+=1){let v=Mt(l,w,p),T=k(v);u.set(T,f[p]=It(T,v))}return{c(){e=y("div"),t=y("div"),n=W(`New leads\r
		\r
		`),_&&_.c(),i=j(),g&&g.c(),s=j(),r=y("div"),o=y("div"),a=y("div");for(let p=0;p<f.length;p+=1)f[p].c();S(t,"class","flex flex_cx flex_cy header pos_rel w100 svelte-nqr5he"),S(a,"class","flex list h100 svelte-nqr5he"),S(o,"class","pos_abs w100"),B(o,"overflow","hidden"),S(r,"class","flex cnt h100 pos_rel w100 svelte-nqr5he"),S(e,"class","flex flex_clm wrapMain flex_grow_1 w100 svelte-nqr5he")},m(p,v){I(p,e,v),h(e,t),h(t,n),_&&_.m(t,null),h(t,i),g&&g.m(t,null),h(e,s),h(e,r),h(r,o),h(o,a);for(let T=0;T<f.length;T+=1)f[T].m(a,null);l[9](o),m=!0,c||(d=Ye(Qe.call(null,o)),c=!0)},p(p,[v]){p[4]!==null?_?_.p(p,v):(_=St(p),_.c(),_.m(t,i)):_&&(_.d(1),_=null),p[5]?g?v&32&&E(g,1):(g=At(),g.c(),E(g,1),g.m(t,null)):g&&(de(),H(g,1,1,()=>{g=null}),_e()),v&78&&(w=p[3],de(),f=je(f,v,k,1,p,w,u,a,Ue,It,null,Mt),_e())},i(p){if(!m){E(g);for(let v=0;v<w.length;v+=1)E(f[v]);m=!0}},o(p){H(g);for(let v=0;v<f.length;v+=1)H(f[v]);m=!1},d(p){p&&D(e),_&&_.d(),g&&g.d();for(let v=0;v<f.length;v+=1)f[v].d();l[9](null),c=!1,d()}}}const pn=160,yl=42,lt=0;function mn(l,e,t){let{app:n}=e,i=[],s=new Map,r=new Set,o=[],a=null;function f(){if(!a)return;const p=a.getBoundingClientRect(),v=pn+lt*2,T=yl+lt*2,b=Math.max(1,Math.floor(p.width/v)),L=(p.width-b*v)/2,A=lt;t(3,o=i.map((M,O)=>{const q={...M};return q.x=O%b*v+L,q.y=A+Math.floor(O/b)*T,q}))}let u=null,m=!1;async function c(){var v;const p=await g_Api.lead_GetUnassignedList({offset:0,limit:20});return p?(t(4,u=p.count),(v=p.results)!=null?v:p):null}let d=!0;async function _(){for(;d;){await Kl(g_Config.updateIntervals.new_leads);const p=await c();if(!p)continue;const v=new Set(i.map(O=>O.tg_id)),T=new Set(p.map(O=>O.tg_id)),b=p.filter(O=>!v.has(O.tg_id)),L=i.filter(O=>!T.has(O.tg_id)),A=Date.now();L.map(O=>s.has(O.tg_id)||s.set(O.tg_id,A)),b.length===0&&L.length===0||t(8,i=[...i,...b]);const M=new Set;[...s].map(O=>{O[1]+2e3<=A&&M.add(O[0]),O[1]+1e4<=A&&s.delete(O[0])}),M.size&&t(8,i=i.filter(O=>!M.has(O.tg_id)))}}async function g(){for(t(5,m=!0);d;){const p=await c();if(p){t(8,i=p);break}}t(5,m=!1),_()}Ze(()=>d=!1);const w=p=>async v=>{if(r.has(p)||s.has(p))return;r.add(p),t(2,r);const T=await g_Api.lead_AssignOperatorSelft(p);r.delete(p),t(2,r),T!==null&&(s.set(p,Date.now()),t(1,s)),t(8,i),t(3,o)};g();function k(p){Ae[p?"unshift":"push"](()=>{a=p,t(0,a)})}return l.$$set=p=>{"app"in p&&t(7,n=p.app)},l.$$.update=()=>{l.$$.dirty&257&&f()},[a,s,r,o,u,m,w,n,i,k]}class hn extends pe{constructor(e){super(),ge(this,e,mn,gn,ce,{app:7})}}function Et(l,e,t){const n=l.slice();return n[15]=e[t],n}function vn(l){let e;return{c(){e=W("\xA0")},m(t,n){I(t,e,n)},p:J,d(t){t&&D(e)}}}function bn(l){var n,i;let e=((i=(n=l[3])==null?void 0:n.last_message)==null?void 0:i.text)+"",t;return{c(){t=W(e)},m(s,r){I(s,t,r)},p(s,r){var o,a;r&8&&e!==(e=((a=(o=s[3])==null?void 0:o.last_message)==null?void 0:a.text)+"")&&$(t,e)},d(s){s&&D(t)}}}function jt(l,e){let t,n=e[15].title.toLowerCase()+"",i;return{key:l,first:null,c(){t=y("div"),i=W(n),S(t,"class","flex tag svelte-iig2av"),B(t,"background",e[15].background_color),B(t,"color",e[15].color),this.first=t},m(s,r){I(s,t,r),h(t,i)},p(s,r){e=s,r&8&&n!==(n=e[15].title.toLowerCase()+"")&&$(i,n),r&8&&B(t,"background",e[15].background_color),r&8&&B(t,"color",e[15].color)},d(s){s&&D(t)}}}function Ct(l){var i;let e,t=l[10]((i=l[3])==null?void 0:i._lastTime)+"",n;return{c(){e=y("div"),n=W(t),S(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-iig2av")},m(s,r){I(s,e,r),h(e,n)},p(s,r){var o;r&8&&t!==(t=s[10]((o=s[3])==null?void 0:o._lastTime)+"")&&$(n,t)},d(s){s&&D(e)}}}function Ht(l){var i;let e,t=((i=l[3])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=y("div"),n=W(t),S(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-iig2av")},m(s,r){I(s,e,r),h(e,n)},p(s,r){var o;r&8&&t!==(t=((o=s[3])==null?void 0:o.unread_messages_count)+"")&&$(n,t)},d(s){s&&D(e)}}}function wn(l){var z,F,X,Z,N,ee,C,G,te,fe;let e,t,n,i,s,r,o=((X=(F=(z=l[3])==null?void 0:z.lead)==null?void 0:F.first_name)!=null?X:"")+"",a,f,u,m,c,d=((ee=(N=(Z=l[3])==null?void 0:Z.lead)==null?void 0:N.last_name)!=null?ee:"")+"",_,g,w,k,p,v=[],T=new Map,b,L,A,M;function O(Y,K){var ue,he;return(he=(ue=Y[3])==null?void 0:ue.last_message)!=null&&he.text?bn:vn}let q=O(l),R=q(l),oe=(G=(C=l[3])==null?void 0:C.tag)!=null?G:[];const P=Y=>Y[15].id;for(let Y=0;Y<oe.length;Y+=1){let K=Et(l,oe,Y),ue=P(K);T.set(ue,v[Y]=jt(ue,K))}let U=((te=l[3])==null?void 0:te._lastTime)&&Ct(l),x=((fe=l[3])==null?void 0:fe.unread_messages_count)&&Ht(l);return{c(){e=y("div"),t=y("div"),n=y("div"),i=y("div"),s=j(),r=y("div"),a=W(o),f=j(),u=y("div"),m=j(),c=y("div"),_=W(d),g=j(),w=y("div"),R.c(),k=j(),p=y("div");for(let Y=0;Y<v.length;Y+=1)v[Y].c();b=j(),U&&U.c(),L=j(),x&&x.c(),B(i,"width","8px"),B(u,"width","8px"),S(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-iig2av"),S(w,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-iig2av"),S(p,"class","flex tag_list svelte-iig2av"),S(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-iig2av"),B(t,"height",l[0]+"px"),V(t,"active",l[1]===l[5]),S(e,"class","pos_abs w100"),B(e,"top",l[4]+l[2]+"px")},m(Y,K){I(Y,e,K),h(e,t),h(t,n),h(n,i),h(n,s),h(n,r),h(r,a),h(n,f),h(n,u),h(n,m),h(n,c),h(c,_),h(t,g),h(t,w),R.m(w,null),h(t,k),h(t,p);for(let ue=0;ue<v.length;ue+=1)v[ue].m(p,null);h(t,b),U&&U.m(t,null),h(t,L),x&&x.m(t,null),A||(M=ne(t,"click",l[9]),A=!0)},p(Y,[K]){var ue,he,ae,le,ye,De,Q,ve,be,xe;K&8&&o!==(o=((ae=(he=(ue=Y[3])==null?void 0:ue.lead)==null?void 0:he.first_name)!=null?ae:"")+"")&&$(a,o),K&8&&d!==(d=((De=(ye=(le=Y[3])==null?void 0:le.lead)==null?void 0:ye.last_name)!=null?De:"")+"")&&$(_,d),q===(q=O(Y))&&R?R.p(Y,K):(R.d(1),R=q(Y),R&&(R.c(),R.m(w,null))),K&8&&(oe=(ve=(Q=Y[3])==null?void 0:Q.tag)!=null?ve:[],v=je(v,K,P,1,Y,oe,T,p,bl,jt,null,Et)),(be=Y[3])!=null&&be._lastTime?U?U.p(Y,K):(U=Ct(Y),U.c(),U.m(t,L)):U&&(U.d(1),U=null),(xe=Y[3])!=null&&xe.unread_messages_count?x?x.p(Y,K):(x=Ht(Y),x.c(),x.m(t,null)):x&&(x.d(1),x=null),K&1&&B(t,"height",Y[0]+"px"),K&34&&V(t,"active",Y[1]===Y[5]),K&20&&B(e,"top",Y[4]+Y[2]+"px")},i:J,o:J,d(Y){Y&&D(e),R.d();for(let K=0;K<v.length;K+=1)v[K].d();U&&U.d(),x&&x.d(),A=!1,M()}}}function yn(l,e,t){let n,i,s,r,{app:o}=e;const{dialogMap_r:a,dialogActiveID_r:f,dialogActiveID_Set:u}=o;me(l,a,p=>t(13,i=p)),me(l,f,p=>t(5,r=p));let{height:m=54}=e,{dialog_id:c}=e,{y:d=0}=e,{scrollY:_=0}=e;const g=_t(d);me(l,g,p=>t(4,s=p));const w=p=>{n&&u(n.id)},k=p=>{if(!p)return"";const v=b=>String(b).padStart(2,"0"),T=new Date;return p=new Date(p),p.getYear()===T.getYear()&&p.getMonth()===T.getMonth()?p.getDate()===T.getDate()?`${v(p.getHours())}:${v(p.getMinutes())}`:`${v(p.getDate())}d ${v(p.getHours())}:${v(p.getMinutes())}`:`${v(p.getDate())}.${v(p.getMonth())}.${p.getFullYear()}`};return l.$$set=p=>{"app"in p&&t(11,o=p.app),"height"in p&&t(0,m=p.height),"dialog_id"in p&&t(1,c=p.dialog_id),"y"in p&&t(12,d=p.y),"scrollY"in p&&t(2,_=p.scrollY)},l.$$.update=()=>{l.$$.dirty&4096&&at(g,s=d,s),l.$$.dirty&8194&&t(3,n=i[c])},[m,c,_,n,s,r,a,f,g,w,k,o,d,i]}class kn extends pe{constructor(e){super(),ge(this,e,yn,wn,ce,{app:11,height:0,dialog_id:1,y:12,scrollY:2})}}function Ln(l){let e,t,n,i;return{c(){e=y("div"),t=y("div"),S(t,"class","pos_abs thumb w100 svelte-5ca5ia"),B(t,"height",l[1]+"px"),B(t,"top",l[5](l[0],l[2],l[1])+"px"),V(t,"active",l[3]),S(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),V(e,"active",l[3])},m(s,r){I(s,e,r),h(e,t),n||(i=[ne(window,"mousemove",l[7]),ne(window,"mouseup",l[8]),ne(window,"blur",l[8]),ne(t,"mousedown",l[6]),Ye(un.call(null,e,l[4])),ne(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&B(t,"height",s[1]+"px"),r&7&&B(t,"top",s[5](s[0],s[2],s[1])+"px"),r&8&&V(t,"active",s[3]),r&8&&V(e,"active",s[3])},i:J,o:J,d(s){s&&D(e),n=!1,Te(i)}}}function Tn(l,e,t){let n;const i=v=>Se(0,Array.isArray(v)?v[0]:v,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:a=null}=e;const f=Oe(null);me(l,f,v=>t(2,n=v));const u=()=>n?n.height-o:1,m=v=>n?v*u():0,c=()=>{if(!n)return 1;if(a===null)return o;t(1,o=Se(.1,a,1)*n.height)};let d=null;const _=v=>{!n||t(3,d={y:v.clientY,value_out:r})},g=v=>{if(!n||!d)return;const T=v.clientY-d.y;if(n.height){const b=T/u();t(0,r=Se(0,d.value_out+b,1))}},w=v=>{t(3,d=null)},k=v=>{!n||d||(t(0,r=Se(0,(v.clientY-n.y-o/2)/u(),1)),t(3,d={y:v.clientY,value_out:r}))},p=()=>{if(!n)return 0;d||t(0,r=i(s))};return l.$$set=v=>{"value_in"in v&&t(10,s=v.value_in),"value_out"in v&&t(0,r=v.value_out),"thumb_Height"in v&&t(1,o=v.thumb_Height),"thumb_HeightRate"in v&&t(11,a=v.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&c(),l.$$.dirty&1024&&p()},[r,o,n,d,f,m,_,g,w,k,s,a]}class kl extends pe{constructor(e){super(),ge(this,e,Tn,Ln,ce,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:Mn}=vl;function qt(l,e,t){const n=l.slice();return n[24]=e[t],n}function Pt(l,e){let t,n,i;return n=new kn({props:{app:e[0],height:Ie,dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Be(),re(n.$$.fragment),this.first=t},m(s,r){I(s,t,r),ie(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(E(n.$$.fragment,s),i=!0)},o(s){H(n.$$.fragment,s),i=!1},d(s){s&&D(t),se(n,s)}}}function Nt(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new kl({props:r}),Ae.push(()=>ut(t,"value_out",s)),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,a){I(o,e,a),ie(t,e,null),i=!0},p(o,a){const f={};a&32&&(f.value_in=o[5]),a&64&&(f.thumb_HeightRate=o[6]),!n&&a&2&&(n=!0,f.value_out=o[1],ct(()=>n=!1)),t.$set(f)},i(o){i||(E(t.$$.fragment,o),i=!0)},o(o){H(t.$$.fragment,o),i=!1},d(o){o&&D(e),se(t)}}}function Rt(l){let e,t,n,i,s;return{c(){e=y("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',S(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){I(r,e,o),n=!0,i||(s=ne(e,"click",l[15]),i=!0)},p:J,i(r){n||(r&&ke(()=>{t||(t=we(e,Le,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=we(e,Le,{},!1)),t.run(0)),n=!1},d(r){r&&D(e),r&&t&&t.end(),i=!1,s()}}}function Sn(l){let e,t,n=[],i=new Mn,s,r,o,a,f,u=l[4];const m=_=>_[24].dialog_id;for(let _=0;_<u.length;_+=1){let g=qt(l,u,_),w=m(g);i.set(w,n[_]=Pt(w,g))}let c=l[6]<1&&Nt(l),d=l[6]<1&&l[7]&&Rt(l);return{c(){e=y("div"),t=y("div");for(let _=0;_<n.length;_+=1)n[_].c();s=j(),c&&c.c(),r=j(),d&&d.c(),S(t,"class","flex flex_clm flex_grow_1 overhide pos_abs"),S(e,"class","flex flex_grow_1 pos_rel")},m(_,g){I(_,e,g),h(e,t);for(let w=0;w<n.length;w+=1)n[w].m(t,null);h(e,s),c&&c.m(e,null),h(e,r),d&&d.m(e,null),o=!0,a||(f=[Ye(Qe.call(null,t,l[8])),ne(e,"wheel",l[10])],a=!0)},p(_,[g]){g&21&&(u=_[4],de(),n=je(n,g,m,1,_,u,i,t,Ue,Pt,null,qt),_e()),_[6]<1?c?(c.p(_,g),g&64&&E(c,1)):(c=Nt(_),c.c(),E(c,1),c.m(e,r)):c&&(de(),H(c,1,1,()=>{c=null}),_e()),_[6]<1&&_[7]?d?(d.p(_,g),g&192&&E(d,1)):(d=Rt(_),d.c(),E(d,1),d.m(e,null)):d&&(de(),H(d,1,1,()=>{d=null}),_e())},i(_){if(!o){for(let g=0;g<u.length;g+=1)E(n[g]);E(c),E(d),o=!0}},o(_){for(let g=0;g<n.length;g+=1)H(n[g]);H(c),H(d),o=!1},d(_){_&&D(e);for(let g=0;g<n.length;g+=1)n[g].d();c&&c.d(),d&&d.d(),a=!1,Te(f)}}}const Ie=54;function An(l,e,t){let n,i,s=J,r=()=>(s(),s=ul(_,P=>t(13,i=P)),_),o;l.$$.on_destroy.push(()=>s());let{app:a}=e;const{dialogMap_SetDialogList:f}=a;let{filter:u={}}=e;const m=P=>{var U;return[u.filterUnreadFirst?1:0,(U=u.filterTag)!=null?U:""].join("/")};let c={},d=null,_=Oe(null);r();function g(){const P={...u},U=m();c[U]||(c[U]=$l({fLoad:x=>(x={unread_first:P.filterUnreadFirst?1:0,...x},P.filterTag&&(x.tag=P.filterTag),g_Api.dialog_GetList(x)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:f})),d!==c[U]&&([...Object.values(c)].map(x=>x.pause()),d=c[U],d.resume(),console.log({filterHash:U}),r(t(3,_=d.getData_r())))}Ze(()=>[...Object.values(c)].map(P=>P.destroy()));let w=[];const k=Oe(null);me(l,k,P=>t(12,n=P));let p=0,v=0,T=1,b=0,L=_t(b,{duration:200});me(l,L,P=>t(2,o=P));function A(){if(!n||!i)return;const P=Math.max(1,Math.floor(n.height)),U=i.total*Ie,x=U-P;t(6,T=U?Se(0,P/U,1):1),x<0?b=0:b=v*x,at(L,o=b,o)}let M=!1;function O(){if(!n||!i)return;const P=i,U=Math.max(1,Math.floor(n.height)),x=Math.ceil(U/Ie);i.total*Ie;let F=Math.max(0,Math.floor(o/Ie)-1);const X=x+2;F>P.total&&(F=Math.max(0,P.total-X)),d&&d.setRange(F,X);const Z=[];for(let N=F,ee=0;ee<X&&N<P.total;ee++,N++){const C=P.list[N];Z.push({index:N,item:C,y:N*Ie})}t(4,w=[...new Map(Z.filter(N=>N.item).map(N=>[N.item.id,N]))].map(([N,ee])=>({dialog_id:ee.item.id,y:ee.y}))),t(7,M=F>1)}const q=P=>{if(!n||!i)return;const U=i,x=Math.max(1,Math.floor(n.height)),F=U.total*Ie-x;if(F<0)return;const X=P.deltaY>0?1:-1;t(5,p=[v+Ie/F*X])};function R(P){v=P,t(1,v)}const oe=()=>t(5,p=[0]);return l.$$set=P=>{"app"in P&&t(0,a=P.app),"filter"in P&&t(11,u=P.filter)},l.$$.update=()=>{l.$$.dirty&2048&&g(),l.$$.dirty&12290&&A(),l.$$.dirty&12294&&O()},[a,v,o,_,w,p,T,M,k,L,q,u,n,i,R,oe]}class On extends pe{constructor(e){super(),ge(this,e,An,Sn,ce,{app:0,filter:11})}}function Ft(l,e,t){const n=l.slice();return n[5]=e[t],n}function Yt(l,e){let t,n=e[5].title+"",i,s,r;function o(){return e[4](e[5])}return{key:l,first:null,c(){t=y("div"),i=W(n),S(t,"class","cursor_ptr filter_tag inactive svelte-12nwhpm"),B(t,"background",e[5].background_color),B(t,"color",e[5].color),V(t,"active",e[0]===e[5].title),this.first=t},m(a,f){I(a,t,f),h(t,i),s||(r=ne(t,"click",o),s=!0)},p(a,f){e=a,f&3&&V(t,"active",e[0]===e[5].title)},d(a){a&&D(t),s=!1,r()}}}function Dn(l){let e,t,n,i,s,r,o=[],a=new Map,f,u,m=l[1];const c=d=>d[5].title;for(let d=0;d<m.length;d+=1){let _=Ft(l,m,d),g=c(_);a.set(g,o[d]=Yt(g,_))}return{c(){e=y("div"),t=y("div"),t.textContent="Filter tag",n=j(),i=y("div"),s=y("div"),s.textContent="all",r=j();for(let d=0;d<o.length;d+=1)o[d].c();S(t,"class","flex label svelte-12nwhpm"),S(s,"class","cursor_ptr filter_tag inactive svelte-12nwhpm"),B(s,"background","#fff"),B(s,"color","#000"),V(s,"active",l[0]===null),S(i,"class","flex filter_tag_list svelte-12nwhpm"),S(e,"class","flex flex_clm cnt unselect svelte-12nwhpm")},m(d,_){I(d,e,_),h(e,t),h(e,n),h(e,i),h(i,s),h(i,r);for(let g=0;g<o.length;g+=1)o[g].m(i,null);f||(u=ne(s,"click",l[3]),f=!0)},p(d,[_]){_&1&&V(s,"active",d[0]===null),_&3&&(m=d[1],o=je(o,_,c,1,d,m,a,i,bl,Yt,null,Ft))},i:J,o:J,d(d){d&&D(e);for(let _=0;_<o.length;_+=1)o[_].d();f=!1,u()}}}function In(l,e,t){let{app:n}=e,{filterTag:i=null}=e,s=[...g_Config.pinnedTags];const r=()=>t(0,i=null),o=a=>t(0,i=a.title);return l.$$set=a=>{"app"in a&&t(2,n=a.app),"filterTag"in a&&t(0,i=a.filterTag)},[i,s,n,r,o]}class En extends pe{constructor(e){super(),ge(this,e,In,Dn,ce,{app:2,filterTag:0})}}function Bt(l,e,t){const n=l.slice();return n[9]=e[t],n}function Ut(l){let e,t;return{c(){e=y("div"),t=W(l[1]),S(e,"class","username svelte-1vzm2ij")},m(n,i){I(n,e,i),h(e,t)},p(n,i){i&2&&$(t,n[1])},d(n){n&&D(e)}}}function xt(l){let e,t;return{c(){e=y("img"),S(e,"class","a_img svelte-1vzm2ij"),Ll(e.src,t=l[9].url)||S(e,"src",t)},m(n,i){I(n,e,i)},p:J,d(n){n&&D(e)}}}function jn(l){let e,t,n,i,s,r,o=l[0]&&l[1]&&Ut(l),a=l[4],f=[];for(let u=0;u<a.length;u+=1)f[u]=xt(Bt(l,a,u));return{c(){e=y("div"),o&&o.c(),t=j();for(let u=0;u<f.length;u+=1)f[u].c();n=j(),i=y("div"),s=y("pre"),r=W(l[2]),S(s,"class","text svelte-1vzm2ij"),S(i,"class","flex"),S(e,"class","flex flex_clm chat_item pos_abs svelte-1vzm2ij"),V(e,"chat_item_other",l[0]),V(e,"chat_item_self",!l[0])},m(u,m){I(u,e,m),o&&o.m(e,null),h(e,t);for(let c=0;c<f.length;c+=1)f[c].m(e,null);h(e,n),h(e,i),h(i,s),h(s,r),l[8](e)},p(u,[m]){if(u[0]&&u[1]?o?o.p(u,m):(o=Ut(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null),m&16){a=u[4];let c;for(c=0;c<a.length;c+=1){const d=Bt(u,a,c);f[c]?f[c].p(d,m):(f[c]=xt(d),f[c].c(),f[c].m(e,n))}for(;c<f.length;c+=1)f[c].d(1);f.length=a.length}m&4&&$(r,u[2]),m&1&&V(e,"chat_item_other",u[0]),m&1&&V(e,"chat_item_self",!u[0])},i:J,o:J,d(u){u&&D(e),o&&o.d(),ml(f,u),l[8](null)}}}function Cn(l,e,t){let{incoming:n=!1}=e,{username:i=null}=e,{text:s=null}=e,{attachments:r=[]}=e,{render_Width:o=1}=e,{render_X:a=-o*2}=e,f=null;console.log(r);const u=r.filter(c=>c.file_type==="IM");function m(c){Ae[c?"unshift":"push"](()=>{f=c,t(3,f)})}return l.$$set=c=>{"incoming"in c&&t(0,n=c.incoming),"username"in c&&t(1,i=c.username),"text"in c&&t(2,s=c.text),"attachments"in c&&t(5,r=c.attachments),"render_Width"in c&&t(6,o=c.render_Width),"render_X"in c&&t(7,a=c.render_X)},[n,i,s,f,u,r,o,a,m]}class Hn extends pe{constructor(e){super(),ge(this,e,Cn,jn,ce,{incoming:0,username:1,text:2,attachments:5,render_Width:6,render_X:7})}}function Wt(l){let e;return{c(){e=y("div"),e.innerHTML=`<img src="assets/icons/status1.png" draggable="false" class="pos_abs statusIcon svelte-ofumox"/> 
		<div class="flex flex_cx flex_cy label nowrap pos_rel svelte-ofumox">in work</div>`,S(e,"class","flex flex_cx flex_cy cursor_ptr unselect statusCnt pos_rel svelte-ofumox")},m(t,n){I(t,e,n)},d(t){t&&D(e)}}}function qn(l){let e,t=l[0]&&Wt();return{c(){t&&t.c(),e=Be()},m(n,i){t&&t.m(n,i),I(n,e,i)},p(n,[i]){n[0]?t||(t=Wt(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:J,o:J,d(n){t&&t.d(n),n&&D(e)}}}function Pn(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;me(l,r,a=>t(4,i=a));let{dialog_id:o}=e;return l.$$set=a=>{"app"in a&&t(2,s=a.app),"dialog_id"in a&&t(3,o=a.dialog_id)},l.$$.update=()=>{l.$$.dirty&24&&t(0,n=i[o])},[n,r,s,o,i]}class Nn extends pe{constructor(e){super(),ge(this,e,Pn,qn,ce,{app:2,dialog_id:3})}}function zt(l,e,t){const n=l.slice();return n[20]=e[t],n}function Gt(l,e,t){const n=l.slice();return n[20]=e[t],n}function Xt(l){var d,_;let e,t,n,i=[],s=new Map,r,o,a,f,u=(_=(d=l[0])==null?void 0:d.tag)!=null?_:[];const m=g=>g[20].id;for(let g=0;g<u.length;g+=1){let w=Gt(l,u,g),k=m(w);s.set(k,i[g]=Kt(k,w))}let c=l[1]!==null&&l[0]&&l[1]===l[0].id&&l[3].length&&Vt(l);return{c(){e=y("div"),t=y("div"),t.innerHTML=`Add tag
			<div class="flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6">+</div>`,n=j();for(let g=0;g<i.length;g+=1)i[g].c();r=j(),c&&c.c(),S(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),V(t,"disabled",l[3].length===0),S(e,"class","flex tag_list unselect pos_rel svelte-elfos6")},m(g,w){I(g,e,w),h(e,t),h(e,n);for(let k=0;k<i.length;k+=1)i[k].m(e,null);h(e,r),c&&c.m(e,null),l[14](e),o=!0,a||(f=ne(t,"click",l[13]),a=!0)},p(g,w){var k,p;(!o||w&8)&&V(t,"disabled",g[3].length===0),w&325&&(u=(p=(k=g[0])==null?void 0:k.tag)!=null?p:[],de(),i=je(i,w,m,1,g,u,s,e,Ue,Kt,r,Gt),_e()),g[1]!==null&&g[0]&&g[1]===g[0].id&&g[3].length?c?(c.p(g,w),w&11&&E(c,1)):(c=Vt(g),c.c(),E(c,1),c.m(e,null)):c&&(de(),H(c,1,1,()=>{c=null}),_e())},i(g){if(!o){for(let w=0;w<u.length;w+=1)E(i[w]);E(c),o=!0}},o(g){for(let w=0;w<i.length;w+=1)H(i[w]);H(c),o=!1},d(g){g&&D(e);for(let w=0;w<i.length;w+=1)i[w].d();c&&c.d(),l[14](null),a=!1,f()}}}function Jt(l){let e,t,n;return t=new qe({}),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){I(i,e,s),ie(t,e,null),n=!0},i(i){n||(E(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){i&&D(e),se(t)}}}function Kt(l,e){let t,n=e[20].title.toLowerCase()+"",i,s,r,o,a=e[2]===e[6](e[0].id,e[20]),f,u,m,c=a&&Jt();return{key:l,first:null,c(){t=y("div"),i=W(n),s=j(),r=y("div"),r.textContent="X",o=j(),c&&c.c(),S(r,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),S(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag svelte-elfos6"),B(t,"background",e[20].background_color),B(t,"color",e[20].color),V(t,"disabled",e[2]),this.first=t},m(d,_){I(d,t,_),h(t,i),h(t,s),h(t,r),h(t,o),c&&c.m(t,null),f=!0,u||(m=ne(t,"click",function(){Ee(e[8](e[20]))&&e[8](e[20]).apply(this,arguments)}),u=!0)},p(d,_){e=d,(!f||_&1)&&n!==(n=e[20].title.toLowerCase()+"")&&$(i,n),_&5&&(a=e[2]===e[6](e[0].id,e[20])),a?c?_&5&&E(c,1):(c=Jt(),c.c(),E(c,1),c.m(t,null)):c&&(de(),H(c,1,1,()=>{c=null}),_e()),(!f||_&1)&&B(t,"background",e[20].background_color),(!f||_&1)&&B(t,"color",e[20].color),(!f||_&4)&&V(t,"disabled",e[2])},i(d){f||(E(c),f=!0)},o(d){H(c),f=!1},d(d){d&&D(t),c&&c.d(),u=!1,m()}}}function Vt(l){let e,t,n=[],i=new Map,s,r,o=l[3];const a=f=>f[20].title;for(let f=0;f<o.length;f+=1){let u=zt(l,o,f),m=a(u);i.set(m,n[f]=Qt(m,u))}return{c(){e=y("div"),t=y("div");for(let f=0;f<n.length;f+=1)n[f].c();S(t,"class","flex tagAddList1 svelte-elfos6"),B(t,"flex-wrap","wrap"),S(e,"class","pos_abs tag_settings flex flex_clm svelte-elfos6")},m(f,u){I(f,e,u),h(e,t);for(let m=0;m<n.length;m+=1)n[m].m(t,null);r=!0},p(f,u){u&205&&(o=f[3],de(),n=je(n,u,a,1,f,o,i,t,Ue,Qt,null,zt),_e())},i(f){if(!r){for(let u=0;u<o.length;u+=1)E(n[u]);f&&ke(()=>{s||(s=we(e,vt,{},!0)),s.run(1)}),r=!0}},o(f){for(let u=0;u<n.length;u+=1)H(n[u]);f&&(s||(s=we(e,vt,{},!1)),s.run(0)),r=!1},d(f){f&&D(e);for(let u=0;u<n.length;u+=1)n[u].d();f&&s&&s.end()}}}function Zt(l){let e,t,n;return t=new qe({}),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){I(i,e,s),ie(t,e,null),n=!0},i(i){n||(E(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){i&&D(e),se(t)}}}function Qt(l,e){let t,n=e[20].title+"",i,s,r,o=e[2]===e[6](e[0].id,e[20]),a,f,u,m,c=o&&Zt();return{key:l,first:null,c(){t=y("div"),i=W(n),s=y("div"),s.textContent="+",r=j(),c&&c.c(),a=j(),S(s,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),S(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),B(t,"background",e[20].background_color),B(t,"color",e[20].color),V(t,"disabled",e[2]),this.first=t},m(d,_){I(d,t,_),h(t,i),h(t,s),h(t,r),c&&c.m(t,null),h(t,a),f=!0,u||(m=ne(t,"click",function(){Ee(e[7](e[20]))&&e[7](e[20]).apply(this,arguments)}),u=!0)},p(d,_){e=d,(!f||_&8)&&n!==(n=e[20].title+"")&&$(i,n),_&13&&(o=e[2]===e[6](e[0].id,e[20])),o?c?_&13&&E(c,1):(c=Zt(),c.c(),E(c,1),c.m(t,a)):c&&(de(),H(c,1,1,()=>{c=null}),_e()),(!f||_&8)&&B(t,"background",e[20].background_color),(!f||_&8)&&B(t,"color",e[20].color),(!f||_&4)&&V(t,"disabled",e[2])},i(d){f||(E(c),f=!0)},o(d){H(c),f=!1},d(d){d&&D(t),c&&c.d(),u=!1,m()}}}function Rn(l){let e,t,n,i,s=l[0]&&Xt(l);return{c(){s&&s.c(),e=Be()},m(r,o){s&&s.m(r,o),I(r,e,o),t=!0,n||(i=[ne(window,"mousedown",l[9]),ne(window,"blure_",l[9])],n=!0)},p(r,[o]){r[0]?s?(s.p(r,o),o&1&&E(s,1)):(s=Xt(r),s.c(),E(s,1),s.m(e.parentNode,e)):s&&(de(),H(s,1,1,()=>{s=null}),_e())},i(r){t||(E(s),t=!0)},o(r){H(s),t=!1},d(r){s&&s.d(r),r&&D(e),n=!1,Te(i)}}}function Fn(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r,dialogMap_SetDialog:o}=s;me(l,r,b=>t(12,i=b));let{dialog_id:a=null}=e,f=null,u=!1;const m=async(b,L)=>{const A=await g_Api.dialog_SetTags(n.id,L);return A&&o(A),A},c=(b,L)=>{var A;return`${b}|${(A=L==null?void 0:L.title)!=null?A:"*"}`},d=b=>async L=>{if(!n||u)return;t(2,u=c(n.id,b));const A={color:"#fff",background_color:"#f00",...b,title:b.title.toLowerCase().trim()};await m(n.id,[...n.tag,A]),t(2,u=!1)},_=b=>async L=>{if(!n||u)return;t(2,u=c(n.id,b));const A=n.tag.filter(M=>M.id!==b.id).map(M=>({title:M.title,color:M.color,background_color:M.background_color}));await m(n.id,A),t(2,u=!1)};let g=[];function w(){var L;if(!n)return;const b=new Set(((L=n==null?void 0:n.tag)!=null?L:[]).map(A=>A.title));t(3,g=g_Config.pinnedTags.filter(A=>!b.has(A.title)))}let k;const p=b=>{let L=b.target;for(;L;){if(L===k)return;L=L.parentNode}t(1,f=null)},v=()=>t(1,f=n.id);function T(b){Ae[b?"unshift":"push"](()=>{k=b,t(4,k)})}return l.$$set=b=>{"app"in b&&t(10,s=b.app),"dialog_id"in b&&t(11,a=b.dialog_id)},l.$$.update=()=>{l.$$.dirty&6144&&t(0,n=i[a]),l.$$.dirty&1&&w()},[n,f,u,g,k,r,c,d,_,p,s,a,i,v,T]}class Yn extends pe{constructor(e){super(),ge(this,e,Fn,Rn,ce,{app:10,dialog_id:11})}}function $t(l){var oe,P,U,x,z,F,X,Z,N,ee;let e,t,n,i,s=((U=(P=(oe=l[2])==null?void 0:oe.lead)==null?void 0:P.first_name)!=null?U:"")+"",r,o,a,f,u,m=((F=(z=(x=l[2])==null?void 0:x.lead)==null?void 0:z.last_name)!=null?F:"")+"",c,d,_,g,w,k,p,v,T,b,L,A,M,O,q=((Z=(X=l[2])==null?void 0:X.lead)==null?void 0:Z.username)&&el(l),R=((ee=(N=l[2])==null?void 0:N.lead)==null?void 0:ee.ref_link)&&tl(l);return p=new Nn({props:{app:l[0],dialog_id:l[2].id}}),L=new Yn({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=y("div"),t=y("div"),n=j(),i=y("div"),r=W(s),o=j(),a=y("div"),f=j(),u=y("div"),c=W(m),d=j(),_=y("div"),q&&q.c(),g=j(),R&&R.c(),w=j(),k=y("div"),re(p.$$.fragment),v=j(),T=y("div"),b=j(),re(L.$$.fragment),A=j(),M=y("div"),B(t,"width","8px"),B(a,"width","8px"),S(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),S(_,"class","nowrap textOverEllipsis username svelte-qywc37"),B(T,"width","4px"),S(k,"class","flex"),B(M,"height","4px")},m(C,G){I(C,e,G),h(e,t),h(e,n),h(e,i),h(i,r),h(e,o),h(e,a),h(e,f),h(e,u),h(u,c),I(C,d,G),I(C,_,G),q&&q.m(_,null),I(C,g,G),R&&R.m(C,G),I(C,w,G),I(C,k,G),ie(p,k,null),h(k,v),h(k,T),h(k,b),ie(L,k,null),I(C,A,G),I(C,M,G),O=!0},p(C,G){var Y,K,ue,he,ae,le,ye,De,Q,ve;(!O||G&4)&&s!==(s=((ue=(K=(Y=C[2])==null?void 0:Y.lead)==null?void 0:K.first_name)!=null?ue:"")+"")&&$(r,s),(!O||G&4)&&m!==(m=((le=(ae=(he=C[2])==null?void 0:he.lead)==null?void 0:ae.last_name)!=null?le:"")+"")&&$(c,m),(De=(ye=C[2])==null?void 0:ye.lead)!=null&&De.username?q?q.p(C,G):(q=el(C),q.c(),q.m(_,null)):q&&(q.d(1),q=null),(ve=(Q=C[2])==null?void 0:Q.lead)!=null&&ve.ref_link?R?R.p(C,G):(R=tl(C),R.c(),R.m(w.parentNode,w)):R&&(R.d(1),R=null);const te={};G&1&&(te.app=C[0]),G&4&&(te.dialog_id=C[2].id),p.$set(te);const fe={};G&1&&(fe.app=C[0]),G&4&&(fe.dialog_id=C[2].id),L.$set(fe)},i(C){O||(E(p.$$.fragment,C),E(L.$$.fragment,C),O=!0)},o(C){H(p.$$.fragment,C),H(L.$$.fragment,C),O=!1},d(C){C&&D(e),C&&D(d),C&&D(_),q&&q.d(),C&&D(g),R&&R.d(C),C&&D(w),C&&D(k),se(p),se(L),C&&D(A),C&&D(M)}}}function el(l){let e,t=l[2].lead.username+"",n;return{c(){e=W("@"),n=W(t)},m(i,s){I(i,e,s),I(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&$(n,t)},d(i){i&&D(e),i&&D(n)}}}function tl(l){var m,c;let e,t,n,i,s=((c=(m=l[2])==null?void 0:m.lead)==null?void 0:c.ref_link)+"",r,o,a,f,u;return{c(){e=y("div"),t=y("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=j(),i=y("div"),r=W(s),o=j(),a=y("div"),S(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),S(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),S(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),B(a,"height","4px")},m(d,_){I(d,e,_),h(e,t),h(e,n),h(e,i),h(i,r),I(d,o,_),I(d,a,_),f||(u=ne(e,"click",l[6]),f=!0)},p(d,_){var g,w;_&4&&s!==(s=((w=(g=d[2])==null?void 0:g.lead)==null?void 0:w.ref_link)+"")&&$(r,s)},d(d){d&&D(e),d&&D(o),d&&D(a),f=!1,u()}}}function ll(l){let e,t,n,i;return t=new qe({}),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_abs loading svelte-qywc37")},m(s,r){I(s,e,r),ie(t,e,null),i=!0},i(s){i||(E(t.$$.fragment,s),s&&ke(()=>{n||(n=we(e,Le,{},!0)),n.run(1)}),i=!0)},o(s){H(t.$$.fragment,s),s&&(n||(n=we(e,Le,{},!1)),n.run(0)),i=!1},d(s){s&&D(e),se(t),s&&n&&n.end()}}}function Bn(l){let e,t,n,i,s=l[2]&&$t(l),r=l[1]&&ll();return{c(){e=y("div"),t=y("div"),s&&s.c(),n=j(),r&&r.c(),S(t,"class","flex flex_clm flex_cx flex_grow_1"),S(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,a){I(o,e,a),h(e,t),s&&s.m(t,null),h(e,n),r&&r.m(e,null),i=!0},p(o,[a]){o[2]?s?(s.p(o,a),a&4&&E(s,1)):(s=$t(o),s.c(),E(s,1),s.m(t,null)):s&&(de(),H(s,1,1,()=>{s=null}),_e()),o[1]?r?a&2&&E(r,1):(r=ll(),r.c(),E(r,1),r.m(e,null)):r&&(de(),H(r,1,1,()=>{r=null}),_e())},i(o){i||(E(s),E(r),i=!0)},o(o){H(s),H(r),i=!1},d(o){o&&D(e),s&&s.d(),r&&r.d()}}}function Un(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;me(l,r,u=>t(5,i=u));let{dialog_id:o=null}=e,{loading:a=!1}=e;const f=()=>{var u;return en((u=n==null?void 0:n.lead)==null?void 0:u.ref_link)};return l.$$set=u=>{"app"in u&&t(0,s=u.app),"dialog_id"in u&&t(4,o=u.dialog_id),"loading"in u&&t(1,a=u.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,a,n,r,o,i,f]}class xn extends pe{constructor(e){super(),ge(this,e,Un,Bn,ce,{app:0,dialog_id:4,loading:1})}}function nl(l,e,t){const n=l.slice();return n[36]=e[t],n}function il(l,e){var s,r,o,a,f,u,m,c;let t,n,i;return n=new Hn({props:{render_Width:e[9],incoming:(s=e[36])==null?void 0:s.incoming,username:(a=(o=(r=e[2])==null?void 0:r.lead)==null?void 0:o.username)!=null?a:"",text:(u=(f=e[36])==null?void 0:f.text)!=null?u:"",attachments:(c=(m=e[36])==null?void 0:m.attachments)!=null?c:""}}),{key:l,first:null,c(){t=Be(),re(n.$$.fragment),this.first=t},m(d,_){I(d,t,_),ie(n,d,_),i=!0},p(d,_){var w,k,p,v,T,b,L,A;e=d;const g={};_[0]&512&&(g.render_Width=e[9]),_[0]&8&&(g.incoming=(w=e[36])==null?void 0:w.incoming),_[0]&4&&(g.username=(v=(p=(k=e[2])==null?void 0:k.lead)==null?void 0:p.username)!=null?v:""),_[0]&8&&(g.text=(b=(T=e[36])==null?void 0:T.text)!=null?b:""),_[0]&8&&(g.attachments=(A=(L=e[36])==null?void 0:L.attachments)!=null?A:""),n.$set(g)},i(d){i||(E(n.$$.fragment,d),i=!0)},o(d){H(n.$$.fragment,d),i=!1},d(d){d&&D(t),se(n,d)}}}function Wn(l){let e,t,n,i,s,r,o,a=[],f=new Map,u,m,c,d,_,g,w,k,p,v;t=new xn({props:{app:l[0],dialog_id:l[1],loading:l[4]}});let T=l[3];const b=M=>M[36].index;for(let M=0;M<T.length;M+=1){let O=nl(l,T,M),q=b(O);f.set(q,a[M]=il(q,O))}function L(M){l[16](M)}let A={value_in:l[5]};return l[6]!==void 0&&(A.value_out=l[6]),c=new kl({props:A}),Ae.push(()=>ut(c,"value_out",L)),{c(){e=y("div"),re(t.$$.fragment),n=j(),i=y("div"),s=y("div"),r=y("div"),o=y("div");for(let M=0;M<a.length;M+=1)a[M].c();u=j(),m=y("div"),re(c.$$.fragment),_=j(),g=y("div"),w=y("textarea"),S(o,"class","pos_rel w100 h100"),S(m,"class","pos_abs h100 chatScroll svelte-13uz7b1"),S(r,"class","pos_rel w100 h100"),S(s,"class","flex pos_abs overhide"),S(i,"class","flex flex_grow_1 pos_rel overhide"),S(w,"class","flex flex_grow_1 chat_input_textarea svelte-13uz7b1"),S(g,"class","flex chat_input svelte-13uz7b1"),S(e,"class","flex flex_clm flex_grow_1 overhide")},m(M,O){I(M,e,O),ie(t,e,null),h(e,n),h(e,i),h(i,s),h(s,r),h(r,o);for(let q=0;q<a.length;q+=1)a[q].m(o,null);l[15](o),h(r,u),h(r,m),ie(c,m,null),h(e,_),h(e,g),h(g,w),mt(w,l[8]),k=!0,p||(v=[ne(r,"wheel",l[13]),Ye(Qe.call(null,s,l[11])),ne(w,"input",l[17]),ne(w,"keyup",l[12])],p=!0)},p(M,O){const q={};O[0]&1&&(q.app=M[0]),O[0]&2&&(q.dialog_id=M[1]),O[0]&16&&(q.loading=M[4]),t.$set(q),O[0]&524&&(T=M[3],de(),a=je(a,O,b,1,M,T,f,o,Ue,il,null,nl),_e());const R={};O[0]&32&&(R.value_in=M[5]),!d&&O[0]&64&&(d=!0,R.value_out=M[6],ct(()=>d=!1)),c.$set(R),O[0]&256&&mt(w,M[8])},i(M){if(!k){E(t.$$.fragment,M);for(let O=0;O<T.length;O+=1)E(a[O]);E(c.$$.fragment,M),k=!0}},o(M){H(t.$$.fragment,M);for(let O=0;O<a.length;O+=1)H(a[O]);H(c.$$.fragment,M),k=!1},d(M){M&&D(e),se(t);for(let O=0;O<a.length;O+=1)a[O].d();l[15](null),se(c),p=!1,Te(v)}}}const sl=10,Ge=4;async function rl(l){try{await g_Api("POST",`dialogs/${l}/read`)}catch(e){console.log(e.message)}}function zn(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;me(l,o,N=>t(14,i=N));let{dialog_id:a=null}=e,f=[],u=[],m=new Set,c=0,d=0,_=1,g=1,w=null;const k=Oe(null);me(l,k,N=>t(26,s=N)),new Date().toJSON();let p=-1;async function v(N,ee=0,C=20){const G=await g_Api.message_GetList({dialog_id:N,offset:ee,limit:C});if(!!G&&n&&n.id===N){for(c=G.count;f.length<c;){const fe=f.length;f.push({id:p--,index:fe,_isFakeMsg:!0})}const te=G.results;te.map((fe,Y)=>fe.index=ee+Y),te.map(fe=>f[fe.index]=fe)}}let T="";const b=async N=>{if(N.which===13&&(t(8,T=T.trim()),T)){const ee=T;t(8,T=""),n&&await g_Api.message_Create(n.id,ee)}};function L(){f=[],t(3,u=[]),m=new Set,c=0,console.log("clear all")}let A=null,M=null;async function O(N){if(!N){if(!A)return;A=null,L();return}M!==N.id&&(A=N,M=N.id,L(),f=[],t(3,u=[]),c=0,t(4,d++,d),await v(N.id),c&&await v(N.id,Math.max(c-20,0),20),await rl(N.id),t(4,d--,d))}let q=1,R=!0;function oe(){if(R&&requestAnimationFrame(oe),!s||!w||!f.length)return;s.width;const N=s.height,ee=s.width-sl*2,C=sl;t(9,q=Math.floor(ee*.9));const G=1+g*(f.length-1);let te=Math.floor(G),fe=G-te;te>=f.length&&(te=f.length-1,fe=1);const Y=[],K=[];let ue=null;t(3,u=[]);for(let ae=te-22,le=0,ye=!0;ae<te+2;ae++)ae<0||ae>=f.length||(f[ae]._isFakeMsg&&m.add(ae),u[le]!==f[ae]&&(ye&&(ye=!1,u.splice(le,1e9)),t(3,u[le]=f[ae],u),t(3,u)),t(3,u[le]._drawIndex=le,u),ae<te&&Y.push(u[le]),ae>te&&K.push(u[le]),ae===te&&(ue=u[le]),le++);const he=[...w.children];if(he.length===u.length){he.map((Q,ve)=>{const be=u[ve];if(!be||Q._remove)return;const xe=Q.getBoundingClientRect();Q._bbox=xe;const $e=Math.floor(C+(be.incoming?0:s.width*.05));Q.__cacheWidth!==q&&(Q.__cacheWidth=q,Q.style.width=q+"px"),Q.__cacheLeft!==$e&&(Q.__cacheLeft=$e,Q.style.left=$e+"px")});const ae=(Q,ve,be=1)=>(Q.__cacheTop!==ve&&(Q.__cacheTop=ve,Q.style.top=ve+"px"),ve+(Q._bbox.height+Ge)*be);let le=0,ye=0;const De=he[ue._drawIndex];if(De){const Q=De;le=N+Ge-(Q._bbox.height+Ge)*fe,ye=le,le=ae(Q,le,1)}K.map((Q,ve)=>{const be=he[Q._drawIndex];le=ae(be,le,1)}),le=ye,Y.reverse().map((Q,ve)=>{const be=he[Q._drawIndex];le-=be._bbox.height+Ge,ae(be,le,0)})}}requestAnimationFrame(oe),Ze(()=>R=!1);async function P(){if(m.size){const N=[...m].sort((G,te)=>G-te);m.clear();const ee=[];let C={offset:null,limit:0};for(const G of N){if(C.offset!==null){if(C.limit<=500&&C.offset+C.limit===G){C.limit++;continue}ee.push(C)}C={offset:G,limit:1}}C.offset!==null&&ee.push(C),n&&(t(4,d++,d),await Promise.all(ee.map(G=>v(n.id,G.offset,G.limit))),t(4,d--,d))}R&&setTimeout(P,500)}P();async function U(){n&&await rl(n.id),R&&setTimeout(U,5e3)}U();async function x(){n&&await v(n.id,c,20),R&&setTimeout(x,500)}x();const z=N=>{t(5,_=f.length?g+Math.sign(N.deltaY)/(f.length-1):0)};function F(N){Ae[N?"unshift":"push"](()=>{w=N,t(7,w)})}function X(N){g=N,t(6,g)}function Z(){T=this.value,t(8,T)}return l.$$set=N=>{"app"in N&&t(0,r=N.app),"dialog_id"in N&&t(1,a=N.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&16386&&t(2,n=i[a]),l.$$.dirty[0]&4&&O(n)},[r,a,n,u,d,_,g,w,T,q,o,k,b,z,i,F,X,Z]}class Gn extends pe{constructor(e){super(),ge(this,e,zn,Wn,ce,{app:0,dialog_id:1},null,[-1,-1])}}function Xn(l){let e,t,n,i,s,r,o,a,f,u,m,c,d,_,g,w;function k(v){l[6](v)}let p={app:l[0]};return l[1]!==void 0&&(p.filterTag=l[1]),a=new En({props:p}),Ae.push(()=>ut(a,"filterTag",k)),m=new On({props:{app:l[0],filter:{filterTag:l[1],filterUnreadFirst:l[2]}}}),d=new Gn({props:{app:l[0],dialog_id:l[3]}}),{c(){e=y("div"),t=y("div"),n=y("div"),i=y("button"),s=W("UF:"),r=W(l[2]),o=j(),re(a.$$.fragment),u=j(),re(m.$$.fragment),c=j(),re(d.$$.fragment),S(i,"class","pos_abs cursor_ptr"),B(i,"right","1px"),B(i,"background","#484848"),B(i,"color","#000"),S(n,"class","flex flex_cx flex_cy header pos_rel svelte-b47b5y"),S(t,"class","flex flex_clm list svelte-b47b5y"),S(e,"class","flex flex_grow_1")},m(v,T){I(v,e,T),h(e,t),h(t,n),h(n,i),h(i,s),h(i,r),h(t,o),ie(a,t,null),h(t,u),ie(m,t,null),h(e,c),ie(d,e,null),_=!0,g||(w=ne(i,"click",l[5]),g=!0)},p(v,[T]){(!_||T&4)&&$(r,v[2]);const b={};T&1&&(b.app=v[0]),!f&&T&2&&(f=!0,b.filterTag=v[1],ct(()=>f=!1)),a.$set(b);const L={};T&1&&(L.app=v[0]),T&6&&(L.filter={filterTag:v[1],filterUnreadFirst:v[2]}),m.$set(L);const A={};T&1&&(A.app=v[0]),T&8&&(A.dialog_id=v[3]),d.$set(A)},i(v){_||(E(a.$$.fragment,v),E(m.$$.fragment,v),E(d.$$.fragment,v),_=!0)},o(v){H(a.$$.fragment,v),H(m.$$.fragment,v),H(d.$$.fragment,v),_=!1},d(v){v&&D(e),se(a),se(m),se(d),g=!1,w()}}}function Jn(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;me(l,s,u=>t(3,n=u));let r=null,o=1;const a=()=>t(2,o^=1);function f(u){r=u,t(1,r)}return l.$$set=u=>{"app"in u&&t(0,i=u.app)},[i,r,o,n,s,a,f]}class Kn extends pe{constructor(e){super(),ge(this,e,Jn,Xn,ce,{app:0})}}function Vn(l){let e,t,n,i,s,r,o,a;return n=new cn({props:{app:l[0]}}),s=new hn({props:{app:l[0]}}),o=new Kn({props:{app:l[0]}}),{c(){e=y("div"),t=y("div"),re(n.$$.fragment),i=j(),re(s.$$.fragment),r=j(),re(o.$$.fragment),S(t,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),S(e,"class","flex w100 h100 pos_rel")},m(f,u){I(f,e,u),h(e,t),ie(n,t,null),h(t,i),ie(s,t,null),h(e,r),ie(o,e,null),a=!0},p:J,i(f){a||(E(n.$$.fragment,f),E(s.$$.fragment,f),E(o.$$.fragment,f),a=!0)},o(f){H(n.$$.fragment,f),H(s.$$.fragment,f),H(o.$$.fragment,f),a=!1},d(f){f&&D(e),se(n),se(s),se(o)}}}function Zn(l,e,t){let{app:n}=e;const i=n;return l.$$set=s=>{"app"in s&&t(1,n=s.app)},[i,n]}class Qn extends pe{constructor(e){super(),ge(this,e,Zn,Vn,ce,{app:1})}}function ol(l,e,t){const n=l.slice();return n[5]=e[t],n}function $n(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=fl(ol(l,n,r));const s=r=>H(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Be()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);I(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let a;for(a=0;a<n.length;a+=1){const f=ol(r,n,a);i[a]?(i[a].p(f,o),E(i[a],1)):(i[a]=fl(f),i[a].c(),E(i[a],1),i[a].m(e.parentNode,e))}for(de(),a=n.length;a<i.length;a+=1)s(a);_e()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)E(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)H(i[o]);t=!1},d(r){ml(i,r),r&&D(e)}}}function ei(l){let e,t,n,i,s;return i=new qe({}),{c(){e=y("div"),t=y("div"),n=j(),re(i.$$.fragment),B(t,"height","20px"),S(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){I(r,e,o),h(e,t),h(e,n),ie(i,e,null),s=!0},p:J,i(r){s||(E(i.$$.fragment,r),s=!0)},o(r){H(i.$$.fragment,r),s=!1},d(r){r&&D(e),se(i)}}}function al(l){let e,t,n=l[5].username+"",i;return{c(){e=y("div"),t=W("@"),i=W(n),S(e,"class","nowrap textOverEllipsis")},m(s,r){I(s,e,r),h(e,t),h(e,i)},p(s,r){r&1&&n!==(n=s[5].username+"")&&$(i,n)},d(s){s&&D(e)}}}function fl(l){var v,T;let e,t,n,i=((v=l[5].first_name)!=null?v:"")+"",s,r,o,a,f,u=((T=l[5].last_name)!=null?T:"")+"",m,c,d,_,g,w,k,p=l[5].username&&al(l);return{c(){e=y("div"),t=y("div"),n=y("div"),s=W(i),r=j(),o=y("div"),a=j(),f=y("div"),m=W(u),c=j(),p&&p.c(),d=j(),B(o,"width","8px"),S(t,"class","flex nowrap textOverEllipsis"),S(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(b,L){I(b,e,L),h(e,t),h(t,n),h(n,s),h(t,r),h(t,o),h(t,a),h(t,f),h(f,m),h(e,c),p&&p.m(e,null),h(e,d),g=!0,w||(k=ne(e,"click",function(){Ee(l[2](l[5]))&&l[2](l[5]).apply(this,arguments)}),w=!0)},p(b,L){var A,M;l=b,(!g||L&1)&&i!==(i=((A=l[5].first_name)!=null?A:"")+"")&&$(s,i),(!g||L&1)&&u!==(u=((M=l[5].last_name)!=null?M:"")+"")&&$(m,u),l[5].username?p?p.p(l,L):(p=al(l),p.c(),p.m(e,d)):p&&(p.d(1),p=null)},i(b){g||(b&&ke(()=>{_||(_=we(e,Le,{},!0)),_.run(1)}),g=!0)},o(b){b&&(_||(_=we(e,Le,{},!1)),_.run(0)),g=!1},d(b){b&&D(e),p&&p.d(),b&&_&&_.end(),w=!1,k()}}}function ti(l){let e,t,n,i;const s=[ei,$n],r=[];function o(a,f){return a[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=y("div"),n.c(),S(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){I(a,e,f),r[t].m(e,null),i=!0},p(a,[f]){let u=t;t=o(a),t===u?r[t].p(a,f):(de(),H(r[u],1,1,()=>{r[u]=null}),_e(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),E(n,1),n.m(e,null))},i(a){i||(E(n),i=!0)},o(a){H(n),i=!1},d(a){a&&D(e),r[t].d()}}}function li(l,e,t){let n=[],i=!1;const s=async()=>{var a;t(1,i=!0),t(0,n=[]);try{const f=await g_Api("GET","operators");t(0,n=(a=f.results)!=null?a:[])}catch{}t(1,i=!1)};let r=!1;const o=a=>f=>{r||(wl(a),r=!0)};return s(),[n,i,o]}class ni extends pe{constructor(e){super(),ge(this,e,li,ti,ce,{})}}function ii(l){let e,t,n,i,s;return t=new Qn({props:{app:l[1]}}),{c(){e=y("div"),re(t.$$.fragment),S(e,"class","pos_rel flex")},m(r,o){I(r,e,o),ie(t,e,null),n=!0,i||(s=Ye(Qe.call(null,e)),i=!0)},p(r,o){const a={};o&2&&(a.app=r[1]),t.$set(a)},i(r){n||(E(t.$$.fragment,r),n=!0)},o(r){H(t.$$.fragment,r),n=!1},d(r){r&&D(e),se(t),i=!1,s()}}}function si(l){let e,t,n,i,s;return e=new Gl({props:{select:"operators"}}),i=new ni({}),{c(){re(e.$$.fragment),t=j(),n=y("div"),re(i.$$.fragment),S(n,"class","flex")},m(r,o){ie(e,r,o),I(r,t,o),I(r,n,o),ie(i,n,null),s=!0},p:J,i(r){s||(E(e.$$.fragment,r),E(i.$$.fragment,r),s=!0)},o(r){H(e.$$.fragment,r),H(i.$$.fragment,r),s=!1},d(r){se(e,r),r&&D(t),r&&D(n),se(i)}}}function ri(l){let e,t,n,i,s,r;const o=[si,ii],a=[];function f(u,m){return u[0]?1:0}return t=f(l),n=a[t]=o[t](l),s=new Jl({}),{c(){e=y("main"),n.c(),i=j(),re(s.$$.fragment),S(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-116f09r")},m(u,m){I(u,e,m),a[t].m(e,null),h(e,i),ie(s,e,null),r=!0},p(u,[m]){let c=t;t=f(u),t===c?a[t].p(u,m):(de(),H(a[c],1,1,()=>{a[c]=null}),_e(),n=a[t],n?n.p(u,m):(n=a[t]=o[t](u),n.c()),E(n,1),n.m(e,i))},i(u){r||(E(n),E(s.$$.fragment,u),r=!0)},o(u){H(n),H(s.$$.fragment,u),r=!1},d(u){u&&D(e),a[t].d(),se(s)}}}function oi(){const l=r=>new Promise(o=>setTimeout(o,r)),t=(()=>{const r=()=>l(1500+(Math.random()*200|0)),o={id:1};let a=0;const f={tg_id:123123124,username:"123124123",first_name:"test",last_name:"ewr",date_joined:"2022-10-27T13:48:51.054781Z",esub:"123123",pub_id:"2312",refcode:"123123",subpub:"23123",hasOperator:!1,ref_link:"https://ref.global.com/getRef?tg_id=1232132"};let u=[];const m=b=>u.find(L=>String(L.tg_id)===String(b)),c=()=>{const b={...f};b.tg_id+=a,b.first_name+=" "+a,b.last_name+=" "+a,b.date_joined=new Date().toJSON(),b.username=[b.first_name,b.last_name].map(L=>L.trim()).filter(Boolean).join(" ").replace(/\s/g,"_"),a++,u.push(b)},d=()=>[...u],_=()=>d().filter(b=>!b.hasOperator),g=(b,L)=>{var R;const A=L.offset|0,M=Math.max(1,Math.min(1e6,((R=L.limit)!=null?R:20)|0)),O=b.length,q=b.slice(A).slice(0,M);return{count:O,results:q}},w={},k={};let p=1,v=1;const T=b=>(b!=null?b:[]).map(L=>({...L,id:v++}));return Array(1e4).fill().map(c),setInterval(()=>{},2400),setInterval(()=>{},3e3),setInterval(()=>{const b=Object.keys(k),L=b[b.length*Math.random()|0],A=k[L];if(A){const M=A.length?0:10;for(let O=0;O<M;O++)A.push({id:p++,dialog:L,text:Math.random()<.5?"Hi. And short message "+(p-1)+" ...":"Hi. And long message "+(p-1)+" ..."+`
 Long!`.repeat(20),is_read:!1,incoming:!0,received_at:new Date().toJSON()})}},1e3),async(b,L,A={})=>{var M,O,q,R,oe,P,U,x;if(await r(),b==="GET"&&L==="operators")return{results:[{username:"stan18k",first_name:"Stanislav",last_name:"Kulakov"},{username:"dmodev",first_name:"Demon",last_name:"Dev"},{username:"idandrey",first_name:"Andrey",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer ".repeat(1e3),first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer",first_name:"YEHA",last_name:""},{username:"eveascigarettesnbeer ".repeat(1e3),first_name:"YEHA ".repeat(1e3),last_name:"D sf  ".repeat(1e3)}]};if(b==="GET"&&L==="leads/unassigned")return g(_(),A);if(b==="POST"&&/leads\/\d+\/assign/.test(L)){const z=(M=L.match(/leads\/(\d+)\/assign/))==null?void 0:M[1],F=n["x-username"];if(!z||!F)return!1;const X=m(z);if(!X||X.hasOperator)return!1;X.hasOperator=!0,o.id++;const Z={...o,lead_id:z,lead:X,operator:F,tag:T([g_Config.pinnedTags[0]])};return w[F]=(O=w[F])!=null?O:[],w[F].push(Z),k[Z.id]=[],!0}if(b==="GET"&&L==="dialogs"){let z=[...(q=w[n["x-username"]])!=null?q:[]].map(F=>({...F,lead:m(F.lead_id)}));return A.tag&&(z=z.filter(F=>F.tag.map(X=>X.title).includes(A.tag))),g(z,A)}if(b==="PATCH"&&/dialogs\/\d+/.test(L)){const z=((oe=(R=L.match(/dialogs\/(\d+)/))==null?void 0:R[1])!=null?oe:-1)|0,F=n["x-username"],Z=((P=w[F])!=null?P:[]).find(N=>N.id===z);return Z&&A.tag&&(Z.tag=T(A.tag)),Z}if(b==="GET"&&L==="messages"){const z=k[A.dialog_id]=(U=k[A.dialog_id])!=null?U:[];return g(z,A)}if(b==="POST"&&L==="messages")return k[A.dialog]=(x=k[A.dialog])!=null?x:[],k[A.dialog].push({id:p++,dialog:A.dialog,text:A.text,is_read:!!A.is_read,incoming:!1,received_at:new Date().toJSON()}),!0}})(),n={"Content-Type":"application/json"},i=async(r,o,a={},f=0)=>{var p,v,T;if(!location.hash.match(/real\-api/)){const b=await t(r,o,a);if(f===0)return b;if(f===1)return{status:200,json:()=>b}}const m=g_Config.api,c=(p=m.protocol)!=null?p:location.protocol,d=(v=m.host)!=null?v:location.host,_=(T=m.path_base)!=null?T:"/",g=new URL(`${c}//${d}/${_}`);r==="GET"&&Object.entries(a).map(([b,L])=>g.searchParams.append(b,L)),g.pathname=[g.pathname,o].join("/").split("/").filter(Boolean).concat(" ").join("/").trim();let w;(r==="POST"||r==="PATCH")&&(w=JSON.stringify(a));const k=await fetch(g,{method:r,headers:n,body:w});if(f===0)return await k.json();if(f===1)return k},s=r=>{var a,f,u;const o=(u=(a=r==null?void 0:r.last_message)==null?void 0:a.received_at)!=null?u:(f=r==null?void 0:r.lead)==null?void 0:f.date_joined;return{...r,_lastTime:o?+new Date(o):null}};return i.message_GetList=async r=>{try{const o=await g_Api("GET","messages",r,1);if(o.status===200)return await o.json()}catch(o){console.error(o.message)}},i.message_Create=async(r,o)=>{try{const a=await g_Api("POST","messages",{dialog:r,text:o,is_read:!0},1);if(a.status===200)return await a.json()}catch(a){console.error(a.message)}return null},i.dialog_SetTags=async(r,o)=>{try{const a=await g_Api("PATCH",`dialogs/${r}`,{tag:o},1);if(console.log(await a.json()),a.status===200)return await a.json()}catch(a){console.error(a.message)}return null},i.dialog_GetList=async r=>{try{const o=await g_Api("GET","dialogs",r,1);if(o.status===200){const a=await o.json();return a.results=a.results.map(s),a}}catch(o){console.error(o.message)}return null},i.lead_GetUnassignedList=async r=>{try{const o=await g_Api("GET","leads/unassigned",r,1);if(o.status===200)return await o.json()}catch(o){console.error(o.message)}return null},i.lead_AssignOperatorSelft=async r=>{try{const o=await g_Api("POST",`leads/${r}/assign`,{},1),a=await o.json();if(o.status===200)return!0;if(o.status===400)return!1}catch(o){console.error(o.message)}return null},i.setHeader=(r,o)=>{n[r]=o,o==null&&delete n[r]},i}function ai(l,e,t){let n;me(l,dt,r=>t(0,n=r));let i=null;function s(r){r&&(t(1,i=xl(r)),console.log(i))}return globalThis.g_Api=oi(),l.$$.update=()=>{l.$$.dirty&1&&s(n)},[n,i]}class fi extends pe{constructor(e){super(),ge(this,e,ai,ri,ce,{})}}new fi({target:document.getElementById("app")});
