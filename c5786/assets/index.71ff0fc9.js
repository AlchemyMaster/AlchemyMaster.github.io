(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ae(){}const Pt=l=>l;function Xt(l,e){for(const t in e)l[t]=e[t];return l}function nn(l){return l()}function Kt(){return Object.create(null)}function je(l){l.forEach(nn)}function Pe(l){return typeof l=="function"}function he(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let ct;function Xe(l,e){return ct||(ct=document.createElement("a")),ct.href=e,l===ct.href}function kn(l){return Object.keys(l).length===0}function zt(l,...e){if(l==null)return ae;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Le(l,e,t){l.$$.on_destroy.push(zt(e,t))}function Be(l,e,t){return l.set(t),e}function $e(l){return l&&Pe(l.destroy)?l.destroy:ae}const sn=typeof window<"u";let rn=sn?()=>window.performance.now():()=>Date.now(),Ft=sn?l=>requestAnimationFrame(l):ae;const Qe=new Set;function on(l){Qe.forEach(e=>{e.c(l)||(Qe.delete(e),e.f())}),Qe.size!==0&&Ft(on)}function an(l){let e;return Qe.size===0&&Ft(on),{promise:new Promise(t=>{Qe.add(e={c:l,f:t})}),abort(){Qe.delete(e)}}}function g(l,e){l.appendChild(e)}function Sn(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function Ln(l,e){return g(l.head||l,e),e.sheet}function F(l,e,t){l.insertBefore(e,t||null)}function P(l){l.parentNode.removeChild(l)}function kt(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function y(l){return document.createElement(l)}function Ne(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function se(l){return document.createTextNode(l)}function E(){return se(" ")}function Ue(){return se("")}function le(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function v(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Mn(l){return Array.from(l.childNodes)}function pe(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function Zt(l,e){l.value=e==null?"":e}function N(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function ne(l,e,t){l.classList[t?"add":"remove"](e)}function fn(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const pt=new Map;let ht=0;function Tn(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function In(l){const e={style_element:y("style"),rules:{}};return pt.set(l,e),e}function Qt(l,e,t,n,i,s,r,o=0){const a=16.666/n;let f=`{
`;for(let b=0;b<=1;b+=a){const k=e+(t-e)*s(b);f+=b*100+`%{${r(k,1-k)}}
`}const c=f+`100% {${r(t,1-t)}}
}`,p=`__svelte_${Tn(c)}_${o}`,_=Sn(l),{style_element:u,rules:d}=pt.get(_)||In(_);if(!d[p]){const b=Ln(_,u);d[p]=!0,b.insertRule(`@keyframes ${p} ${c}`,b.cssRules.length)}const m=l.style.animation||"";return l.style.animation=`${m?`${m}, `:""}${p} ${n}ms linear ${i}ms 1 both`,ht+=1,p}function Dn(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),ht-=i,ht||On())}function On(){Ft(()=>{ht||(pt.forEach(l=>{const{style_element:e}=l;P(e)}),pt.clear())})}let it;function nt(l){it=l}function Ht(){if(!it)throw new Error("Function called outside component initialization");return it}function Cn(l){Ht().$$.on_mount.push(l)}function Fe(l){Ht().$$.on_destroy.push(l)}function En(){const l=Ht();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=fn(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function jn(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const lt=[],xe=[],gt=[],Ct=[],An=Promise.resolve();let Et=!1;function xn(){Et||(Et=!0,An.then(cn))}function Ee(l){gt.push(l)}function vt(l){Ct.push(l)}const Mt=new Set;let ut=0;function cn(){const l=it;do{for(;ut<lt.length;){const e=lt[ut];ut++,nt(e),Nn(e.$$)}for(nt(null),lt.length=0,ut=0;xe.length;)xe.pop()();for(let e=0;e<gt.length;e+=1){const t=gt[e];Mt.has(t)||(Mt.add(t),t())}gt.length=0}while(lt.length);for(;Ct.length;)Ct.pop()();Et=!1,Mt.clear(),nt(l)}function Nn(l){if(l.fragment!==null){l.update(),je(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Ee)}}let tt;function Pn(){return tt||(tt=Promise.resolve(),tt.then(()=>{tt=null})),tt}function Tt(l,e,t){l.dispatchEvent(fn(`${e?"intro":"outro"}${t}`))}const mt=new Set;let Re;function be(){Re={r:0,c:[],p:Re}}function we(){Re.r||je(Re.c),Re=Re.p}function x(l,e){l&&l.i&&(mt.delete(l),l.i(e))}function R(l,e,t,n){if(l&&l.o){if(mt.has(l))return;mt.add(l),Re.c.push(()=>{mt.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const zn={duration:0};function Me(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,a=null;function f(){a&&Dn(l,a)}function c(_,u){const d=_.b-s;return u*=Math.abs(d),{a:s,b:_.b,d,duration:u,start:_.start,end:_.start+u,group:_.group}}function p(_){const{delay:u=0,duration:d=300,easing:m=Pt,tick:b=ae,css:k}=i||zn,h={start:rn()+u,b:_};_||(h.group=Re,Re.r+=1),r||o?o=h:(k&&(f(),a=Qt(l,s,_,d,u,m,k)),_&&b(0,1),r=c(h,d),Ee(()=>Tt(l,_,"start")),an(S=>{if(o&&S>o.start&&(r=c(o,d),o=null,Tt(l,r.b,"start"),k&&(f(),a=Qt(l,s,r.b,r.duration,0,m,i.css))),r){if(S>=r.end)b(s=r.b,1-s),Tt(l,r.b,"end"),o||(r.b?f():--r.group.r||je(r.group.c)),r=null;else if(S>=r.start){const M=S-r.start;s=r.a+r.d*m(M/r.duration),b(s,1-s)}}return!!(r||o)}))}return{run(_){Pe(i)?Pn().then(()=>{i=i(),p(_)}):p(_)},end(){f(),r=o=null}}}const un=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function dn(l,e){l.d(1),e.delete(l.key)}function Ke(l,e){R(l,1,1,()=>{e.delete(l.key)})}function qe(l,e,t,n,i,s,r,o,a,f,c,p){let _=l.length,u=s.length,d=_;const m={};for(;d--;)m[l[d].key]=d;const b=[],k=new Map,h=new Map;for(d=u;d--;){const w=p(i,s,d),C=t(w);let D=r.get(C);D?n&&D.p(w,e):(D=f(C,w),D.c()),k.set(C,b[d]=D),C in m&&h.set(C,Math.abs(d-m[C]))}const S=new Set,M=new Set;function L(w){x(w,1),w.m(o,c),r.set(w.key,w),c=w.first,u--}for(;_&&u;){const w=b[u-1],C=l[_-1],D=w.key,T=C.key;w===C?(c=w.first,_--,u--):k.has(T)?!r.has(D)||S.has(D)?L(w):M.has(T)?_--:h.get(D)>h.get(T)?(M.add(D),L(w)):(S.add(T),_--):(a(C,r),_--)}for(;_--;){const w=l[_];k.has(w.key)||a(w,r)}for(;u;)L(b[u-1]);return b}function bt(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function ge(l){l&&l.c()}function ue(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||Ee(()=>{const a=s.map(nn).filter(Pe);r?r.push(...a):je(a),l.$$.on_mount=[]}),o.forEach(Ee)}function de(l,e){const t=l.$$;t.fragment!==null&&(je(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Fn(l,e){l.$$.dirty[0]===-1&&(lt.push(l),xn(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ye(l,e,t,n,i,s,r,o=[-1]){const a=it;nt(l);const f=l.$$={fragment:null,ctx:null,props:s,update:ae,not_equal:i,bound:Kt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Kt(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(f.root);let c=!1;if(f.ctx=t?t(l,e.props||{},(p,_,...u)=>{const d=u.length?u[0]:_;return f.ctx&&i(f.ctx[p],f.ctx[p]=d)&&(!f.skip_bound&&f.bound[p]&&f.bound[p](d),c&&Fn(l,p)),_}):[],f.update(),c=!0,je(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const p=Mn(e.target);f.fragment&&f.fragment.l(p),p.forEach(P)}else f.fragment&&f.fragment.c();e.intro&&x(l.$$.fragment),ue(l,e.target,e.anchor,e.customElement),cn()}nt(a)}class ke{$destroy(){de(this,1),this.$destroy=ae}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!kn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function _n(l){const e=l-1;return e*e*e+1}function Ce(l,{delay:e=0,duration:t=400,easing:n=Pt}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function wt(l,{delay:e=0,duration:t=400,easing:n=_n}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),p=parseFloat(i.borderTopWidth),_=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*s};height: ${u*r}px;padding-top: ${u*o}px;padding-bottom: ${u*a}px;margin-top: ${u*f}px;margin-bottom: ${u*c}px;border-top-width: ${u*p}px;border-bottom-width: ${u*_}px;`}}const Ze=[];function He(l,e=ae){let t;const n=new Set;function i(o){if(he(l,o)&&(l=o,t)){const a=!Ze.length;for(const f of n)f[1](),Ze.push(f,l);if(a){for(let f=0;f<Ze.length;f+=2)Ze[f][0](Ze[f+1]);Ze.length=0}}}function s(o){i(o(l))}function r(o,a=ae){const f=[o,a];return n.add(f),n.size===1&&(t=e(i)||ae),o(l),()=>{n.delete(f),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const st=()=>{},jt=l=>new Promise(e=>setTimeout(e,l)),ze=(l,e,t)=>Math.min(t,Math.max(l,e)),Rt=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),At=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,a)=>At(o,e[a]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,a])=>!(!r.has(o)||!At(a,r.get(o))))}catch{}return!1},Hn=l=>{let e=!1,t=[];const n=async i=>{e=!0;let s,r,o;try{s=await l()}catch(a){o=!0,r=a}if(i.map(a=>{o&&a.reject(r),a.resolve(s)}),t.length){const a=t;return t=[],n(a)}e=!1};return()=>{const i=Rt();return e?t.push(i):(e=!0,n([i])),i.promise}},Rn=l=>{const e=Rt();return setTimeout(e.resolve,l),e},Bn=Symbol("RangeLoadList_ItemLastUpdateTime"),Gn=l=>{var J,te,z,B;const e=ze(1,((J=l.updateInterval)!=null?J:1e3)|0,36e5),t=ze(1,((te=l.maxLimit)!=null?te:50)|0,1e3);let n=l.fLoad;const i=(z=l.onUpdateItem)!=null?z:st,s=(B=l.onUpdateItemList)!=null?B:st,r=!!l.isLoadEnd,o=Bn,a={},f=He(null),c={subscribe:f.subscribe};let p=0,_=t,u=null;const d=V=>n=V,m=async(V,re)=>{try{const _e=await n({offset:V,limit:re});if(typeof _e.count=="number"&&Array.isArray(_e.results))return _e}catch{}return null},b=async(V,re)=>{const _e=await m(V,re);if(_e){const W=_e.results,U=Math.max(0,_e.count|0),Y=u!==U,j=Date.now();u=U;const K=[];for(let Q=0,fe=V;Q<W.length&&fe<u;Q++,fe++){const Se=W[Q];a[fe]!==void 0&&At(a[fe],Se)||(Se[o]=j,a[fe]=Se,i(Se),K.push(Se))}K.length&&s(K),(Y||K.length)&&f.set({total:u,list:a})}},k=async V=>{const re=[];re.push(b(p,_)),u!==null&&p+_<u&&r&&re.push(b(u,t)),await Promise.all(re),u!==null&&p+_<u&&r&&V&&await b(u,t)};let h=!1,S=!0,M,L=1;return(async()=>{let V=0;for(;S;){for(;S&&!h;){const re=L;if(await k(V++===0),re===L)break}M=Rn(e),await M.promise}})(),{setFLoad:d,update:()=>{L++,M&&M.resolve()},setRange:(V,re)=>{p=Math.max(0,V|0),_=ze(0,re|0,t)},destroy:()=>S=!1,getData_r:()=>c,symbolUpdateTime:o,pause:()=>h=!0,resume:()=>h=!1}},Un=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},St=(l,e,t=!0)=>{let n=!0;return(async()=>{for(t&&await jt(l);n;){try{await e()}catch(i){console.error("setIntervalAwait error",i)}await jt(l)}})(),()=>n=!1},gn=()=>{let l=new Map;try{l=new Map([...new URLSearchParams(location.hash.replace(/^\#/,""))])}catch{}return l},Bt=()=>{const l={};return{on:(n,i)=>{var o;const s={event:n,cb:i},r=l[n]=(o=l[n])!=null?o:[];return r.push(s),()=>{const a=r.findIndex(f=>f===s);a!==-1&&r.splice(a,1)}},emit:(n,...i)=>{var s;return((s=l[n])!=null?s:[]).map(r=>r.cb(...i))}}},mn=(l,e="file-")=>{const t=document.createElement("a");t.href=l;const n=e+t.pathname.split(/[^a-zA-Z0-9\.\-_]/).pop();t.download=n,t.target="blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},xt=l=>mn(l,"image-"),qn=l=>{try{if(typeof l.message=="string")return l.message}catch{}return""},yt=He(null),pn=yt.set,dt=(l,e)=>{const{subscribe:t,set:n,update:i}=He(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},Yn=(l,e)=>{const{subscribe:t,set:n,update:i}=He(l);return[{subscribe:t},i]},Wn=l=>parseInt(l.id);function Vn(l,e,t){var W;const n={},i={...e};Object.assign(n,{appConfig:i}),Object.assign(n,{api:t});const s=Bt();Object.assign(n,{events:s});const r=[],o=U=>r.push(U);Object.assign(n,{destroy:()=>r.map(U=>U())});const f=l,[c]=dt(f),[p,_]=dt(null);let u=0;const[d,m]=dt(u),b=Hn(t.operatorSelf_GetOnlineInfo),k=async()=>{m(++u);const U=await b();return U&&_(U),m(--u),U};Object.assign(n,{operatorSelf_r:c,operatorSelfLastOnlineInfo_r:p,operatorSelfLastOnlineInfo_Update:k,operatorSelfLastOnline_SetOnlineFlag:async U=>{m(++u);const Y=await t.operatorSelf_SetOnlineFlag(U);return Y&&_(Y),m(--u),Y},operatorSelfLastOnlineInfoLoading_r:d});const S=Object.create(null),[M,L]=Yn(S),w=U=>{!U.length||L(Y=>{for(const j of U)Y[Wn(j)]=j;return Y})},C=U=>w([U]),[D,T]=dt(null);Object.assign(n,{dialogMap_r:M,dialogMap_SetDialogList:w,dialogMap_SetDialog:C,dialogActiveID_r:D,dialogActiveID_Set:T});const A=Object.fromEntries(i==null?void 0:i.lead_StatusList.map(U=>[U.id,U])),H=Object.entries((W=i==null?void 0:i.lead_StatusJumpMap)!=null?W:{}).reduce((U,[Y,j])=>(j.map(K=>{var Q;return(U[K]=(Q=U[K])!=null?Q:[]).push(Y)}),U),{}),ee=U=>{var j,K,Q;const Y=V(U==null?void 0:U.status);return{title:(j=Y==null?void 0:Y.title)!=null?j:Y!=null&&Y.id?`#${Y==null?void 0:Y.id}`:"*UNK*",bgColor:(K=Y==null?void 0:Y.bgColor)!=null?K:"#000",color:(Q=Y==null?void 0:Y.color)!=null?Q:"#fff"}},J=U=>{var Y;try{return(Y=i.lead_StatusGetID(U))!=null?Y:null}catch{}return null},te=(U,Y)=>{var j;try{return(j=i.lead_StatusPrevIDResolve(U,Y))!=null?j:null}catch{}return null},z=(U,Y)=>{try{const j=H==null?void 0:H[U],K=(j==null?void 0:j.length)===1?j==null?void 0:j[0]:(j==null?void 0:j.length)>1?te(U,Y):null,Q=A==null?void 0:A[K];return Q&&!(Q!=null&&Q.stopPrevSearch)?K:null}catch{}return null},B=U=>{let Y=J(U);const j=[Y];for(;Y=z(Y,U),U=null,!!Y;)j.unshift(Y);return j.map(K=>A==null?void 0:A[K]).filter(Boolean)},V=U=>{var Y,j;return(j=((Y=e==null?void 0:e.lead_StatusList)!=null?Y:[]).find(K=>K.id===U))!=null?j:null};return Object.assign(n,{lead_GetStatusOrDefault:ee,lead_GetStatusByID:V,lead_GetStatusTitle:U=>{var Y,j;return(j=(Y=V(U))==null?void 0:Y.title)!=null?j:U},lead_GetStatusList:U=>{var Y;return((Y=e==null?void 0:e.lead_StatusList)!=null?Y:[]).filter(j=>j.access==="user").filter(j=>j.id!==U).filter(j=>j.id!=="DL")},lead_GetStatusID:J,lead_StatusPrevIDResolve:te,lead_GetStatusPrevID:z,lead_GetStatusHistory:B}),o(St(e.updateIntervals.sync_online_info,k,!1)),Object.freeze(n),n}function $t(l){let e,t,n;return{c(){e=y("div"),e.textContent="Operators",v(e,"class","item cursor_ptr svelte-vbcb9r"),ne(e,"active",l[0]==="operators"),ne(e,"disabled",l[1].has("operators"))},m(i,s){F(i,e,s),t||(n=le(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&ne(e,"active",i[0]==="operators"),s&2&&ne(e,"disabled",i[1].has("operators"))},d(i){i&&P(e),t=!1,n()}}}function el(l){let e,t=l[2].username+"",n,i,s;return{c(){e=y("div"),n=se(t),v(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),N(e,"max-width","200px")},m(r,o){F(r,e,o),g(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&pe(n,t)},i(r){s||(Ee(()=>{i||(i=Me(e,Ce,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=Me(e,Ce,{},!1)),i.run(0),s=!1},d(r){r&&P(e),r&&i&&i.end()}}}function Jn(l){let e,t,n,i,s,r,o=!l[2]&&$t(l),a=l[2]&&0,f=l[2]&&el(l);return{c(){e=y("div"),o&&o.c(),t=E(),a&&a.c(),n=E(),i=y("div"),s=E(),f&&f.c(),v(i,"class","flex flex_grow_1"),v(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(c,p){F(c,e,p),o&&o.m(e,null),g(e,t),a&&a.m(e,null),g(e,n),g(e,i),g(e,s),f&&f.m(e,null),r=!0},p(c,[p]){c[2]?o&&(o.d(1),o=null):o?o.p(c,p):(o=$t(c),o.c(),o.m(e,t)),c[2],a&&(a.d(1),a=null),c[2]?f?(f.p(c,p),p&4&&x(f,1)):(f=el(c),f.c(),x(f,1),f.m(e,null)):f&&(be(),R(f,1,1,()=>{f=null}),we())},i(c){r||(x(f),r=!0)},o(c){R(f),r=!1},d(c){c&&P(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function Xn(l,e,t){let n;Le(l,yt,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>a=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class Kn extends ke{constructor(e){super(),ye(this,e,Xn,Jn,he,{select:0,disabled:1})}}function tl(l,e,t){const n=l.slice();return n[4]=e[t],n}function ll(l,e,t){const n=l.slice();return n[7]=e[t],n}function nl(l){let e,t=l[7].text+"",n,i;return{c(){e=y("div"),n=se(t),i=se("\xA0"),v(e,"class","text svelte-13s1vua"),N(e,"color",l[7].color)},m(s,r){F(s,e,r),g(e,n),F(s,i,r)},p(s,r){r&2&&t!==(t=s[7].text+"")&&pe(n,t),r&2&&N(e,"color",s[7].color)},d(s){s&&P(e),s&&P(i)}}}function sl(l){let e,t,n=l[4].chunks,i=[];for(let s=0;s<n.length;s+=1)i[s]=nl(ll(l,n,s));return{c(){e=y("div");for(let s=0;s<i.length;s+=1)i[s].c();t=E(),v(e,"class","flex flex_cy line svelte-13s1vua"),ne(e,"mini",l[4].type==="mini")},m(s,r){F(s,e,r);for(let o=0;o<i.length;o+=1)i[o].m(e,null);g(e,t)},p(s,r){if(r&2){n=s[4].chunks;let o;for(o=0;o<n.length;o+=1){const a=ll(s,n,o);i[o]?i[o].p(a,r):(i[o]=nl(a),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}r&2&&ne(e,"mini",s[4].type==="mini")},d(s){s&&P(e),kt(i,s)}}}function Zn(l){let e,t,n,i=l[1],s=[];for(let r=0;r<i.length;r+=1)s[r]=sl(tl(l,i,r));return{c(){e=y("div");for(let r=0;r<s.length;r+=1)s[r].c();v(e,"class","flex flex_clm notify svelte-13s1vua"),ne(e,"normal",l[0]==="normal"),ne(e,"error",l[0]==="error"),ne(e,"debug",l[0]==="debug")},m(r,o){F(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,[o]){if(o&2){i=r[1];let a;for(a=0;a<i.length;a+=1){const f=tl(r,i,a);s[a]?s[a].p(f,o):(s[a]=sl(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}(!n||o&1)&&ne(e,"normal",r[0]==="normal"),(!n||o&1)&&ne(e,"error",r[0]==="error"),(!n||o&1)&&ne(e,"debug",r[0]==="debug")},i(r){n||(r&&Ee(()=>{t||(t=Me(e,wt,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Me(e,wt,{},!1)),t.run(0)),n=!1},d(r){r&&P(e),kt(s,r),r&&t&&t.end()}}}function Qn(l,e,t){let{notify:n}=e,i="normal",s=[];const r=()=>{t(0,i=n==null?void 0:n.type),t(1,s=[]),Array.isArray(n==null?void 0:n.data)&&t(1,s=n.data.filter(Boolean).map(o=>{let a="normal",f=[];return typeof o=="string"?f.push({color:"#fff",text:o}):(a=o.type,f=o.chunks?o.chunks:[{color:"#fff",text:o.text}]),f=f.filter(c=>c.text),{type:a,chunks:f}}).filter(o=>o.chunks.length))};return l.$$set=o=>{"notify"in o&&t(2,n=o.notify)},l.$$.update=()=>{l.$$.dirty&4&&r()},[i,s,n]}class $n extends ke{constructor(e){super(),ye(this,e,Qn,Zn,he,{notify:2})}}function il(l,e,t){const n=l.slice();return n[4]=e[t],n}function rl(l,e){let t,n,i;return n=new $n({props:{notify:e[4]}}),{key:l,first:null,c(){t=Ue(),ge(n.$$.fragment),this.first=t},m(s,r){F(s,t,r),ue(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.notify=e[4]),n.$set(o)},i(s){i||(x(n.$$.fragment,s),i=!0)},o(s){R(n.$$.fragment,s),i=!1},d(s){s&&P(t),de(n,s)}}}function es(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[4].id;for(let o=0;o<s.length;o+=1){let a=il(l,s,o),f=r(a);n.set(f,t[o]=rl(f,a))}return{c(){e=y("div");for(let o=0;o<t.length;o+=1)t[o].c();v(e,"class","pos_abs notify_list svelte-11tn2wf")},m(o,a){F(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],be(),t=qe(t,a,r,1,o,s,n,e,Ke,rl,null,il),we())},i(o){if(!i){for(let a=0;a<s.length;a+=1)x(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)R(t[a]);i=!1},d(o){o&&P(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}const ts=5e3;function ls(l,e,t){let{events:n=Bt()}=e,i=1,s=[];const r=o=>a=>{s.push({id:i++,time:Date.now(),type:o,data:a}),t(0,s)};return Fe(St(1e3,()=>{const o=Date.now(),a=s.filter(f=>f.time+ts>=o);a.length!==s.length&&t(0,s=a)})),Fe(n.on("error",r("error"))),gn().has("debug")&&Fe(n.on("debug",r("debug"))),l.$$set=o=>{"events"in o&&t(1,n=o.events)},[s,n]}class ns extends ke{constructor(e){super(),ye(this,e,ls,es,he,{events:1})}}function ol(l){return Object.prototype.toString.call(l)==="[object Date]"}function Nt(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>Nt(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if(ol(l)&&ol(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=Nt(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function Ge(l,e={}){const t=He(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let a=n,f=!1,{delay:c=0,duration:p=400,easing:_=Pt,interpolate:u=Nt}=Xt(Xt({},e),o);if(p===0)return a&&(a.abort(),a=null),t.set(l=i),Promise.resolve();const d=rn()+c;let m;return n=an(b=>{if(b<d)return!0;f||(m=u(l,r),typeof p=="function"&&(p=p(l,r)),f=!0),a&&(a.abort(),a=null);const k=b-d;return k>p?(t.set(l=r),!1):(t.set(l=m(_(k/p))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}function ss(l){let e,t,n,i,s,r,o,a,f;return{c(){e=y("div"),t=y("div"),n=y("div"),i=E(),s=y("div"),r=E(),o=y("div"),a=E(),f=y("div"),v(n,"class","pos_abs s1 svelte-fxby3d"),v(s,"class","pos_abs s2 svelte-fxby3d"),v(o,"class","pos_abs s3 svelte-fxby3d"),v(f,"class","pos_abs s4 svelte-fxby3d"),v(t,"class","flex pos_rel ellipsis svelte-fxby3d"),N(t,"transform","scale("+l[1]+")"),v(e,"class","flex"),N(e,"height",l[0]+"px"),N(e,"width",l[2]+"px")},m(c,p){F(c,e,p),g(e,t),g(t,n),g(t,i),g(t,s),g(t,r),g(t,o),g(t,a),g(t,f)},p(c,[p]){p&2&&N(t,"transform","scale("+c[1]+")"),p&1&&N(e,"height",c[0]+"px"),p&4&&N(e,"width",c[2]+"px")},i:ae,o:ae,d(c){c&&P(e)}}}function is(l,e,t){let n,i,{height:s=5}=e;return l.$$set=r=>{"height"in r&&t(0,s=r.height)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=s/.1625),l.$$.dirty&1&&t(1,i=s/13)},[s,i,n]}class hn extends ke{constructor(e){super(),ye(this,e,is,ss,he,{height:0})}}function al(l){let e,t,n,i;return t=new hn({props:{height:6}}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","flex pos_abs loading svelte-15wz55f")},m(s,r){F(s,e,r),ue(t,e,null),i=!0},i(s){i||(x(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function rs(l){let e,t,n,i,s,r,o,a,f,c,p,_,u,d=l[0]&&al();return{c(){e=y("div"),t=y("div"),n=E(),i=y("div"),i.textContent="offline",s=E(),r=y("div"),o=se(`online\r
		`),a=y("div"),f=se(l[2]),c=E(),d&&d.c(),v(t,"class","pos_abs h100 onlineProgressTrumb svelte-15wz55f"),N(t,"width",l[1]+"%"),v(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-15wz55f"),ne(i,"hideR",l[1]>=1),v(a,"class","pos_abs onlineProgressTrumbLastTime svelte-15wz55f"),v(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-15wz55f"),ne(r,"hideL",l[1]<1),v(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-15wz55f")},m(m,b){F(m,e,b),g(e,t),g(e,n),g(e,i),g(e,s),g(e,r),g(r,o),g(r,a),g(a,f),g(e,c),d&&d.m(e,null),p=!0,_||(u=le(e,"click",l[8]),_=!0)},p(m,[b]){(!p||b&2)&&N(t,"width",m[1]+"%"),(!p||b&2)&&ne(i,"hideR",m[1]>=1),(!p||b&4)&&pe(f,m[2]),(!p||b&2)&&ne(r,"hideL",m[1]<1),m[0]?d?b&1&&x(d,1):(d=al(),d.c(),x(d,1),d.m(e,null)):d&&(be(),R(d,1,1,()=>{d=null}),we())},i(m){p||(x(d),p=!0)},o(m){R(d),p=!1},d(m){m&&P(e),d&&d.d(),_=!1,u()}}}function os(l,e,t){let n,i,s,{endTime:r=0}=e,{intervalTime:o=1}=e,{loading:a=!1}=e;const f=Ge(0);Le(l,f,d=>t(7,s=d));let c=0;function p(){const d=Math.max(0,r-Date.now());t(1,c=Math.floor(ze(0,d/o,1)*100)),Be(f,s=Math.ceil(d/1e3),s)}Fe(St(1e3,p));const _=d=>{const m=Math.floor(d%60);d/=60;const b=Math.floor(d%60);d/=60;const k=Math.floor(d),h=[];return(h.length||k)&&h.push(`${String(k).padStart(h.length?2:1,"0")}h`),(h.length||b)&&h.push(`${String(b).padStart(h.length?2:1,"0")}m`),(h.length||m)&&h.push(`${String(m).padStart(h.length?2:1,"0")}s`),h.join(" ")};function u(d){jn.call(this,l,d)}return l.$$set=d=>{"endTime"in d&&t(4,r=d.endTime),"intervalTime"in d&&t(5,o=d.intervalTime),"loading"in d&&t(0,a=d.loading)},l.$$.update=()=>{l.$$.dirty&128&&t(6,n=Math.ceil(s)),l.$$.dirty&64&&t(2,i=_(n))},[a,c,i,f,r,o,n,s,u]}class as extends ke{constructor(e){super(),ye(this,e,os,rs,he,{endTime:4,intervalTime:5,loading:0})}}function fs(l){let e;return{c(){e=se("\xA0")},m(t,n){F(t,e,n)},p:ae,d(t){t&&P(e)}}}function cs(l){let e,t=l[2].username+"",n;return{c(){e=se("@"),n=se(t)},m(i,s){F(i,e,s),F(i,n,s)},p(i,s){s&4&&t!==(t=i[2].username+"")&&pe(n,t)},d(i){i&&P(e),i&&P(n)}}}function us(l){var te,z;let e,t,n,i,s=((te=l[2].first_name)!=null?te:"")+"",r,o,a,f,c,p=((z=l[2].last_name)!=null?z:"")+"",_,u,d,m,b,k,h,S,M,L,w,C,D,T,A;function H(B,V){return B[2].username?cs:fs}let ee=H(l),J=ee(l);return L=new as({props:{intervalTime:l[1],endTime:l[0],loading:l[3]}}),L.$on("click",l[8]),{c(){e=y("div"),t=y("div"),n=y("div"),i=y("div"),r=se(s),o=E(),a=y("div"),f=E(),c=y("div"),_=se(p),u=se("\xA0"),d=E(),m=y("div"),J.c(),b=E(),k=y("div"),k.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',h=E(),S=y("div"),M=E(),ge(L.$$.fragment),w=E(),C=y("div"),N(a,"width","8px"),v(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),v(m,"class","nowrap textOverEllipsis username svelte-1qt21qp"),v(k,"class","pos_abs btnLogout svelte-1qt21qp"),v(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),N(S,"height","8px"),N(C,"height","8px"),v(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(B,V){F(B,e,V),g(e,t),g(t,n),g(n,i),g(i,r),g(n,o),g(n,a),g(n,f),g(n,c),g(c,_),g(c,u),g(t,d),g(t,m),J.m(m,null),g(t,b),g(t,k),g(e,h),g(e,S),g(e,M),ue(L,e,null),g(e,w),g(e,C),D=!0,T||(A=le(k,"click",l[7]),T=!0)},p(B,[V]){var _e,W;(!D||V&4)&&s!==(s=((_e=B[2].first_name)!=null?_e:"")+"")&&pe(r,s),(!D||V&4)&&p!==(p=((W=B[2].last_name)!=null?W:"")+"")&&pe(_,p),ee===(ee=H(B))&&J?J.p(B,V):(J.d(1),J=ee(B),J&&(J.c(),J.m(m,null)));const re={};V&2&&(re.intervalTime=B[1]),V&1&&(re.endTime=B[0]),V&8&&(re.loading=B[3]),L.$set(re)},i(B){D||(x(L.$$.fragment,B),D=!0)},o(B){R(L.$$.fragment,B),D=!1},d(B){B&&P(e),J.d(),de(L),T=!1,A()}}}function ds(l,e,t){let n,i,s,{app:r}=e;const{operatorSelf_r:o,operatorSelfLastOnlineInfo_r:a,operatorSelfLastOnlineInfoLoading_r:f,operatorSelfLastOnline_SetOnlineFlag:c}=r;Le(l,o,k=>t(2,i=k)),Le(l,a,k=>t(10,n=k)),Le(l,f,k=>t(3,s=k));const p=()=>pn(null);let _=0,u=1;const d=k=>{if(!k){t(0,_=0),t(1,u=1);return}t(0,_=+new Date(k.offline_at)),t(1,u=ze(1,(k.interval|0)*1e3,1e9))};let m=!1;const b=async()=>{var k;!((k=r.appConfig)!=null&&k.operatorSelf_CanSetOnline)||m||(m=!0,await c(!0),m=!1)};return l.$$set=k=>{"app"in k&&t(9,r=k.app)},l.$$.update=()=>{l.$$.dirty&1024&&d(n)},[_,u,i,s,o,a,f,p,b,r,n]}class _s extends ke{constructor(e){super(),ye(this,e,ds,us,he,{app:9})}}const rt=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{i&&setTimeout(s,10);const o=l.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||n!==a.height)&&(t=a.width,n=a.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(a))}};return s(),{destroy:()=>i=!1}},gs=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{r&&setTimeout(o,10);const f=l.getBoundingClientRect();(t!==f.width||n!==f.height||i!==f.x||s!==f.y)&&(t=f.width,n=f.height,i=f.x,s=f.y,e&&e.set(f))};return o(),{destroy:()=>r=!1}};function ms(l){let e,t,n,i,s,r,o,a,f,c,p,_,u,d,m,b,k;return{c(){e=y("div"),t=y("div"),n=y("div"),i=E(),s=y("div"),r=E(),o=y("div"),a=E(),f=y("div"),c=E(),p=y("div"),_=E(),u=y("div"),d=E(),m=y("div"),b=E(),k=y("div"),v(n,"class","svelte-1lltvmx"),v(s,"class","svelte-1lltvmx"),v(o,"class","svelte-1lltvmx"),v(f,"class","svelte-1lltvmx"),v(p,"class","svelte-1lltvmx"),v(u,"class","svelte-1lltvmx"),v(m,"class","svelte-1lltvmx"),v(k,"class","svelte-1lltvmx"),v(t,"class","lds-roller svelte-1lltvmx"),N(t,"transform","scale("+l[2]+")"),N(t,"--loadingItemColor",l[1]),v(e,"class","flex"),N(e,"height",l[0]+"px"),N(e,"width",l[0]+"px")},m(h,S){F(h,e,S),g(e,t),g(t,n),g(t,i),g(t,s),g(t,r),g(t,o),g(t,a),g(t,f),g(t,c),g(t,p),g(t,_),g(t,u),g(t,d),g(t,m),g(t,b),g(t,k)},p(h,[S]){S&4&&N(t,"transform","scale("+h[2]+")"),S&2&&N(t,"--loadingItemColor",h[1]),S&1&&N(e,"height",h[0]+"px"),S&1&&N(e,"width",h[0]+"px")},i:ae,o:ae,d(h){h&&P(e)}}}function ps(l,e,t){let n,{size:i=80}=e,{color:s="#000"}=e;return l.$$set=r=>{"size"in r&&t(0,i=r.size),"color"in r&&t(1,s=r.color)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=i/80)},[i,s,n]}class vn extends ke{constructor(e){super(),ye(this,e,ps,ms,he,{size:0,color:1})}}const{Map:hs}=un;function fl(l,e,t){const n=l.slice();return n[15]=e[t],n}function cl(l){let e,t,n,i;return t=new vn({props:{color:"#fff",size:"32"}}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","pos_abs loading svelte-15mx73l")},m(s,r){F(s,e,r),ue(t,e,null),i=!0},i(s){i||(x(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function ul(l){let e,t,n=l[15].username+"",i;return{c(){e=y("div"),t=se("@"),i=se(n),v(e,"class","nowrap textOverEllipsis username svelte-15mx73l")},m(s,r){F(s,e,r),g(e,t),g(e,i)},p(s,r){r&8&&n!==(n=s[15].username+"")&&pe(i,n)},d(s){s&&P(e)}}}function dl(l){let e,t,n;return t=new vn({props:{color:"#fff",size:"32"}}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","flex flex_cy h100 pos_abs loadingLead svelte-15mx73l")},m(i,s){F(i,e,s),ue(t,e,null),n=!0},i(i){n||(x(t.$$.fragment,i),n=!0)},o(i){R(t.$$.fragment,i),n=!1},d(i){i&&P(e),de(t)}}}function _l(l,e){var C,D;let t,n,i,s=((C=e[15].first_name)!=null?C:"")+"",r,o,a,f,c,p=((D=e[15].last_name)!=null?D:"")+"",_,u,d,m,b=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id),k,h,S,M,L=e[15].username&&ul(e),w=b&&dl();return{key:l,first:null,c(){t=y("div"),n=y("div"),i=y("div"),r=se(s),o=E(),a=y("div"),f=E(),c=y("div"),_=se(p),u=se("\xA0"),d=E(),L&&L.c(),m=E(),w&&w.c(),k=E(),N(a,"width","8px"),v(n,"class","flex nowrap textOverEllipsis userAttr svelte-15mx73l"),v(t,"class","flex flex_clm cursor_ptr w100 item unselect pos_abs svelte-15mx73l"),N(t,"top",e[15].y+"px"),N(t,"height",bn+"px"),ne(t,"disabled",e[1].has(e[15].tg_id)),this.first=t},m(T,A){F(T,t,A),g(t,n),g(n,i),g(i,r),g(n,o),g(n,a),g(n,f),g(n,c),g(c,_),g(c,u),g(t,d),L&&L.m(t,null),g(t,m),w&&w.m(t,null),g(t,k),h=!0,S||(M=le(t,"click",function(){Pe(e[6](e[15].tg_id))&&e[6](e[15].tg_id).apply(this,arguments)}),S=!0)},p(T,A){var H,ee;e=T,(!h||A&8)&&s!==(s=((H=e[15].first_name)!=null?H:"")+"")&&pe(r,s),(!h||A&8)&&p!==(p=((ee=e[15].last_name)!=null?ee:"")+"")&&pe(_,p),e[15].username?L?L.p(e,A):(L=ul(e),L.c(),L.m(t,m)):L&&(L.d(1),L=null),A&14&&(b=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id)),b?w?A&14&&x(w,1):(w=dl(),w.c(),x(w,1),w.m(t,k)):w&&(be(),R(w,1,1,()=>{w=null}),we()),(!h||A&8)&&N(t,"top",e[15].y+"px"),(!h||A&10)&&ne(t,"disabled",e[1].has(e[15].tg_id))},i(T){h||(x(w),h=!0)},o(T){R(w),h=!1},d(T){T&&P(t),L&&L.d(),w&&w.d(),S=!1,M()}}}function vs(l){var te;let e,t,n,i,s,r,o,a,f,c=((te=l[4])!=null?te:0)+"",p,_,u,d,m,b,k,h,S,M,L,w=[],C=new hs,D,T,A,H=l[5]&&cl(),ee=l[3];const J=z=>z[15].tg_id;for(let z=0;z<ee.length;z+=1){let B=fl(l,ee,z),V=J(B);C.set(V,w[z]=_l(V,B))}return{c(){e=y("div"),t=y("div"),n=y("div"),n.textContent="New leads",i=E(),H&&H.c(),s=E(),r=y("div"),o=y("div"),o.textContent="count:\xA0",a=E(),f=y("div"),p=se(c),_=E(),u=y("div"),d=E(),m=y("div"),m.textContent="Get one",b=E(),k=y("div"),h=E(),S=y("div"),M=y("div"),L=y("div");for(let z=0;z<w.length;z+=1)w[z].c();v(n,"class","flex mainLabel svelte-15mx73l"),v(o,"class","flex labelCountLabel svelte-15mx73l"),v(f,"class","flex labelCountNum svelte-15mx73l"),v(r,"class","flex flex_cx flex_cy pos_abs labelCount svelte-15mx73l"),v(t,"class","flex flex_cx flex_cy header pos_rel w100 svelte-15mx73l"),N(u,"height","20px"),v(m,"class","flex flex_cx flex_cy cursor_ptr noselect bntMain svelte-15mx73l"),N(k,"height","10px"),v(L,"class","flex list h100 svelte-15mx73l"),v(M,"class","pos_abs w100"),N(M,"overflow","hidden"),v(S,"class","flex cnt h100 pos_rel w100 svelte-15mx73l"),v(e,"class","flex flex_clm wrapMain flex_grow_1 w100 unselect svelte-15mx73l")},m(z,B){F(z,e,B),g(e,t),g(t,n),g(t,i),H&&H.m(t,null),g(t,s),g(t,r),g(r,o),g(r,a),g(r,f),g(f,p),g(e,_),g(e,u),g(e,d),g(e,m),g(e,b),g(e,k),g(e,h),g(e,S),g(S,M),g(M,L);for(let V=0;V<w.length;V+=1)w[V].m(L,null);l[9](M),D=!0,T||(A=$e(rt.call(null,M)),T=!0)},p(z,[B]){var V;z[5]?H?B&32&&x(H,1):(H=cl(),H.c(),x(H,1),H.m(t,s)):H&&(be(),R(H,1,1,()=>{H=null}),we()),(!D||B&16)&&c!==(c=((V=z[4])!=null?V:0)+"")&&pe(p,c),B&78&&(ee=z[3],be(),w=qe(w,B,J,1,z,ee,C,L,Ke,_l,null,fl),we())},i(z){if(!D){x(H);for(let B=0;B<ee.length;B+=1)x(w[B]);D=!0}},o(z){R(H);for(let B=0;B<w.length;B+=1)R(w[B]);D=!1},d(z){z&&P(e),H&&H.d();for(let B=0;B<w.length;B+=1)w[B].d();l[9](null),T=!1,A()}}}const bs=160,bn=42,It=0;function ws(l,e,t){let{app:n}=e,i=[],s=new Map,r=new Set,o=[],a=null;function f(){if(!a)return;const h=a.getBoundingClientRect(),S=bs+It*2,M=bn+It*2,L=Math.max(1,Math.floor(h.width/S)),w=(h.width-L*S)/2,C=It;t(3,o=i.map((D,T)=>{const A={...D};return A.x=T%L*S+w,A.y=C+Math.floor(T/L)*M,A}))}let c=null,p=!1;async function _(){var S;const h=await n.api.lead_GetUnassignedList({offset:0,limit:20});return h?(t(4,c=h.count),(S=h.results)!=null?S:h):null}let u=!0;async function d(){for(;u;){await jt(g_Config.updateIntervals.new_leads);const h=await _();if(!h)continue;const S=new Set(i.map(T=>T.tg_id)),M=new Set(h.map(T=>T.tg_id)),L=h.filter(T=>!S.has(T.tg_id)),w=i.filter(T=>!M.has(T.tg_id)),C=Date.now();w.map(T=>s.has(T.tg_id)||s.set(T.tg_id,C)),L.length===0&&w.length===0||t(8,i=[...i,...L]);const D=new Set;[...s].map(T=>{T[1]+2e3<=C&&D.add(T[0]),T[1]+1e4<=C&&s.delete(T[0])}),D.size&&t(8,i=i.filter(T=>!D.has(T.tg_id)))}}async function m(){for(t(5,p=!0);u;){const h=await _();if(h){t(8,i=h);break}}t(5,p=!1),d()}Fe(()=>u=!1);const b=h=>async S=>{if(r.has(h)||s.has(h))return;r.add(h),t(2,r);const M=await n.api.lead_AssignOperatorSelft(h);r.delete(h),t(2,r),M!==null&&(s.set(h,Date.now()),t(1,s)),t(8,i),t(3,o)};m();function k(h){xe[h?"unshift":"push"](()=>{a=h,t(0,a)})}return l.$$set=h=>{"app"in h&&t(7,n=h.app)},l.$$.update=()=>{l.$$.dirty&257&&f()},[a,s,r,o,c,p,b,n,i,k]}class ys extends ke{constructor(e){super(),ye(this,e,ws,vs,he,{app:7})}}function ks(l){let e,t,n,i,s,r,o,a,f,c,p,_,u,d,m,b,k,h;return{c(){e=y("label"),t=y("input"),n=E(),i=Ne("svg"),s=Ne("symbol"),r=Ne("path"),o=Ne("defs"),a=Ne("mask"),f=Ne("use"),c=Ne("use"),p=Ne("path"),_=E(),u=Ne("svg"),d=Ne("path"),m=Ne("path"),b=Ne("path"),v(t,"type","checkbox"),v(t,"class","svelte-13drl8w"),v(r,"d","M5.22003 7.26C5.72003 7.76 7.57 9.7 8.67 11.45C12.2 6.05 15.65 3.5 19.19 1.69"),v(r,"fill","none"),v(r,"stroke-width","2.25"),v(r,"stroke-linecap","round"),v(r,"stroke-linejoin","round"),v(s,"id","tick-path"),v(s,"viewBox","0 0 21 18"),v(s,"xmlns","http://www.w3.org/2000/svg"),v(f,"class","tick mask svelte-13drl8w"),v(f,"href","#tick-path"),v(a,"id","tick"),v(c,"class","tick svelte-13drl8w"),v(c,"href","#tick-path"),v(c,"stroke","currentColor"),v(p,"fill","white"),v(p,"mask","url(#tick)"),v(p,"d","M18 9C18 10.4464 17.9036 11.8929 17.7589 13.1464C17.5179 15.6054 15.6054 17.5179 13.1625 17.7589C11.8929 17.9036 10.4464 18 9 18C7.55357 18 6.10714 17.9036 4.85357 17.7589C2.39464 17.5179 0.498214 15.6054 0.241071 13.1464C0.0964286 11.8929 0 10.4464 0 9C0 7.55357 0.0964286 6.10714 0.241071 4.8375C0.498214 2.39464 2.39464 0.482143 4.85357 0.241071C6.10714 0.0964286 7.55357 0 9 0C10.4464 0 11.8929 0.0964286 13.1625 0.241071C15.6054 0.482143 17.5179 2.39464 17.7589 4.8375C17.9036 6.10714 18 7.55357 18 9Z"),v(i,"viewBox","0 0 21 18"),v(i,"class","svelte-13drl8w"),v(d,"d","M5.88086 5.89441L9.53504 4.26746"),v(m,"d","M5.5274 8.78838L9.45391 9.55161"),v(b,"d","M3.49371 4.22065L5.55387 0.79198"),v(u,"class","lines svelte-13drl8w"),v(u,"viewBox","0 0 11 11"),v(e,"class","checkbox svelte-13drl8w")},m(S,M){F(S,e,M),g(e,t),t.checked=l[0],g(e,n),g(e,i),g(i,s),g(s,r),g(i,o),g(o,a),g(a,f),g(i,c),g(i,p),g(e,_),g(e,u),g(u,d),g(u,m),g(u,b),k||(h=le(t,"change",l[1]),k=!0)},p(S,[M]){M&1&&(t.checked=S[0])},i:ae,o:ae,d(S){S&&P(e),k=!1,h()}}}function Ss(l,e,t){let{checked:n=!1}=e;function i(){n=this.checked,t(0,n)}return l.$$set=s=>{"checked"in s&&t(0,n=s.checked)},[n,i]}class Ls extends ke{constructor(e){super(),ye(this,e,Ss,ks,he,{checked:0})}}function gl(l,e,t){const n=l.slice();return n[17]=e[t],n}function ml(l,e){let t,n=e[17].title.toLowerCase()+"",i;return{key:l,first:null,c(){t=y("div"),i=se(n),v(t,"class","flex tag svelte-n8zo8q"),N(t,"background",e[17].background_color),N(t,"color",e[17].color),this.first=t},m(s,r){F(s,t,r),g(t,i)},p(s,r){e=s,r&8&&n!==(n=e[17].title.toLowerCase()+"")&&pe(i,n),r&8&&N(t,"background",e[17].background_color),r&8&&N(t,"color",e[17].color)},d(s){s&&P(t)}}}function pl(l){var i;let e,t=l[12]((i=l[3])==null?void 0:i._lastTime)+"",n;return{c(){e=y("div"),n=se(t),v(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-n8zo8q")},m(s,r){F(s,e,r),g(e,n)},p(s,r){var o;r&8&&t!==(t=s[12]((o=s[3])==null?void 0:o._lastTime)+"")&&pe(n,t)},d(s){s&&P(e)}}}function hl(l){var i;let e,t=((i=l[3])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=y("div"),n=se(t),v(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-n8zo8q")},m(s,r){F(s,e,r),g(e,n)},p(s,r){var o;r&8&&t!==(t=((o=s[3])==null?void 0:o.unread_messages_count)+"")&&pe(n,t)},d(s){s&&P(e)}}}function Ms(l){var Se,Ae,Oe,ve,I,O,G,q,Z,X,oe,ce,ie,Te;let e,t,n,i,s,r,o=((Oe=(Ae=(Se=l[3])==null?void 0:Se.lead)==null?void 0:Ae.first_name)!=null?Oe:"")+"",a,f,c,p,_,u=((O=(I=(ve=l[3])==null?void 0:ve.lead)==null?void 0:I.last_name)!=null?O:"")+"",d,m,b,k,h=((Z=(q=(G=l[3])==null?void 0:G.last_message)==null?void 0:q.text)!=null?Z:"")+"",S,M,L,w,C,D,T,A,H=((X=l[4])==null?void 0:X.title)+"",ee,J,te,z,B,V=[],re=new Map,_e,W,U,Y,j=(ce=(oe=l[3])==null?void 0:oe.tag)!=null?ce:[];const K=$=>$[17].id;for(let $=0;$<j.length;$+=1){let me=gl(l,j,$),Ie=K(me);re.set(Ie,V[$]=ml(Ie,me))}let Q=((ie=l[3])==null?void 0:ie._lastTime)&&pl(l),fe=((Te=l[3])==null?void 0:Te.unread_messages_count)&&hl(l);return{c(){e=y("div"),t=y("div"),n=y("div"),i=y("div"),s=E(),r=y("div"),a=se(o),f=E(),c=y("div"),p=E(),_=y("div"),d=se(u),m=se("\xA0"),b=E(),k=y("div"),S=se(h),M=se("\xA0"),L=E(),w=y("div"),C=y("div"),D=y("img"),A=E(),ee=se(H),J=E(),te=y("div"),z=E(),B=y("div");for(let $=0;$<V.length;$+=1)V[$].c();_e=E(),Q&&Q.c(),W=E(),fe&&fe.c(),N(i,"width","8px"),N(c,"width","8px"),v(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-n8zo8q"),v(k,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-n8zo8q"),Xe(D.src,T="assets/icons/status1.png")||v(D,"src",T),v(D,"draggable","false"),v(D,"class","pos_abs statusIcon svelte-n8zo8q"),v(C,"class","flex flex_cy leadStatus pos_rel svelte-n8zo8q"),N(C,"background",l[4].bgColor),N(C,"color",l[4].color),N(te,"width","4px"),v(B,"class","flex tag_list svelte-n8zo8q"),v(w,"class","flex"),v(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-n8zo8q"),N(t,"height",l[0]+"px"),ne(t,"active",l[1]===l[6]),ne(t,"disabled",l[11](l[3])),v(e,"class","pos_abs w100 cntWrapper svelte-n8zo8q"),N(e,"transform","translate3d(0px, "+(l[5]+l[2])+"px, 0px)")},m($,me){F($,e,me),g(e,t),g(t,n),g(n,i),g(n,s),g(n,r),g(r,a),g(n,f),g(n,c),g(n,p),g(n,_),g(_,d),g(_,m),g(t,b),g(t,k),g(k,S),g(k,M),g(t,L),g(t,w),g(w,C),g(C,D),g(C,A),g(C,ee),g(w,J),g(w,te),g(w,z),g(w,B);for(let Ie=0;Ie<V.length;Ie+=1)V[Ie].m(B,null);g(t,_e),Q&&Q.m(t,null),g(t,W),fe&&fe.m(t,null),U||(Y=le(t,"click",l[10]),U=!0)},p($,[me]){var Ie,Ve,et,De,Je,ot,at,ft,Ut,qt,Yt,Wt,Vt,Jt;me&8&&o!==(o=((et=(Ve=(Ie=$[3])==null?void 0:Ie.lead)==null?void 0:Ve.first_name)!=null?et:"")+"")&&pe(a,o),me&8&&u!==(u=((ot=(Je=(De=$[3])==null?void 0:De.lead)==null?void 0:Je.last_name)!=null?ot:"")+"")&&pe(d,u),me&8&&h!==(h=((Ut=(ft=(at=$[3])==null?void 0:at.last_message)==null?void 0:ft.text)!=null?Ut:"")+"")&&pe(S,h),me&16&&H!==(H=((qt=$[4])==null?void 0:qt.title)+"")&&pe(ee,H),me&16&&N(C,"background",$[4].bgColor),me&16&&N(C,"color",$[4].color),me&8&&(j=(Wt=(Yt=$[3])==null?void 0:Yt.tag)!=null?Wt:[],V=qe(V,me,K,1,$,j,re,B,dn,ml,null,gl)),(Vt=$[3])!=null&&Vt._lastTime?Q?Q.p($,me):(Q=pl($),Q.c(),Q.m(t,W)):Q&&(Q.d(1),Q=null),(Jt=$[3])!=null&&Jt.unread_messages_count?fe?fe.p($,me):(fe=hl($),fe.c(),fe.m(t,null)):fe&&(fe.d(1),fe=null),me&1&&N(t,"height",$[0]+"px"),me&66&&ne(t,"active",$[1]===$[6]),me&2056&&ne(t,"disabled",$[11]($[3])),me&36&&N(e,"transform","translate3d(0px, "+($[5]+$[2])+"px, 0px)")},i:ae,o:ae,d($){$&&P(e);for(let me=0;me<V.length;me+=1)V[me].d();Q&&Q.d(),fe&&fe.d(),U=!1,Y()}}}function Ts(l,e,t){let n,i,s,r,o,{app:a}=e;const{dialogMap_r:f,dialogActiveID_r:c,dialogActiveID_Set:p}=a;Le(l,f,M=>t(15,s=M)),Le(l,c,M=>t(6,o=M));let{height:_=54}=e,{dialog_id:u}=e,{y:d=0}=e,{scrollY:m=0}=e;const b=Ge(d);Le(l,b,M=>t(5,r=M));const k=M=>{n&&!h(n)&&p(n.id)},h=M=>{var L;return((L=M==null?void 0:M.lead)==null?void 0:L.status)==="DL"},S=M=>{if(!M)return"";const L=C=>String(C).padStart(2,"0"),w=new Date;return M=new Date(M),M.getYear()===w.getYear()&&M.getMonth()===w.getMonth()?M.getDate()===w.getDate()?`${L(M.getHours())}:${L(M.getMinutes())}`:`${L(M.getDate())}d ${L(M.getHours())}:${L(M.getMinutes())}`:`${L(M.getDate())}.${L(M.getMonth())}.${M.getFullYear()}`};return l.$$set=M=>{"app"in M&&t(13,a=M.app),"height"in M&&t(0,_=M.height),"dialog_id"in M&&t(1,u=M.dialog_id),"y"in M&&t(14,d=M.y),"scrollY"in M&&t(2,m=M.scrollY)},l.$$.update=()=>{l.$$.dirty&16384&&Be(b,r=d,r),l.$$.dirty&32770&&t(3,n=s[u]),l.$$.dirty&8200&&t(4,i=a.lead_GetStatusOrDefault(n==null?void 0:n.lead))},[_,u,m,n,i,r,o,f,c,b,k,h,S,a,d,s]}class Is extends ke{constructor(e){super(),ye(this,e,Ts,Ms,he,{app:13,height:0,dialog_id:1,y:14,scrollY:2})}}function Ds(l){let e,t,n,i;return{c(){e=y("div"),t=y("div"),v(t,"class","pos_abs thumb w100 svelte-5ca5ia"),N(t,"height",l[1]+"px"),N(t,"transform","translate(0px, "+l[5](l[0],l[2],l[1])+"px)"),ne(t,"active",l[3]),v(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),ne(e,"active",l[3])},m(s,r){F(s,e,r),g(e,t),n||(i=[le(window,"mousemove",l[7]),le(window,"mouseup",l[8]),le(window,"blur",l[8]),le(t,"mousedown",l[6]),$e(gs.call(null,e,l[4])),le(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&N(t,"height",s[1]+"px"),r&7&&N(t,"transform","translate(0px, "+s[5](s[0],s[2],s[1])+"px)"),r&8&&ne(t,"active",s[3]),r&8&&ne(e,"active",s[3])},i:ae,o:ae,d(s){s&&P(e),n=!1,je(i)}}}function Os(l,e,t){let n;const i=S=>ze(0,Array.isArray(S)?S[0]:S,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:a=null}=e;const f=He(null);Le(l,f,S=>t(2,n=S));const c=()=>n?n.height-o:1,p=S=>n?S*c():0,_=()=>{if(!n)return 1;if(a===null)return o;t(1,o=ze(.1,a,1)*n.height)};let u=null;const d=S=>{!n||t(3,u={y:S.clientY,value_out:r})},m=S=>{if(!n||!u)return;const M=S.clientY-u.y;if(n.height){const L=M/c();t(0,r=ze(0,u.value_out+L,1))}},b=S=>{t(3,u=null)},k=S=>{!n||u||(t(0,r=ze(0,(S.clientY-n.y-o/2)/c(),1)),t(3,u={y:S.clientY,value_out:r}))},h=()=>{if(!n)return 0;u||t(0,r=i(s))};return l.$$set=S=>{"value_in"in S&&t(10,s=S.value_in),"value_out"in S&&t(0,r=S.value_out),"thumb_Height"in S&&t(1,o=S.thumb_Height),"thumb_HeightRate"in S&&t(11,a=S.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&_(),l.$$.dirty&1024&&h()},[r,o,n,u,f,p,d,m,b,k,s,a]}class wn extends ke{constructor(e){super(),ye(this,e,Os,Ds,he,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:Cs}=un;function vl(l,e,t){const n=l.slice();return n[24]=e[t],n}function bl(l,e){let t,n,i;return n=new Is({props:{app:e[0],dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Ue(),ge(n.$$.fragment),this.first=t},m(s,r){F(s,t,r),ue(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(x(n.$$.fragment,s),i=!0)},o(s){R(n.$$.fragment,s),i=!1},d(s){s&&P(t),de(n,s)}}}function wl(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new wn({props:r}),xe.push(()=>bt(t,"value_out",s)),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,a){F(o,e,a),ue(t,e,null),i=!0},p(o,a){const f={};a&32&&(f.value_in=o[5]),a&64&&(f.thumb_HeightRate=o[6]),!n&&a&2&&(n=!0,f.value_out=o[1],vt(()=>n=!1)),t.$set(f)},i(o){i||(x(t.$$.fragment,o),i=!0)},o(o){R(t.$$.fragment,o),i=!1},d(o){o&&P(e),de(t)}}}function yl(l){let e,t,n,i,s;return{c(){e=y("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',v(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){F(r,e,o),n=!0,i||(s=le(e,"click",l[15]),i=!0)},p:ae,i(r){n||(r&&Ee(()=>{t||(t=Me(e,Ce,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Me(e,Ce,{},!1)),t.run(0)),n=!1},d(r){r&&P(e),r&&t&&t.end(),i=!1,s()}}}function Es(l){let e,t,n=[],i=new Cs,s,r,o,a,f,c=l[4];const p=d=>d[24].dialog_id;for(let d=0;d<c.length;d+=1){let m=vl(l,c,d),b=p(m);i.set(b,n[d]=bl(b,m))}let _=l[6]<1&&wl(l),u=l[6]<1&&l[7]&&yl(l);return{c(){e=y("div"),t=y("div");for(let d=0;d<n.length;d+=1)n[d].c();s=E(),_&&_.c(),r=E(),u&&u.c(),v(t,"class","flex overhide pos_rel"),v(e,"class","flex flex_grow_1 pos_rel"),N(e,"--itemHeight",Ye+"px")},m(d,m){F(d,e,m),g(e,t);for(let b=0;b<n.length;b+=1)n[b].m(t,null);g(e,s),_&&_.m(e,null),g(e,r),u&&u.m(e,null),o=!0,a||(f=[$e(rt.call(null,t,l[8])),le(e,"wheel",l[10],{passive:!0})],a=!0)},p(d,[m]){m&21&&(c=d[4],be(),n=qe(n,m,p,1,d,c,i,t,Ke,bl,null,vl),we()),d[6]<1?_?(_.p(d,m),m&64&&x(_,1)):(_=wl(d),_.c(),x(_,1),_.m(e,r)):_&&(be(),R(_,1,1,()=>{_=null}),we()),d[6]<1&&d[7]?u?(u.p(d,m),m&192&&x(u,1)):(u=yl(d),u.c(),x(u,1),u.m(e,null)):u&&(be(),R(u,1,1,()=>{u=null}),we())},i(d){if(!o){for(let m=0;m<c.length;m+=1)x(n[m]);x(_),x(u),o=!0}},o(d){for(let m=0;m<n.length;m+=1)R(n[m]);R(_),R(u),o=!1},d(d){d&&P(e);for(let m=0;m<n.length;m+=1)n[m].d();_&&_.d(),u&&u.d(),a=!1,je(f)}}}const Ye=54;function js(l,e,t){let n,i,s=ae,r=()=>(s(),s=zt(d,J=>t(13,i=J)),d),o;l.$$.on_destroy.push(()=>s());let{app:a}=e;const{dialogMap_SetDialogList:f}=a;let{filter:c={}}=e;const p=J=>{var te;return[c.filterUnreadFirst?1:0,(te=c.filterTag)!=null?te:""].join("/")};let _={},u=null,d=He(null);r();function m(){const J={...c},te=p();_[te]||(_[te]=Gn({fLoad:z=>(z={unread_first:J.filterUnreadFirst?1:0,...z},J.filterTag&&(z.tag=J.filterTag),a.api.dialog_GetList(z)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:f})),u!==_[te]&&([...Object.values(_)].map(z=>z.pause()),u=_[te],u.resume(),console.log({filterHash:te}),r(t(3,d=u.getData_r())))}Fe(()=>[...Object.values(_)].map(J=>J.destroy()));let b=[];const k=He(null);Le(l,k,J=>t(12,n=J));let h=0,S=0,M=1,L=0,w=Ge(L,{duration:200});Le(l,w,J=>t(2,o=J));function C(){if(!n||!i)return;const J=Math.max(1,Math.floor(n.height)),te=i.total*Ye,z=te-J;t(6,M=te?ze(0,J/te,1):1),z<0?L=0:L=S*z,Be(w,o=L,o)}let D=!1;function T(){if(!n||!i)return;const J=i,te=Math.max(1,Math.floor(n.height)),z=Math.ceil(te/Ye);i.total*Ye;let V=Math.max(0,Math.floor(o/Ye)-1);const re=z+2;V>J.total&&(V=Math.max(0,J.total-re)),u&&u.setRange(V,re);const _e=[];for(let W=V,U=0;U<re&&W<J.total;U++,W++){const Y=J.list[W];_e.push({index:W,item:Y,y:W*Ye})}t(4,b=[...new Map(_e.filter(W=>W.item).map(W=>[W.item.id,W]))].map(([W,U])=>({dialog_id:U.item.id,y:U.y}))),t(7,D=V>1)}const A=J=>{if(!n||!i)return;const te=i,z=Math.max(1,Math.floor(n.height)),V=te.total*Ye-z;if(V<0)return;const re=J.deltaY>0?1:-1;t(5,h=[S+Ye/V*re])};function H(J){S=J,t(1,S)}const ee=()=>t(5,h=[0]);return l.$$set=J=>{"app"in J&&t(0,a=J.app),"filter"in J&&t(11,c=J.filter)},l.$$.update=()=>{l.$$.dirty&2048&&m(),l.$$.dirty&12290&&C(),l.$$.dirty&12292&&T()},[a,S,o,d,b,h,M,D,k,w,A,c,n,i,H,ee]}class As extends ke{constructor(e){super(),ye(this,e,js,Es,he,{app:0,filter:11})}}function kl(l,e,t){const n=l.slice();return n[5]=e[t],n}function Sl(l,e){let t,n=e[5].title+"",i,s,r;function o(){return e[4](e[5])}return{key:l,first:null,c(){t=y("div"),i=se(n),v(t,"class","cursor_ptr filter_tag inactive svelte-1t7cez8"),N(t,"background",e[5].background_color),N(t,"color",e[5].color),ne(t,"active",e[0]===e[5].title),this.first=t},m(a,f){F(a,t,f),g(t,i),s||(r=le(t,"click",o),s=!0)},p(a,f){e=a,f&3&&ne(t,"active",e[0]===e[5].title)},d(a){a&&P(t),s=!1,r()}}}function xs(l){let e,t,n,i,s,r,o=[],a=new Map,f,c,p=l[1];const _=u=>u[5].title;for(let u=0;u<p.length;u+=1){let d=kl(l,p,u),m=_(d);a.set(m,o[u]=Sl(m,d))}return{c(){e=y("div"),t=y("div"),t.textContent="Filter tag",n=E(),i=y("div"),s=y("div"),s.textContent="all",r=E();for(let u=0;u<o.length;u+=1)o[u].c();v(t,"class","flex label svelte-1t7cez8"),v(s,"class","cursor_ptr filter_tag inactive svelte-1t7cez8"),N(s,"background","#fff"),N(s,"color","#000"),ne(s,"active",l[0]===null),v(i,"class","flex filter_tag_list svelte-1t7cez8"),v(e,"class","flex flex_clm cnt unselect svelte-1t7cez8")},m(u,d){F(u,e,d),g(e,t),g(e,n),g(e,i),g(i,s),g(i,r);for(let m=0;m<o.length;m+=1)o[m].m(i,null);f||(c=le(s,"click",l[3]),f=!0)},p(u,[d]){d&1&&ne(s,"active",u[0]===null),d&3&&(p=u[1],o=qe(o,d,_,1,u,p,a,i,dn,Sl,null,kl))},i:ae,o:ae,d(u){u&&P(e);for(let d=0;d<o.length;d+=1)o[d].d();f=!1,c()}}}function Ns(l,e,t){let{app:n}=e,{filterTag:i=null}=e,s=[...g_Config.pinnedTags];const r=()=>t(0,i=null),o=a=>t(0,i=a.title);return l.$$set=a=>{"app"in a&&t(2,n=a.app),"filterTag"in a&&t(0,i=a.filterTag)},[i,s,n,r,o]}class Ps extends ke{constructor(e){super(),ye(this,e,Ns,xs,he,{app:2,filterTag:0})}}function Ll(l){let e,t,n,i,s,r,o,a,f;return{c(){e=y("img"),n=E(),i=y("div"),s=y("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',r=E(),o=y("div"),o.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/fullscreen.png"/>',v(e,"class","a_img svelte-1m8yuzj"),Xe(e.src,t=l[2].url)||v(e,"src",t),N(e,"max-height",l[4]+"px"),v(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),v(o,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),v(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(c,p){F(c,e,p),F(c,n,p),F(c,i,p),g(i,s),g(i,r),g(i,o),a||(f=[le(s,"click",function(){Pe(l[5](l[2]))&&l[5](l[2]).apply(this,arguments)}),le(o,"click",function(){Pe(l[6](l[2]))&&l[6](l[2]).apply(this,arguments)})],a=!0)},p(c,p){l=c,p&4&&!Xe(e.src,t=l[2].url)&&v(e,"src",t),p&16&&N(e,"max-height",l[4]+"px")},d(c){c&&P(e),c&&P(n),c&&P(i),a=!1,je(f)}}}function Ml(l){let e,t,n,i,s,r,o;return{c(){e=y("img"),n=E(),i=y("div"),s=y("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',v(e,"class","a_img fileIcon svelte-1m8yuzj"),Xe(e.src,t="assets/icons/folder.png")||v(e,"src",t),N(e,"max-height",l[4]+"px"),v(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),v(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(a,f){F(a,e,f),F(a,n,f),F(a,i,f),g(i,s),r||(o=le(s,"click",l[13]),r=!0)},p(a,f){f&16&&N(e,"max-height",a[4]+"px")},d(a){a&&P(e),a&&P(n),a&&P(i),r=!1,o()}}}function Tl(l){var i;let e,t=((i=l[0])==null?void 0:i.text)+"",n;return{c(){e=y("pre"),n=se(t),v(e,"class","w100 text textPre svelte-1m8yuzj")},m(s,r){F(s,e,r),g(e,n)},p(s,r){var o;r&1&&t!==(t=((o=s[0])==null?void 0:o.text)+"")&&pe(n,t)},d(s){s&&P(e)}}}function zs(l){var p,_;let e,t,n,i,s,r=l[7]((p=l[0])==null?void 0:p.received_at)+"",o,a=l[2]&&Ll(l),f=l[3]&&Ml(l),c=((_=l[0])==null?void 0:_.text)&&Tl(l);return{c(){var u,d,m,b;e=y("div"),a&&a.c(),t=E(),f&&f.c(),n=E(),c&&c.c(),i=E(),s=y("div"),o=se(r),v(s,"class","flex pos_abs unselect date svelte-1m8yuzj"),ne(s,"attachment_mode",l[2]&&!((u=l[0])!=null&&u.text)),v(e,"class","flex flex_clm overhide pos_abs chat_item svelte-1m8yuzj"),ne(e,"chat_item_other",(d=l[0])==null?void 0:d.incoming),ne(e,"chat_item_self",!((m=l[0])!=null&&m.incoming)),ne(e,"has_text",(b=l[0])==null?void 0:b.text)},m(u,d){F(u,e,d),a&&a.m(e,null),g(e,t),f&&f.m(e,null),g(e,n),c&&c.m(e,null),g(e,i),g(e,s),g(s,o),l[14](e)},p(u,[d]){var m,b,k,h,S,M;u[2]?a?a.p(u,d):(a=Ll(u),a.c(),a.m(e,t)):a&&(a.d(1),a=null),u[3]?f?f.p(u,d):(f=Ml(u),f.c(),f.m(e,n)):f&&(f.d(1),f=null),(m=u[0])!=null&&m.text?c?c.p(u,d):(c=Tl(u),c.c(),c.m(e,i)):c&&(c.d(1),c=null),d&1&&r!==(r=u[7]((b=u[0])==null?void 0:b.received_at)+"")&&pe(o,r),d&5&&ne(s,"attachment_mode",u[2]&&!((k=u[0])!=null&&k.text)),d&1&&ne(e,"chat_item_other",(h=u[0])==null?void 0:h.incoming),d&1&&ne(e,"chat_item_self",!((S=u[0])!=null&&S.incoming)),d&1&&ne(e,"has_text",(M=u[0])==null?void 0:M.text)},i:ae,o:ae,d(u){u&&P(e),a&&a.d(),f&&f.d(),c&&c.d(),l[14](null)}}}function Fs(l,e,t){let{app:n}=e,{bbox:i=null}=e,{message:s=null}=e,{render_Width:r=1}=e,{render_X:o=-r*2}=e,a=null,f=null,c=null,p=null,_=[],u=[],d=1;function m(w){var D;_=[],u=[],w&&(D=w.attachments)!=null&&D.length&&(_=w.attachments.filter(T=>T.file_type==="IM").map(T=>({url:T.url})),u=w.attachments.filter(T=>T.file_type==="DC").map(T=>({url:T.url})));const C=i.height*.7;i.width,t(4,d=C),t(2,c=_==null?void 0:_[0]),t(3,p=u==null?void 0:u[0])}function b(w){if(!w||!Array.isArray(w.attachments)){t(0,f=null);return}if(!f){t(0,f=w);return}if(f.text!==w.text||f.incoming!==w.incoming||f.received_at!==w.received_at||f.attachments.length!==w.attachments.length){t(0,f=w);return}if(!f.attachments.map((C,D)=>[C,w.attachments[D]]).every(([C,D])=>C.file_type===D.file_type&&C.url===D.url)){t(0,f=w);return}}const k=w=>C=>{w&&w.url&&xt(w.url)},h=w=>C=>{w&&w.url&&n.events.emit("openOverlayImageView",w.url)},S=w=>{if(w===null)return"";const C=T=>String(T).padStart(2,"0"),D=new Date;return w=new Date(w),w.getYear()===D.getYear()&&w.getMonth()===D.getMonth()&&w.getDate()===D.getDate()?`${C(w.getHours())}:${C(w.getMinutes())}`:`${C(w.getDate())}.${C(w.getMonth())}.${w.getFullYear()} ${C(w.getHours())}:${C(w.getMinutes())}`},M=()=>mn(p.url);function L(w){xe[w?"unshift":"push"](()=>{a=w,t(1,a)})}return l.$$set=w=>{"app"in w&&t(8,n=w.app),"bbox"in w&&t(9,i=w.bbox),"message"in w&&t(10,s=w.message),"render_Width"in w&&t(11,r=w.render_Width),"render_X"in w&&t(12,o=w.render_X)},l.$$.update=()=>{l.$$.dirty&1024&&b(s),l.$$.dirty&1&&m(f)},[f,a,c,p,d,k,h,S,n,i,s,r,o,M,L]}class Hs extends ke{constructor(e){super(),ye(this,e,Fs,zs,he,{app:8,bbox:9,message:10,render_Width:11,render_X:12})}}function Rs(l){let e;return{c(){e=y("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,v(e,"class","lds-roller svelte-j15bjw")},m(t,n){F(t,e,n)},p:ae,i:ae,o:ae,d(t){t&&P(e)}}}class Lt extends ke{constructor(e){super(),ye(this,e,null,Rs,he,{})}}const Il=(l,{delay:e=0,duration:t=400,easing:n=_n}={})=>{const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.width),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),p=parseFloat(i.borderTopWidth),_=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*s};width: ${u*r}px;padding-top: ${u*o}px;padding-bottom: ${u*a}px;margin-top: ${u*f}px;margin-bottom: ${u*c}px;border-top-width: ${u*p}px;border-bottom-width: ${u*_}px;`}};function Dl(l){let e;return{c(){e=y("div"),e.textContent=">",v(e,"class","flex flex_cx flex_cy statusItemDlm svelte-1pt3u5i")},m(t,n){F(t,e,n)},d(t){t&&P(e)}}}function Bs(l){var f,c,p,_;let e,t,n,i,s=((_=(f=l[2])==null?void 0:f.title)!=null?_:(c=l[2])!=null&&c.id?`#${(p=l[2])==null?void 0:p.id}`:"*UNK*")+"",r,o,a=l[0]&&Dl();return{c(){var u,d,m,b;e=y("div"),t=y("div"),a&&a.c(),n=E(),i=y("div"),r=se(s),v(i,"class","flex flex_cx flex_cy nowrap statusItem svelte-1pt3u5i"),N(i,"background",(d=(u=l[2])==null?void 0:u.bgColor)!=null?d:"#000"),N(i,"color",(b=(m=l[2])==null?void 0:m.color)!=null?b:"#fff"),v(t,"class","flex"),v(e,"class","flex flex_cy h100 overhide itemWrapper svelte-1pt3u5i"),v(e,"style",o=l[1]?"width: 0px;":"")},m(u,d){F(u,e,d),g(e,t),a&&a.m(t,null),g(t,n),g(t,i),g(i,r),l[5](t),l[6](e)},p(u,[d]){var m,b,k,h,S,M,L,w;u[0]?a||(a=Dl(),a.c(),a.m(t,n)):a&&(a.d(1),a=null),d&4&&s!==(s=((h=(m=u[2])==null?void 0:m.title)!=null?h:(b=u[2])!=null&&b.id?`#${(k=u[2])==null?void 0:k.id}`:"*UNK*")+"")&&pe(r,s),d&4&&N(i,"background",(M=(S=u[2])==null?void 0:S.bgColor)!=null?M:"#000"),d&4&&N(i,"color",(w=(L=u[2])==null?void 0:L.color)!=null?w:"#fff"),d&2&&o!==(o=u[1]?"width: 0px;":"")&&v(e,"style",o)},i:ae,o:ae,d(u){u&&P(e),a&&a.d(),l[5](null),l[6](null)}}}function Gs(l,e,t){let{beforeDlm:n=!1}=e,{hide:i=!1}=e,{status:s={}}=e,r,o;Cn(()=>{r&&o&&t(3,r.style.width=o.offsetWidth+"px",r)});function a(c){xe[c?"unshift":"push"](()=>{o=c,t(4,o)})}function f(c){xe[c?"unshift":"push"](()=>{r=c,t(3,r)})}return l.$$set=c=>{"beforeDlm"in c&&t(0,n=c.beforeDlm),"hide"in c&&t(1,i=c.hide),"status"in c&&t(2,s=c.status)},[n,i,s,r,o,a,f]}class Us extends ke{constructor(e){super(),ye(this,e,Gs,Bs,he,{beforeDlm:0,hide:1,status:2})}}function Ol(l,e,t){const n=l.slice();return n[8]=e[t],n[10]=t,n}function Cl(l,e){var s;let t,n,i;return n=new Us({props:{beforeDlm:(s=e[8].status)==null?void 0:s.beforeDlm,status:e[8].status,hide:e[8].hide}}),{key:l,first:null,c(){t=Ue(),ge(n.$$.fragment),this.first=t},m(r,o){F(r,t,o),ue(n,r,o),i=!0},p(r,o){var f;e=r;const a={};o&1&&(a.beforeDlm=(f=e[8].status)==null?void 0:f.beforeDlm),o&1&&(a.status=e[8].status),o&1&&(a.hide=e[8].hide),n.$set(a)},i(r){i||(x(n.$$.fragment,r),i=!0)},o(r){R(n.$$.fragment,r),i=!1},d(r){r&&P(t),de(n,r)}}}function qs(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[8].rID;for(let o=0;o<s.length;o+=1){let a=Ol(l,s,o),f=r(a);n.set(f,t[o]=Cl(f,a))}return{c(){e=y("div");for(let o=0;o<t.length;o+=1)t[o].c();v(e,"class","flex h100")},m(o,a){F(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],be(),t=qe(t,a,r,1,o,s,n,e,Ke,Cl,null,Ol),we())},i(o){if(!i){for(let a=0;a<s.length;a+=1)x(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)R(t[a]);i=!1},d(o){o&&P(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Ys(l,e,t){let{app:n}=e,{statusList:i=[]}=e,{statusSelectList:s=[]}=e,r=[],o=1;Fe(St(1e3,()=>{const f=Date.now();t(0,r=r.filter(c=>!c.hide||c.hide<=f))}));const a=()=>{r.forEach(f=>{f.hide||i.find(c=>{var p;return((p=f==null?void 0:f.status)==null?void 0:p.id)===(c==null?void 0:c.id)})||(f.hide=Date.now()+1e3)}),i.forEach(f=>{r.find(c=>{var p;return!c.hide&&((p=c==null?void 0:c.status)==null?void 0:p.id)===(f==null?void 0:f.id)})||r.push({rID:o++,status:f,hide:!1})}),t(0,r)};return l.$$set=f=>{"app"in f&&t(1,n=f.app),"statusList"in f&&t(2,i=f.statusList),"statusSelectList"in f&&t(3,s=f.statusSelectList)},l.$$.update=()=>{l.$$.dirty&4&&a()},[r,n,i,s]}class Ws extends ke{constructor(e){super(),ye(this,e,Ys,qs,he,{app:1,statusList:2,statusSelectList:3})}}function El(l,e,t){const n=l.slice();return n[27]=e[t],n[29]=t,n}function jl(l){var k;let e,t,n,i,s,r,o,a,f,c,p,_,u,d;f=new Ws({props:{statusList:l[0].lead_GetStatusHistory((k=l[1])==null?void 0:k.lead).map(Pl)}});let m=l[3]&&!l[4]&&Al(l),b=l[4]&&Nl();return{c(){e=y("div"),t=y("div"),n=y("div"),i=E(),s=y("img"),o=E(),a=y("div"),ge(f.$$.fragment),c=E(),m&&m.c(),p=E(),b&&b.c(),v(n,"class","pos_abs w100 h100 deleteProgress svelte-socr2e"),N(n,"width",l[2]+"%"),v(t,"class","pos_abs w100 h100 overhide bg svelte-socr2e"),Xe(s.src,r="assets/icons/status1.png")||v(s,"src",r),v(s,"draggable","false"),v(s,"class","pos_abs statusIcon svelte-socr2e"),v(a,"class","flex flex_cy "),N(a,"z-index","200"),v(e,"class","flex flex_cx flex_cy cursor_ptr unselect statusCnt pos_rel svelte-socr2e"),ne(e,"loading",l[4])},m(h,S){F(h,e,S),g(e,t),g(t,n),g(e,i),g(e,s),g(e,o),g(e,a),ue(f,a,null),g(e,c),m&&m.m(e,null),g(e,p),b&&b.m(e,null),l[15](e),_=!0,u||(d=[le(e,"mouseenter",l[16]),le(e,"mouseleave",l[17]),le(e,"click",l[18])],u=!0)},p(h,S){var L;(!_||S&4)&&N(n,"width",h[2]+"%");const M={};S&3&&(M.statusList=h[0].lead_GetStatusHistory((L=h[1])==null?void 0:L.lead).map(Pl)),f.$set(M),h[3]&&!h[4]?m?(m.p(h,S),S&24&&x(m,1)):(m=Al(h),m.c(),x(m,1),m.m(e,p)):m&&(be(),R(m,1,1,()=>{m=null}),we()),h[4]?b?S&16&&x(b,1):(b=Nl(),b.c(),x(b,1),b.m(e,null)):b&&(be(),R(b,1,1,()=>{b=null}),we()),(!_||S&16)&&ne(e,"loading",h[4])},i(h){_||(x(f.$$.fragment,h),x(m),x(b),_=!0)},o(h){R(f.$$.fragment,h),R(m),R(b),_=!1},d(h){h&&P(e),de(f),m&&m.d(),b&&b.d(),l[15](null),u=!1,je(d)}}}function Al(l){let e,t,n,i=l[7],s=[];for(let r=0;r<i.length;r+=1)s[r]=xl(El(l,i,r));return{c(){e=y("div");for(let r=0;r<s.length;r+=1)s[r].c();v(e,"class","flex flex_cy"),N(e,"z-index","100")},m(r,o){F(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,o){if(o&3202){i=r[7];let a;for(a=0;a<i.length;a+=1){const f=El(r,i,a);s[a]?s[a].p(f,o):(s[a]=xl(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}},i(r){n||(r&&Ee(()=>{t||(t=Me(e,Il,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Me(e,Il,{},!1)),t.run(0)),n=!1},d(r){r&&P(e),kt(s,r),r&&t&&t.end()}}}function Vs(l){let e;return{c(){e=y("div"),N(e,"min-width","4px")},m(t,n){F(t,e,n)},d(t){t&&P(e)}}}function Js(l){let e;return{c(){e=y("div"),e.textContent=">",v(e,"class","flex flex_cx flex_cy statusItemDlm svelte-socr2e")},m(t,n){F(t,e,n)},d(t){t&&P(e)}}}function xl(l){let e,t,n=l[27].title+"",i,s,r;function o(c,p){return c[29]===0?Js:Vs}let f=o(l)(l);return{c(){f.c(),e=E(),t=y("div"),i=se(n),v(t,"class","flex flex_cx flex_cy nowrap statusItem select svelte-socr2e"),N(t,"background",l[27].bgColor),N(t,"color",l[27].color)},m(c,p){f.m(c,p),F(c,e,p),F(c,t,p),g(t,i),s||(r=[le(t,"click",function(){Pe(l[10](l[1],l[27]))&&l[10](l[1],l[27]).apply(this,arguments)}),le(t,"mousedown",function(){Pe(l[11](l[1],l[27]))&&l[11](l[1],l[27]).apply(this,arguments)})],s=!0)},p(c,p){l=c,p&128&&n!==(n=l[27].title+"")&&pe(i,n),p&128&&N(t,"background",l[27].bgColor),p&128&&N(t,"color",l[27].color)},d(c){f.d(c),c&&P(e),c&&P(t),s=!1,je(r)}}}function Nl(l){let e,t,n,i;return t=new hn({props:{height:"6"}}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","flex pos_abs flex_cy h100 loadingInd svelte-socr2e"),N(e,"filter","invert(0)")},m(s,r){F(s,e,r),ue(t,e,null),i=!0},i(s){i||(x(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function Xs(l){let e,t,n,i,s=l[1]&&l[1].lead&&jl(l);return{c(){s&&s.c(),e=Ue()},m(r,o){s&&s.m(r,o),F(r,e,o),t=!0,n||(i=[le(window,"mouseup",l[12]),le(window,"mousedown",l[9]),le(window,"blur",l[9])],n=!0)},p(r,[o]){r[1]&&r[1].lead?s?(s.p(r,o),o&2&&x(s,1)):(s=jl(r),s.c(),x(s,1),s.m(e.parentNode,e)):s&&(be(),R(s,1,1,()=>{s=null}),we())},i(r){t||(x(s),t=!0)},o(r){R(s),t=!1},d(r){s&&s.d(r),r&&P(e),n=!1,je(i)}}}const Pl=(l,e)=>({...l,beforeDlm:e!==0});function Ks(l,e,t){let n,i,s,r,o=ae,a=()=>(o(),o=zt(w,z=>t(2,r=z)),w);l.$$.on_destroy.push(()=>o());let{app:f}=e;const{dialogMap_r:c,dialogMap_SetDialog:p}=f;Le(l,c,z=>t(14,s=z));let{dialog_id:_}=e,u=!1,d=!1;const m=()=>{var z;return!(!n||!n.lead||((z=n==null?void 0:n.lead)==null?void 0:z.status)==="DL"||d)};let b;const k=z=>{let B=z.target;for(;B;){if(B===b)return;B=B.parentNode}t(3,u=!1)},h=(z,B,V=!1)=>async re=>{if(!m()||!V&&B.protection)return;const _e=B.id;if(t(3,u=!1),A({status:_e}).length||t(7,i=[]),t(4,d=!0),z){const W=await f.api.lead_SetStatus(z.lead.tg_id,_e);W&&z&&z.lead&&z.lead.tg_id===W.tg_id&&(z.lead=W,p(z))}t(4,d=!1)};let S=null,M=null,L=Number.POSITIVE_INFINITY,w=Ge(0,{duration:2e3});a();const C=(z,B)=>V=>{var re;!B.protection||(S=(re=z==null?void 0:z.lead)==null?void 0:re.tg_id,L=Date.now(),M=B,a(t(6,w=Ge(r,{duration:2e3}))),Be(w,r=100,r))},D=z=>{t(3,u=!1),S=null,L=Number.POSITIVE_INFINITY,a(t(6,w=Ge(r,{duration:200}))),Be(w,r=0,r)},T=async()=>{var z;!m()||(M&&L+1200<Date.now()&&S===((z=n==null?void 0:n.lead)==null?void 0:z.tg_id)&&await h(n,M,!0)(),D())},A=z=>{var B,V,re;try{const _e=f.lead_GetStatusID(z);return((re=(V=(B=f==null?void 0:f.appConfig)==null?void 0:B.lead_StatusJumpMap)==null?void 0:V[_e])!=null?re:[]).map(f==null?void 0:f.lead_GetStatusByID).filter(Boolean)}catch{}return[]};function H(z){xe[z?"unshift":"push"](()=>{b=z,t(5,b)})}const ee=()=>t(3,u=!0),J=()=>t(3,u=!1),te=()=>t(3,u=!0);return l.$$set=z=>{"app"in z&&t(0,f=z.app),"dialog_id"in z&&t(13,_=z.dialog_id)},l.$$.update=()=>{l.$$.dirty&4&&r>=100&&T(),l.$$.dirty&24576&&t(1,n=s[_]),l.$$.dirty&2&&t(7,i=A(n==null?void 0:n.lead))},[f,n,r,u,d,b,w,i,c,k,h,C,D,_,s,H,ee,J,te]}class Zs extends ke{constructor(e){super(),ye(this,e,Ks,Xs,he,{app:0,dialog_id:13})}}function zl(l,e,t){const n=l.slice();return n[20]=e[t],n}function Fl(l,e,t){const n=l.slice();return n[20]=e[t],n}function Hl(l){var u,d;let e,t,n,i=[],s=new Map,r,o,a,f,c=(d=(u=l[0])==null?void 0:u.tag)!=null?d:[];const p=m=>m[20].id;for(let m=0;m<c.length;m+=1){let b=Fl(l,c,m),k=p(b);s.set(k,i[m]=Bl(k,b))}let _=l[1]!==null&&l[0]&&l[1]===l[0].id&&l[3].length&&Gl(l);return{c(){e=y("div"),t=y("div"),t.innerHTML=`Add tag
			<div class="flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6">+</div>`,n=E();for(let m=0;m<i.length;m+=1)i[m].c();r=E(),_&&_.c(),v(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),ne(t,"disabled",l[3].length===0),v(e,"class","flex tag_list unselect pos_rel svelte-elfos6")},m(m,b){F(m,e,b),g(e,t),g(e,n);for(let k=0;k<i.length;k+=1)i[k].m(e,null);g(e,r),_&&_.m(e,null),l[14](e),o=!0,a||(f=le(t,"click",l[13]),a=!0)},p(m,b){var k,h;(!o||b&8)&&ne(t,"disabled",m[3].length===0),b&325&&(c=(h=(k=m[0])==null?void 0:k.tag)!=null?h:[],be(),i=qe(i,b,p,1,m,c,s,e,Ke,Bl,r,Fl),we()),m[1]!==null&&m[0]&&m[1]===m[0].id&&m[3].length?_?(_.p(m,b),b&11&&x(_,1)):(_=Gl(m),_.c(),x(_,1),_.m(e,null)):_&&(be(),R(_,1,1,()=>{_=null}),we())},i(m){if(!o){for(let b=0;b<c.length;b+=1)x(i[b]);x(_),o=!0}},o(m){for(let b=0;b<i.length;b+=1)R(i[b]);R(_),o=!1},d(m){m&&P(e);for(let b=0;b<i.length;b+=1)i[b].d();_&&_.d(),l[14](null),a=!1,f()}}}function Rl(l){let e,t,n;return t=new Lt({}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){F(i,e,s),ue(t,e,null),n=!0},i(i){n||(x(t.$$.fragment,i),n=!0)},o(i){R(t.$$.fragment,i),n=!1},d(i){i&&P(e),de(t)}}}function Bl(l,e){let t,n=e[20].title.toLowerCase()+"",i,s,r,o,a=e[2]===e[6](e[0].id,e[20]),f,c,p,_=a&&Rl();return{key:l,first:null,c(){t=y("div"),i=se(n),s=E(),r=y("div"),r.textContent="X",o=E(),_&&_.c(),v(r,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),v(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag svelte-elfos6"),N(t,"background",e[20].background_color),N(t,"color",e[20].color),ne(t,"disabled",e[2]),this.first=t},m(u,d){F(u,t,d),g(t,i),g(t,s),g(t,r),g(t,o),_&&_.m(t,null),f=!0,c||(p=le(t,"click",function(){Pe(e[8](e[20]))&&e[8](e[20]).apply(this,arguments)}),c=!0)},p(u,d){e=u,(!f||d&1)&&n!==(n=e[20].title.toLowerCase()+"")&&pe(i,n),d&5&&(a=e[2]===e[6](e[0].id,e[20])),a?_?d&5&&x(_,1):(_=Rl(),_.c(),x(_,1),_.m(t,null)):_&&(be(),R(_,1,1,()=>{_=null}),we()),(!f||d&1)&&N(t,"background",e[20].background_color),(!f||d&1)&&N(t,"color",e[20].color),(!f||d&4)&&ne(t,"disabled",e[2])},i(u){f||(x(_),f=!0)},o(u){R(_),f=!1},d(u){u&&P(t),_&&_.d(),c=!1,p()}}}function Gl(l){let e,t,n=[],i=new Map,s,r,o=l[3];const a=f=>f[20].title;for(let f=0;f<o.length;f+=1){let c=zl(l,o,f),p=a(c);i.set(p,n[f]=ql(p,c))}return{c(){e=y("div"),t=y("div");for(let f=0;f<n.length;f+=1)n[f].c();v(t,"class","flex tagAddList1 svelte-elfos6"),N(t,"flex-wrap","wrap"),v(e,"class","pos_abs tag_settings flex flex_clm svelte-elfos6")},m(f,c){F(f,e,c),g(e,t);for(let p=0;p<n.length;p+=1)n[p].m(t,null);r=!0},p(f,c){c&205&&(o=f[3],be(),n=qe(n,c,a,1,f,o,i,t,Ke,ql,null,zl),we())},i(f){if(!r){for(let c=0;c<o.length;c+=1)x(n[c]);f&&Ee(()=>{s||(s=Me(e,wt,{},!0)),s.run(1)}),r=!0}},o(f){for(let c=0;c<n.length;c+=1)R(n[c]);f&&(s||(s=Me(e,wt,{},!1)),s.run(0)),r=!1},d(f){f&&P(e);for(let c=0;c<n.length;c+=1)n[c].d();f&&s&&s.end()}}}function Ul(l){let e,t,n;return t=new Lt({}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){F(i,e,s),ue(t,e,null),n=!0},i(i){n||(x(t.$$.fragment,i),n=!0)},o(i){R(t.$$.fragment,i),n=!1},d(i){i&&P(e),de(t)}}}function ql(l,e){let t,n=e[20].title+"",i,s,r,o=e[2]===e[6](e[0].id,e[20]),a,f,c,p,_=o&&Ul();return{key:l,first:null,c(){t=y("div"),i=se(n),s=y("div"),s.textContent="+",r=E(),_&&_.c(),a=E(),v(s,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),v(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),N(t,"background",e[20].background_color),N(t,"color",e[20].color),ne(t,"disabled",e[2]),this.first=t},m(u,d){F(u,t,d),g(t,i),g(t,s),g(t,r),_&&_.m(t,null),g(t,a),f=!0,c||(p=le(t,"click",function(){Pe(e[7](e[20]))&&e[7](e[20]).apply(this,arguments)}),c=!0)},p(u,d){e=u,(!f||d&8)&&n!==(n=e[20].title+"")&&pe(i,n),d&13&&(o=e[2]===e[6](e[0].id,e[20])),o?_?d&13&&x(_,1):(_=Ul(),_.c(),x(_,1),_.m(t,a)):_&&(be(),R(_,1,1,()=>{_=null}),we()),(!f||d&8)&&N(t,"background",e[20].background_color),(!f||d&8)&&N(t,"color",e[20].color),(!f||d&4)&&ne(t,"disabled",e[2])},i(u){f||(x(_),f=!0)},o(u){R(_),f=!1},d(u){u&&P(t),_&&_.d(),c=!1,p()}}}function Qs(l){let e,t,n,i,s=l[0]&&Hl(l);return{c(){s&&s.c(),e=Ue()},m(r,o){s&&s.m(r,o),F(r,e,o),t=!0,n||(i=[le(window,"mousedown",l[9]),le(window,"blur",l[9])],n=!0)},p(r,[o]){r[0]?s?(s.p(r,o),o&1&&x(s,1)):(s=Hl(r),s.c(),x(s,1),s.m(e.parentNode,e)):s&&(be(),R(s,1,1,()=>{s=null}),we())},i(r){t||(x(s),t=!0)},o(r){R(s),t=!1},d(r){s&&s.d(r),r&&P(e),n=!1,je(i)}}}function $s(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r,dialogMap_SetDialog:o}=s;Le(l,r,L=>t(12,i=L));let{dialog_id:a=null}=e,f=null,c=!1;const p=async(L,w)=>{const C=await s.api.dialog_SetTags(n.id,w);return C&&o(C),C},_=(L,w)=>{var C;return`${L}|${(C=w==null?void 0:w.title)!=null?C:"*"}`},u=L=>async w=>{if(!n||c)return;t(2,c=_(n.id,L));const C={color:"#fff",background_color:"#f00",...L,title:L.title.toLowerCase().trim()};await p(n.id,[...n.tag,C]),t(2,c=!1)},d=L=>async w=>{if(!n||c)return;t(2,c=_(n.id,L));const C=n.tag.filter(D=>D.id!==L.id).map(D=>({title:D.title,color:D.color,background_color:D.background_color}));await p(n.id,C),t(2,c=!1)};let m=[];function b(){var w;if(!n)return;const L=new Set(((w=n==null?void 0:n.tag)!=null?w:[]).map(C=>C.title));t(3,m=g_Config.pinnedTags.filter(C=>!L.has(C.title)))}let k;const h=L=>{let w=L.target;for(;w;){if(w===k)return;w=w.parentNode}t(1,f=null)},S=()=>t(1,f=n.id);function M(L){xe[L?"unshift":"push"](()=>{k=L,t(4,k)})}return l.$$set=L=>{"app"in L&&t(10,s=L.app),"dialog_id"in L&&t(11,a=L.dialog_id)},l.$$.update=()=>{l.$$.dirty&6144&&t(0,n=i[a]),l.$$.dirty&1&&b()},[n,f,c,m,k,r,_,u,d,h,s,a,i,S,M]}class ei extends ke{constructor(e){super(),ye(this,e,$s,Qs,he,{app:10,dialog_id:11})}}function Yl(l){var J,te,z,B,V,re,_e,W,U,Y;let e,t,n,i,s=((z=(te=(J=l[2])==null?void 0:J.lead)==null?void 0:te.first_name)!=null?z:"")+"",r,o,a,f,c,p=((re=(V=(B=l[2])==null?void 0:B.lead)==null?void 0:V.last_name)!=null?re:"")+"",_,u,d,m,b,k,h,S,M,L,w,C,D,T,A,H=((W=(_e=l[2])==null?void 0:_e.lead)==null?void 0:W.username)&&Wl(l),ee=((Y=(U=l[2])==null?void 0:U.lead)==null?void 0:Y.ref_link)&&Vl(l);return S=new Zs({props:{app:l[0],dialog_id:l[2].id}}),C=new ei({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=y("div"),t=y("div"),n=E(),i=y("div"),r=se(s),o=E(),a=y("div"),f=E(),c=y("div"),_=se(p),u=se("\xA0"),d=E(),m=y("div"),H&&H.c(),b=E(),ee&&ee.c(),k=E(),h=y("div"),ge(S.$$.fragment),M=E(),L=y("div"),w=E(),ge(C.$$.fragment),D=E(),T=y("div"),N(t,"width","8px"),N(a,"width","8px"),v(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),v(m,"class","nowrap textOverEllipsis username svelte-qywc37"),N(L,"width","4px"),v(h,"class","flex"),N(T,"height","4px")},m(j,K){F(j,e,K),g(e,t),g(e,n),g(e,i),g(i,r),g(e,o),g(e,a),g(e,f),g(e,c),g(c,_),g(c,u),F(j,d,K),F(j,m,K),H&&H.m(m,null),F(j,b,K),ee&&ee.m(j,K),F(j,k,K),F(j,h,K),ue(S,h,null),g(h,M),g(h,L),g(h,w),ue(C,h,null),F(j,D,K),F(j,T,K),A=!0},p(j,K){var Se,Ae,Oe,ve,I,O,G,q,Z,X;(!A||K&4)&&s!==(s=((Oe=(Ae=(Se=j[2])==null?void 0:Se.lead)==null?void 0:Ae.first_name)!=null?Oe:"")+"")&&pe(r,s),(!A||K&4)&&p!==(p=((O=(I=(ve=j[2])==null?void 0:ve.lead)==null?void 0:I.last_name)!=null?O:"")+"")&&pe(_,p),(q=(G=j[2])==null?void 0:G.lead)!=null&&q.username?H?H.p(j,K):(H=Wl(j),H.c(),H.m(m,null)):H&&(H.d(1),H=null),(X=(Z=j[2])==null?void 0:Z.lead)!=null&&X.ref_link?ee?ee.p(j,K):(ee=Vl(j),ee.c(),ee.m(k.parentNode,k)):ee&&(ee.d(1),ee=null);const Q={};K&1&&(Q.app=j[0]),K&4&&(Q.dialog_id=j[2].id),S.$set(Q);const fe={};K&1&&(fe.app=j[0]),K&4&&(fe.dialog_id=j[2].id),C.$set(fe)},i(j){A||(x(S.$$.fragment,j),x(C.$$.fragment,j),A=!0)},o(j){R(S.$$.fragment,j),R(C.$$.fragment,j),A=!1},d(j){j&&P(e),j&&P(d),j&&P(m),H&&H.d(),j&&P(b),ee&&ee.d(j),j&&P(k),j&&P(h),de(S),de(C),j&&P(D),j&&P(T)}}}function Wl(l){let e,t=l[2].lead.username+"",n;return{c(){e=se("@"),n=se(t)},m(i,s){F(i,e,s),F(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&pe(n,t)},d(i){i&&P(e),i&&P(n)}}}function Vl(l){var p,_;let e,t,n,i,s=((_=(p=l[2])==null?void 0:p.lead)==null?void 0:_.ref_link)+"",r,o,a,f,c;return{c(){e=y("div"),t=y("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=E(),i=y("div"),r=se(s),o=E(),a=y("div"),v(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),v(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),v(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),N(a,"height","4px")},m(u,d){F(u,e,d),g(e,t),g(e,n),g(e,i),g(i,r),F(u,o,d),F(u,a,d),f||(c=le(e,"click",l[6]),f=!0)},p(u,d){var m,b;d&4&&s!==(s=((b=(m=u[2])==null?void 0:m.lead)==null?void 0:b.ref_link)+"")&&pe(r,s)},d(u){u&&P(e),u&&P(o),u&&P(a),f=!1,c()}}}function Jl(l){let e,t,n,i;return t=new Lt({}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","pos_abs loading svelte-qywc37")},m(s,r){F(s,e,r),ue(t,e,null),i=!0},i(s){i||(x(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&P(e),de(t),s&&n&&n.end()}}}function ti(l){let e,t,n,i,s=l[2]&&Yl(l),r=l[1]&&Jl();return{c(){e=y("div"),t=y("div"),s&&s.c(),n=E(),r&&r.c(),v(t,"class","flex flex_clm flex_cx flex_grow_1"),v(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,a){F(o,e,a),g(e,t),s&&s.m(t,null),g(e,n),r&&r.m(e,null),i=!0},p(o,[a]){o[2]?s?(s.p(o,a),a&4&&x(s,1)):(s=Yl(o),s.c(),x(s,1),s.m(t,null)):s&&(be(),R(s,1,1,()=>{s=null}),we()),o[1]?r?a&2&&x(r,1):(r=Jl(),r.c(),x(r,1),r.m(e,null)):r&&(be(),R(r,1,1,()=>{r=null}),we())},i(o){i||(x(s),x(r),i=!0)},o(o){R(s),R(r),i=!1},d(o){o&&P(e),s&&s.d(),r&&r.d()}}}function li(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;Le(l,r,c=>t(5,i=c));let{dialog_id:o=null}=e,{loading:a=!1}=e;const f=()=>{var c;return Un((c=n==null?void 0:n.lead)==null?void 0:c.ref_link)};return l.$$set=c=>{"app"in c&&t(0,s=c.app),"dialog_id"in c&&t(4,o=c.dialog_id),"loading"in c&&t(1,a=c.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,a,n,r,o,i,f]}class ni extends ke{constructor(e){super(),ye(this,e,li,ti,he,{app:0,dialog_id:4,loading:1})}}function Xl(l,e,t){const n=l.slice();return n[36]=e[t],n}function Kl(l,e){let t,n,i;return n=new Hs({props:{app:e[0],bbox:e[9],message:e[36],render_Width:e[8]}}),{key:l,first:null,c(){t=Ue(),ge(n.$$.fragment),this.first=t},m(s,r){F(s,t,r),ue(n,s,r),i=!0},p(s,r){e=s;const o={};r[0]&1&&(o.app=e[0]),r[0]&512&&(o.bbox=e[9]),r[0]&4&&(o.message=e[36]),r[0]&256&&(o.render_Width=e[8]),n.$set(o)},i(s){i||(x(n.$$.fragment,s),i=!0)},o(s){R(n.$$.fragment,s),i=!1},d(s){s&&P(t),de(n,s)}}}function si(l){let e,t,n,i,s,r,o,a=[],f=new Map,c,p,_,u,d,m,b,k,h,S;t=new ni({props:{app:l[0],dialog_id:l[1],loading:l[3]}});let M=l[2];const L=D=>D[36].index;for(let D=0;D<M.length;D+=1){let T=Xl(l,M,D),A=L(T);f.set(A,a[D]=Kl(A,T))}function w(D){l[17](D)}let C={value_in:l[4]};return l[5]!==void 0&&(C.value_out=l[5]),_=new wn({props:C}),xe.push(()=>bt(_,"value_out",w)),{c(){e=y("div"),ge(t.$$.fragment),n=E(),i=y("div"),s=y("div"),r=y("div"),o=y("div");for(let D=0;D<a.length;D+=1)a[D].c();c=E(),p=y("div"),ge(_.$$.fragment),d=E(),m=y("div"),b=y("textarea"),v(o,"class","pos_rel w100 h100"),v(p,"class","pos_abs h100 chatScroll svelte-1khz9us"),v(r,"class","pos_rel w100 h100"),v(s,"class","flex pos_abs overhide"),v(i,"class","flex flex_grow_1 pos_rel overhide"),v(b,"class","flex flex_grow_1 chat_input_textarea svelte-1khz9us"),v(m,"class","flex chat_input svelte-1khz9us"),v(e,"class","flex flex_clm flex_grow_1 overhide cnt svelte-1khz9us")},m(D,T){F(D,e,T),ue(t,e,null),g(e,n),g(e,i),g(i,s),g(s,r),g(r,o);for(let A=0;A<a.length;A+=1)a[A].m(o,null);l[16](o),g(r,c),g(r,p),ue(_,p,null),g(e,d),g(e,m),g(m,b),Zt(b,l[7]),k=!0,h||(S=[le(r,"wheel",l[13],{passive:!0}),$e(rt.call(null,s,l[11])),le(b,"input",l[18]),le(b,"keyup",l[12]),le(b,"keydown",l[12])],h=!0)},p(D,T){const A={};T[0]&1&&(A.app=D[0]),T[0]&2&&(A.dialog_id=D[1]),T[0]&8&&(A.loading=D[3]),t.$set(A),T[0]&773&&(M=D[2],be(),a=qe(a,T,L,1,D,M,f,o,Ke,Kl,null,Xl),we());const H={};T[0]&16&&(H.value_in=D[4]),!u&&T[0]&32&&(u=!0,H.value_out=D[5],vt(()=>u=!1)),_.$set(H),T[0]&128&&Zt(b,D[7])},i(D){if(!k){x(t.$$.fragment,D);for(let T=0;T<M.length;T+=1)x(a[T]);x(_.$$.fragment,D),k=!0}},o(D){R(t.$$.fragment,D);for(let T=0;T<a.length;T+=1)R(a[T]);R(_.$$.fragment,D),k=!1},d(D){D&&P(e),de(t);for(let T=0;T<a.length;T+=1)a[T].d();l[16](null),de(_),h=!1,je(S)}}}const Zl=10,_t=4;function ii(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;Le(l,o,W=>t(15,i=W));let{dialog_id:a=null}=e,f=[],c=[],p=new Set,_=0,u=0,d=1,m=1,b=null;const k=He(null);Le(l,k,W=>t(9,s=W)),new Date().toJSON();let h=-1;async function S(W,U=0,Y=20){const j=await r.api.message_GetList({dialog_id:W,offset:U,limit:Y});if(!!j&&n&&n.id===W){for(_=j.count;f.length<_;){const Q=f.length;f.push({id:h--,index:Q,_isFakeMsg:!0})}const K=j.results.map(Q=>{var fe;return(fe=Q==null?void 0:Q.attachments)!=null&&fe.length&&Q.attachments.map(Se=>{var Ae,Oe,ve,I,O,G,q,Z;if((Oe=(Ae=r==null?void 0:r.appConfig)==null?void 0:Ae.api)!=null&&Oe.attachments_OverwriteApiHostProtocol)try{const X=new URL(Se.url);X.protocol=(O=(I=(ve=r==null?void 0:r.appConfig)==null?void 0:ve.api)==null?void 0:I.protocol)!=null?O:location.protocol,X.host=(Z=(q=(G=r==null?void 0:r.appConfig)==null?void 0:G.api)==null?void 0:q.host)!=null?Z:location.host,Se.url=String(X)}catch{}}),Q});K.map((Q,fe)=>Q.index=U+fe),K.map(Q=>f[Q.index]=Q)}}let M="";const L=async W=>{if(W.which===13&&!W.shiftKey&&!W.ctrlKey&&(W.preventDefault(),t(7,M=M.trim()),M)){const U=M;t(7,M=""),n&&await r.api.message_Create(n.id,U)}};function w(){f=[],t(2,c=[]),p=new Set,_=0,console.log("clear all")}let C=null,D=null;async function T(W){if(!W){if(!C)return;C=null,w();return}D!==W.id&&(C=W,D=W.id,w(),f=[],t(2,c=[]),_=0,t(3,u++,u),await S(W.id),_&&await S(W.id,Math.max(_-20,0),20),await r.api.dialog_SetReadFlagAllMessages(W.id),t(3,u--,u))}let A=1,H=!0;function ee(){if(H&&requestAnimationFrame(ee),!s||!b||!f.length)return;s.width;const W=s.height,U=s.width-Zl*2,Y=Zl;t(8,A=U-Math.max(120,Math.floor(U*.1)));const j=1+m*(f.length-1);let K=Math.floor(j),Q=j-K;K>=f.length&&(K=f.length-1,Q=1);const fe=[],Se=[];let Ae=null;t(2,c=[]);for(let ve=K-100,I=0,O=!0;ve<K+100;ve++)ve<0||ve>=f.length||(f[ve]._isFakeMsg&&p.add(ve),c[I]!==f[ve]&&(O&&(O=!1,c.splice(I,1e9)),t(2,c[I]=f[ve],c),t(2,c)),t(2,c[I]._drawIndex=I,c),ve<K&&fe.push(c[I]),ve>K&&Se.push(c[I]),ve===K&&(Ae=c[I]),I++);const Oe=[...b.children];if(Oe.length===c.length){Oe.map((q,Z)=>{const X=c[Z];if(!X||q._remove)return;const oe=q.getBoundingClientRect();q._bbox=oe;const ce=Math.floor(Y+(X.incoming?0:Math.max(100,s.width*.05)));q.__cacheWidth!==A&&(q.__cacheWidth=A,q.style.maxWidth=A+"px"),q.__cacheLeft!==ce&&(q.__cacheLeft=ce,q.style.left=ce+"px")});const ve=(q,Z,X=1)=>(q.__cacheTop!==Z&&(q.__cacheTop=Z,q.style.transform=`translate3d(0px, ${Z}px, 0px)`),Z+(q._bbox.height+_t)*X);let I=0,O=0;const G=Oe[Ae._drawIndex];if(G){const q=G;I=W+_t-(q._bbox.height+_t)*Q,O=I,I=ve(q,I,1)}Se.map((q,Z)=>{const X=Oe[q._drawIndex];I=ve(X,I,1)}),I=O,fe.reverse().map((q,Z)=>{const X=Oe[q._drawIndex];I-=X._bbox.height+_t,ve(X,I,0)})}}requestAnimationFrame(ee),Fe(()=>H=!1);async function J(){if(p.size){const W=[...p].sort((j,K)=>j-K);p.clear();const U=[];let Y={offset:null,limit:0};for(const j of W){if(Y.offset!==null){if(Y.limit<=500&&Y.offset+Y.limit===j){Y.limit++;continue}U.push(Y)}Y={offset:j,limit:1}}Y.offset!==null&&U.push(Y),n&&(t(3,u++,u),await Promise.all(U.map(j=>S(n.id,j.offset,j.limit))),t(3,u--,u))}H&&setTimeout(J,500)}J();async function te(){n&&await r.api.dialog_SetReadFlagAllMessages(n.id),H&&setTimeout(te,5e3)}te();async function z(){n&&await S(n.id,_,20),H&&setTimeout(z,500)}z();const B=W=>{t(4,d=f.length?m+Math.sign(W.deltaY)/(f.length-1):0)};function V(W){xe[W?"unshift":"push"](()=>{b=W,t(6,b)})}function re(W){m=W,t(5,m)}function _e(){M=this.value,t(7,M)}return l.$$set=W=>{"app"in W&&t(0,r=W.app),"dialog_id"in W&&t(1,a=W.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&32770&&t(14,n=i[a]),l.$$.dirty[0]&16384&&T(n)},[r,a,c,u,d,m,b,M,A,s,o,k,L,B,n,i,V,re,_e]}class ri extends ke{constructor(e){super(),ye(this,e,ii,si,he,{app:0,dialog_id:1},null,[-1,-1])}}function oi(l){let e,t,n,i,s,r,o,a,f,c,p,_,u,d,m,b,k,h,S,M,L;function w(A){l[5](A)}let C={};l[2]!==void 0&&(C.checked=l[2]),c=new Ls({props:C}),xe.push(()=>bt(c,"checked",w));function D(A){l[6](A)}let T={app:l[0]};return l[1]!==void 0&&(T.filterTag=l[1]),u=new Ps({props:T}),xe.push(()=>bt(u,"filterTag",D)),h=new As({props:{app:l[0],filter:{filterTag:l[1],filterUnreadFirst:l[2]}}}),M=new ri({props:{app:l[0],dialog_id:l[3]}}),{c(){e=y("div"),t=y("div"),n=y("div"),i=E(),s=y("div"),r=y("label"),o=se(`First unread \r
				`),a=y("div"),f=E(),ge(c.$$.fragment),_=E(),ge(u.$$.fragment),m=E(),b=y("div"),k=E(),ge(h.$$.fragment),S=E(),ge(M.$$.fragment),N(n,"height","2px"),N(a,"width","4px"),v(r,"class","flex flex_cy cursor_ptr unselect firstUnread svelte-14xikx8"),v(s,"class","flex flex_clm flex_cx header pos_rel svelte-14xikx8"),N(b,"height","20px"),v(t,"class","flex flex_clm list svelte-14xikx8"),v(e,"class","flex flex_grow_1")},m(A,H){F(A,e,H),g(e,t),g(t,n),g(t,i),g(t,s),g(s,r),g(r,o),g(r,a),g(r,f),ue(c,r,null),g(s,_),ue(u,s,null),g(t,m),g(t,b),g(t,k),ue(h,t,null),g(e,S),ue(M,e,null),L=!0},p(A,[H]){const ee={};!p&&H&4&&(p=!0,ee.checked=A[2],vt(()=>p=!1)),c.$set(ee);const J={};H&1&&(J.app=A[0]),!d&&H&2&&(d=!0,J.filterTag=A[1],vt(()=>d=!1)),u.$set(J);const te={};H&1&&(te.app=A[0]),H&6&&(te.filter={filterTag:A[1],filterUnreadFirst:A[2]}),h.$set(te);const z={};H&1&&(z.app=A[0]),H&8&&(z.dialog_id=A[3]),M.$set(z)},i(A){L||(x(c.$$.fragment,A),x(u.$$.fragment,A),x(h.$$.fragment,A),x(M.$$.fragment,A),L=!0)},o(A){R(c.$$.fragment,A),R(u.$$.fragment,A),R(h.$$.fragment,A),R(M.$$.fragment,A),L=!1},d(A){A&&P(e),de(c),de(u),de(h),de(M)}}}function ai(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;Le(l,s,c=>t(3,n=c));let r=null,o=1;function a(c){o=c,t(2,o)}function f(c){r=c,t(1,r)}return l.$$set=c=>{"app"in c&&t(0,i=c.app)},[i,r,o,n,s,a,f]}class fi extends ke{constructor(e){super(),ye(this,e,ai,oi,he,{app:0})}}function ci(l){let e,t,n,i,s,r,o,a,f,c,p,_,u,d,m,b;return{c(){e=y("div"),t=y("div"),n=y("div"),i=y("img"),r=E(),o=y("div"),a=y("div"),a.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/rotate.png"/>',f=E(),c=y("div"),c.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/download.png"/>',p=E(),_=y("div"),_.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/close.png"/>',v(i,"class","img svelte-d45see"),v(i,"draggable","false"),Xe(i.src,s=l[0])||v(i,"src",s),N(i,"transform","rotate("+l[3]+"deg)"),v(n,"class","pos_abs flex flex_cx flex_cy pad svelte-d45see"),N(n,"width",l[5]+"px"),N(n,"height",l[4]+"px"),v(t,"class","pos_abs flex flex_cx flex_cy pos_abs w100 h100 "),N(t,"transform","translate("+l[1]+"px, "+l[2]+"px)"),v(a,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),v(c,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),v(_,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),v(o,"class","flex pos_abs imgCtrlBtnGroup svelte-d45see"),v(e,"class","pos_abs w100 h100 unselect cnt layer_bg svelte-d45see")},m(k,h){F(k,e,h),g(e,t),g(t,n),g(n,i),g(e,r),g(e,o),g(o,a),g(o,f),g(o,c),g(o,p),g(o,_),d=!0,m||(b=[le(window,"mousemove",l[14]),le(window,"mouseup",l[13]),le(window,"blur",l[13]),le(window,"keydown",l[16]),le(i,"mousedown",l[12]),$e(rt.call(null,t,l[6])),le(a,"click",l[10]),le(c,"click",function(){Pe(xt(l[0]))&&xt(l[0]).apply(this,arguments)}),le(_,"click",l[15]),le(e,"wheel",l[11])],m=!0)},p(k,[h]){l=k,(!d||h&1&&!Xe(i.src,s=l[0]))&&v(i,"src",s),(!d||h&8)&&N(i,"transform","rotate("+l[3]+"deg)"),(!d||h&32)&&N(n,"width",l[5]+"px"),(!d||h&16)&&N(n,"height",l[4]+"px"),(!d||h&6)&&N(t,"transform","translate("+l[1]+"px, "+l[2]+"px)")},i(k){d||(Ee(()=>{u||(u=Me(e,Ce,{duration:100},!0)),u.run(1)}),d=!0)},o(k){u||(u=Me(e,Ce,{duration:100},!1)),u.run(0),d=!1},d(k){k&&P(e),k&&u&&u.end(),m=!1,je(b)}}}function ui(l,e,t){let n,i,s,r,{url:o=null}=e;const a=En(),f=He(null);Le(l,f,T=>t(18,n=T));const c=Ge(0);Le(l,c,T=>t(3,i=T));const p=Ge(0);Le(l,p,T=>t(5,r=T));const _=Ge(0);Le(l,_,T=>t(4,s=T));let u=0,d=0,m={rotate:0,scale:1,whInverse:!1};const b=()=>{if(!n||!m)return;const T=m.whInverse?n.height:n.width,A=m.whInverse?n.width:n.height;Be(p,r=T*m.scale,r),Be(_,s=A*m.scale,s),Be(c,i=m.rotate,i)},k=()=>{!n||!m||(t(17,m.rotate+=90,m),t(17,m.whInverse=!m.whInverse,m),t(17,m))},h=T=>{t(17,m.scale=ze(.1,m.scale+Math.sign(T.deltaY)*.1,10),m)};let S=null;const M=T=>S=[T.clientX,T.clientY,u,d],L=T=>S=null,w=T=>{!S||t(1,[u,d]=[T.clientX,T.clientY].map((A,H)=>A-S[H]+S[H+2]),u,t(2,d))},C=T=>a("close"),D=T=>T.which===27&&C();return l.$$set=T=>{"url"in T&&t(0,o=T.url)},l.$$.update=()=>{l.$$.dirty&393216&&b()},[o,u,d,i,s,r,f,c,p,_,k,h,M,L,w,C,D,m,n]}class di extends ke{constructor(e){super(),ye(this,e,ui,ci,he,{url:0})}}function Ql(l){let e=l[0],t,n,i=$l(l);return{c(){i.c(),t=Ue()},m(s,r){i.m(s,r),F(s,t,r),n=!0},p(s,r){r&1&&he(e,e=s[0])?(be(),R(i,1,1,ae),we(),i=$l(s),i.c(),x(i,1),i.m(t.parentNode,t)):i.p(s,r)},i(s){n||(x(i),n=!0)},o(s){R(i),n=!1},d(s){s&&P(t),i.d(s)}}}function $l(l){let e,t;return e=new di({props:{url:l[1]}}),e.$on("close",l[3]),{c(){ge(e.$$.fragment)},m(n,i){ue(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.url=n[1]),e.$set(s)},i(n){t||(x(e.$$.fragment,n),t=!0)},o(n){R(e.$$.fragment,n),t=!1},d(n){de(e,n)}}}function _i(l){let e,t,n=l[1]&&Ql(l);return{c(){n&&n.c(),e=Ue()},m(i,s){n&&n.m(i,s),F(i,e,s),t=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&x(n,1)):(n=Ql(i),n.c(),x(n,1),n.m(e.parentNode,e)):n&&(be(),R(n,1,1,()=>{n=null}),we())},i(i){t||(x(n),t=!0)},o(i){R(n),t=!1},d(i){n&&n.d(i),i&&P(e)}}}function gi(l,e,t){let n=1,i=null,{events:s}=e;Fe(s.on("openOverlayImageView",o=>{t(0,n++,n),t(1,i=o)}));const r=()=>t(1,i=null);return l.$$set=o=>{"events"in o&&t(2,s=o.events)},[n,i,s,r]}class mi extends ke{constructor(e){super(),ye(this,e,gi,_i,he,{events:2})}}function pi(l){let e,t,n,i,s,r,o,a,f,c,p,_=hi;return i=new _s({props:{app:l[0]}}),r=new ys({props:{app:l[0]}}),a=new fi({props:{app:l[0]}}),c=new mi({props:{events:l[0].events}}),{c(){e=y("div"),t=E(),n=y("div"),ge(i.$$.fragment),s=E(),ge(r.$$.fragment),o=E(),ge(a.$$.fragment),f=E(),ge(c.$$.fragment),v(n,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),v(e,"class","flex w100 h100 pos_rel")},m(u,d){F(u,e,d),g(e,t),g(e,n),ue(i,n,null),g(n,s),ue(r,n,null),g(e,o),ue(a,e,null),g(e,f),ue(c,e,null),p=!0},p(u,[d]){},i(u){p||(x(_),x(i.$$.fragment,u),x(r.$$.fragment,u),x(a.$$.fragment,u),x(c.$$.fragment,u),p=!0)},o(u){R(_),R(i.$$.fragment,u),R(r.$$.fragment,u),R(a.$$.fragment,u),R(c.$$.fragment,u),p=!1},d(u){u&&P(e),de(i),de(r),de(a),de(c)}}}const hi=!1;function vi(l,e,t){let{operatorSelf:n}=e,{config:i}=e,{notifyEvents:s}=e,{createApi:r}=e;const o=r(n.username),a=Vn(n,i,o);return Fe(a.destroy),l.$$set=f=>{"operatorSelf"in f&&t(1,n=f.operatorSelf),"config"in f&&t(2,i=f.config),"notifyEvents"in f&&t(3,s=f.notifyEvents),"createApi"in f&&t(4,r=f.createApi)},[a,n,i,s,r]}class bi extends ke{constructor(e){super(),ye(this,e,vi,pi,he,{operatorSelf:1,config:2,notifyEvents:3,createApi:4})}}function en(l,e,t){const n=l.slice();return n[6]=e[t],n}function wi(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=ln(en(l,n,r));const s=r=>R(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Ue()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);F(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let a;for(a=0;a<n.length;a+=1){const f=en(r,n,a);i[a]?(i[a].p(f,o),x(i[a],1)):(i[a]=ln(f),i[a].c(),x(i[a],1),i[a].m(e.parentNode,e))}for(be(),a=n.length;a<i.length;a+=1)s(a);we()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)x(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)R(i[o]);t=!1},d(r){kt(i,r),r&&P(e)}}}function yi(l){let e,t,n,i,s;return i=new Lt({}),{c(){e=y("div"),t=y("div"),n=E(),ge(i.$$.fragment),N(t,"height","20px"),v(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){F(r,e,o),g(e,t),g(e,n),ue(i,e,null),s=!0},p:ae,i(r){s||(x(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&P(e),de(i)}}}function tn(l){let e,t,n=l[6].username+"",i;return{c(){e=y("div"),t=se("@"),i=se(n),v(e,"class","nowrap textOverEllipsis")},m(s,r){F(s,e,r),g(e,t),g(e,i)},p(s,r){r&1&&n!==(n=s[6].username+"")&&pe(i,n)},d(s){s&&P(e)}}}function ln(l){var S,M;let e,t,n,i=((S=l[6].first_name)!=null?S:"")+"",s,r,o,a,f,c=((M=l[6].last_name)!=null?M:"")+"",p,_,u,d,m,b,k,h=l[6].username&&tn(l);return{c(){e=y("div"),t=y("div"),n=y("div"),s=se(i),r=E(),o=y("div"),a=E(),f=y("div"),p=se(c),_=E(),h&&h.c(),u=E(),N(o,"width","8px"),v(t,"class","flex nowrap textOverEllipsis"),v(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(L,w){F(L,e,w),g(e,t),g(t,n),g(n,s),g(t,r),g(t,o),g(t,a),g(t,f),g(f,p),g(e,_),h&&h.m(e,null),g(e,u),m=!0,b||(k=le(e,"click",function(){Pe(l[2](l[6]))&&l[2](l[6]).apply(this,arguments)}),b=!0)},p(L,w){var C,D;l=L,(!m||w&1)&&i!==(i=((C=l[6].first_name)!=null?C:"")+"")&&pe(s,i),(!m||w&1)&&c!==(c=((D=l[6].last_name)!=null?D:"")+"")&&pe(p,c),l[6].username?h?h.p(l,w):(h=tn(l),h.c(),h.m(e,u)):h&&(h.d(1),h=null)},i(L){m||(L&&Ee(()=>{d||(d=Me(e,Ce,{},!0)),d.run(1)}),m=!0)},o(L){L&&(d||(d=Me(e,Ce,{},!1)),d.run(0)),m=!1},d(L){L&&P(e),h&&h.d(),L&&d&&d.end(),b=!1,k()}}}function ki(l){let e,t,n,i;const s=[yi,wi],r=[];function o(a,f){return a[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=y("div"),n.c(),v(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){F(a,e,f),r[t].m(e,null),i=!0},p(a,[f]){let c=t;t=o(a),t===c?r[t].p(a,f):(be(),R(r[c],1,1,()=>{r[c]=null}),we(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),x(n,1),n.m(e,null))},i(a){i||(x(n),i=!0)},o(a){R(n),i=!1},d(a){a&&P(e),r[t].d()}}}function Si(l,e,t){let{api:n}=e,i=[],s=!1;const r=async()=>{var f,c;t(1,s=!0),t(0,i=(c=(f=await n.operator_GetList())==null?void 0:f.results)!=null?c:[]),t(1,s=!1)};let o=!1;const a=f=>c=>{o||(pn(f),o=!0)};return r(),l.$$set=f=>{"api"in f&&t(3,n=f.api)},[i,s,a,n]}class Li extends ke{constructor(e){super(),ye(this,e,Si,ki,he,{api:3})}}const Mi=l=>typeof l=="number"&&String(l|0)===String(l);class yn extends Error{}const We=async(l,e=null)=>{try{return await l()}catch{}return e},Gt=l=>async e=>{if(await We(()=>e.response.status===l))return e;throw new Error(`Invalid response status, expected ${l}`)},Ti=Gt(200),Ii=Gt(201),Di=Gt(204),Oi=async l=>{if(await We(()=>Mi(l.result.count)&&Array.isArray(l.result.results)))return l;throw new Error("Invalid result, expected list container")},Dt=async l=>{if(await We(()=>l.result.detail==="Authentication credentials were not provided.")===!0)throw new yn("Not authorized");return l},Ot=async l=>({...l,result:l.response.status===204?null:await l.response.json()}),Ci=(l,e)=>{var a,f,c;const t=(a=l==null?void 0:l.protocol)!=null?a:location.protocol,n=(f=l==null?void 0:l.host)!=null?f:location.host,i=(c=l==null?void 0:l.path_base)!=null?c:"/",s=`${t}//${n}/${i}`,r=new Set(["POST","PATCH","PUT"]),o={...e!=null?e:{},"content-type":"application/json"};return(p,_,u)=>{const d=p.toUpperCase().trim(),m=_!=null?_:"",b=u!=null?u:{},k=new URL(s);d==="GET"&&Object.entries(b).map(([S,M])=>k.searchParams.append(S,M)),k.pathname=[k.pathname,m].join("/").split("/").filter(Boolean).concat(" ").filter(Boolean).join("/").trim();const h=r.has(d)?JSON.stringify(b):null;return new Request(k,{method:d,headers:o,body:h})}},Ei=(l,e,t)=>{var d,m,b;const n=Ci(l,e.operator?{"x-username":e.operator}:{}),i=(d=e.onerror)!=null?d:st,s=(m=e.onnotify)!=null?m:st,r=(b=e.onNotAuthorizedError)!=null?b:st,o=t!=null?t:(k,h)=>h(),a=async([k,h,S],M)=>{let L=null,w=null,C={},D=null,T=!1;try{C.request=L=n(k,h,S),C.response=w=await o({request:L,method:k,path:h,options:S},()=>fetch(L));for(const H of M)C=await H(C)}catch(H){D=H,T=!0}await We(()=>{D instanceof yn&&r()});const A=[];return A.push(...await We(async()=>{const H=new URL(L.url);return[{type:"normal",chunks:[{color:"#fff",text:L.method},{color:"#000",text:`${H.pathname}${String(H.searchParams)?"?"+H.searchParams:""}`},{color:"#f00",text:await We(()=>w.status,"")}]},{type:"mini",text:`${H.protocol}//${H.host}`}]},[`${k} ${h}`])),A.push(await We(()=>L.body?"Body: "+JSON.stringify(S).slice(0,100):"")),A.push(await We(()=>C.result.detail?`Detail: ${C.result.detail}`:"")),A.push(qn(D)),T?i(A):s(A),!T&&C.hasOwnProperty("result")?C.result:null},f=[Ot,Dt,Ii],c=[Ot,Dt,Ti],p=[Ot,Dt,Di],_=[...c,Oi],u={};return u.message_GetList=k=>a(["GET","messages",k],_),u.message_Create=(k,h)=>a(["POST","messages",{dialog:k,text:h,is_read:!0}],f),u.dialog_GetList=k=>a(["GET","dialogs",k],_),u.dialog_SetTags=(k,h)=>a(["PATCH",`dialogs/${k}`,{tag:h}],c),u.dialog_SetReadFlagAllMessages=k=>a(["POST",`dialogs/${k}/read`,{}],p),u.lead_GetUnassignedList=k=>a(["GET","leads/unassigned",k],_),u.lead_AssignOperatorSelft=k=>a(["POST",`leads/${k}/assign`,{}],c),u.lead_SetStatus=(k,h)=>a(["PATCH",`leads/${k}`,{status:h}],c),u.operatorSelf_GetOnlineInfo=()=>a(["GET","online",{}],c),u.operatorSelf_SetOnlineFlag=k=>a(["PUT","online",{online:!!k}],c),u.operator_GetList=k=>a(["GET","operators",k],_),u},ji=()=>{const l=()=>!0,e=I=>new Promise(O=>setTimeout(O,I)),t=(I,O)=>e(I+Math.round(Math.random()*(O-I))),n=(I,O,G)=>Math.min(G,Math.max(I,O)),i=(I=0)=>new Date(Date.now()+(I!=null?I:0)).toJSON(),s=(I,O)=>{var oe;const G=Math.max(0,(O==null?void 0:O.offset)|0),q=n(1,((oe=O==null?void 0:O.limit)!=null?oe:20)|0,1e6),Z=I.length,X=I.slice(G,G+q);return{count:Z,results:X}};let r=1;const o=I=>(I!=null?I:[]).map(O=>({...O,id:r++}));let a=1;const f=[],c={},p=I=>{var O;return(O=c[I])!=null?O:null},_=()=>f,u=I=>{var G,q,Z;const O={operator_id:a++,username:(G=I.username)!=null?G:null,first_name:(q=I.first_name)!=null?q:null,last_name:(Z=I.last_name)!=null?Z:null};return f.push(O),c[O.username]=O,j(O.username),O};let d=123123124;const m=[],b={},k=I=>{var O;return(O=b[I])!=null?O:null},h=()=>m.filter(I=>!I.hasOperator).sort((I,O)=>I._date_joined_msec-O._date_joined_msec),S=I=>{var q,Z,X;const O=d++,G={tg_id:O,username:(q=I.username)!=null?q:null,first_name:(Z=I.first_name)!=null?Z:null,last_name:(X=I.last_name)!=null?X:null,date_joined:i(I.timeDelta),esub:null,pub_id:null,refcode:null,subpub:null,hasOperator:!1,status:"NW",ref_link:`https://ref.global.com/getRef?tg_id=${O}`};return G._date_joined_msec=+new Date(G.date_joined),m.push(G),b[G.tg_id]=G,G},M=(I,O)=>{const G=k(O);return!G||!p(I)||G.hasOperator?!1:(H(I,O),G.hasOperator=!0,!0)},L=(I,O,G)=>{const q=k(O);return q?(G.status&&(q.status=G.status),q):null};let w=1;const C=[],D={},T=I=>{var O;return(O=D[I])!=null?O:null},A=(I,O=[])=>{I.tag||(I.tag=[],I._tagSearch=new Set);const G=o(O);I.tag.splice(0,1e9),I._tagSearch.clear(),G.map(q=>{I.tag.push(q),I._tagSearch.add(q.title)})},H=(I,O)=>{const G=k(O);if(!G||!p(I))return null;const Z={id:w++,lead_id:O,lead:G,operator:I,unread_messages_count:0,last_message:null};return A(Z),C.push(Z),D[Z.id]=Z,G.hasOperator=!0,Z},ee=(I,O,G)=>{const q=T(O);return q?(G.tag&&A(q,G.tag),q):null},J=(I,O,G)=>{const q=T(O);return q?(_e(I,{dialog_id:+O}).map(X=>X.is_read=!1),q.unread_messages_count=0,!0):null},te=(I,O={})=>{const G=ie=>ie.last_message?ie.last_message._received_at_msec:ie.lead?ie.lead._date_joined_msec:0,q=(ie,Te)=>Te-ie,Z=(ie,Te)=>{let $=q(G(ie),G(Te));return $===0&&($=q(ie.id,Te.id)),$},X=C.filter(ie=>ie.operator===I).filter(O.tag?ie=>ie._tagSearch.has(O.tag):l).filter(ie=>{var Te;return((Te=ie==null?void 0:ie.lead)==null?void 0:Te.status)!=="DL"});let oe=[],ce=[];return O.unread_first?(oe=X.filter(ie=>ie.unread_messages_count!==0),ce=X.filter(ie=>ie.unread_messages_count===0)):oe=X,oe.sort(Z),ce.sort(Z),oe.concat(ce)};let z=1;const B=[],V={},re=(I,O={})=>{var oe,ce,ie;const G=+O.dialog,q=O.text,Z=T(G);if(!Z)return null;const X={id:z++,dialog:G,text:q,is_read:(oe=O.is_read)!=null?oe:!0,incoming:(ce=O.incoming)!=null?ce:!1,attachments:(ie=O.attachments)!=null?ie:[],received_at:i(O.timeDelta)};return X._received_at_msec=+new Date(X.received_at),B.push(X),V[X.id]=X,Z.last_message=X,X.is_read||Z.unread_messages_count++,X},_e=(I,O={})=>B.filter(O.dialog_id?G=>G.dialog===O.dialog_id:l),W=5*60*1e3,U={},Y=I=>{var O;return(O=U[I])!=null?O:null},j=(I,O={})=>{const q={online:!!O.online,offline_at:i(W),interval:Math.round(W/1e3)};return U[I]=q,q},K=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.webp","9.webp","10.png","11.png","13.png","12.webp"],Q=`\u0414\u0430, \u043C\u0451\u0440\u0442\u0432.
\u0411\u0435\u0434\u0441\u0442\u0432\u0438\u0435, \u0443\u0433\u0440\u043E\u0436\u0430\u044E\u0449\u0435\u0435 \u0436\u0438\u0437\u043D\u0438 \u0434\u0435\u0432\u0443\u0448\u043A\u0438, \u0438\u0441\u0447\u0435\u0437\u043B\u043E, \u0441\u043B\u043E\u0432\u043D\u043E \u044D\u0442\u043E \u0431\u044B\u043B\u0430 \u043A\u0430\u043A\u0430\u044F-\u0442\u043E \u0448\u0443\u0442\u043A\u0430. \u041D\u043E \u043E\u043D\u0430 \u043D\u0435 \u043C\u043E\u0433\u043B\u0430 \u0440\u0430\u0434\u043E\u0432\u0430\u0442\u044C\u0441\u044F, \u0432\u0435\u0434\u044C \u0421\u043C\u0435\u0440\u0442\u044C \u0441\u043C\u0435\u043D\u0438\u043B\u0430 \u0441\u0432\u043E\u044E \u0444\u043E\u0440\u043C\u0443 \u0438 \u043F\u0440\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432 \u0431\u043E\u043B\u0435\u0435 \u044F\u0432\u043D\u043E\u043C \u0432\u0438\u0434\u0435.
\u041F\u043E\u0434 \u0432\u0437\u0433\u043B\u044F\u0434\u043E\u043C \u043D\u0430\u043F\u0443\u0433\u0430\u043D\u043D\u043E\u0439 \u0434\u0435\u0432\u0443\u0448\u043A\u0438 \u0421\u043C\u0435\u0440\u0442\u044C \u0434\u0432\u0438\u043D\u0443\u043B\u0430\u0441\u044C \u0432 \u0435\u0451 \u0441\u0442\u043E\u0440\u043E\u043D\u0443. \u0422\u044C\u043C\u0430 \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439 \u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0433\u0443\u0449\u0430\u0442\u044C\u0441\u044F.
\u0422\u044C\u043C\u0430... \u043E\u043D\u0430 \u0441\u0435\u0439\u0447\u0430\u0441 \u043C\u0435\u043D\u044F \u043F\u0440\u043E\u0433\u043B\u043E\u0442\u0438\u0442, \u2014 \u043F\u043E\u0434\u0443\u043C\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430 \u0438 \u0435\u0449\u0451 \u043A\u0440\u0435\u043F\u0447\u0435 \u043E\u0431\u043D\u044F\u043B\u0430 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443. \u041E\u043D\u0430 \u0443\u0436\u0435 \u0434\u0430\u0436\u0435 \u0438 \u043D\u0435 \u0434\u0443\u043C\u0430\u043B\u0430 \u0431\u0435\u0436\u0430\u0442\u044C. \u0411\u0443\u0434\u044C \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u043E\u043C, \u043E\u043D\u0430 \u0431\u044B \u0435\u0449\u0435 \u043C\u043E\u0433\u043B\u0430 \u043D\u0430 \u0447\u0442\u043E-\u0442\u043E \u043D\u0430\u0434\u0435\u044F\u0442\u044C\u0441\u044F. \u041D\u043E \u043D\u0435\u0447\u0442\u043E, \u0432\u043E\u0437\u0432\u044B\u0448\u0430\u044E\u0449\u0435\u0435\u0441\u044F \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439, \u0441 \u043B\u0435\u0433\u043A\u043E\u0441\u0442\u044C\u044E \u0440\u0430\u0437\u0432\u0435\u044F\u043B\u043E \u0442\u0430\u043A\u0438\u0435 \u043C\u044B\u0441\u043B\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0445\u043E\u0442\u044F \u0431\u044B \u0434\u0430\u0440\u0443\u0439 \u043C\u043D\u0435 \u0431\u0435\u0437\u0431\u043E\u043B\u0435\u0437\u043D\u0435\u043D\u043D\u0443\u044E \u0441\u043C\u0435\u0440\u0442\u044C.
\u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u043C\u043E\u043B\u0438\u0442\u044C\u0441\u044F.
\u041C\u0430\u043B\u044B\u0448\u043A\u0430 \u0443\u0446\u0435\u043F\u0438\u043B\u0430\u0441\u044C \u0437\u0430 \u0435\u0451 \u0442\u0430\u043B\u0438\u044E, \u0434\u0440\u043E\u0436\u0430 \u043E\u0442 \u0443\u0436\u0430\u0441\u0430. \u0421\u043F\u0430\u0441\u0442\u0438 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443... \u043D\u043E \u044D\u0442\u043E \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E. \u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u0438\u0437\u0432\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u0437\u0430 \u0441\u0432\u043E\u0451 \u0431\u0435\u0441\u0441\u0438\u043B\u0438\u0435. \u0421\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0430, \u0442\u044B \u043D\u0435 \u0431\u0443\u0434\u0435\u0448\u044C \u043E\u0434\u0438\u043D\u043E\u043A\u0430, \u044F \u043F\u043E\u0439\u0434\u0443 \u0441 \u0442\u043E\u0431\u043E\u0439.
\u0418 \u0442\u043E\u0433\u0434\u0430...`;let fe=1;const Se=(I=null,O=null)=>(I=I!=null?I:Math.random()*K.length|0,O=O!=null?O:O=["IM","DC"][Math.random()*2|0],{file:fe++,file_type:O,url:`assets/img-test/${K[I]}`});(async()=>{const I=(Z,X)=>{const oe=X/Z;let ce=-(X+oe);return()=>(ce+=oe,ce)};let O=1;const G=(Z=0)=>{let X=Math.random()<.5,oe=Math.random()<.5,ce=Math.random()<.5;!X&&!oe&&!ce&&(X=!0),X=oe=ce=!0;const ie=(O++).toString(36);return S({username:X?`test_lead_${ie}`:null,first_name:oe?`F${ie}`:null,last_name:ce?`L${ie}`:null,timeDelta:Z})},q=(Z,X,oe=0)=>{re(Z,{dialog:X,text:`\u041F\u0440\u0438\u0432\u0435\u0442 @${Z}. \u042F \u043D\u043E\u0432\u044B\u0439 \u043B\u0438\u0434, \u0432\u043E\u0442.`,is_read:!1,incoming:!0,timeDelta:oe});for(let ce=0;ce<Math.round(Math.random()*K.length);ce++){const ie=Se(ce);re(Z,{dialog:X,text:`${ie.file_type==="IM"?"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430":"\u0424\u0430\u0439\u043B"} ${ce+1}.`,is_read:!1,incoming:!0,attachments:[ie],timeDelta:oe+ce*1e3})}};for(let Z=0;Z<10;Z++){const oe=[10,100,1e3,5e3,7e3,1e4,1e4,1e5,2,3,5,7,8,10][Z],ce=`op_test_${Z}`;u({username:ce,first_name:"OpNumDlgs",last_name:oe+""});let ie=0;const Te=I(oe,6e4*oe);for(let $=0;$<oe;$++){const me=Te(),Ie=G(me),Ve=H(ce,Ie.tg_id);Math.random()<.5&&ie++<5&&q(ce,Ve.id,me)}}for(;;)await t(1e3,1e4),G()})();const Oe=(I,O,G)=>{const q=X=>{X&&j(G)},Z=async X=>{await t(1e3,1e4);const oe=O.text.match(/without_text/i),ce=O.text.match(/long_text/i),ie=O.text.match(/allimg|allfile/i),Te=oe?"":ce?Q:`\u042D\u0445\u043E \u043E\u0442\u0432\u0435\u0442 \u0434\u043B\u044F @${G}.
"${O.text}"`;if(ie){const me=O.text.match(/allimg/i)?"IM":"DC";for(let Ie=0;Ie<K.length;Ie++)re(G,{dialog:O.dialog,text:Te,is_read:!1,incoming:!0,attachments:[Se(Ie,me)]});return}const $=[];O.text.match(/img/i)?$.push(Se(null,"IM")):O.text.match(/file/i)&&$.push(Se(null,"DC")),re(G,{dialog:O.dialog,text:Te,is_read:!1,incoming:!0,attachments:$})};I("GET","operators",200,()=>s(_(),O)),I("GET","online",200,()=>Y(G)),I("PUT","online",200,()=>j(G,O)),I("GET","leads/unassigned",200,()=>s(h(),O)),I("POST",/^leads\/(\d+)\/assign$/,200,X=>M(G,X),[q]),I("PATCH",/^leads\/(\d+)$/,200,X=>L(G,X,O),[q]),I("GET","dialogs",200,()=>s(te(G,O),O)),I("POST",/^dialogs\/(\d+)\/read$/,204,X=>J(G,X)),I("PATCH",/^dialogs\/(\d+)$/,200,X=>ee(G,X,O),[q]),I("GET","messages",200,()=>s(_e(G,O),O)),I("POST","messages",201,()=>re(G,O),[q,Z])},ve=I=>{var $,me,Ie,Ve,et;const O=(($=I==null?void 0:I.method)!=null?$:"").toUpperCase().trim(),G=((me=I==null?void 0:I.path)!=null?me:"").split("/").map(De=>De.trim()).filter(Boolean).join("/"),q=Object.fromEntries(Object.entries((Ie=I==null?void 0:I.headers)!=null?Ie:{}).map(De=>[De[0].toLowerCase(),De[1]])),Z=(Ve=I==null?void 0:I.options)!=null?Ve:{},X=(et=q["x-username"])!=null?et:null,oe=[];Oe((De,Je,ot,at,ft=[])=>oe.push({method:De,pathPattern:Je,cb:at,status:ot,mwList:ft}),Z,X);const ie=oe.map(De=>{if(De.method===O){if(De.pathPattern instanceof RegExp){const Je=G.match(De.pathPattern);return Je?{...De,args:Je.slice(1)}:!1}return De.pathPattern===G?{...De,args:[]}:!1}}).filter(Boolean)[0];if(!ie)return null;const Te=ie.cb(...ie.args);return ie.mwList&&ie.mwList.map(De=>De(Te,X,Z)),{status:ie.status,result:Te}};try{self.addEventListener("message",({data:{rpcID:I,data:O}})=>{let G,q;try{G=ve(O)}catch(Z){q=Z.message}self.postMessage({rpcID:I,result:G,error:q})})}catch{}return{request:ve}},Ai=()=>{const l=`( ${ji.toString()} )()`,e=new Blob([l],{type:"text/javascript"}),t=new Worker(window.URL.createObjectURL(e));let n=1;const i={};return t.addEventListener("message",({data:{rpcID:o,result:a,error:f}})=>{const c=i[o];delete i[o],f&&c.reject(new Error(f)),c.resolve(a)}),{request:o=>{const a=n++,f=i[a]=Rt();return t.postMessage({rpcID:a,data:o}),f.promise},destroy:()=>t.terminate()}};function xi(l){let e,t,n,i,s;return t=new bi({props:{operatorSelf:l[0],config:l[2],notifyEvents:l[1],createApi:l[3]}}),{c(){e=y("div"),ge(t.$$.fragment),v(e,"class","pos_rel flex")},m(r,o){F(r,e,o),ue(t,e,null),n=!0,i||(s=$e(rt.call(null,e)),i=!0)},p(r,o){const a={};o&1&&(a.operatorSelf=r[0]),t.$set(a)},i(r){n||(x(t.$$.fragment,r),n=!0)},o(r){R(t.$$.fragment,r),n=!1},d(r){r&&P(e),de(t),i=!1,s()}}}function Ni(l){let e,t,n,i,s;return e=new Kn({props:{select:"operators"}}),i=new Li({props:{api:l[4]}}),{c(){ge(e.$$.fragment),t=E(),n=y("div"),ge(i.$$.fragment),v(n,"class","flex")},m(r,o){ue(e,r,o),F(r,t,o),F(r,n,o),ue(i,n,null),s=!0},p:ae,i(r){s||(x(e.$$.fragment,r),x(i.$$.fragment,r),s=!0)},o(r){R(e.$$.fragment,r),R(i.$$.fragment,r),s=!1},d(r){de(e,r),r&&P(t),r&&P(n),de(i)}}}function Pi(l){let e,t,n,i,s,r;const o=[Ni,xi],a=[];function f(c,p){return c[0]?1:0}return t=f(l),n=a[t]=o[t](l),s=new ns({props:{events:l[1]}}),{c(){e=y("main"),n.c(),i=E(),ge(s.$$.fragment),v(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-l8w6xt")},m(c,p){F(c,e,p),a[t].m(e,null),g(e,i),ue(s,e,null),r=!0},p(c,[p]){let _=t;t=f(c),t===_?a[t].p(c,p):(be(),R(a[_],1,1,()=>{a[_]=null}),we(),n=a[t],n?n.p(c,p):(n=a[t]=o[t](c),n.c()),x(n,1),n.m(e,i))},i(c){r||(x(n),x(s.$$.fragment,c),r=!0)},o(c){R(n),R(s.$$.fragment,c),r=!1},d(c){c&&P(e),a[t].d(),de(s)}}}function zi(l,e,t){let n;Le(l,yt,f=>t(0,n=f));const i=Bt(),s=g_Config,o=(f=>{var u;const c=((u=f.testMode)!=null?u:!0)&&!gn().has("real-api");let p=()=>null,_=f.api;if(c){const d=Ai();Fe(d.destroy),_={protocol:"https:",host:"test.mode.dev",path_base:"api/"},p=()=>async({method:m,path:b,options:k,request:h})=>{const S=Object.fromEntries([...h.headers]),{status:M,result:L}=await d.request({method:m,path:b,options:k,headers:S});return{status:M,json:()=>L}}}return(d=null)=>Ei(_,{onerror:m=>i.emit("error",m),onnotify:m=>i.emit("debug",m),onNotAuthorizedError:()=>Be(yt,n=null,n),operator:d},p())})(s),a=o();return[n,i,s,o,a]}class Fi extends ke{constructor(e){super(),ye(this,e,zi,Pi,he,{})}}new Fi({target:document.getElementById("app")});
