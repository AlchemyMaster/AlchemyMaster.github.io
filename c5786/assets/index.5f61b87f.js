(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ae(){}const Nt=l=>l;function Zt(l,e){for(const t in e)l[t]=e[t];return l}function tn(l){return l()}function Qt(){return Object.create(null)}function je(l){l.forEach(tn)}function ze(l){return typeof l=="function"}function me(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let dt;function Xe(l,e){return dt||(dt=document.createElement("a")),dt.href=e,l===dt.href}function vn(l){return Object.keys(l).length===0}function Pt(l,...e){if(l==null)return ae;const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Se(l,e,t){l.$$.on_destroy.push(Pt(e,t))}function Ge(l,e,t){return l.set(t),e}function $e(l){return l&&ze(l.destroy)?l.destroy:ae}const ln=typeof window<"u";let nn=ln?()=>window.performance.now():()=>Date.now(),zt=ln?l=>requestAnimationFrame(l):ae;const Ze=new Set;function sn(l){Ze.forEach(e=>{e.c(l)||(Ze.delete(e),e.f())}),Ze.size!==0&&zt(sn)}function rn(l){let e;return Ze.size===0&&zt(sn),{promise:new Promise(t=>{Ze.add(e={c:l,f:t})}),abort(){Ze.delete(e)}}}function g(l,e){l.appendChild(e)}function wn(l){if(!l)return document;const e=l.getRootNode?l.getRootNode():l.ownerDocument;return e&&e.host?e:l.ownerDocument}function bn(l,e){return g(l.head||l,e),e.sheet}function z(l,e,t){l.insertBefore(e,t||null)}function N(l){l.parentNode.removeChild(l)}function Ht(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function y(l){return document.createElement(l)}function Pe(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function K(l){return document.createTextNode(l)}function A(){return K(" ")}function Ve(){return K("")}function $(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function yn(l){return function(e){return e.preventDefault(),l.call(this,e)}}function kn(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function b(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Ln(l){return Array.from(l.childNodes)}function _e(l,e){e=""+e,l.wholeText!==e&&(l.data=e)}function $t(l,e){l.value=e==null?"":e}function H(l,e,t,n){t===null?l.style.removeProperty(e):l.style.setProperty(e,t,n?"important":"")}function X(l,e,t){l.classList[t?"add":"remove"](e)}function on(l,e,{bubbles:t=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,t,n,e),i}const vt=new Map;let wt=0;function Sn(l){let e=5381,t=l.length;for(;t--;)e=(e<<5)-e^l.charCodeAt(t);return e>>>0}function Mn(l){const e={style_element:y("style"),rules:{}};return vt.set(l,e),e}function el(l,e,t,n,i,s,r,o=0){const a=16.666/n;let f=`{
`;for(let k=0;k<=1;k+=a){const w=e+(t-e)*s(k);f+=k*100+`%{${r(w,1-w)}}
`}const c=f+`100% {${r(t,1-t)}}
}`,m=`__svelte_${Sn(c)}_${o}`,d=wn(l),{style_element:u,rules:_}=vt.get(d)||Mn(d);if(!_[m]){const k=bn(d,u);_[m]=!0,k.insertRule(`@keyframes ${m} ${c}`,k.cssRules.length)}const p=l.style.animation||"";return l.style.animation=`${p?`${p}, `:""}${m} ${n}ms linear ${i}ms 1 both`,wt+=1,m}function Tn(l,e){const t=(l.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=t.length-n.length;i&&(l.style.animation=n.join(", "),wt-=i,wt||On())}function On(){zt(()=>{wt||(vt.forEach(l=>{const{style_element:e}=l;N(e)}),vt.clear())})}let rt;function st(l){rt=l}function an(){if(!rt)throw new Error("Function called outside component initialization");return rt}function Be(l){an().$$.on_destroy.push(l)}function In(){const l=an();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=on(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function Dn(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const nt=[],Re=[],mt=[],It=[],Cn=Promise.resolve();let Dt=!1;function En(){Dt||(Dt=!0,Cn.then(fn))}function Ee(l){mt.push(l)}function bt(l){It.push(l)}const Lt=new Set;let _t=0;function fn(){const l=rt;do{for(;_t<nt.length;){const e=nt[_t];_t++,st(e),An(e.$$)}for(st(null),nt.length=0,_t=0;Re.length;)Re.pop()();for(let e=0;e<mt.length;e+=1){const t=mt[e];Lt.has(t)||(Lt.add(t),t())}mt.length=0}while(nt.length);for(;It.length;)It.pop()();Dt=!1,Lt.clear(),st(l)}function An(l){if(l.fragment!==null){l.update(),je(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Ee)}}let lt;function jn(){return lt||(lt=Promise.resolve(),lt.then(()=>{lt=null})),lt}function St(l,e,t){l.dispatchEvent(on(`${e?"intro":"outro"}${t}`))}const ht=new Set;let Ue;function he(){Ue={r:0,c:[],p:Ue}}function ve(){Ue.r||je(Ue.c),Ue=Ue.p}function j(l,e){l&&l.i&&(ht.delete(l),l.i(e))}function R(l,e,t,n){if(l&&l.o){if(ht.has(l))return;ht.add(l),Ue.c.push(()=>{ht.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}const Nn={duration:0};function Me(l,e,t,n){let i=e(l,t),s=n?0:1,r=null,o=null,a=null;function f(){a&&Tn(l,a)}function c(d,u){const _=d.b-s;return u*=Math.abs(_),{a:s,b:d.b,d:_,duration:u,start:d.start,end:d.start+u,group:d.group}}function m(d){const{delay:u=0,duration:_=300,easing:p=Nt,tick:k=ae,css:w}=i||Nn,h={start:nn()+u,b:d};d||(h.group=Ue,Ue.r+=1),r||o?o=h:(w&&(f(),a=el(l,s,d,_,u,p,w)),d&&k(0,1),r=c(h,_),Ee(()=>St(l,d,"start")),rn(v=>{if(o&&v>o.start&&(r=c(o,_),o=null,St(l,r.b,"start"),w&&(f(),a=el(l,s,r.b,r.duration,0,p,i.css))),r){if(v>=r.end)k(s=r.b,1-s),St(l,r.b,"end"),o||(r.b?f():--r.group.r||je(r.group.c)),r=null;else if(v>=r.start){const E=v-r.start;s=r.a+r.d*p(E/r.duration),k(s,1-s)}}return!!(r||o)}))}return{run(d){ze(i)?jn().then(()=>{i=i(),m(d)}):m(d)},end(){f(),r=o=null}}}const cn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Rt(l,e){l.d(1),e.delete(l.key)}function et(l,e){R(l,1,1,()=>{e.delete(l.key)})}function xe(l,e,t,n,i,s,r,o,a,f,c,m){let d=l.length,u=s.length,_=d;const p={};for(;_--;)p[l[_].key]=_;const k=[],w=new Map,h=new Map;for(_=u;_--;){const L=m(i,s,_),C=t(L);let O=r.get(C);O?n&&O.p(L,e):(O=f(C,L),O.c()),w.set(C,k[_]=O),C in p&&h.set(C,Math.abs(_-p[C]))}const v=new Set,E=new Set;function M(L){j(L,1),L.m(o,c),r.set(L.key,L),c=L.first,u--}for(;d&&u;){const L=k[u-1],C=l[d-1],O=L.key,S=C.key;L===C?(c=L.first,d--,u--):w.has(S)?!r.has(O)||v.has(O)?M(L):E.has(S)?d--:h.get(O)>h.get(S)?(E.add(O),M(L)):(v.add(S),d--):(a(C,r),d--)}for(;d--;){const L=l[d];w.has(L.key)||a(L,r)}for(;u;)M(k[u-1]);return k}function yt(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function ge(l){l&&l.c()}function fe(l,e,t,n){const{fragment:i,on_mount:s,on_destroy:r,after_update:o}=l.$$;i&&i.m(e,t),n||Ee(()=>{const a=s.map(tn).filter(ze);r?r.push(...a):je(a),l.$$.on_mount=[]}),o.forEach(Ee)}function ce(l,e){const t=l.$$;t.fragment!==null&&(je(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Pn(l,e){l.$$.dirty[0]===-1&&(nt.push(l),En(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ye(l,e,t,n,i,s,r,o=[-1]){const a=rt;st(l);const f=l.$$={fragment:null,ctx:null,props:s,update:ae,not_equal:i,bound:Qt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Qt(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(f.root);let c=!1;if(f.ctx=t?t(l,e.props||{},(m,d,...u)=>{const _=u.length?u[0]:d;return f.ctx&&i(f.ctx[m],f.ctx[m]=_)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](_),c&&Pn(l,m)),d}):[],f.update(),c=!0,je(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const m=Ln(e.target);f.fragment&&f.fragment.l(m),m.forEach(N)}else f.fragment&&f.fragment.c();e.intro&&j(l.$$.fragment),fe(l,e.target,e.anchor,e.customElement),fn()}st(a)}class ke{$destroy(){ce(this,1),this.$destroy=ae}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!vn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function zn(l){const e=l-1;return e*e*e+1}function Ce(l,{delay:e=0,duration:t=400,easing:n=Nt}={}){const i=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*i}`}}function Qe(l,{delay:e=0,duration:t=400,easing:n=zn}={}){const i=getComputedStyle(l),s=+i.opacity,r=parseFloat(i.height),o=parseFloat(i.paddingTop),a=parseFloat(i.paddingBottom),f=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),m=parseFloat(i.borderTopWidth),d=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:n,css:u=>`overflow: hidden;opacity: ${Math.min(u*20,1)*s};height: ${u*r}px;padding-top: ${u*o}px;padding-bottom: ${u*a}px;margin-top: ${u*f}px;margin-bottom: ${u*c}px;border-top-width: ${u*m}px;border-bottom-width: ${u*d}px;`}}const Ke=[];function Fe(l,e=ae){let t;const n=new Set;function i(o){if(me(l,o)&&(l=o,t)){const a=!Ke.length;for(const f of n)f[1](),Ke.push(f,l);if(a){for(let f=0;f<Ke.length;f+=2)Ke[f][0](Ke[f+1]);Ke.length=0}}}function s(o){i(o(l))}function r(o,a=ae){const f=[o,a];return n.add(f),n.size===1&&(t=e(i)||ae),o(l),()=>{n.delete(f),n.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const it=()=>{},Ct=l=>new Promise(e=>setTimeout(e,l)),He=(l,e,t)=>Math.min(t,Math.max(l,e)),Bt=(l={})=>(Object.assign(l,{promise:new Promise((e,t)=>Object.assign(l,{resolve:e,reject:t}))}),l),Et=(l,e)=>{try{if(l===e)return!0;const t=typeof l;if(t!==typeof e)return!1;switch(t){case"undefined":case"boolean":case"bigint":case"symbol":case"string":return l===e;case"number":return isNaN(l)&&isNaN(e)?!0:l===e}if(l===null||e===null)return l===e;if(t!=="object")return!1;if(Array.isArray(l)&&Array.isArray(e))return l.length!==e.length?!1:l.every((o,a)=>Et(o,e[a]));const i=Object.entries(l),s=Object.entries(e);if(i.length!==s.length)return!1;const r=new Map(s);return i.every(([o,a])=>!(!r.has(o)||!Et(a,r.get(o))))}catch{}return!1},Hn=l=>{let e=!1,t=[];const n=async i=>{e=!0;let s,r,o;try{s=await l()}catch(a){o=!0,r=a}if(i.map(a=>{o&&a.reject(r),a.resolve(s)}),t.length){const a=t;return t=[],n(a)}e=!1};return()=>{const i=Bt();return e?t.push(i):(e=!0,n([i])),i.promise}},Rn=l=>{const e=Bt();return setTimeout(e.resolve,l),e},Bn=Symbol("RangeLoadList_ItemLastUpdateTime"),Fn=l=>{var F,V,le,te;const e=He(1,((F=l.updateInterval)!=null?F:1e3)|0,36e5),t=He(1,((V=l.maxLimit)!=null?V:50)|0,1e3);let n=l.fLoad;const i=(le=l.onUpdateItem)!=null?le:it,s=(te=l.onUpdateItemList)!=null?te:it,r=!!l.isLoadEnd,o=Bn,a={},f=Fe(null),c={subscribe:f.subscribe};let m=0,d=t,u=null;const _=J=>n=J,p=async(J,se)=>{try{const we=await n({offset:J,limit:se});if(typeof we.count=="number"&&Array.isArray(we.results))return we}catch{}return null},k=async(J,se)=>{const we=await p(J,se);if(we){const Y=we.results,ue=Math.max(0,we.count|0),be=u!==ue,x=Date.now();u=ue;const Z=[];for(let ne=0,re=J;ne<Y.length&&re<u;ne++,re++){const Le=Y[ne];a[re]!==void 0&&Et(a[re],Le)||(Le[o]=x,a[re]=Le,i(Le),Z.push(Le))}Z.length&&s(Z),(be||Z.length)&&f.set({total:u,list:a})}},w=async J=>{const se=[];se.push(k(m,d)),u!==null&&m+d<u&&r&&se.push(k(u,t)),await Promise.all(se),u!==null&&m+d<u&&r&&J&&await k(u,t)};let h=!1,v=!0,E,M=1;return(async()=>{let J=0;for(;v;){for(;v&&!h;){const se=M;if(await w(J++===0),se===M)break}E=Rn(e),await E.promise}})(),{setFLoad:_,update:()=>{M++,E&&E.resolve()},setRange:(J,se)=>{m=Math.max(0,J|0),d=He(0,se|0,t)},destroy:()=>v=!1,getData_r:()=>c,symbolUpdateTime:o,pause:()=>h=!0,resume:()=>h=!1}},Un=async l=>{const e=t=>{const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();let i=!1;try{i=!!document.execCommand("copy")}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),i};try{return navigator.clipboard?(await navigator.clipboard.writeText(l),!0):e(l)}catch(t){console.error(t)}return!1},Ft=(l,e,t=!0)=>{let n=!0;return(async()=>{for(t&&await Ct(l);n;){try{await e()}catch(i){console.error("setIntervalAwait error",i)}await Ct(l)}})(),()=>n=!1},un=()=>{let l=new Map;try{l=new Map([...new URLSearchParams(location.hash.replace(/^\#/,""))])}catch{}return l},Ut=()=>{const l={};return{on:(n,i)=>{var o;const s={event:n,cb:i},r=l[n]=(o=l[n])!=null?o:[];return r.push(s),()=>{const a=r.findIndex(f=>f===s);a!==-1&&r.splice(a,1)}},emit:(n,...i)=>{var s;return((s=l[n])!=null?s:[]).map(r=>r.cb(...i))}}},dn=(l,e="file-")=>{const t=document.createElement("a");t.href=l;const n=e+t.pathname.split(/[^a-zA-Z0-9\.\-_]/).pop();t.download=n,t.target="blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},At=l=>dn(l,"image-"),Gn=l=>{try{if(typeof l.message=="string")return l.message}catch{}return""},kt=Fe(null),_n=kt.set,gt=(l,e)=>{const{subscribe:t,set:n,update:i}=Fe(l);return[{subscribe:t},s=>{n(s),e&&e(s)}]},qn=(l,e)=>{const{subscribe:t,set:n,update:i}=Fe(l);return[{subscribe:t},i]},xn=l=>parseInt(l.id);function Yn(l,e,t){const n={},i={...e};Object.assign(n,{appConfig:i}),Object.assign(n,{api:t});const s=Ut();Object.assign(n,{events:s});const r=[],o=G=>r.push(G);Object.assign(n,{destroy:()=>r.map(G=>G())});const f=l,[c]=gt(f),[m,d]=gt(null);let u=0;const[_,p]=gt(u),k=Hn(t.operatorSelf_GetOnlineInfo),w=async()=>{p(++u);const G=await k();return G&&d(G),p(--u),G};Object.assign(n,{operatorSelf_r:c,operatorSelfLastOnlineInfo_r:m,operatorSelfLastOnlineInfo_Update:w,operatorSelfLastOnline_SetOnlineFlag:async G=>{p(++u);const F=await t.operatorSelf_SetOnlineFlag(G);return F&&d(F),p(--u),F},operatorSelfLastOnlineInfoLoading_r:_});const v=Object.create(null),[E,M]=qn(v),L=G=>{!G.length||M(F=>{for(const V of G)F[xn(V)]=V;return F})},C=G=>L([G]),[O,S]=gt(null);return Object.assign(n,{dialogMap_r:E,dialogMap_SetDialogList:L,dialogMap_SetDialog:C,dialogActiveID_r:O,dialogActiveID_Set:S}),Object.assign(n,{lead_GetStatusTitle:G=>{var F,V,le;return(le=(V=((F=e==null?void 0:e.lead_StatusList)!=null?F:[]).find(te=>te.id===G))==null?void 0:V.title)!=null?le:G},lead_GetStatusList:G=>{var F;return((F=e==null?void 0:e.lead_StatusList)!=null?F:[]).filter(V=>V.access==="user").filter(V=>V.id!==G).filter(V=>V.id!=="DL")}}),o(Ft(e.updateIntervals.sync_online_info,w,!1)),Object.freeze(n),n}function tl(l){let e,t,n;return{c(){e=y("div"),e.textContent="Operators",b(e,"class","item cursor_ptr svelte-vbcb9r"),X(e,"active",l[0]==="operators"),X(e,"disabled",l[1].has("operators"))},m(i,s){z(i,e,s),t||(n=$(e,"click",l[3]("operators")),t=!0)},p(i,s){s&1&&X(e,"active",i[0]==="operators"),s&2&&X(e,"disabled",i[1].has("operators"))},d(i){i&&N(e),t=!1,n()}}}function ll(l){let e,t=l[2].username+"",n,i,s;return{c(){e=y("div"),n=K(t),b(e,"class","item cursor_ptr notHover nowrap textOverEllipsis svelte-vbcb9r"),H(e,"max-width","200px")},m(r,o){z(r,e,o),g(e,n),s=!0},p(r,o){(!s||o&4)&&t!==(t=r[2].username+"")&&_e(n,t)},i(r){s||(Ee(()=>{i||(i=Me(e,Ce,{},!0)),i.run(1)}),s=!0)},o(r){i||(i=Me(e,Ce,{},!1)),i.run(0),s=!1},d(r){r&&N(e),r&&i&&i.end()}}}function Wn(l){let e,t,n,i,s,r,o=!l[2]&&tl(l),a=l[2]&&0,f=l[2]&&ll(l);return{c(){e=y("div"),o&&o.c(),t=A(),a&&a.c(),n=A(),i=y("div"),s=A(),f&&f.c(),b(i,"class","flex flex_grow_1"),b(e,"class","flex flex_cy w100 list unselect svelte-vbcb9r")},m(c,m){z(c,e,m),o&&o.m(e,null),g(e,t),a&&a.m(e,null),g(e,n),g(e,i),g(e,s),f&&f.m(e,null),r=!0},p(c,[m]){c[2]?o&&(o.d(1),o=null):o?o.p(c,m):(o=tl(c),o.c(),o.m(e,t)),c[2],a&&(a.d(1),a=null),c[2]?f?(f.p(c,m),m&4&&j(f,1)):(f=ll(c),f.c(),j(f,1),f.m(e,null)):f&&(he(),R(f,1,1,()=>{f=null}),ve())},i(c){r||(j(f),r=!0)},o(c){R(f),r=!1},d(c){c&&N(e),o&&o.d(),a&&a.d(),f&&f.d()}}}function Vn(l,e,t){let n;Se(l,kt,o=>t(2,n=o));let{select:i=""}=e,{disabled:s=new Set}=e;s.add("newLeads"),s.add("myLeads");const r=o=>a=>{s.has(o)||t(0,i=o)};return l.$$set=o=>{"select"in o&&t(0,i=o.select),"disabled"in o&&t(1,s=o.disabled)},[i,s,n,r]}class Jn extends ke{constructor(e){super(),ye(this,e,Vn,Wn,me,{select:0,disabled:1})}}function nl(l,e,t){const n=l.slice();return n[4]=e[t],n}function sl(l,e,t){const n=l.slice();return n[7]=e[t],n}function il(l){let e,t=l[7].text+"",n,i;return{c(){e=y("div"),n=K(t),i=K("\xA0"),b(e,"class","text svelte-13s1vua"),H(e,"color",l[7].color)},m(s,r){z(s,e,r),g(e,n),z(s,i,r)},p(s,r){r&2&&t!==(t=s[7].text+"")&&_e(n,t),r&2&&H(e,"color",s[7].color)},d(s){s&&N(e),s&&N(i)}}}function rl(l){let e,t,n=l[4].chunks,i=[];for(let s=0;s<n.length;s+=1)i[s]=il(sl(l,n,s));return{c(){e=y("div");for(let s=0;s<i.length;s+=1)i[s].c();t=A(),b(e,"class","flex flex_cy line svelte-13s1vua"),X(e,"mini",l[4].type==="mini")},m(s,r){z(s,e,r);for(let o=0;o<i.length;o+=1)i[o].m(e,null);g(e,t)},p(s,r){if(r&2){n=s[4].chunks;let o;for(o=0;o<n.length;o+=1){const a=sl(s,n,o);i[o]?i[o].p(a,r):(i[o]=il(a),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}r&2&&X(e,"mini",s[4].type==="mini")},d(s){s&&N(e),Ht(i,s)}}}function Xn(l){let e,t,n,i=l[1],s=[];for(let r=0;r<i.length;r+=1)s[r]=rl(nl(l,i,r));return{c(){e=y("div");for(let r=0;r<s.length;r+=1)s[r].c();b(e,"class","flex flex_clm notify svelte-13s1vua"),X(e,"normal",l[0]==="normal"),X(e,"error",l[0]==="error"),X(e,"debug",l[0]==="debug")},m(r,o){z(r,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);n=!0},p(r,[o]){if(o&2){i=r[1];let a;for(a=0;a<i.length;a+=1){const f=nl(r,i,a);s[a]?s[a].p(f,o):(s[a]=rl(f),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}(!n||o&1)&&X(e,"normal",r[0]==="normal"),(!n||o&1)&&X(e,"error",r[0]==="error"),(!n||o&1)&&X(e,"debug",r[0]==="debug")},i(r){n||(r&&Ee(()=>{t||(t=Me(e,Qe,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Me(e,Qe,{},!1)),t.run(0)),n=!1},d(r){r&&N(e),Ht(s,r),r&&t&&t.end()}}}function Kn(l,e,t){let{notify:n}=e,i="normal",s=[];const r=()=>{t(0,i=n==null?void 0:n.type),t(1,s=[]),Array.isArray(n==null?void 0:n.data)&&t(1,s=n.data.filter(Boolean).map(o=>{let a="normal",f=[];return typeof o=="string"?f.push({color:"#fff",text:o}):(a=o.type,f=o.chunks?o.chunks:[{color:"#fff",text:o.text}]),f=f.filter(c=>c.text),{type:a,chunks:f}}).filter(o=>o.chunks.length))};return l.$$set=o=>{"notify"in o&&t(2,n=o.notify)},l.$$.update=()=>{l.$$.dirty&4&&r()},[i,s,n]}class Zn extends ke{constructor(e){super(),ye(this,e,Kn,Xn,me,{notify:2})}}function ol(l,e,t){const n=l.slice();return n[4]=e[t],n}function al(l,e){let t,n,i;return n=new Zn({props:{notify:e[4]}}),{key:l,first:null,c(){t=Ve(),ge(n.$$.fragment),this.first=t},m(s,r){z(s,t,r),fe(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.notify=e[4]),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){R(n.$$.fragment,s),i=!1},d(s){s&&N(t),ce(n,s)}}}function Qn(l){let e,t=[],n=new Map,i,s=l[0];const r=o=>o[4].id;for(let o=0;o<s.length;o+=1){let a=ol(l,s,o),f=r(a);n.set(f,t[o]=al(f,a))}return{c(){e=y("div");for(let o=0;o<t.length;o+=1)t[o].c();b(e,"class","pos_abs notify_list svelte-11tn2wf")},m(o,a){z(o,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);i=!0},p(o,[a]){a&1&&(s=o[0],he(),t=xe(t,a,r,1,o,s,n,e,et,al,null,ol),ve())},i(o){if(!i){for(let a=0;a<s.length;a+=1)j(t[a]);i=!0}},o(o){for(let a=0;a<t.length;a+=1)R(t[a]);i=!1},d(o){o&&N(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}const $n=5e3;function es(l,e,t){let{events:n=Ut()}=e,i=1,s=[];const r=o=>a=>{s.push({id:i++,time:Date.now(),type:o,data:a}),t(0,s)};return Be(Ft(1e3,()=>{const o=Date.now(),a=s.filter(f=>f.time+$n>=o);a.length!==s.length&&t(0,s=a)})),Be(n.on("error",r("error"))),un().has("debug")&&Be(n.on("debug",r("debug"))),l.$$set=o=>{"events"in o&&t(1,n=o.events)},[s,n]}class ts extends ke{constructor(e){super(),ye(this,e,es,Qn,me,{events:1})}}function fl(l){return Object.prototype.toString.call(l)==="[object Date]"}function jt(l,e){if(l===e||l!==l)return()=>l;const t=typeof l;if(t!==typeof e||Array.isArray(l)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(l)){const n=e.map((i,s)=>jt(l[s],i));return i=>n.map(s=>s(i))}if(t==="object"){if(!l||!e)throw new Error("Object cannot be null");if(fl(l)&&fl(e)){l=l.getTime(),e=e.getTime();const s=e-l;return r=>new Date(l+r*s)}const n=Object.keys(e),i={};return n.forEach(s=>{i[s]=jt(l[s],e[s])}),s=>{const r={};return n.forEach(o=>{r[o]=i[o](s)}),r}}if(t==="number"){const n=e-l;return i=>l+i*n}throw new Error(`Cannot interpolate ${t} values`)}function qe(l,e={}){const t=Fe(l);let n,i=l;function s(r,o){if(l==null)return t.set(l=r),Promise.resolve();i=r;let a=n,f=!1,{delay:c=0,duration:m=400,easing:d=Nt,interpolate:u=jt}=Zt(Zt({},e),o);if(m===0)return a&&(a.abort(),a=null),t.set(l=i),Promise.resolve();const _=nn()+c;let p;return n=rn(k=>{if(k<_)return!0;f||(p=u(l,r),typeof m=="function"&&(m=m(l,r)),f=!0),a&&(a.abort(),a=null);const w=k-_;return w>m?(t.set(l=r),!1):(t.set(l=p(d(w/m))),!0)}),n.promise}return{set:s,update:(r,o)=>s(r(i,l),o),subscribe:t.subscribe}}function ls(l){let e,t,n,i,s,r,o,a,f;return{c(){e=y("div"),t=y("div"),n=y("div"),i=A(),s=y("div"),r=A(),o=y("div"),a=A(),f=y("div"),b(n,"class","pos_abs s1 svelte-fxby3d"),b(s,"class","pos_abs s2 svelte-fxby3d"),b(o,"class","pos_abs s3 svelte-fxby3d"),b(f,"class","pos_abs s4 svelte-fxby3d"),b(t,"class","flex pos_rel ellipsis svelte-fxby3d"),H(t,"transform","scale("+l[1]+")"),b(e,"class","flex"),H(e,"height",l[0]+"px"),H(e,"width",l[2]+"px")},m(c,m){z(c,e,m),g(e,t),g(t,n),g(t,i),g(t,s),g(t,r),g(t,o),g(t,a),g(t,f)},p(c,[m]){m&2&&H(t,"transform","scale("+c[1]+")"),m&1&&H(e,"height",c[0]+"px"),m&4&&H(e,"width",c[2]+"px")},i:ae,o:ae,d(c){c&&N(e)}}}function ns(l,e,t){let n,i,{height:s=5}=e;return l.$$set=r=>{"height"in r&&t(0,s=r.height)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=s/.1625),l.$$.dirty&1&&t(1,i=s/13)},[s,i,n]}class ss extends ke{constructor(e){super(),ye(this,e,ns,ls,me,{height:0})}}function cl(l){let e,t,n,i;return t=new ss({props:{height:6}}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","flex pos_abs loading svelte-15wz55f")},m(s,r){z(s,e,r),fe(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&N(e),ce(t),s&&n&&n.end()}}}function is(l){let e,t,n,i,s,r,o,a,f,c,m,d,u,_=l[0]&&cl();return{c(){e=y("div"),t=y("div"),n=A(),i=y("div"),i.textContent="offline",s=A(),r=y("div"),o=K(`online\r
		`),a=y("div"),f=K(l[2]),c=A(),_&&_.c(),b(t,"class","pos_abs h100 onlineProgressTrumb svelte-15wz55f"),H(t,"width",l[1]+"%"),b(i,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel label2 svelte-15wz55f"),X(i,"hideR",l[1]>=1),b(a,"class","pos_abs onlineProgressTrumbLastTime svelte-15wz55f"),b(r,"class","flex flex_cx flex_cy pos_abs w100 h100 onlineProgressTrackLabel  svelte-15wz55f"),X(r,"hideL",l[1]<1),b(e,"class","flex flex_cx flex_cy flex_grow_1 onlineProgressTrack pos_rel overhide unselect cursor_ptr svelte-15wz55f")},m(p,k){z(p,e,k),g(e,t),g(e,n),g(e,i),g(e,s),g(e,r),g(r,o),g(r,a),g(a,f),g(e,c),_&&_.m(e,null),m=!0,d||(u=$(e,"click",l[8]),d=!0)},p(p,[k]){(!m||k&2)&&H(t,"width",p[1]+"%"),(!m||k&2)&&X(i,"hideR",p[1]>=1),(!m||k&4)&&_e(f,p[2]),(!m||k&2)&&X(r,"hideL",p[1]<1),p[0]?_?k&1&&j(_,1):(_=cl(),_.c(),j(_,1),_.m(e,null)):_&&(he(),R(_,1,1,()=>{_=null}),ve())},i(p){m||(j(_),m=!0)},o(p){R(_),m=!1},d(p){p&&N(e),_&&_.d(),d=!1,u()}}}function rs(l,e,t){let n,i,s,{endTime:r=0}=e,{intervalTime:o=1}=e,{loading:a=!1}=e;const f=qe(0);Se(l,f,_=>t(7,s=_));let c=0;function m(){const _=Math.max(0,r-Date.now());t(1,c=Math.floor(He(0,_/o,1)*100)),Ge(f,s=Math.ceil(_/1e3),s)}Be(Ft(1e3,m));const d=_=>{const p=Math.floor(_%60);_/=60;const k=Math.floor(_%60);_/=60;const w=Math.floor(_),h=[];return(h.length||w)&&h.push(`${String(w).padStart(h.length?2:1,"0")}h`),(h.length||k)&&h.push(`${String(k).padStart(h.length?2:1,"0")}m`),(h.length||p)&&h.push(`${String(p).padStart(h.length?2:1,"0")}s`),h.join(" ")};function u(_){Dn.call(this,l,_)}return l.$$set=_=>{"endTime"in _&&t(4,r=_.endTime),"intervalTime"in _&&t(5,o=_.intervalTime),"loading"in _&&t(0,a=_.loading)},l.$$.update=()=>{l.$$.dirty&128&&t(6,n=Math.ceil(s)),l.$$.dirty&64&&t(2,i=d(n))},[a,c,i,f,r,o,n,s,u]}class os extends ke{constructor(e){super(),ye(this,e,rs,is,me,{endTime:4,intervalTime:5,loading:0})}}function as(l){let e;return{c(){e=K("\xA0")},m(t,n){z(t,e,n)},p:ae,d(t){t&&N(e)}}}function fs(l){let e,t=l[2].username+"",n;return{c(){e=K("@"),n=K(t)},m(i,s){z(i,e,s),z(i,n,s)},p(i,s){s&4&&t!==(t=i[2].username+"")&&_e(n,t)},d(i){i&&N(e),i&&N(n)}}}function cs(l){var V,le;let e,t,n,i,s=((V=l[2].first_name)!=null?V:"")+"",r,o,a,f,c,m=((le=l[2].last_name)!=null?le:"")+"",d,u,_,p,k,w,h,v,E,M,L,C,O,S,T;function P(te,J){return te[2].username?fs:as}let G=P(l),F=G(l);return M=new os({props:{intervalTime:l[1],endTime:l[0],loading:l[3]}}),M.$on("click",l[8]),{c(){e=y("div"),t=y("div"),n=y("div"),i=y("div"),r=K(s),o=A(),a=y("div"),f=A(),c=y("div"),d=K(m),u=K("\xA0"),_=A(),p=y("div"),F.c(),k=A(),w=y("div"),w.innerHTML='<img src="assets/icons/logout.png" draggable="false" class="pos_abs w100 h100 svelte-1qt21qp"/>',h=A(),v=y("div"),E=A(),ge(M.$$.fragment),L=A(),C=y("div"),H(a,"width","8px"),b(n,"class","flex nowrap textOverEllipsis name svelte-1qt21qp"),b(p,"class","nowrap textOverEllipsis username svelte-1qt21qp"),b(w,"class","pos_abs btnLogout svelte-1qt21qp"),b(t,"class","flex flex_clm cursor_ptr pos_rel unselect operator svelte-1qt21qp"),H(v,"height","8px"),H(C,"height","8px"),b(e,"class","flex flex_clm cnt svelte-1qt21qp")},m(te,J){z(te,e,J),g(e,t),g(t,n),g(n,i),g(i,r),g(n,o),g(n,a),g(n,f),g(n,c),g(c,d),g(c,u),g(t,_),g(t,p),F.m(p,null),g(t,k),g(t,w),g(e,h),g(e,v),g(e,E),fe(M,e,null),g(e,L),g(e,C),O=!0,S||(T=$(w,"click",l[7]),S=!0)},p(te,[J]){var we,Y;(!O||J&4)&&s!==(s=((we=te[2].first_name)!=null?we:"")+"")&&_e(r,s),(!O||J&4)&&m!==(m=((Y=te[2].last_name)!=null?Y:"")+"")&&_e(d,m),G===(G=P(te))&&F?F.p(te,J):(F.d(1),F=G(te),F&&(F.c(),F.m(p,null)));const se={};J&2&&(se.intervalTime=te[1]),J&1&&(se.endTime=te[0]),J&8&&(se.loading=te[3]),M.$set(se)},i(te){O||(j(M.$$.fragment,te),O=!0)},o(te){R(M.$$.fragment,te),O=!1},d(te){te&&N(e),F.d(),ce(M),S=!1,T()}}}function us(l,e,t){let n,i,s,{app:r}=e;const{operatorSelf_r:o,operatorSelfLastOnlineInfo_r:a,operatorSelfLastOnlineInfoLoading_r:f,operatorSelfLastOnline_SetOnlineFlag:c}=r;Se(l,o,w=>t(2,i=w)),Se(l,a,w=>t(10,n=w)),Se(l,f,w=>t(3,s=w));const m=()=>_n(null);let d=0,u=1;const _=w=>{if(!w){t(0,d=0),t(1,u=1);return}t(0,d=+new Date(w.offline_at)),t(1,u=He(1,(w.interval|0)*1e3,1e9))};let p=!1;const k=async()=>{var w;!((w=r.appConfig)!=null&&w.operatorSelf_CanSetOnline)||p||(p=!0,await c(!0),p=!1)};return l.$$set=w=>{"app"in w&&t(9,r=w.app)},l.$$.update=()=>{l.$$.dirty&1024&&_(n)},[d,u,i,s,o,a,f,m,k,r,n]}class ds extends ke{constructor(e){super(),ye(this,e,us,cs,me,{app:9})}}const ot=(l,e)=>{let t=null,n=null,i=!0;const s=()=>{i&&setTimeout(s,10);const o=l.parentNode;if(o){const a=o.getBoundingClientRect();(t!==a.width||n!==a.height)&&(t=a.width,n=a.height,l.style.width=`${t}px`,l.style.height=`${n}px`,e&&e.set(a))}};return s(),{destroy:()=>i=!1}},_s=(l,e)=>{let t=null,n=null,i=null,s=null,r=!0;const o=()=>{r&&setTimeout(o,10);const f=l.getBoundingClientRect();(t!==f.width||n!==f.height||i!==f.x||s!==f.y)&&(t=f.width,n=f.height,i=f.x,s=f.y,e&&e.set(f))};return o(),{destroy:()=>r=!1}};function gs(l){let e,t,n,i,s,r,o,a,f,c,m,d,u,_,p,k,w;return{c(){e=y("div"),t=y("div"),n=y("div"),i=A(),s=y("div"),r=A(),o=y("div"),a=A(),f=y("div"),c=A(),m=y("div"),d=A(),u=y("div"),_=A(),p=y("div"),k=A(),w=y("div"),b(n,"class","svelte-1lltvmx"),b(s,"class","svelte-1lltvmx"),b(o,"class","svelte-1lltvmx"),b(f,"class","svelte-1lltvmx"),b(m,"class","svelte-1lltvmx"),b(u,"class","svelte-1lltvmx"),b(p,"class","svelte-1lltvmx"),b(w,"class","svelte-1lltvmx"),b(t,"class","lds-roller svelte-1lltvmx"),H(t,"transform","scale("+l[2]+")"),H(t,"--loadingItemColor",l[1]),b(e,"class","flex"),H(e,"height",l[0]+"px"),H(e,"width",l[0]+"px")},m(h,v){z(h,e,v),g(e,t),g(t,n),g(t,i),g(t,s),g(t,r),g(t,o),g(t,a),g(t,f),g(t,c),g(t,m),g(t,d),g(t,u),g(t,_),g(t,p),g(t,k),g(t,w)},p(h,[v]){v&4&&H(t,"transform","scale("+h[2]+")"),v&2&&H(t,"--loadingItemColor",h[1]),v&1&&H(e,"height",h[0]+"px"),v&1&&H(e,"width",h[0]+"px")},i:ae,o:ae,d(h){h&&N(e)}}}function ps(l,e,t){let n,{size:i=80}=e,{color:s="#000"}=e;return l.$$set=r=>{"size"in r&&t(0,i=r.size),"color"in r&&t(1,s=r.color)},l.$$.update=()=>{l.$$.dirty&1&&t(2,n=i/80)},[i,s,n]}class gn extends ke{constructor(e){super(),ye(this,e,ps,gs,me,{size:0,color:1})}}const{Map:ms}=cn;function ul(l,e,t){const n=l.slice();return n[15]=e[t],n}function dl(l){let e,t,n,i;return t=new gn({props:{color:"#fff",size:"32"}}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_abs loading svelte-1i0u6mf")},m(s,r){z(s,e,r),fe(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&N(e),ce(t),s&&n&&n.end()}}}function _l(l){let e,t,n=l[15].username+"",i;return{c(){e=y("div"),t=K("@"),i=K(n),b(e,"class","nowrap textOverEllipsis username svelte-1i0u6mf")},m(s,r){z(s,e,r),g(e,t),g(e,i)},p(s,r){r&8&&n!==(n=s[15].username+"")&&_e(i,n)},d(s){s&&N(e)}}}function gl(l){let e,t,n;return t=new gn({props:{color:"#fff",size:"32"}}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","flex flex_cy h100 pos_abs loadingLead svelte-1i0u6mf")},m(i,s){z(i,e,s),fe(t,e,null),n=!0},i(i){n||(j(t.$$.fragment,i),n=!0)},o(i){R(t.$$.fragment,i),n=!1},d(i){i&&N(e),ce(t)}}}function pl(l,e){var C,O;let t,n,i,s=((C=e[15].first_name)!=null?C:"")+"",r,o,a,f,c,m=((O=e[15].last_name)!=null?O:"")+"",d,u,_,p,k=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id),w,h,v,E,M=e[15].username&&_l(e),L=k&&gl();return{key:l,first:null,c(){t=y("div"),n=y("div"),i=y("div"),r=K(s),o=A(),a=y("div"),f=A(),c=y("div"),d=K(m),u=K("\xA0"),_=A(),M&&M.c(),p=A(),L&&L.c(),w=A(),H(a,"width","8px"),b(n,"class","flex nowrap textOverEllipsis userAttr svelte-1i0u6mf"),b(t,"class","flex flex_clm cursor_ptr w100 item unselect pos_abs svelte-1i0u6mf"),H(t,"top",e[15].y+"px"),H(t,"height",pn+"px"),X(t,"disabled",e[1].has(e[15].tg_id)),this.first=t},m(S,T){z(S,t,T),g(t,n),g(n,i),g(i,r),g(n,o),g(n,a),g(n,f),g(n,c),g(c,d),g(c,u),g(t,_),M&&M.m(t,null),g(t,p),L&&L.m(t,null),g(t,w),h=!0,v||(E=$(t,"click",function(){ze(e[6](e[15].tg_id))&&e[6](e[15].tg_id).apply(this,arguments)}),v=!0)},p(S,T){var P,G;e=S,(!h||T&8)&&s!==(s=((P=e[15].first_name)!=null?P:"")+"")&&_e(r,s),(!h||T&8)&&m!==(m=((G=e[15].last_name)!=null?G:"")+"")&&_e(d,m),e[15].username?M?M.p(e,T):(M=_l(e),M.c(),M.m(t,p)):M&&(M.d(1),M=null),T&14&&(k=e[2].has(e[15].tg_id)||e[1].has(e[15].tg_id)),k?L?T&14&&j(L,1):(L=gl(),L.c(),j(L,1),L.m(t,w)):L&&(he(),R(L,1,1,()=>{L=null}),ve()),(!h||T&8)&&H(t,"top",e[15].y+"px"),(!h||T&10)&&X(t,"disabled",e[1].has(e[15].tg_id))},i(S){h||(j(L),h=!0)},o(S){R(L),h=!1},d(S){S&&N(t),M&&M.d(),L&&L.d(),v=!1,E()}}}function hs(l){var O;let e,t,n,i,s,r,o,a=((O=l[4])!=null?O:0)+"",f,c,m,d,u,_,p,k=[],w=new ms,h,v,E,M=l[5]&&dl(),L=l[3];const C=S=>S[15].tg_id;for(let S=0;S<L.length;S+=1){let T=ul(l,L,S),P=C(T);w.set(P,k[S]=pl(P,T))}return{c(){e=y("div"),t=y("div"),n=y("div"),n.textContent="New leads",i=A(),M&&M.c(),s=A(),r=y("div"),o=K("count: "),f=K(a),c=A(),m=y("div"),d=A(),u=y("div"),_=y("div"),p=y("div");for(let S=0;S<k.length;S+=1)k[S].c();b(n,"class","flex mainLabel svelte-1i0u6mf"),b(r,"class","flex pos_abs labelCount svelte-1i0u6mf"),b(t,"class","flex flex_cx flex_cy header pos_rel w100 svelte-1i0u6mf"),H(m,"height","20px"),b(p,"class","flex list h100 svelte-1i0u6mf"),b(_,"class","pos_abs w100"),H(_,"overflow","hidden"),b(u,"class","flex cnt h100 pos_rel w100 svelte-1i0u6mf"),b(e,"class","flex flex_clm wrapMain flex_grow_1 w100 unselect svelte-1i0u6mf")},m(S,T){z(S,e,T),g(e,t),g(t,n),g(t,i),M&&M.m(t,null),g(t,s),g(t,r),g(r,o),g(r,f),g(e,c),g(e,m),g(e,d),g(e,u),g(u,_),g(_,p);for(let P=0;P<k.length;P+=1)k[P].m(p,null);l[9](_),h=!0,v||(E=$e(ot.call(null,_)),v=!0)},p(S,[T]){var P;S[5]?M?T&32&&j(M,1):(M=dl(),M.c(),j(M,1),M.m(t,s)):M&&(he(),R(M,1,1,()=>{M=null}),ve()),(!h||T&16)&&a!==(a=((P=S[4])!=null?P:0)+"")&&_e(f,a),T&78&&(L=S[3],he(),k=xe(k,T,C,1,S,L,w,p,et,pl,null,ul),ve())},i(S){if(!h){j(M);for(let T=0;T<L.length;T+=1)j(k[T]);h=!0}},o(S){R(M);for(let T=0;T<k.length;T+=1)R(k[T]);h=!1},d(S){S&&N(e),M&&M.d();for(let T=0;T<k.length;T+=1)k[T].d();l[9](null),v=!1,E()}}}const vs=160,pn=42,Mt=0;function ws(l,e,t){let{app:n}=e,i=[],s=new Map,r=new Set,o=[],a=null;function f(){if(!a)return;const h=a.getBoundingClientRect(),v=vs+Mt*2,E=pn+Mt*2,M=Math.max(1,Math.floor(h.width/v)),L=(h.width-M*v)/2,C=Mt;t(3,o=i.map((O,S)=>{const T={...O};return T.x=S%M*v+L,T.y=C+Math.floor(S/M)*E,T}))}let c=null,m=!1;async function d(){var v;const h=await n.api.lead_GetUnassignedList({offset:0,limit:20});return h?(t(4,c=h.count),(v=h.results)!=null?v:h):null}let u=!0;async function _(){for(;u;){await Ct(g_Config.updateIntervals.new_leads);const h=await d();if(!h)continue;const v=new Set(i.map(S=>S.tg_id)),E=new Set(h.map(S=>S.tg_id)),M=h.filter(S=>!v.has(S.tg_id)),L=i.filter(S=>!E.has(S.tg_id)),C=Date.now();L.map(S=>s.has(S.tg_id)||s.set(S.tg_id,C)),M.length===0&&L.length===0||t(8,i=[...i,...M]);const O=new Set;[...s].map(S=>{S[1]+2e3<=C&&O.add(S[0]),S[1]+1e4<=C&&s.delete(S[0])}),O.size&&t(8,i=i.filter(S=>!O.has(S.tg_id)))}}async function p(){for(t(5,m=!0);u;){const h=await d();if(h){t(8,i=h);break}}t(5,m=!1),_()}Be(()=>u=!1);const k=h=>async v=>{if(r.has(h)||s.has(h))return;r.add(h),t(2,r);const E=await n.api.lead_AssignOperatorSelft(h);r.delete(h),t(2,r),E!==null&&(s.set(h,Date.now()),t(1,s)),t(8,i),t(3,o)};p();function w(h){Re[h?"unshift":"push"](()=>{a=h,t(0,a)})}return l.$$set=h=>{"app"in h&&t(7,n=h.app)},l.$$.update=()=>{l.$$.dirty&257&&f()},[a,s,r,o,c,m,k,n,i,w]}class bs extends ke{constructor(e){super(),ye(this,e,ws,hs,me,{app:7})}}function ys(l){let e,t,n,i,s,r,o,a,f,c,m,d,u,_,p,k,w,h;return{c(){e=y("label"),t=y("input"),n=A(),i=Pe("svg"),s=Pe("symbol"),r=Pe("path"),o=Pe("defs"),a=Pe("mask"),f=Pe("use"),c=Pe("use"),m=Pe("path"),d=A(),u=Pe("svg"),_=Pe("path"),p=Pe("path"),k=Pe("path"),b(t,"type","checkbox"),b(t,"class","svelte-13drl8w"),b(r,"d","M5.22003 7.26C5.72003 7.76 7.57 9.7 8.67 11.45C12.2 6.05 15.65 3.5 19.19 1.69"),b(r,"fill","none"),b(r,"stroke-width","2.25"),b(r,"stroke-linecap","round"),b(r,"stroke-linejoin","round"),b(s,"id","tick-path"),b(s,"viewBox","0 0 21 18"),b(s,"xmlns","http://www.w3.org/2000/svg"),b(f,"class","tick mask svelte-13drl8w"),b(f,"href","#tick-path"),b(a,"id","tick"),b(c,"class","tick svelte-13drl8w"),b(c,"href","#tick-path"),b(c,"stroke","currentColor"),b(m,"fill","white"),b(m,"mask","url(#tick)"),b(m,"d","M18 9C18 10.4464 17.9036 11.8929 17.7589 13.1464C17.5179 15.6054 15.6054 17.5179 13.1625 17.7589C11.8929 17.9036 10.4464 18 9 18C7.55357 18 6.10714 17.9036 4.85357 17.7589C2.39464 17.5179 0.498214 15.6054 0.241071 13.1464C0.0964286 11.8929 0 10.4464 0 9C0 7.55357 0.0964286 6.10714 0.241071 4.8375C0.498214 2.39464 2.39464 0.482143 4.85357 0.241071C6.10714 0.0964286 7.55357 0 9 0C10.4464 0 11.8929 0.0964286 13.1625 0.241071C15.6054 0.482143 17.5179 2.39464 17.7589 4.8375C17.9036 6.10714 18 7.55357 18 9Z"),b(i,"viewBox","0 0 21 18"),b(i,"class","svelte-13drl8w"),b(_,"d","M5.88086 5.89441L9.53504 4.26746"),b(p,"d","M5.5274 8.78838L9.45391 9.55161"),b(k,"d","M3.49371 4.22065L5.55387 0.79198"),b(u,"class","lines svelte-13drl8w"),b(u,"viewBox","0 0 11 11"),b(e,"class","checkbox svelte-13drl8w")},m(v,E){z(v,e,E),g(e,t),t.checked=l[0],g(e,n),g(e,i),g(i,s),g(s,r),g(i,o),g(o,a),g(a,f),g(i,c),g(i,m),g(e,d),g(e,u),g(u,_),g(u,p),g(u,k),w||(h=$(t,"change",l[1]),w=!0)},p(v,[E]){E&1&&(t.checked=v[0])},i:ae,o:ae,d(v){v&&N(e),w=!1,h()}}}function ks(l,e,t){let{checked:n=!1}=e;function i(){n=this.checked,t(0,n)}return l.$$set=s=>{"checked"in s&&t(0,n=s.checked)},[n,i]}class Ls extends ke{constructor(e){super(),ye(this,e,ks,ys,me,{checked:0})}}function ml(l,e,t){const n=l.slice();return n[16]=e[t],n}function hl(l,e){let t,n=e[16].title.toLowerCase()+"",i;return{key:l,first:null,c(){t=y("div"),i=K(n),b(t,"class","flex tag svelte-15iclg5"),H(t,"background",e[16].background_color),H(t,"color",e[16].color),this.first=t},m(s,r){z(s,t,r),g(t,i)},p(s,r){e=s,r&16&&n!==(n=e[16].title.toLowerCase()+"")&&_e(i,n),r&16&&H(t,"background",e[16].background_color),r&16&&H(t,"color",e[16].color)},d(s){s&&N(t)}}}function vl(l){var i;let e,t=l[12]((i=l[4])==null?void 0:i._lastTime)+"",n;return{c(){e=y("div"),n=K(t),b(e,"class","pos_abs flex flex_cx flex_cy lastTime svelte-15iclg5")},m(s,r){z(s,e,r),g(e,n)},p(s,r){var o;r&16&&t!==(t=s[12]((o=s[4])==null?void 0:o._lastTime)+"")&&_e(n,t)},d(s){s&&N(e)}}}function wl(l){var i;let e,t=((i=l[4])==null?void 0:i.unread_messages_count)+"",n;return{c(){e=y("div"),n=K(t),b(e,"class","pos_abs flex flex_cx flex_cy unreadMsgs svelte-15iclg5")},m(s,r){z(s,e,r),g(e,n)},p(s,r){var o;r&16&&t!==(t=((o=s[4])==null?void 0:o.unread_messages_count)+"")&&_e(n,t)},d(s){s&&N(e)}}}function Ss(l){var Le,Ne,Ie,pe,I,D,B,U,W,q,ie,oe,Q,Te,De;let e,t,n,i,s,r,o=((Ie=(Ne=(Le=l[4])==null?void 0:Le.lead)==null?void 0:Ne.first_name)!=null?Ie:"")+"",a,f,c,m,d,u=((D=(I=(pe=l[4])==null?void 0:pe.lead)==null?void 0:I.last_name)!=null?D:"")+"",_,p,k,w,h=((W=(U=(B=l[4])==null?void 0:B.last_message)==null?void 0:U.text)!=null?W:"")+"",v,E,M,L,C,O,S,T,P=l[0].lead_GetStatusTitle((ie=(q=l[4])==null?void 0:q.lead)==null?void 0:ie.status)+"",G,F,V,le,te,J=[],se=new Map,we,Y,ue,be,x=(Q=(oe=l[4])==null?void 0:oe.tag)!=null?Q:[];const Z=ee=>ee[16].id;for(let ee=0;ee<x.length;ee+=1){let de=ml(l,x,ee),Ae=Z(de);se.set(Ae,J[ee]=hl(Ae,de))}let ne=((Te=l[4])==null?void 0:Te._lastTime)&&vl(l),re=((De=l[4])==null?void 0:De.unread_messages_count)&&wl(l);return{c(){e=y("div"),t=y("div"),n=y("div"),i=y("div"),s=A(),r=y("div"),a=K(o),f=A(),c=y("div"),m=A(),d=y("div"),_=K(u),p=K("\xA0"),k=A(),w=y("div"),v=K(h),E=K("\xA0"),M=A(),L=y("div"),C=y("div"),O=y("img"),T=A(),G=K(P),F=A(),V=y("div"),le=A(),te=y("div");for(let ee=0;ee<J.length;ee+=1)J[ee].c();we=A(),ne&&ne.c(),Y=A(),re&&re.c(),H(i,"width","8px"),H(c,"width","8px"),b(n,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-15iclg5"),b(w,"class","nowrap textOverEllipsis lastMessage pos_rel svelte-15iclg5"),Xe(O.src,S="assets/icons/status1.png")||b(O,"src",S),b(O,"draggable","false"),b(O,"class","pos_abs statusIcon svelte-15iclg5"),b(C,"class","flex flex_cy leadStatus pos_rel svelte-15iclg5"),H(V,"width","4px"),b(te,"class","flex tag_list svelte-15iclg5"),b(L,"class","flex"),b(t,"class","flex flex_clm cursor_ptr item flex_cx unselect pos_rel svelte-15iclg5"),H(t,"height",l[1]+"px"),X(t,"active",l[2]===l[6]),X(t,"disabled",l[11](l[4])),b(e,"class","pos_abs w100 cntWrapper svelte-15iclg5"),H(e,"transform","translate3d(0px, "+(l[5]+l[3])+"px, 0px)")},m(ee,de){z(ee,e,de),g(e,t),g(t,n),g(n,i),g(n,s),g(n,r),g(r,a),g(n,f),g(n,c),g(n,m),g(n,d),g(d,_),g(d,p),g(t,k),g(t,w),g(w,v),g(w,E),g(t,M),g(t,L),g(L,C),g(C,O),g(C,T),g(C,G),g(L,F),g(L,V),g(L,le),g(L,te);for(let Ae=0;Ae<J.length;Ae+=1)J[Ae].m(te,null);g(t,we),ne&&ne.m(t,null),g(t,Y),re&&re.m(t,null),ue||(be=$(t,"click",l[10]),ue=!0)},p(ee,[de]){var Ae,tt,Oe,Je,ft,ct,ut,qt,xt,Yt,Wt,Vt,Jt,Xt,Kt;de&16&&o!==(o=((Oe=(tt=(Ae=ee[4])==null?void 0:Ae.lead)==null?void 0:tt.first_name)!=null?Oe:"")+"")&&_e(a,o),de&16&&u!==(u=((ct=(ft=(Je=ee[4])==null?void 0:Je.lead)==null?void 0:ft.last_name)!=null?ct:"")+"")&&_e(_,u),de&16&&h!==(h=((xt=(qt=(ut=ee[4])==null?void 0:ut.last_message)==null?void 0:qt.text)!=null?xt:"")+"")&&_e(v,h),de&17&&P!==(P=ee[0].lead_GetStatusTitle((Wt=(Yt=ee[4])==null?void 0:Yt.lead)==null?void 0:Wt.status)+"")&&_e(G,P),de&16&&(x=(Jt=(Vt=ee[4])==null?void 0:Vt.tag)!=null?Jt:[],J=xe(J,de,Z,1,ee,x,se,te,Rt,hl,null,ml)),(Xt=ee[4])!=null&&Xt._lastTime?ne?ne.p(ee,de):(ne=vl(ee),ne.c(),ne.m(t,Y)):ne&&(ne.d(1),ne=null),(Kt=ee[4])!=null&&Kt.unread_messages_count?re?re.p(ee,de):(re=wl(ee),re.c(),re.m(t,null)):re&&(re.d(1),re=null),de&2&&H(t,"height",ee[1]+"px"),de&68&&X(t,"active",ee[2]===ee[6]),de&2064&&X(t,"disabled",ee[11](ee[4])),de&40&&H(e,"transform","translate3d(0px, "+(ee[5]+ee[3])+"px, 0px)")},i:ae,o:ae,d(ee){ee&&N(e);for(let de=0;de<J.length;de+=1)J[de].d();ne&&ne.d(),re&&re.d(),ue=!1,be()}}}function Ms(l,e,t){let n,i,s,r,{app:o}=e;const{dialogMap_r:a,dialogActiveID_r:f,dialogActiveID_Set:c}=o;Se(l,a,v=>t(14,i=v)),Se(l,f,v=>t(6,r=v));let{height:m=54}=e,{dialog_id:d}=e,{y:u=0}=e,{scrollY:_=0}=e;const p=qe(u);Se(l,p,v=>t(5,s=v));const k=v=>{n&&!w(n)&&c(n.id)},w=v=>{var E;return((E=v==null?void 0:v.lead)==null?void 0:E.status)==="DL"},h=v=>{if(!v)return"";const E=L=>String(L).padStart(2,"0"),M=new Date;return v=new Date(v),v.getYear()===M.getYear()&&v.getMonth()===M.getMonth()?v.getDate()===M.getDate()?`${E(v.getHours())}:${E(v.getMinutes())}`:`${E(v.getDate())}d ${E(v.getHours())}:${E(v.getMinutes())}`:`${E(v.getDate())}.${E(v.getMonth())}.${v.getFullYear()}`};return l.$$set=v=>{"app"in v&&t(0,o=v.app),"height"in v&&t(1,m=v.height),"dialog_id"in v&&t(2,d=v.dialog_id),"y"in v&&t(13,u=v.y),"scrollY"in v&&t(3,_=v.scrollY)},l.$$.update=()=>{l.$$.dirty&8192&&Ge(p,s=u,s),l.$$.dirty&16388&&t(4,n=i[d])},[o,m,d,_,n,s,r,a,f,p,k,w,h,u,i]}class Ts extends ke{constructor(e){super(),ye(this,e,Ms,Ss,me,{app:0,height:1,dialog_id:2,y:13,scrollY:3})}}function Os(l){let e,t,n,i;return{c(){e=y("div"),t=y("div"),b(t,"class","pos_abs thumb w100 svelte-5ca5ia"),H(t,"height",l[1]+"px"),H(t,"transform","translate(0px, "+l[5](l[0],l[2],l[1])+"px)"),X(t,"active",l[3]),b(e,"class","pos_rel h100 unselect line svelte-5ca5ia"),X(e,"active",l[3])},m(s,r){z(s,e,r),g(e,t),n||(i=[$(window,"mousemove",l[7]),$(window,"mouseup",l[8]),$(window,"blur",l[8]),$(t,"mousedown",l[6]),$e(_s.call(null,e,l[4])),$(e,"mousedown",l[9])],n=!0)},p(s,[r]){r&2&&H(t,"height",s[1]+"px"),r&7&&H(t,"transform","translate(0px, "+s[5](s[0],s[2],s[1])+"px)"),r&8&&X(t,"active",s[3]),r&8&&X(e,"active",s[3])},i:ae,o:ae,d(s){s&&N(e),n=!1,je(i)}}}function Is(l,e,t){let n;const i=v=>He(0,Array.isArray(v)?v[0]:v,1);let{value_in:s=0}=e,{value_out:r=i(s)}=e,{thumb_Height:o=20}=e,{thumb_HeightRate:a=null}=e;const f=Fe(null);Se(l,f,v=>t(2,n=v));const c=()=>n?n.height-o:1,m=v=>n?v*c():0,d=()=>{if(!n)return 1;if(a===null)return o;t(1,o=He(.1,a,1)*n.height)};let u=null;const _=v=>{!n||t(3,u={y:v.clientY,value_out:r})},p=v=>{if(!n||!u)return;const E=v.clientY-u.y;if(n.height){const M=E/c();t(0,r=He(0,u.value_out+M,1))}},k=v=>{t(3,u=null)},w=v=>{!n||u||(t(0,r=He(0,(v.clientY-n.y-o/2)/c(),1)),t(3,u={y:v.clientY,value_out:r}))},h=()=>{if(!n)return 0;u||t(0,r=i(s))};return l.$$set=v=>{"value_in"in v&&t(10,s=v.value_in),"value_out"in v&&t(0,r=v.value_out),"thumb_Height"in v&&t(1,o=v.thumb_Height),"thumb_HeightRate"in v&&t(11,a=v.thumb_HeightRate)},l.$$.update=()=>{l.$$.dirty&2052&&d(),l.$$.dirty&1024&&h()},[r,o,n,u,f,m,_,p,k,w,s,a]}class mn extends ke{constructor(e){super(),ye(this,e,Is,Os,me,{value_in:10,value_out:0,thumb_Height:1,thumb_HeightRate:11})}}const{Map:Ds}=cn;function bl(l,e,t){const n=l.slice();return n[24]=e[t],n}function yl(l,e){let t,n,i;return n=new Ts({props:{app:e[0],dialog_id:e[24].dialog_id,scrollY:-e[2],y:e[24].y}}),{key:l,first:null,c(){t=Ve(),ge(n.$$.fragment),this.first=t},m(s,r){z(s,t,r),fe(n,s,r),i=!0},p(s,r){e=s;const o={};r&1&&(o.app=e[0]),r&16&&(o.dialog_id=e[24].dialog_id),r&4&&(o.scrollY=-e[2]),r&16&&(o.y=e[24].y),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){R(n.$$.fragment,s),i=!1},d(s){s&&N(t),ce(n,s)}}}function kl(l){let e,t,n,i;function s(o){l[14](o)}let r={value_in:l[5],thumb_HeightRate:l[6]};return l[1]!==void 0&&(r.value_out=l[1]),t=new mn({props:r}),Re.push(()=>yt(t,"value_out",s)),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_abs h100 dialogScroll svelte-1l0pdn")},m(o,a){z(o,e,a),fe(t,e,null),i=!0},p(o,a){const f={};a&32&&(f.value_in=o[5]),a&64&&(f.thumb_HeightRate=o[6]),!n&&a&2&&(n=!0,f.value_out=o[1],bt(()=>n=!1)),t.$set(f)},i(o){i||(j(t.$$.fragment,o),i=!0)},o(o){R(t.$$.fragment,o),i=!1},d(o){o&&N(e),ce(t)}}}function Ll(l){let e,t,n,i,s;return{c(){e=y("div"),e.innerHTML='<img class="flex" draggable="false" style="filter: invert(1);" src="assets/icons/arrow-up.png"/>',b(e,"class","flex pos_abs cursor_ptr btnScrollUp svelte-1l0pdn")},m(r,o){z(r,e,o),n=!0,i||(s=$(e,"click",l[15]),i=!0)},p:ae,i(r){n||(r&&Ee(()=>{t||(t=Me(e,Ce,{},!0)),t.run(1)}),n=!0)},o(r){r&&(t||(t=Me(e,Ce,{},!1)),t.run(0)),n=!1},d(r){r&&N(e),r&&t&&t.end(),i=!1,s()}}}function Cs(l){let e,t,n=[],i=new Ds,s,r,o,a,f,c=l[4];const m=_=>_[24].dialog_id;for(let _=0;_<c.length;_+=1){let p=bl(l,c,_),k=m(p);i.set(k,n[_]=yl(k,p))}let d=l[6]<1&&kl(l),u=l[6]<1&&l[7]&&Ll(l);return{c(){e=y("div"),t=y("div");for(let _=0;_<n.length;_+=1)n[_].c();s=A(),d&&d.c(),r=A(),u&&u.c(),b(t,"class","flex overhide pos_rel"),b(e,"class","flex flex_grow_1 pos_rel"),H(e,"--itemHeight",Ye+"px")},m(_,p){z(_,e,p),g(e,t);for(let k=0;k<n.length;k+=1)n[k].m(t,null);g(e,s),d&&d.m(e,null),g(e,r),u&&u.m(e,null),o=!0,a||(f=[$e(ot.call(null,t,l[8])),$(e,"wheel",l[10],{passive:!0})],a=!0)},p(_,[p]){p&21&&(c=_[4],he(),n=xe(n,p,m,1,_,c,i,t,et,yl,null,bl),ve()),_[6]<1?d?(d.p(_,p),p&64&&j(d,1)):(d=kl(_),d.c(),j(d,1),d.m(e,r)):d&&(he(),R(d,1,1,()=>{d=null}),ve()),_[6]<1&&_[7]?u?(u.p(_,p),p&192&&j(u,1)):(u=Ll(_),u.c(),j(u,1),u.m(e,null)):u&&(he(),R(u,1,1,()=>{u=null}),ve())},i(_){if(!o){for(let p=0;p<c.length;p+=1)j(n[p]);j(d),j(u),o=!0}},o(_){for(let p=0;p<n.length;p+=1)R(n[p]);R(d),R(u),o=!1},d(_){_&&N(e);for(let p=0;p<n.length;p+=1)n[p].d();d&&d.d(),u&&u.d(),a=!1,je(f)}}}const Ye=54;function Es(l,e,t){let n,i,s=ae,r=()=>(s(),s=Pt(_,F=>t(13,i=F)),_),o;l.$$.on_destroy.push(()=>s());let{app:a}=e;const{dialogMap_SetDialogList:f}=a;let{filter:c={}}=e;const m=F=>{var V;return[c.filterUnreadFirst?1:0,(V=c.filterTag)!=null?V:""].join("/")};let d={},u=null,_=Fe(null);r();function p(){const F={...c},V=m();d[V]||(d[V]=Fn({fLoad:le=>(le={unread_first:F.filterUnreadFirst?1:0,...le},F.filterTag&&(le.tag=F.filterTag),a.api.dialog_GetList(le)),updateInterval:500,isLoadEnd:!1,onUpdateItemList:f})),u!==d[V]&&([...Object.values(d)].map(le=>le.pause()),u=d[V],u.resume(),console.log({filterHash:V}),r(t(3,_=u.getData_r())))}Be(()=>[...Object.values(d)].map(F=>F.destroy()));let k=[];const w=Fe(null);Se(l,w,F=>t(12,n=F));let h=0,v=0,E=1,M=0,L=qe(M,{duration:200});Se(l,L,F=>t(2,o=F));function C(){if(!n||!i)return;const F=Math.max(1,Math.floor(n.height)),V=i.total*Ye,le=V-F;t(6,E=V?He(0,F/V,1):1),le<0?M=0:M=v*le,Ge(L,o=M,o)}let O=!1;function S(){if(!n||!i)return;const F=i,V=Math.max(1,Math.floor(n.height)),le=Math.ceil(V/Ye);i.total*Ye;let J=Math.max(0,Math.floor(o/Ye)-1);const se=le+2;J>F.total&&(J=Math.max(0,F.total-se)),u&&u.setRange(J,se);const we=[];for(let Y=J,ue=0;ue<se&&Y<F.total;ue++,Y++){const be=F.list[Y];we.push({index:Y,item:be,y:Y*Ye})}t(4,k=[...new Map(we.filter(Y=>Y.item).map(Y=>[Y.item.id,Y]))].map(([Y,ue])=>({dialog_id:ue.item.id,y:ue.y}))),t(7,O=J>1)}const T=F=>{if(!n||!i)return;const V=i,le=Math.max(1,Math.floor(n.height)),J=V.total*Ye-le;if(J<0)return;const se=F.deltaY>0?1:-1;t(5,h=[v+Ye/J*se])};function P(F){v=F,t(1,v)}const G=()=>t(5,h=[0]);return l.$$set=F=>{"app"in F&&t(0,a=F.app),"filter"in F&&t(11,c=F.filter)},l.$$.update=()=>{l.$$.dirty&2048&&p(),l.$$.dirty&12290&&C(),l.$$.dirty&12292&&S()},[a,v,o,_,k,h,E,O,w,L,T,c,n,i,P,G]}class As extends ke{constructor(e){super(),ye(this,e,Es,Cs,me,{app:0,filter:11})}}function Sl(l,e,t){const n=l.slice();return n[5]=e[t],n}function Ml(l,e){let t,n=e[5].title+"",i,s,r;function o(){return e[4](e[5])}return{key:l,first:null,c(){t=y("div"),i=K(n),b(t,"class","cursor_ptr filter_tag inactive svelte-1t7cez8"),H(t,"background",e[5].background_color),H(t,"color",e[5].color),X(t,"active",e[0]===e[5].title),this.first=t},m(a,f){z(a,t,f),g(t,i),s||(r=$(t,"click",o),s=!0)},p(a,f){e=a,f&3&&X(t,"active",e[0]===e[5].title)},d(a){a&&N(t),s=!1,r()}}}function js(l){let e,t,n,i,s,r,o=[],a=new Map,f,c,m=l[1];const d=u=>u[5].title;for(let u=0;u<m.length;u+=1){let _=Sl(l,m,u),p=d(_);a.set(p,o[u]=Ml(p,_))}return{c(){e=y("div"),t=y("div"),t.textContent="Filter tag",n=A(),i=y("div"),s=y("div"),s.textContent="all",r=A();for(let u=0;u<o.length;u+=1)o[u].c();b(t,"class","flex label svelte-1t7cez8"),b(s,"class","cursor_ptr filter_tag inactive svelte-1t7cez8"),H(s,"background","#fff"),H(s,"color","#000"),X(s,"active",l[0]===null),b(i,"class","flex filter_tag_list svelte-1t7cez8"),b(e,"class","flex flex_clm cnt unselect svelte-1t7cez8")},m(u,_){z(u,e,_),g(e,t),g(e,n),g(e,i),g(i,s),g(i,r);for(let p=0;p<o.length;p+=1)o[p].m(i,null);f||(c=$(s,"click",l[3]),f=!0)},p(u,[_]){_&1&&X(s,"active",u[0]===null),_&3&&(m=u[1],o=xe(o,_,d,1,u,m,a,i,Rt,Ml,null,Sl))},i:ae,o:ae,d(u){u&&N(e);for(let _=0;_<o.length;_+=1)o[_].d();f=!1,c()}}}function Ns(l,e,t){let{app:n}=e,{filterTag:i=null}=e,s=[...g_Config.pinnedTags];const r=()=>t(0,i=null),o=a=>t(0,i=a.title);return l.$$set=a=>{"app"in a&&t(2,n=a.app),"filterTag"in a&&t(0,i=a.filterTag)},[i,s,n,r,o]}class Ps extends ke{constructor(e){super(),ye(this,e,Ns,js,me,{app:2,filterTag:0})}}function Tl(l){let e,t,n,i,s,r,o,a,f;return{c(){e=y("img"),n=A(),i=y("div"),s=y("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',r=A(),o=y("div"),o.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/fullscreen.png"/>',b(e,"class","a_img svelte-1m8yuzj"),Xe(e.src,t=l[2].url)||b(e,"src",t),H(e,"max-height",l[4]+"px"),b(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),b(o,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),b(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(c,m){z(c,e,m),z(c,n,m),z(c,i,m),g(i,s),g(i,r),g(i,o),a||(f=[$(s,"click",function(){ze(l[5](l[2]))&&l[5](l[2]).apply(this,arguments)}),$(o,"click",function(){ze(l[6](l[2]))&&l[6](l[2]).apply(this,arguments)})],a=!0)},p(c,m){l=c,m&4&&!Xe(e.src,t=l[2].url)&&b(e,"src",t),m&16&&H(e,"max-height",l[4]+"px")},d(c){c&&N(e),c&&N(n),c&&N(i),a=!1,je(f)}}}function Ol(l){let e,t,n,i,s,r,o;return{c(){e=y("img"),n=A(),i=y("div"),s=y("div"),s.innerHTML='<img class="w100 h100 svelte-1m8yuzj" draggable="false" src="assets/icons/download.png"/>',b(e,"class","a_img fileIcon svelte-1m8yuzj"),Xe(e.src,t="assets/icons/folder.png")||b(e,"src",t),H(e,"max-height",l[4]+"px"),b(s,"class","flex cursor_ptr imgCtrlBtn svelte-1m8yuzj"),b(i,"class","flex pos_abs imgCtrlBtnGroup svelte-1m8yuzj")},m(a,f){z(a,e,f),z(a,n,f),z(a,i,f),g(i,s),r||(o=$(s,"click",l[13]),r=!0)},p(a,f){f&16&&H(e,"max-height",a[4]+"px")},d(a){a&&N(e),a&&N(n),a&&N(i),r=!1,o()}}}function Il(l){var i;let e,t=((i=l[0])==null?void 0:i.text)+"",n;return{c(){e=y("pre"),n=K(t),b(e,"class","w100 text textPre svelte-1m8yuzj")},m(s,r){z(s,e,r),g(e,n)},p(s,r){var o;r&1&&t!==(t=((o=s[0])==null?void 0:o.text)+"")&&_e(n,t)},d(s){s&&N(e)}}}function zs(l){var m,d;let e,t,n,i,s,r=l[7]((m=l[0])==null?void 0:m.received_at)+"",o,a=l[2]&&Tl(l),f=l[3]&&Ol(l),c=((d=l[0])==null?void 0:d.text)&&Il(l);return{c(){var u,_,p,k;e=y("div"),a&&a.c(),t=A(),f&&f.c(),n=A(),c&&c.c(),i=A(),s=y("div"),o=K(r),b(s,"class","flex pos_abs unselect date svelte-1m8yuzj"),X(s,"attachment_mode",l[2]&&!((u=l[0])!=null&&u.text)),b(e,"class","flex flex_clm overhide pos_abs chat_item svelte-1m8yuzj"),X(e,"chat_item_other",(_=l[0])==null?void 0:_.incoming),X(e,"chat_item_self",!((p=l[0])!=null&&p.incoming)),X(e,"has_text",(k=l[0])==null?void 0:k.text)},m(u,_){z(u,e,_),a&&a.m(e,null),g(e,t),f&&f.m(e,null),g(e,n),c&&c.m(e,null),g(e,i),g(e,s),g(s,o),l[14](e)},p(u,[_]){var p,k,w,h,v,E;u[2]?a?a.p(u,_):(a=Tl(u),a.c(),a.m(e,t)):a&&(a.d(1),a=null),u[3]?f?f.p(u,_):(f=Ol(u),f.c(),f.m(e,n)):f&&(f.d(1),f=null),(p=u[0])!=null&&p.text?c?c.p(u,_):(c=Il(u),c.c(),c.m(e,i)):c&&(c.d(1),c=null),_&1&&r!==(r=u[7]((k=u[0])==null?void 0:k.received_at)+"")&&_e(o,r),_&5&&X(s,"attachment_mode",u[2]&&!((w=u[0])!=null&&w.text)),_&1&&X(e,"chat_item_other",(h=u[0])==null?void 0:h.incoming),_&1&&X(e,"chat_item_self",!((v=u[0])!=null&&v.incoming)),_&1&&X(e,"has_text",(E=u[0])==null?void 0:E.text)},i:ae,o:ae,d(u){u&&N(e),a&&a.d(),f&&f.d(),c&&c.d(),l[14](null)}}}function Hs(l,e,t){let{app:n}=e,{bbox:i=null}=e,{message:s=null}=e,{render_Width:r=1}=e,{render_X:o=-r*2}=e,a=null,f=null,c=null,m=null,d=[],u=[],_=1;function p(L){var O;d=[],u=[],L&&(O=L.attachments)!=null&&O.length&&(d=L.attachments.filter(S=>S.file_type==="IM").map(S=>({url:S.url})),u=L.attachments.filter(S=>S.file_type==="DC").map(S=>({url:S.url})));const C=i.height*.7;i.width,t(4,_=C),t(2,c=d==null?void 0:d[0]),t(3,m=u==null?void 0:u[0])}function k(L){if(!L||!Array.isArray(L.attachments)){t(0,f=null);return}if(!f){t(0,f=L);return}if(f.text!==L.text||f.incoming!==L.incoming||f.received_at!==L.received_at||f.attachments.length!==L.attachments.length){t(0,f=L);return}if(!f.attachments.map((C,O)=>[C,L.attachments[O]]).every(([C,O])=>C.file_type===O.file_type&&C.url===O.url)){t(0,f=L);return}}const w=L=>C=>{L&&L.url&&At(L.url)},h=L=>C=>{L&&L.url&&n.events.emit("openOverlayImageView",L.url)},v=L=>{if(L===null)return"";const C=S=>String(S).padStart(2,"0"),O=new Date;return L=new Date(L),L.getYear()===O.getYear()&&L.getMonth()===O.getMonth()&&L.getDate()===O.getDate()?`${C(L.getHours())}:${C(L.getMinutes())}`:`${C(L.getDate())}.${C(L.getMonth())}.${L.getFullYear()} ${C(L.getHours())}:${C(L.getMinutes())}`},E=()=>dn(m.url);function M(L){Re[L?"unshift":"push"](()=>{a=L,t(1,a)})}return l.$$set=L=>{"app"in L&&t(8,n=L.app),"bbox"in L&&t(9,i=L.bbox),"message"in L&&t(10,s=L.message),"render_Width"in L&&t(11,r=L.render_Width),"render_X"in L&&t(12,o=L.render_X)},l.$$.update=()=>{l.$$.dirty&1024&&k(s),l.$$.dirty&1&&p(f)},[f,a,c,m,_,w,h,v,n,i,s,r,o,E,M]}class Rs extends ke{constructor(e){super(),ye(this,e,Hs,zs,me,{app:8,bbox:9,message:10,render_Width:11,render_X:12})}}function Bs(l){let e;return{c(){e=y("div"),e.innerHTML=`<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div> 
	<div class="svelte-j15bjw"></div>`,b(e,"class","lds-roller svelte-j15bjw")},m(t,n){z(t,e,n)},p:ae,i:ae,o:ae,d(t){t&&N(e)}}}class at extends ke{constructor(e){super(),ye(this,e,null,Bs,me,{})}}function Dl(l,e,t){const n=l.slice();return n[21]=e[t],n}function Cl(l){var E,M,L,C;let e,t,n,i,s,r,o,a,f=l[0].lead_GetStatusTitle((M=(E=l[6])==null?void 0:E.lead)==null?void 0:M.status)+"",c,m,d,u,_,p,k,w=l[2]&&El(l),h=((C=(L=l[6])==null?void 0:L.lead)==null?void 0:C.status)!=="DL"&&jl(l),v=l[3]&&Nl();return{c(){var O,S,T,P;e=y("div"),t=y("div"),n=y("div"),i=A(),s=y("img"),o=A(),a=y("div"),c=K(f),m=A(),w&&w.c(),d=A(),h&&h.c(),u=A(),v&&v.c(),b(n,"class","pos_abs w100 h100 deleteProgress svelte-7zcguq"),H(n,"width",l[1]+"%"),b(t,"class","pos_abs w100 h100 overhide bg svelte-7zcguq"),Xe(s.src,r="assets/icons/status1.png")||b(s,"src",r),b(s,"draggable","false"),b(s,"class","pos_abs statusIcon svelte-7zcguq"),b(a,"class","flex flex_cy nowrap pos_rel label svelte-7zcguq"),X(a,"leftBlock",((S=(O=l[6])==null?void 0:O.lead)==null?void 0:S.status)!=="DL"),b(e,"class","flex flex_cx flex_cy cursor_ptr unselect statusCnt pos_rel svelte-7zcguq"),X(e,"loading",l[3]||((P=(T=l[6])==null?void 0:T.lead)==null?void 0:P.status)==="DL")},m(O,S){z(O,e,S),g(e,t),g(t,n),g(e,i),g(e,s),g(e,o),g(e,a),g(a,c),g(a,m),w&&w.m(a,null),g(e,d),h&&h.m(e,null),g(e,u),v&&v.m(e,null),l[15](e),_=!0,p||(k=$(a,"click",l[8]),p=!0)},p(O,S){var T,P,G,F,V,le,te,J;(!_||S&2)&&H(n,"width",O[1]+"%"),(!_||S&65)&&f!==(f=O[0].lead_GetStatusTitle((P=(T=O[6])==null?void 0:T.lead)==null?void 0:P.status)+"")&&_e(c,f),O[2]?w?(w.p(O,S),S&4&&j(w,1)):(w=El(O),w.c(),j(w,1),w.m(a,null)):w&&(he(),R(w,1,1,()=>{w=null}),ve()),(!_||S&64)&&X(a,"leftBlock",((F=(G=O[6])==null?void 0:G.lead)==null?void 0:F.status)!=="DL"),((le=(V=O[6])==null?void 0:V.lead)==null?void 0:le.status)!=="DL"?h?h.p(O,S):(h=jl(O),h.c(),h.m(e,u)):h&&(h.d(1),h=null),O[3]?v?S&8&&j(v,1):(v=Nl(),v.c(),j(v,1),v.m(e,null)):v&&(he(),R(v,1,1,()=>{v=null}),ve()),(!_||S&72)&&X(e,"loading",O[3]||((J=(te=O[6])==null?void 0:te.lead)==null?void 0:J.status)==="DL")},i(O){_||(j(w),j(v),_=!0)},o(O){R(w),R(v),_=!1},d(O){O&&N(e),w&&w.d(),h&&h.d(),v&&v.d(),l[15](null),p=!1,k()}}}function El(l){var a,f;let e,t=[],n=new Map,i,s,r=l[0].lead_GetStatusList((f=(a=l[6])==null?void 0:a.lead)==null?void 0:f.status);const o=c=>c[21].id;for(let c=0;c<r.length;c+=1){let m=Dl(l,r,c),d=o(m);n.set(d,t[c]=Al(d,m))}return{c(){e=y("div");for(let c=0;c<t.length;c+=1)t[c].c();b(e,"class","flex flex_clm pos_abs overhide selectList svelte-7zcguq")},m(c,m){z(c,e,m);for(let d=0;d<t.length;d+=1)t[d].m(e,null);s=!0},p(c,m){var d,u;m&1089&&(r=c[0].lead_GetStatusList((u=(d=c[6])==null?void 0:d.lead)==null?void 0:u.status),t=xe(t,m,o,1,c,r,n,e,Rt,Al,null,Dl))},i(c){s||(c&&Ee(()=>{i||(i=Me(e,Qe,{},!0)),i.run(1)}),s=!0)},o(c){c&&(i||(i=Me(e,Qe,{},!1)),i.run(0)),s=!1},d(c){c&&N(e);for(let m=0;m<t.length;m+=1)t[m].d();c&&i&&i.end()}}}function Al(l,e){let t,n=e[21].title+"",i,s,r;return{key:l,first:null,c(){t=y("div"),i=K(n),b(t,"class","flex nowrap cursor_ptr w100 label selectItem svelte-7zcguq"),this.first=t},m(o,a){z(o,t,a),g(t,i),s||(r=$(t,"click",kn(yn(function(){ze(e[10](e[21].id))&&e[10](e[21].id).apply(this,arguments)}))),s=!0)},p(o,a){e=o,a&65&&n!==(n=e[21].title+"")&&_e(i,n)},d(o){o&&N(t),s=!1,r()}}}function jl(l){let e,t,n;return{c(){e=y("div"),e.textContent="Delete",b(e,"class","flex flex_cy nowrap pos_rel pad svelte-7zcguq")},m(i,s){z(i,e,s),t||(n=[$(e,"mousedown",function(){ze(l[11](l[6]))&&l[11](l[6]).apply(this,arguments)}),$(e,"mouseleave",l[12])],t=!0)},p(i,s){l=i},d(i){i&&N(e),t=!1,je(n)}}}function Nl(l){let e,t,n,i;return t=new at({}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_abs loadingInd svelte-7zcguq"),H(e,"transform","scale(0.23)"),H(e,"transform-origin","top"),H(e,"filter","invert(1)")},m(s,r){z(s,e,r),fe(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&N(e),ce(t),s&&n&&n.end()}}}function Fs(l){let e,t,n,i,s=l[6]&&l[6].lead&&Cl(l);return{c(){s&&s.c(),e=Ve()},m(r,o){s&&s.m(r,o),z(r,e,o),t=!0,n||(i=[$(window,"mouseup",l[12]),$(window,"mousedown",l[9]),$(window,"blur",l[9])],n=!0)},p(r,[o]){r[6]&&r[6].lead?s?(s.p(r,o),o&64&&j(s,1)):(s=Cl(r),s.c(),j(s,1),s.m(e.parentNode,e)):s&&(he(),R(s,1,1,()=>{s=null}),ve())},i(r){t||(j(s),t=!0)},o(r){R(s),t=!1},d(r){s&&s.d(r),r&&N(e),n=!1,je(i)}}}function Us(l,e,t){let n,i,s,r=ae,o=()=>(r(),r=Pt(M,T=>t(1,s=T)),M);l.$$.on_destroy.push(()=>r());let{app:a}=e;const{dialogMap_r:f,dialogMap_SetDialog:c}=a;Se(l,f,T=>t(14,i=T));let{dialog_id:m}=e,d=!1,u=!1;const _=()=>{var T;return!(!n||!n.lead||((T=n==null?void 0:n.lead)==null?void 0:T.status)==="DL"||u)};let p;const k=T=>{!_()||t(2,d=!d)},w=T=>{let P=T.target;for(;P;){if(P===p)return;P=P.parentNode}t(2,d=!1)},h=T=>async P=>{if(!!_()){if(t(2,d=!1),t(3,u=!0),n){const G=await a.api.lead_SetStatus(n.lead.tg_id,T);G&&n&&n.lead&&n.lead.tg_id===G.tg_id&&(t(6,n.lead=G,n),c(n))}t(3,u=!1)}};let v=null,E=Number.POSITIVE_INFINITY,M=qe(0,{duration:2e3});o();const L=T=>P=>{var G;t(2,d=!1),v=(G=T==null?void 0:T.lead)==null?void 0:G.tg_id,E=Date.now(),o(t(5,M=qe(s,{duration:2e3}))),Ge(M,s=100,s)},C=T=>{t(2,d=!1),v=null,E=Number.POSITIVE_INFINITY,o(t(5,M=qe(s,{duration:200}))),Ge(M,s=0,s)},O=async()=>{var T;!_()||(E+1200<Date.now()&&v===((T=n==null?void 0:n.lead)==null?void 0:T.tg_id)&&await h("DL")(),C())};function S(T){Re[T?"unshift":"push"](()=>{p=T,t(4,p)})}return l.$$set=T=>{"app"in T&&t(0,a=T.app),"dialog_id"in T&&t(13,m=T.dialog_id)},l.$$.update=()=>{l.$$.dirty&2&&s>=100&&O(),l.$$.dirty&24576&&t(6,n=i[m])},[a,s,d,u,p,M,n,f,k,w,h,L,C,m,i,S]}class Gs extends ke{constructor(e){super(),ye(this,e,Us,Fs,me,{app:0,dialog_id:13})}}function Pl(l,e,t){const n=l.slice();return n[20]=e[t],n}function zl(l,e,t){const n=l.slice();return n[20]=e[t],n}function Hl(l){var u,_;let e,t,n,i=[],s=new Map,r,o,a,f,c=(_=(u=l[0])==null?void 0:u.tag)!=null?_:[];const m=p=>p[20].id;for(let p=0;p<c.length;p+=1){let k=zl(l,c,p),w=m(k);s.set(w,i[p]=Bl(w,k))}let d=l[1]!==null&&l[0]&&l[1]===l[0].id&&l[3].length&&Fl(l);return{c(){e=y("div"),t=y("div"),t.innerHTML=`Add tag
			<div class="flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6">+</div>`,n=A();for(let p=0;p<i.length;p+=1)i[p].c();r=A(),d&&d.c(),b(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),X(t,"disabled",l[3].length===0),b(e,"class","flex tag_list unselect pos_rel svelte-elfos6")},m(p,k){z(p,e,k),g(e,t),g(e,n);for(let w=0;w<i.length;w+=1)i[w].m(e,null);g(e,r),d&&d.m(e,null),l[14](e),o=!0,a||(f=$(t,"click",l[13]),a=!0)},p(p,k){var w,h;(!o||k&8)&&X(t,"disabled",p[3].length===0),k&325&&(c=(h=(w=p[0])==null?void 0:w.tag)!=null?h:[],he(),i=xe(i,k,m,1,p,c,s,e,et,Bl,r,zl),ve()),p[1]!==null&&p[0]&&p[1]===p[0].id&&p[3].length?d?(d.p(p,k),k&11&&j(d,1)):(d=Fl(p),d.c(),j(d,1),d.m(e,null)):d&&(he(),R(d,1,1,()=>{d=null}),ve())},i(p){if(!o){for(let k=0;k<c.length;k+=1)j(i[k]);j(d),o=!0}},o(p){for(let k=0;k<i.length;k+=1)R(i[k]);R(d),o=!1},d(p){p&&N(e);for(let k=0;k<i.length;k+=1)i[k].d();d&&d.d(),l[14](null),a=!1,f()}}}function Rl(l){let e,t,n;return t=new at({}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){z(i,e,s),fe(t,e,null),n=!0},i(i){n||(j(t.$$.fragment,i),n=!0)},o(i){R(t.$$.fragment,i),n=!1},d(i){i&&N(e),ce(t)}}}function Bl(l,e){let t,n=e[20].title.toLowerCase()+"",i,s,r,o,a=e[2]===e[6](e[0].id,e[20]),f,c,m,d=a&&Rl();return{key:l,first:null,c(){t=y("div"),i=K(n),s=A(),r=y("div"),r.textContent="X",o=A(),d&&d.c(),b(r,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),b(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag svelte-elfos6"),H(t,"background",e[20].background_color),H(t,"color",e[20].color),X(t,"disabled",e[2]),this.first=t},m(u,_){z(u,t,_),g(t,i),g(t,s),g(t,r),g(t,o),d&&d.m(t,null),f=!0,c||(m=$(t,"click",function(){ze(e[8](e[20]))&&e[8](e[20]).apply(this,arguments)}),c=!0)},p(u,_){e=u,(!f||_&1)&&n!==(n=e[20].title.toLowerCase()+"")&&_e(i,n),_&5&&(a=e[2]===e[6](e[0].id,e[20])),a?d?_&5&&j(d,1):(d=Rl(),d.c(),j(d,1),d.m(t,null)):d&&(he(),R(d,1,1,()=>{d=null}),ve()),(!f||_&1)&&H(t,"background",e[20].background_color),(!f||_&1)&&H(t,"color",e[20].color),(!f||_&4)&&X(t,"disabled",e[2])},i(u){f||(j(d),f=!0)},o(u){R(d),f=!1},d(u){u&&N(t),d&&d.d(),c=!1,m()}}}function Fl(l){let e,t,n=[],i=new Map,s,r,o=l[3];const a=f=>f[20].title;for(let f=0;f<o.length;f+=1){let c=Pl(l,o,f),m=a(c);i.set(m,n[f]=Gl(m,c))}return{c(){e=y("div"),t=y("div");for(let f=0;f<n.length;f+=1)n[f].c();b(t,"class","flex tagAddList1 svelte-elfos6"),H(t,"flex-wrap","wrap"),b(e,"class","pos_abs tag_settings flex flex_clm svelte-elfos6")},m(f,c){z(f,e,c),g(e,t);for(let m=0;m<n.length;m+=1)n[m].m(t,null);r=!0},p(f,c){c&205&&(o=f[3],he(),n=xe(n,c,a,1,f,o,i,t,et,Gl,null,Pl),ve())},i(f){if(!r){for(let c=0;c<o.length;c+=1)j(n[c]);f&&Ee(()=>{s||(s=Me(e,Qe,{},!0)),s.run(1)}),r=!0}},o(f){for(let c=0;c<n.length;c+=1)R(n[c]);f&&(s||(s=Me(e,Qe,{},!1)),s.run(0)),r=!1},d(f){f&&N(e);for(let c=0;c<n.length;c+=1)n[c].d();f&&s&&s.end()}}}function Ul(l){let e,t,n;return t=new at({}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_abs tag_loading svelte-elfos6")},m(i,s){z(i,e,s),fe(t,e,null),n=!0},i(i){n||(j(t.$$.fragment,i),n=!0)},o(i){R(t.$$.fragment,i),n=!1},d(i){i&&N(e),ce(t)}}}function Gl(l,e){let t,n=e[20].title+"",i,s,r,o=e[2]===e[6](e[0].id,e[20]),a,f,c,m,d=o&&Ul();return{key:l,first:null,c(){t=y("div"),i=K(n),s=y("div"),s.textContent="+",r=A(),d&&d.c(),a=A(),b(s,"class","flex flex_cx flex_cy h100 pos_abs tag_delete_btn svelte-elfos6"),b(t,"class","flex flex_cx flex_cy overhide cursor_ptr pos_rel tag_add tag svelte-elfos6"),H(t,"background",e[20].background_color),H(t,"color",e[20].color),X(t,"disabled",e[2]),this.first=t},m(u,_){z(u,t,_),g(t,i),g(t,s),g(t,r),d&&d.m(t,null),g(t,a),f=!0,c||(m=$(t,"click",function(){ze(e[7](e[20]))&&e[7](e[20]).apply(this,arguments)}),c=!0)},p(u,_){e=u,(!f||_&8)&&n!==(n=e[20].title+"")&&_e(i,n),_&13&&(o=e[2]===e[6](e[0].id,e[20])),o?d?_&13&&j(d,1):(d=Ul(),d.c(),j(d,1),d.m(t,a)):d&&(he(),R(d,1,1,()=>{d=null}),ve()),(!f||_&8)&&H(t,"background",e[20].background_color),(!f||_&8)&&H(t,"color",e[20].color),(!f||_&4)&&X(t,"disabled",e[2])},i(u){f||(j(d),f=!0)},o(u){R(d),f=!1},d(u){u&&N(t),d&&d.d(),c=!1,m()}}}function qs(l){let e,t,n,i,s=l[0]&&Hl(l);return{c(){s&&s.c(),e=Ve()},m(r,o){s&&s.m(r,o),z(r,e,o),t=!0,n||(i=[$(window,"mousedown",l[9]),$(window,"blur",l[9])],n=!0)},p(r,[o]){r[0]?s?(s.p(r,o),o&1&&j(s,1)):(s=Hl(r),s.c(),j(s,1),s.m(e.parentNode,e)):s&&(he(),R(s,1,1,()=>{s=null}),ve())},i(r){t||(j(s),t=!0)},o(r){R(s),t=!1},d(r){s&&s.d(r),r&&N(e),n=!1,je(i)}}}function xs(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r,dialogMap_SetDialog:o}=s;Se(l,r,M=>t(12,i=M));let{dialog_id:a=null}=e,f=null,c=!1;const m=async(M,L)=>{const C=await s.api.dialog_SetTags(n.id,L);return C&&o(C),C},d=(M,L)=>{var C;return`${M}|${(C=L==null?void 0:L.title)!=null?C:"*"}`},u=M=>async L=>{if(!n||c)return;t(2,c=d(n.id,M));const C={color:"#fff",background_color:"#f00",...M,title:M.title.toLowerCase().trim()};await m(n.id,[...n.tag,C]),t(2,c=!1)},_=M=>async L=>{if(!n||c)return;t(2,c=d(n.id,M));const C=n.tag.filter(O=>O.id!==M.id).map(O=>({title:O.title,color:O.color,background_color:O.background_color}));await m(n.id,C),t(2,c=!1)};let p=[];function k(){var L;if(!n)return;const M=new Set(((L=n==null?void 0:n.tag)!=null?L:[]).map(C=>C.title));t(3,p=g_Config.pinnedTags.filter(C=>!M.has(C.title)))}let w;const h=M=>{let L=M.target;for(;L;){if(L===w)return;L=L.parentNode}t(1,f=null)},v=()=>t(1,f=n.id);function E(M){Re[M?"unshift":"push"](()=>{w=M,t(4,w)})}return l.$$set=M=>{"app"in M&&t(10,s=M.app),"dialog_id"in M&&t(11,a=M.dialog_id)},l.$$.update=()=>{l.$$.dirty&6144&&t(0,n=i[a]),l.$$.dirty&1&&k()},[n,f,c,p,w,r,d,u,_,h,s,a,i,v,E]}class Ys extends ke{constructor(e){super(),ye(this,e,xs,qs,me,{app:10,dialog_id:11})}}function ql(l){var F,V,le,te,J,se,we,Y,ue,be;let e,t,n,i,s=((le=(V=(F=l[2])==null?void 0:F.lead)==null?void 0:V.first_name)!=null?le:"")+"",r,o,a,f,c,m=((se=(J=(te=l[2])==null?void 0:te.lead)==null?void 0:J.last_name)!=null?se:"")+"",d,u,_,p,k,w,h,v,E,M,L,C,O,S,T,P=((Y=(we=l[2])==null?void 0:we.lead)==null?void 0:Y.username)&&xl(l),G=((be=(ue=l[2])==null?void 0:ue.lead)==null?void 0:be.ref_link)&&Yl(l);return v=new Gs({props:{app:l[0],dialog_id:l[2].id}}),C=new Ys({props:{app:l[0],dialog_id:l[2].id}}),{c(){e=y("div"),t=y("div"),n=A(),i=y("div"),r=K(s),o=A(),a=y("div"),f=A(),c=y("div"),d=K(m),u=K("\xA0"),_=A(),p=y("div"),P&&P.c(),k=A(),G&&G.c(),w=A(),h=y("div"),ge(v.$$.fragment),E=A(),M=y("div"),L=A(),ge(C.$$.fragment),O=A(),S=y("div"),H(t,"width","8px"),H(a,"width","8px"),b(e,"class","flex nowrap textOverEllipsis userFirstLastName pos_rel svelte-qywc37"),b(p,"class","nowrap textOverEllipsis username svelte-qywc37"),H(M,"width","4px"),b(h,"class","flex"),H(S,"height","4px")},m(x,Z){z(x,e,Z),g(e,t),g(e,n),g(e,i),g(i,r),g(e,o),g(e,a),g(e,f),g(e,c),g(c,d),g(c,u),z(x,_,Z),z(x,p,Z),P&&P.m(p,null),z(x,k,Z),G&&G.m(x,Z),z(x,w,Z),z(x,h,Z),fe(v,h,null),g(h,E),g(h,M),g(h,L),fe(C,h,null),z(x,O,Z),z(x,S,Z),T=!0},p(x,Z){var Le,Ne,Ie,pe,I,D,B,U,W,q;(!T||Z&4)&&s!==(s=((Ie=(Ne=(Le=x[2])==null?void 0:Le.lead)==null?void 0:Ne.first_name)!=null?Ie:"")+"")&&_e(r,s),(!T||Z&4)&&m!==(m=((D=(I=(pe=x[2])==null?void 0:pe.lead)==null?void 0:I.last_name)!=null?D:"")+"")&&_e(d,m),(U=(B=x[2])==null?void 0:B.lead)!=null&&U.username?P?P.p(x,Z):(P=xl(x),P.c(),P.m(p,null)):P&&(P.d(1),P=null),(q=(W=x[2])==null?void 0:W.lead)!=null&&q.ref_link?G?G.p(x,Z):(G=Yl(x),G.c(),G.m(w.parentNode,w)):G&&(G.d(1),G=null);const ne={};Z&1&&(ne.app=x[0]),Z&4&&(ne.dialog_id=x[2].id),v.$set(ne);const re={};Z&1&&(re.app=x[0]),Z&4&&(re.dialog_id=x[2].id),C.$set(re)},i(x){T||(j(v.$$.fragment,x),j(C.$$.fragment,x),T=!0)},o(x){R(v.$$.fragment,x),R(C.$$.fragment,x),T=!1},d(x){x&&N(e),x&&N(_),x&&N(p),P&&P.d(),x&&N(k),G&&G.d(x),x&&N(w),x&&N(h),ce(v),ce(C),x&&N(O),x&&N(S)}}}function xl(l){let e,t=l[2].lead.username+"",n;return{c(){e=K("@"),n=K(t)},m(i,s){z(i,e,s),z(i,n,s)},p(i,s){s&4&&t!==(t=i[2].lead.username+"")&&_e(n,t)},d(i){i&&N(e),i&&N(n)}}}function Yl(l){var m,d;let e,t,n,i,s=((d=(m=l[2])==null?void 0:m.lead)==null?void 0:d.ref_link)+"",r,o,a,f,c;return{c(){e=y("div"),t=y("div"),t.innerHTML=`Ref link
						<img src="assets/icons/copy-clipboard.png" class="refLinkIcon svelte-qywc37" style="width: 14px; height: 14px; filter: invert(1);"/>`,n=A(),i=y("div"),r=K(s),o=A(),a=y("div"),b(t,"class","flex flex_cy h100 refLinkLabel svelte-qywc37"),b(i,"class","flex flex_cy h100 overhide textOverEllipsis nowrap refLinkContent svelte-qywc37"),b(e,"class","flex flex_cy nowrap refLink overhide textOverEllipsis cursor_ptr unselect svelte-qywc37"),H(a,"height","4px")},m(u,_){z(u,e,_),g(e,t),g(e,n),g(e,i),g(i,r),z(u,o,_),z(u,a,_),f||(c=$(e,"click",l[6]),f=!0)},p(u,_){var p,k;_&4&&s!==(s=((k=(p=u[2])==null?void 0:p.lead)==null?void 0:k.ref_link)+"")&&_e(r,s)},d(u){u&&N(e),u&&N(o),u&&N(a),f=!1,c()}}}function Wl(l){let e,t,n,i;return t=new at({}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_abs loading svelte-qywc37")},m(s,r){z(s,e,r),fe(t,e,null),i=!0},i(s){i||(j(t.$$.fragment,s),s&&Ee(()=>{n||(n=Me(e,Ce,{},!0)),n.run(1)}),i=!0)},o(s){R(t.$$.fragment,s),s&&(n||(n=Me(e,Ce,{},!1)),n.run(0)),i=!1},d(s){s&&N(e),ce(t),s&&n&&n.end()}}}function Ws(l){let e,t,n,i,s=l[2]&&ql(l),r=l[1]&&Wl();return{c(){e=y("div"),t=y("div"),s&&s.c(),n=A(),r&&r.c(),b(t,"class","flex flex_clm flex_cx flex_grow_1"),b(e,"class","flex flex_cy header pos_rel svelte-qywc37")},m(o,a){z(o,e,a),g(e,t),s&&s.m(t,null),g(e,n),r&&r.m(e,null),i=!0},p(o,[a]){o[2]?s?(s.p(o,a),a&4&&j(s,1)):(s=ql(o),s.c(),j(s,1),s.m(t,null)):s&&(he(),R(s,1,1,()=>{s=null}),ve()),o[1]?r?a&2&&j(r,1):(r=Wl(),r.c(),j(r,1),r.m(e,null)):r&&(he(),R(r,1,1,()=>{r=null}),ve())},i(o){i||(j(s),j(r),i=!0)},o(o){R(s),R(r),i=!1},d(o){o&&N(e),s&&s.d(),r&&r.d()}}}function Vs(l,e,t){let n,i,{app:s}=e;const{dialogMap_r:r}=s;Se(l,r,c=>t(5,i=c));let{dialog_id:o=null}=e,{loading:a=!1}=e;const f=()=>{var c;return Un((c=n==null?void 0:n.lead)==null?void 0:c.ref_link)};return l.$$set=c=>{"app"in c&&t(0,s=c.app),"dialog_id"in c&&t(4,o=c.dialog_id),"loading"in c&&t(1,a=c.loading)},l.$$.update=()=>{l.$$.dirty&48&&t(2,n=i[o])},[s,a,n,r,o,i,f]}class Js extends ke{constructor(e){super(),ye(this,e,Vs,Ws,me,{app:0,dialog_id:4,loading:1})}}function Vl(l,e,t){const n=l.slice();return n[36]=e[t],n}function Jl(l,e){let t,n,i;return n=new Rs({props:{app:e[0],bbox:e[9],message:e[36],render_Width:e[8]}}),{key:l,first:null,c(){t=Ve(),ge(n.$$.fragment),this.first=t},m(s,r){z(s,t,r),fe(n,s,r),i=!0},p(s,r){e=s;const o={};r[0]&1&&(o.app=e[0]),r[0]&512&&(o.bbox=e[9]),r[0]&4&&(o.message=e[36]),r[0]&256&&(o.render_Width=e[8]),n.$set(o)},i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){R(n.$$.fragment,s),i=!1},d(s){s&&N(t),ce(n,s)}}}function Xs(l){let e,t,n,i,s,r,o,a=[],f=new Map,c,m,d,u,_,p,k,w,h,v;t=new Js({props:{app:l[0],dialog_id:l[1],loading:l[3]}});let E=l[2];const M=O=>O[36].index;for(let O=0;O<E.length;O+=1){let S=Vl(l,E,O),T=M(S);f.set(T,a[O]=Jl(T,S))}function L(O){l[17](O)}let C={value_in:l[4]};return l[5]!==void 0&&(C.value_out=l[5]),d=new mn({props:C}),Re.push(()=>yt(d,"value_out",L)),{c(){e=y("div"),ge(t.$$.fragment),n=A(),i=y("div"),s=y("div"),r=y("div"),o=y("div");for(let O=0;O<a.length;O+=1)a[O].c();c=A(),m=y("div"),ge(d.$$.fragment),_=A(),p=y("div"),k=y("textarea"),b(o,"class","pos_rel w100 h100"),b(m,"class","pos_abs h100 chatScroll svelte-1khz9us"),b(r,"class","pos_rel w100 h100"),b(s,"class","flex pos_abs overhide"),b(i,"class","flex flex_grow_1 pos_rel overhide"),b(k,"class","flex flex_grow_1 chat_input_textarea svelte-1khz9us"),b(p,"class","flex chat_input svelte-1khz9us"),b(e,"class","flex flex_clm flex_grow_1 overhide cnt svelte-1khz9us")},m(O,S){z(O,e,S),fe(t,e,null),g(e,n),g(e,i),g(i,s),g(s,r),g(r,o);for(let T=0;T<a.length;T+=1)a[T].m(o,null);l[16](o),g(r,c),g(r,m),fe(d,m,null),g(e,_),g(e,p),g(p,k),$t(k,l[7]),w=!0,h||(v=[$(r,"wheel",l[13],{passive:!0}),$e(ot.call(null,s,l[11])),$(k,"input",l[18]),$(k,"keyup",l[12]),$(k,"keydown",l[12])],h=!0)},p(O,S){const T={};S[0]&1&&(T.app=O[0]),S[0]&2&&(T.dialog_id=O[1]),S[0]&8&&(T.loading=O[3]),t.$set(T),S[0]&773&&(E=O[2],he(),a=xe(a,S,M,1,O,E,f,o,et,Jl,null,Vl),ve());const P={};S[0]&16&&(P.value_in=O[4]),!u&&S[0]&32&&(u=!0,P.value_out=O[5],bt(()=>u=!1)),d.$set(P),S[0]&128&&$t(k,O[7])},i(O){if(!w){j(t.$$.fragment,O);for(let S=0;S<E.length;S+=1)j(a[S]);j(d.$$.fragment,O),w=!0}},o(O){R(t.$$.fragment,O);for(let S=0;S<a.length;S+=1)R(a[S]);R(d.$$.fragment,O),w=!1},d(O){O&&N(e),ce(t);for(let S=0;S<a.length;S+=1)a[S].d();l[16](null),ce(d),h=!1,je(v)}}}const Xl=10,pt=4;function Ks(l,e,t){let n,i,s,{app:r}=e;const{dialogMap_r:o}=r;Se(l,o,Y=>t(15,i=Y));let{dialog_id:a=null}=e,f=[],c=[],m=new Set,d=0,u=0,_=1,p=1,k=null;const w=Fe(null);Se(l,w,Y=>t(9,s=Y)),new Date().toJSON();let h=-1;async function v(Y,ue=0,be=20){const x=await r.api.message_GetList({dialog_id:Y,offset:ue,limit:be});if(!!x&&n&&n.id===Y){for(d=x.count;f.length<d;){const ne=f.length;f.push({id:h--,index:ne,_isFakeMsg:!0})}const Z=x.results.map(ne=>{var re;return(re=ne==null?void 0:ne.attachments)!=null&&re.length&&ne.attachments.map(Le=>{var Ne,Ie,pe,I,D,B,U,W;if((Ie=(Ne=r==null?void 0:r.appConfig)==null?void 0:Ne.api)!=null&&Ie.attachments_OverwriteApiHostProtocol)try{const q=new URL(Le.url);q.protocol=(D=(I=(pe=r==null?void 0:r.appConfig)==null?void 0:pe.api)==null?void 0:I.protocol)!=null?D:location.protocol,q.host=(W=(U=(B=r==null?void 0:r.appConfig)==null?void 0:B.api)==null?void 0:U.host)!=null?W:location.host,Le.url=String(q)}catch{}}),ne});Z.map((ne,re)=>ne.index=ue+re),Z.map(ne=>f[ne.index]=ne)}}let E="";const M=async Y=>{if(Y.which===13&&!Y.shiftKey&&!Y.ctrlKey&&(Y.preventDefault(),t(7,E=E.trim()),E)){const ue=E;t(7,E=""),n&&await r.api.message_Create(n.id,ue)}};function L(){f=[],t(2,c=[]),m=new Set,d=0,console.log("clear all")}let C=null,O=null;async function S(Y){if(!Y){if(!C)return;C=null,L();return}O!==Y.id&&(C=Y,O=Y.id,L(),f=[],t(2,c=[]),d=0,t(3,u++,u),await v(Y.id),d&&await v(Y.id,Math.max(d-20,0),20),await r.api.dialog_SetReadFlagAllMessages(Y.id),t(3,u--,u))}let T=1,P=!0;function G(){if(P&&requestAnimationFrame(G),!s||!k||!f.length)return;s.width;const Y=s.height,ue=s.width-Xl*2,be=Xl;t(8,T=ue-Math.max(120,Math.floor(ue*.1)));const x=1+p*(f.length-1);let Z=Math.floor(x),ne=x-Z;Z>=f.length&&(Z=f.length-1,ne=1);const re=[],Le=[];let Ne=null;t(2,c=[]);for(let pe=Z-100,I=0,D=!0;pe<Z+100;pe++)pe<0||pe>=f.length||(f[pe]._isFakeMsg&&m.add(pe),c[I]!==f[pe]&&(D&&(D=!1,c.splice(I,1e9)),t(2,c[I]=f[pe],c),t(2,c)),t(2,c[I]._drawIndex=I,c),pe<Z&&re.push(c[I]),pe>Z&&Le.push(c[I]),pe===Z&&(Ne=c[I]),I++);const Ie=[...k.children];if(Ie.length===c.length){Ie.map((U,W)=>{const q=c[W];if(!q||U._remove)return;const ie=U.getBoundingClientRect();U._bbox=ie;const oe=Math.floor(be+(q.incoming?0:Math.max(100,s.width*.05)));U.__cacheWidth!==T&&(U.__cacheWidth=T,U.style.maxWidth=T+"px"),U.__cacheLeft!==oe&&(U.__cacheLeft=oe,U.style.left=oe+"px")});const pe=(U,W,q=1)=>(U.__cacheTop!==W&&(U.__cacheTop=W,U.style.transform=`translate3d(0px, ${W}px, 0px)`),W+(U._bbox.height+pt)*q);let I=0,D=0;const B=Ie[Ne._drawIndex];if(B){const U=B;I=Y+pt-(U._bbox.height+pt)*ne,D=I,I=pe(U,I,1)}Le.map((U,W)=>{const q=Ie[U._drawIndex];I=pe(q,I,1)}),I=D,re.reverse().map((U,W)=>{const q=Ie[U._drawIndex];I-=q._bbox.height+pt,pe(q,I,0)})}}requestAnimationFrame(G),Be(()=>P=!1);async function F(){if(m.size){const Y=[...m].sort((x,Z)=>x-Z);m.clear();const ue=[];let be={offset:null,limit:0};for(const x of Y){if(be.offset!==null){if(be.limit<=500&&be.offset+be.limit===x){be.limit++;continue}ue.push(be)}be={offset:x,limit:1}}be.offset!==null&&ue.push(be),n&&(t(3,u++,u),await Promise.all(ue.map(x=>v(n.id,x.offset,x.limit))),t(3,u--,u))}P&&setTimeout(F,500)}F();async function V(){n&&await r.api.dialog_SetReadFlagAllMessages(n.id),P&&setTimeout(V,5e3)}V();async function le(){n&&await v(n.id,d,20),P&&setTimeout(le,500)}le();const te=Y=>{t(4,_=f.length?p+Math.sign(Y.deltaY)/(f.length-1):0)};function J(Y){Re[Y?"unshift":"push"](()=>{k=Y,t(6,k)})}function se(Y){p=Y,t(5,p)}function we(){E=this.value,t(7,E)}return l.$$set=Y=>{"app"in Y&&t(0,r=Y.app),"dialog_id"in Y&&t(1,a=Y.dialog_id)},l.$$.update=()=>{l.$$.dirty[0]&32770&&t(14,n=i[a]),l.$$.dirty[0]&16384&&S(n)},[r,a,c,u,_,p,k,E,T,s,o,w,M,te,n,i,J,se,we]}class Zs extends ke{constructor(e){super(),ye(this,e,Ks,Xs,me,{app:0,dialog_id:1},null,[-1,-1])}}function Qs(l){let e,t,n,i,s,r,o,a,f,c,m,d,u,_,p,k,w,h,v,E,M;function L(T){l[5](T)}let C={};l[2]!==void 0&&(C.checked=l[2]),c=new Ls({props:C}),Re.push(()=>yt(c,"checked",L));function O(T){l[6](T)}let S={app:l[0]};return l[1]!==void 0&&(S.filterTag=l[1]),u=new Ps({props:S}),Re.push(()=>yt(u,"filterTag",O)),h=new As({props:{app:l[0],filter:{filterTag:l[1],filterUnreadFirst:l[2]}}}),E=new Zs({props:{app:l[0],dialog_id:l[3]}}),{c(){e=y("div"),t=y("div"),n=y("div"),i=A(),s=y("div"),r=y("label"),o=K(`First unread \r
				`),a=y("div"),f=A(),ge(c.$$.fragment),d=A(),ge(u.$$.fragment),p=A(),k=y("div"),w=A(),ge(h.$$.fragment),v=A(),ge(E.$$.fragment),H(n,"height","2px"),H(a,"width","4px"),b(r,"class","flex flex_cy cursor_ptr unselect firstUnread svelte-14xikx8"),b(s,"class","flex flex_clm flex_cx header pos_rel svelte-14xikx8"),H(k,"height","20px"),b(t,"class","flex flex_clm list svelte-14xikx8"),b(e,"class","flex flex_grow_1")},m(T,P){z(T,e,P),g(e,t),g(t,n),g(t,i),g(t,s),g(s,r),g(r,o),g(r,a),g(r,f),fe(c,r,null),g(s,d),fe(u,s,null),g(t,p),g(t,k),g(t,w),fe(h,t,null),g(e,v),fe(E,e,null),M=!0},p(T,[P]){const G={};!m&&P&4&&(m=!0,G.checked=T[2],bt(()=>m=!1)),c.$set(G);const F={};P&1&&(F.app=T[0]),!_&&P&2&&(_=!0,F.filterTag=T[1],bt(()=>_=!1)),u.$set(F);const V={};P&1&&(V.app=T[0]),P&6&&(V.filter={filterTag:T[1],filterUnreadFirst:T[2]}),h.$set(V);const le={};P&1&&(le.app=T[0]),P&8&&(le.dialog_id=T[3]),E.$set(le)},i(T){M||(j(c.$$.fragment,T),j(u.$$.fragment,T),j(h.$$.fragment,T),j(E.$$.fragment,T),M=!0)},o(T){R(c.$$.fragment,T),R(u.$$.fragment,T),R(h.$$.fragment,T),R(E.$$.fragment,T),M=!1},d(T){T&&N(e),ce(c),ce(u),ce(h),ce(E)}}}function $s(l,e,t){let n,{app:i}=e;const{dialogActiveID_r:s}=i;Se(l,s,c=>t(3,n=c));let r=null,o=1;function a(c){o=c,t(2,o)}function f(c){r=c,t(1,r)}return l.$$set=c=>{"app"in c&&t(0,i=c.app)},[i,r,o,n,s,a,f]}class ei extends ke{constructor(e){super(),ye(this,e,$s,Qs,me,{app:0})}}function ti(l){let e,t,n,i,s,r,o,a,f,c,m,d,u,_,p,k;return{c(){e=y("div"),t=y("div"),n=y("div"),i=y("img"),r=A(),o=y("div"),a=y("div"),a.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/rotate.png"/>',f=A(),c=y("div"),c.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/download.png"/>',m=A(),d=y("div"),d.innerHTML='<img class="w100 h100 svelte-d45see" draggable="false" src="assets/icons/close.png"/>',b(i,"class","img svelte-d45see"),b(i,"draggable","false"),Xe(i.src,s=l[0])||b(i,"src",s),H(i,"transform","rotate("+l[3]+"deg)"),b(n,"class","pos_abs flex flex_cx flex_cy pad svelte-d45see"),H(n,"width",l[5]+"px"),H(n,"height",l[4]+"px"),b(t,"class","pos_abs flex flex_cx flex_cy pos_abs w100 h100 "),H(t,"transform","translate("+l[1]+"px, "+l[2]+"px)"),b(a,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),b(c,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),b(d,"class","flex cursor_ptr imgCtrlBtn svelte-d45see"),b(o,"class","flex pos_abs imgCtrlBtnGroup svelte-d45see"),b(e,"class","pos_abs w100 h100 unselect cnt layer_bg svelte-d45see")},m(w,h){z(w,e,h),g(e,t),g(t,n),g(n,i),g(e,r),g(e,o),g(o,a),g(o,f),g(o,c),g(o,m),g(o,d),_=!0,p||(k=[$(window,"mousemove",l[14]),$(window,"mouseup",l[13]),$(window,"blur",l[13]),$(window,"keydown",l[16]),$(i,"mousedown",l[12]),$e(ot.call(null,t,l[6])),$(a,"click",l[10]),$(c,"click",function(){ze(At(l[0]))&&At(l[0]).apply(this,arguments)}),$(d,"click",l[15]),$(e,"wheel",l[11])],p=!0)},p(w,[h]){l=w,(!_||h&1&&!Xe(i.src,s=l[0]))&&b(i,"src",s),(!_||h&8)&&H(i,"transform","rotate("+l[3]+"deg)"),(!_||h&32)&&H(n,"width",l[5]+"px"),(!_||h&16)&&H(n,"height",l[4]+"px"),(!_||h&6)&&H(t,"transform","translate("+l[1]+"px, "+l[2]+"px)")},i(w){_||(Ee(()=>{u||(u=Me(e,Ce,{duration:100},!0)),u.run(1)}),_=!0)},o(w){u||(u=Me(e,Ce,{duration:100},!1)),u.run(0),_=!1},d(w){w&&N(e),w&&u&&u.end(),p=!1,je(k)}}}function li(l,e,t){let n,i,s,r,{url:o=null}=e;const a=In(),f=Fe(null);Se(l,f,S=>t(18,n=S));const c=qe(0);Se(l,c,S=>t(3,i=S));const m=qe(0);Se(l,m,S=>t(5,r=S));const d=qe(0);Se(l,d,S=>t(4,s=S));let u=0,_=0,p={rotate:0,scale:1,whInverse:!1};const k=()=>{if(!n||!p)return;const S=p.whInverse?n.height:n.width,T=p.whInverse?n.width:n.height;Ge(m,r=S*p.scale,r),Ge(d,s=T*p.scale,s),Ge(c,i=p.rotate,i)},w=()=>{!n||!p||(t(17,p.rotate+=90,p),t(17,p.whInverse=!p.whInverse,p),t(17,p))},h=S=>{t(17,p.scale=He(.1,p.scale+Math.sign(S.deltaY)*.1,10),p)};let v=null;const E=S=>v=[S.clientX,S.clientY,u,_],M=S=>v=null,L=S=>{!v||t(1,[u,_]=[S.clientX,S.clientY].map((T,P)=>T-v[P]+v[P+2]),u,t(2,_))},C=S=>a("close"),O=S=>S.which===27&&C();return l.$$set=S=>{"url"in S&&t(0,o=S.url)},l.$$.update=()=>{l.$$.dirty&393216&&k()},[o,u,_,i,s,r,f,c,m,d,w,h,E,M,L,C,O,p,n]}class ni extends ke{constructor(e){super(),ye(this,e,li,ti,me,{url:0})}}function Kl(l){let e=l[0],t,n,i=Zl(l);return{c(){i.c(),t=Ve()},m(s,r){i.m(s,r),z(s,t,r),n=!0},p(s,r){r&1&&me(e,e=s[0])?(he(),R(i,1,1,ae),ve(),i=Zl(s),i.c(),j(i,1),i.m(t.parentNode,t)):i.p(s,r)},i(s){n||(j(i),n=!0)},o(s){R(i),n=!1},d(s){s&&N(t),i.d(s)}}}function Zl(l){let e,t;return e=new ni({props:{url:l[1]}}),e.$on("close",l[3]),{c(){ge(e.$$.fragment)},m(n,i){fe(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.url=n[1]),e.$set(s)},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){R(e.$$.fragment,n),t=!1},d(n){ce(e,n)}}}function si(l){let e,t,n=l[1]&&Kl(l);return{c(){n&&n.c(),e=Ve()},m(i,s){n&&n.m(i,s),z(i,e,s),t=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&j(n,1)):(n=Kl(i),n.c(),j(n,1),n.m(e.parentNode,e)):n&&(he(),R(n,1,1,()=>{n=null}),ve())},i(i){t||(j(n),t=!0)},o(i){R(n),t=!1},d(i){n&&n.d(i),i&&N(e)}}}function ii(l,e,t){let n=1,i=null,{events:s}=e;Be(s.on("openOverlayImageView",o=>{t(0,n++,n),t(1,i=o)}));const r=()=>t(1,i=null);return l.$$set=o=>{"events"in o&&t(2,s=o.events)},[n,i,s,r]}class ri extends ke{constructor(e){super(),ye(this,e,ii,si,me,{events:2})}}function oi(l){let e,t,n,i,s,r,o,a,f,c,m,d=ai;return i=new ds({props:{app:l[0]}}),r=new bs({props:{app:l[0]}}),a=new ei({props:{app:l[0]}}),c=new ri({props:{events:l[0].events}}),{c(){e=y("div"),t=A(),n=y("div"),ge(i.$$.fragment),s=A(),ge(r.$$.fragment),o=A(),ge(a.$$.fragment),f=A(),ge(c.$$.fragment),b(n,"class","flex flex_clm flex_grow_1 leftBlock svelte-ufyhtq"),b(e,"class","flex w100 h100 pos_rel")},m(u,_){z(u,e,_),g(e,t),g(e,n),fe(i,n,null),g(n,s),fe(r,n,null),g(e,o),fe(a,e,null),g(e,f),fe(c,e,null),m=!0},p(u,[_]){},i(u){m||(j(d),j(i.$$.fragment,u),j(r.$$.fragment,u),j(a.$$.fragment,u),j(c.$$.fragment,u),m=!0)},o(u){R(d),R(i.$$.fragment,u),R(r.$$.fragment,u),R(a.$$.fragment,u),R(c.$$.fragment,u),m=!1},d(u){u&&N(e),ce(i),ce(r),ce(a),ce(c)}}}const ai=!1;function fi(l,e,t){let{operatorSelf:n}=e,{config:i}=e,{notifyEvents:s}=e,{createApi:r}=e;const o=r(n.username),a=Yn(n,i,o);return Be(a.destroy),l.$$set=f=>{"operatorSelf"in f&&t(1,n=f.operatorSelf),"config"in f&&t(2,i=f.config),"notifyEvents"in f&&t(3,s=f.notifyEvents),"createApi"in f&&t(4,r=f.createApi)},[a,n,i,s,r]}class ci extends ke{constructor(e){super(),ye(this,e,fi,oi,me,{operatorSelf:1,config:2,notifyEvents:3,createApi:4})}}function Ql(l,e,t){const n=l.slice();return n[6]=e[t],n}function ui(l){let e,t,n=l[0],i=[];for(let r=0;r<n.length;r+=1)i[r]=en(Ql(l,n,r));const s=r=>R(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=Ve()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);z(r,e,o),t=!0},p(r,o){if(o&5){n=r[0];let a;for(a=0;a<n.length;a+=1){const f=Ql(r,n,a);i[a]?(i[a].p(f,o),j(i[a],1)):(i[a]=en(f),i[a].c(),j(i[a],1),i[a].m(e.parentNode,e))}for(he(),a=n.length;a<i.length;a+=1)s(a);ve()}},i(r){if(!t){for(let o=0;o<n.length;o+=1)j(i[o]);t=!0}},o(r){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)R(i[o]);t=!1},d(r){Ht(i,r),r&&N(e)}}}function di(l){let e,t,n,i,s;return i=new at({}),{c(){e=y("div"),t=y("div"),n=A(),ge(i.$$.fragment),H(t,"height","20px"),b(e,"class","flex flex_clm flex_grow_1 flex_cy")},m(r,o){z(r,e,o),g(e,t),g(e,n),fe(i,e,null),s=!0},p:ae,i(r){s||(j(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&N(e),ce(i)}}}function $l(l){let e,t,n=l[6].username+"",i;return{c(){e=y("div"),t=K("@"),i=K(n),b(e,"class","nowrap textOverEllipsis")},m(s,r){z(s,e,r),g(e,t),g(e,i)},p(s,r){r&1&&n!==(n=s[6].username+"")&&_e(i,n)},d(s){s&&N(e)}}}function en(l){var v,E;let e,t,n,i=((v=l[6].first_name)!=null?v:"")+"",s,r,o,a,f,c=((E=l[6].last_name)!=null?E:"")+"",m,d,u,_,p,k,w,h=l[6].username&&$l(l);return{c(){e=y("div"),t=y("div"),n=y("div"),s=K(i),r=A(),o=y("div"),a=A(),f=y("div"),m=K(c),d=A(),h&&h.c(),u=A(),H(o,"width","8px"),b(t,"class","flex nowrap textOverEllipsis"),b(e,"class","flex flex_clm cursor_ptr item unselect svelte-1n771m2")},m(M,L){z(M,e,L),g(e,t),g(t,n),g(n,s),g(t,r),g(t,o),g(t,a),g(t,f),g(f,m),g(e,d),h&&h.m(e,null),g(e,u),p=!0,k||(w=$(e,"click",function(){ze(l[2](l[6]))&&l[2](l[6]).apply(this,arguments)}),k=!0)},p(M,L){var C,O;l=M,(!p||L&1)&&i!==(i=((C=l[6].first_name)!=null?C:"")+"")&&_e(s,i),(!p||L&1)&&c!==(c=((O=l[6].last_name)!=null?O:"")+"")&&_e(m,c),l[6].username?h?h.p(l,L):(h=$l(l),h.c(),h.m(e,u)):h&&(h.d(1),h=null)},i(M){p||(M&&Ee(()=>{_||(_=Me(e,Ce,{},!0)),_.run(1)}),p=!0)},o(M){M&&(_||(_=Me(e,Ce,{},!1)),_.run(0)),p=!1},d(M){M&&N(e),h&&h.d(),M&&_&&_.end(),k=!1,w()}}}function _i(l){let e,t,n,i;const s=[di,ui],r=[];function o(a,f){return a[1]?0:1}return t=o(l),n=r[t]=s[t](l),{c(){e=y("div"),n.c(),b(e,"class","flex list flex_grow_1 svelte-1n771m2")},m(a,f){z(a,e,f),r[t].m(e,null),i=!0},p(a,[f]){let c=t;t=o(a),t===c?r[t].p(a,f):(he(),R(r[c],1,1,()=>{r[c]=null}),ve(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),j(n,1),n.m(e,null))},i(a){i||(j(n),i=!0)},o(a){R(n),i=!1},d(a){a&&N(e),r[t].d()}}}function gi(l,e,t){let{api:n}=e,i=[],s=!1;const r=async()=>{var f,c;t(1,s=!0),t(0,i=(c=(f=await n.operator_GetList())==null?void 0:f.results)!=null?c:[]),t(1,s=!1)};let o=!1;const a=f=>c=>{o||(_n(f),o=!0)};return r(),l.$$set=f=>{"api"in f&&t(3,n=f.api)},[i,s,a,n]}class pi extends ke{constructor(e){super(),ye(this,e,gi,_i,me,{api:3})}}const mi=l=>typeof l=="number"&&String(l|0)===String(l);class hn extends Error{}const We=async(l,e=null)=>{try{return await l()}catch{}return e},Gt=l=>async e=>{if(await We(()=>e.response.status===l))return e;throw new Error(`Invalid response status, expected ${l}`)},hi=Gt(200),vi=Gt(201),wi=Gt(204),bi=async l=>{if(await We(()=>mi(l.result.count)&&Array.isArray(l.result.results)))return l;throw new Error("Invalid result, expected list container")},Tt=async l=>{if(await We(()=>l.result.detail==="Authentication credentials were not provided.")===!0)throw new hn("Not authorized");return l},Ot=async l=>({...l,result:l.response.status===204?null:await l.response.json()}),yi=(l,e)=>{var a,f,c;const t=(a=l==null?void 0:l.protocol)!=null?a:location.protocol,n=(f=l==null?void 0:l.host)!=null?f:location.host,i=(c=l==null?void 0:l.path_base)!=null?c:"/",s=`${t}//${n}/${i}`,r=new Set(["POST","PATCH","PUT"]),o={...e!=null?e:{},"content-type":"application/json"};return(m,d,u)=>{const _=m.toUpperCase().trim(),p=d!=null?d:"",k=u!=null?u:{},w=new URL(s);_==="GET"&&Object.entries(k).map(([v,E])=>w.searchParams.append(v,E)),w.pathname=[w.pathname,p].join("/").split("/").filter(Boolean).concat(" ").filter(Boolean).join("/").trim();const h=r.has(_)?JSON.stringify(k):null;return new Request(w,{method:_,headers:o,body:h})}},ki=(l,e,t)=>{var _,p,k;const n=yi(l,e.operator?{"x-username":e.operator}:{}),i=(_=e.onerror)!=null?_:it,s=(p=e.onnotify)!=null?p:it,r=(k=e.onNotAuthorizedError)!=null?k:it,o=t!=null?t:(w,h)=>h(),a=async([w,h,v],E)=>{let M=null,L=null,C={},O=null,S=!1;try{C.request=M=n(w,h,v),C.response=L=await o({request:M,method:w,path:h,options:v},()=>fetch(M));for(const P of E)C=await P(C)}catch(P){O=P,S=!0}await We(()=>{O instanceof hn&&r()});const T=[];return T.push(...await We(async()=>{const P=new URL(M.url);return[{type:"normal",chunks:[{color:"#fff",text:M.method},{color:"#000",text:`${P.pathname}${String(P.searchParams)?"?"+P.searchParams:""}`},{color:"#f00",text:await We(()=>L.status,"")}]},{type:"mini",text:`${P.protocol}//${P.host}`}]},[`${w} ${h}`])),T.push(await We(()=>M.body?"Body: "+JSON.stringify(v).slice(0,100):"")),T.push(await We(()=>C.result.detail?`Detail: ${C.result.detail}`:"")),T.push(Gn(O)),S?i(T):s(T),!S&&C.hasOwnProperty("result")?C.result:null},f=[Ot,Tt,vi],c=[Ot,Tt,hi],m=[Ot,Tt,wi],d=[...c,bi],u={};return u.message_GetList=w=>a(["GET","messages",w],d),u.message_Create=(w,h)=>a(["POST","messages",{dialog:w,text:h,is_read:!0}],f),u.dialog_GetList=w=>a(["GET","dialogs",w],d),u.dialog_SetTags=(w,h)=>a(["PATCH",`dialogs/${w}`,{tag:h}],c),u.dialog_SetReadFlagAllMessages=w=>a(["POST",`dialogs/${w}/read`,{}],m),u.lead_GetUnassignedList=w=>a(["GET","leads/unassigned",w],d),u.lead_AssignOperatorSelft=w=>a(["POST",`leads/${w}/assign`,{}],c),u.lead_SetStatus=(w,h)=>a(["PATCH",`leads/${w}`,{status:h}],c),u.operatorSelf_GetOnlineInfo=()=>a(["GET","online",{}],c),u.operatorSelf_SetOnlineFlag=w=>a(["PUT","online",{online:!!w}],c),u.operator_GetList=w=>a(["GET","operators",w],d),u},Li=()=>{const l=()=>!0,e=I=>new Promise(D=>setTimeout(D,I)),t=(I,D)=>e(I+Math.round(Math.random()*(D-I))),n=(I,D,B)=>Math.min(B,Math.max(I,D)),i=(I=0)=>new Date(Date.now()+(I!=null?I:0)).toJSON(),s=(I,D)=>{var ie;const B=Math.max(0,(D==null?void 0:D.offset)|0),U=n(1,((ie=D==null?void 0:D.limit)!=null?ie:20)|0,1e6),W=I.length,q=I.slice(B,B+U);return{count:W,results:q}};let r=1;const o=I=>(I!=null?I:[]).map(D=>({...D,id:r++}));let a=1;const f=[],c={},m=I=>{var D;return(D=c[I])!=null?D:null},d=()=>f,u=I=>{var B,U,W;const D={operator_id:a++,username:(B=I.username)!=null?B:null,first_name:(U=I.first_name)!=null?U:null,last_name:(W=I.last_name)!=null?W:null};return f.push(D),c[D.username]=D,x(D.username),D};let _=123123124;const p=[],k={},w=I=>{var D;return(D=k[I])!=null?D:null},h=()=>p.filter(I=>!I.hasOperator).sort((I,D)=>I._date_joined_msec-D._date_joined_msec),v=I=>{var U,W,q;const D=_++,B={tg_id:D,username:(U=I.username)!=null?U:null,first_name:(W=I.first_name)!=null?W:null,last_name:(q=I.last_name)!=null?q:null,date_joined:i(I.timeDelta),esub:null,pub_id:null,refcode:null,subpub:null,hasOperator:!1,status:"NW",ref_link:`https://ref.global.com/getRef?tg_id=${D}`};return B._date_joined_msec=+new Date(B.date_joined),p.push(B),k[B.tg_id]=B,B},E=(I,D)=>{const B=w(D);return!B||!m(I)||B.hasOperator?!1:(P(I,D),B.hasOperator=!0,!0)},M=(I,D,B)=>{const U=w(D);return U?(B.status&&(U.status=B.status),U):null};let L=1;const C=[],O={},S=I=>{var D;return(D=O[I])!=null?D:null},T=(I,D=[])=>{I.tag||(I.tag=[],I._tagSearch=new Set);const B=o(D);I.tag.splice(0,1e9),I._tagSearch.clear(),B.map(U=>{I.tag.push(U),I._tagSearch.add(U.title)})},P=(I,D)=>{const B=w(D);if(!B||!m(I))return null;const W={id:L++,lead_id:D,lead:B,operator:I,unread_messages_count:0,last_message:null};return T(W),C.push(W),O[W.id]=W,B.hasOperator=!0,W},G=(I,D,B)=>{const U=S(D);return U?(B.tag&&T(U,B.tag),U):null},F=(I,D,B)=>{const U=S(D);return U?(we(I,{dialog_id:+D}).map(q=>q.is_read=!1),U.unread_messages_count=0,!0):null},V=(I,D={})=>{const B=Q=>Q.last_message?Q.last_message._received_at_msec:Q.lead?Q.lead._date_joined_msec:0,U=(Q,Te)=>Te-Q,W=(Q,Te)=>{let De=U(B(Q),B(Te));return De===0&&(De=U(Q.id,Te.id)),De},q=C.filter(Q=>Q.operator===I).filter(D.tag?Q=>Q._tagSearch.has(D.tag):l).filter(Q=>{var Te;return((Te=Q==null?void 0:Q.lead)==null?void 0:Te.status)!=="DL"});let ie=[],oe=[];return D.unread_first?(ie=q.filter(Q=>Q.unread_messages_count!==0),oe=q.filter(Q=>Q.unread_messages_count===0)):ie=q,ie.sort(W),oe.sort(W),ie.concat(oe)};let le=1;const te=[],J={},se=(I,D={})=>{var ie,oe,Q;const B=+D.dialog,U=D.text,W=S(B);if(!W)return null;const q={id:le++,dialog:B,text:U,is_read:(ie=D.is_read)!=null?ie:!0,incoming:(oe=D.incoming)!=null?oe:!1,attachments:(Q=D.attachments)!=null?Q:[],received_at:i(D.timeDelta)};return q._received_at_msec=+new Date(q.received_at),te.push(q),J[q.id]=q,W.last_message=q,q.is_read||W.unread_messages_count++,q},we=(I,D={})=>te.filter(D.dialog_id?B=>B.dialog===D.dialog_id:l),Y=5*60*1e3,ue={},be=I=>{var D;return(D=ue[I])!=null?D:null},x=(I,D={})=>{const U={online:!!D.online,offline_at:i(Y),interval:Math.round(Y/1e3)};return ue[I]=U,U},Z=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.webp","9.webp","10.png","11.png","13.png","12.webp"],ne=`\u0414\u0430, \u043C\u0451\u0440\u0442\u0432.
\u0411\u0435\u0434\u0441\u0442\u0432\u0438\u0435, \u0443\u0433\u0440\u043E\u0436\u0430\u044E\u0449\u0435\u0435 \u0436\u0438\u0437\u043D\u0438 \u0434\u0435\u0432\u0443\u0448\u043A\u0438, \u0438\u0441\u0447\u0435\u0437\u043B\u043E, \u0441\u043B\u043E\u0432\u043D\u043E \u044D\u0442\u043E \u0431\u044B\u043B\u0430 \u043A\u0430\u043A\u0430\u044F-\u0442\u043E \u0448\u0443\u0442\u043A\u0430. \u041D\u043E \u043E\u043D\u0430 \u043D\u0435 \u043C\u043E\u0433\u043B\u0430 \u0440\u0430\u0434\u043E\u0432\u0430\u0442\u044C\u0441\u044F, \u0432\u0435\u0434\u044C \u0421\u043C\u0435\u0440\u0442\u044C \u0441\u043C\u0435\u043D\u0438\u043B\u0430 \u0441\u0432\u043E\u044E \u0444\u043E\u0440\u043C\u0443 \u0438 \u043F\u0440\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432 \u0431\u043E\u043B\u0435\u0435 \u044F\u0432\u043D\u043E\u043C \u0432\u0438\u0434\u0435.
\u041F\u043E\u0434 \u0432\u0437\u0433\u043B\u044F\u0434\u043E\u043C \u043D\u0430\u043F\u0443\u0433\u0430\u043D\u043D\u043E\u0439 \u0434\u0435\u0432\u0443\u0448\u043A\u0438 \u0421\u043C\u0435\u0440\u0442\u044C \u0434\u0432\u0438\u043D\u0443\u043B\u0430\u0441\u044C \u0432 \u0435\u0451 \u0441\u0442\u043E\u0440\u043E\u043D\u0443. \u0422\u044C\u043C\u0430 \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439 \u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0433\u0443\u0449\u0430\u0442\u044C\u0441\u044F.
\u0422\u044C\u043C\u0430... \u043E\u043D\u0430 \u0441\u0435\u0439\u0447\u0430\u0441 \u043C\u0435\u043D\u044F \u043F\u0440\u043E\u0433\u043B\u043E\u0442\u0438\u0442, \u2014 \u043F\u043E\u0434\u0443\u043C\u0430\u043B\u0430 \u0434\u0435\u0432\u0443\u0448\u043A\u0430 \u0438 \u0435\u0449\u0451 \u043A\u0440\u0435\u043F\u0447\u0435 \u043E\u0431\u043D\u044F\u043B\u0430 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443. \u041E\u043D\u0430 \u0443\u0436\u0435 \u0434\u0430\u0436\u0435 \u0438 \u043D\u0435 \u0434\u0443\u043C\u0430\u043B\u0430 \u0431\u0435\u0436\u0430\u0442\u044C. \u0411\u0443\u0434\u044C \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u0438\u043A \u0447\u0435\u043B\u043E\u0432\u0435\u043A\u043E\u043C, \u043E\u043D\u0430 \u0431\u044B \u0435\u0449\u0435 \u043C\u043E\u0433\u043B\u0430 \u043D\u0430 \u0447\u0442\u043E-\u0442\u043E \u043D\u0430\u0434\u0435\u044F\u0442\u044C\u0441\u044F. \u041D\u043E \u043D\u0435\u0447\u0442\u043E, \u0432\u043E\u0437\u0432\u044B\u0448\u0430\u044E\u0449\u0435\u0435\u0441\u044F \u043F\u0435\u0440\u0435\u0434 \u043D\u0435\u0439, \u0441 \u043B\u0435\u0433\u043A\u043E\u0441\u0442\u044C\u044E \u0440\u0430\u0437\u0432\u0435\u044F\u043B\u043E \u0442\u0430\u043A\u0438\u0435 \u043C\u044B\u0441\u043B\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0445\u043E\u0442\u044F \u0431\u044B \u0434\u0430\u0440\u0443\u0439 \u043C\u043D\u0435 \u0431\u0435\u0437\u0431\u043E\u043B\u0435\u0437\u043D\u0435\u043D\u043D\u0443\u044E \u0441\u043C\u0435\u0440\u0442\u044C.
\u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u043C\u043E\u043B\u0438\u0442\u044C\u0441\u044F.
\u041C\u0430\u043B\u044B\u0448\u043A\u0430 \u0443\u0446\u0435\u043F\u0438\u043B\u0430\u0441\u044C \u0437\u0430 \u0435\u0451 \u0442\u0430\u043B\u0438\u044E, \u0434\u0440\u043E\u0436\u0430 \u043E\u0442 \u0443\u0436\u0430\u0441\u0430. \u0421\u043F\u0430\u0441\u0442\u0438 \u0441\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0443... \u043D\u043E \u044D\u0442\u043E \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E. \u041E\u043D\u0430 \u043C\u043E\u0433\u043B\u0430 \u043B\u0438\u0448\u044C \u0438\u0437\u0432\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u0437\u0430 \u0441\u0432\u043E\u0451 \u0431\u0435\u0441\u0441\u0438\u043B\u0438\u0435. \u0421\u0435\u0441\u0442\u0440\u0451\u043D\u043A\u0430, \u0442\u044B \u043D\u0435 \u0431\u0443\u0434\u0435\u0448\u044C \u043E\u0434\u0438\u043D\u043E\u043A\u0430, \u044F \u043F\u043E\u0439\u0434\u0443 \u0441 \u0442\u043E\u0431\u043E\u0439.
\u0418 \u0442\u043E\u0433\u0434\u0430...`;let re=1;const Le=(I=null,D=null)=>(I=I!=null?I:Math.random()*Z.length|0,D=D!=null?D:D=["IM","DC"][Math.random()*2|0],{file:re++,file_type:D,url:`assets/img-test/${Z[I]}`});(async()=>{const I=(W,q)=>{const ie=q/W;let oe=-(q+ie);return()=>(oe+=ie,oe)};let D=1;const B=(W=0)=>{let q=Math.random()<.5,ie=Math.random()<.5,oe=Math.random()<.5;!q&&!ie&&!oe&&(q=!0),q=ie=oe=!0;const Q=(D++).toString(36);return v({username:q?`test_lead_${Q}`:null,first_name:ie?`F${Q}`:null,last_name:oe?`L${Q}`:null,timeDelta:W})},U=(W,q,ie=0)=>{se(W,{dialog:q,text:`\u041F\u0440\u0438\u0432\u0435\u0442 @${W}. \u042F \u043D\u043E\u0432\u044B\u0439 \u043B\u0438\u0434, \u0432\u043E\u0442.`,is_read:!1,incoming:!0,timeDelta:ie});for(let oe=0;oe<Math.round(Math.random()*Z.length);oe++){const Q=Le(oe);se(W,{dialog:q,text:`${Q.file_type==="IM"?"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430":"\u0424\u0430\u0439\u043B"} ${oe+1}.`,is_read:!1,incoming:!0,attachments:[Q],timeDelta:ie+oe*1e3})}};for(let W=0;W<10;W++){const ie=[10,100,1e3,5e3,7e3,1e4,1e4,1e5,2,3,5,7,8,10][W],oe=`op_test_${W}`;u({username:oe,first_name:"OpNumDlgs",last_name:ie+""});let Q=0;const Te=I(ie,6e4*ie);for(let De=0;De<ie;De++){const ee=Te(),de=B(ee),Ae=P(oe,de.tg_id);Math.random()<.5&&Q++<5&&U(oe,Ae.id,ee)}}for(;;)await t(1e3,1e4),B()})();const Ie=(I,D,B)=>{const U=q=>{q&&x(B)},W=async q=>{await t(1e3,1e4);const ie=D.text.match(/without_text/i),oe=D.text.match(/long_text/i),Q=D.text.match(/allimg|allfile/i),Te=ie?"":oe?ne:`\u042D\u0445\u043E \u043E\u0442\u0432\u0435\u0442 \u0434\u043B\u044F @${B}.
"${D.text}"`;if(Q){const ee=D.text.match(/allimg/i)?"IM":"DC";for(let de=0;de<Z.length;de++)se(B,{dialog:D.dialog,text:Te,is_read:!1,incoming:!0,attachments:[Le(de,ee)]});return}const De=[];D.text.match(/img/i)?De.push(Le(null,"IM")):D.text.match(/file/i)&&De.push(Le(null,"DC")),se(B,{dialog:D.dialog,text:Te,is_read:!1,incoming:!0,attachments:De})};I("GET","operators",200,()=>s(d(),D)),I("GET","online",200,()=>be(B)),I("PUT","online",200,()=>x(B,D)),I("GET","leads/unassigned",200,()=>s(h(),D)),I("POST",/^leads\/(\d+)\/assign$/,200,q=>E(B,q),[U]),I("PATCH",/^leads\/(\d+)$/,200,q=>M(B,q,D),[U]),I("GET","dialogs",200,()=>s(V(B,D),D)),I("POST",/^dialogs\/(\d+)\/read$/,204,q=>F(B,q)),I("PATCH",/^dialogs\/(\d+)$/,200,q=>G(B,q,D),[U]),I("GET","messages",200,()=>s(we(B,D),D)),I("POST","messages",201,()=>se(B,D),[U,W])},pe=I=>{var De,ee,de,Ae,tt;const D=((De=I==null?void 0:I.method)!=null?De:"").toUpperCase().trim(),B=((ee=I==null?void 0:I.path)!=null?ee:"").split("/").map(Oe=>Oe.trim()).filter(Boolean).join("/"),U=Object.fromEntries(Object.entries((de=I==null?void 0:I.headers)!=null?de:{}).map(Oe=>[Oe[0].toLowerCase(),Oe[1]])),W=(Ae=I==null?void 0:I.options)!=null?Ae:{},q=(tt=U["x-username"])!=null?tt:null,ie=[];Ie((Oe,Je,ft,ct,ut=[])=>ie.push({method:Oe,pathPattern:Je,cb:ct,status:ft,mwList:ut}),W,q);const Q=ie.map(Oe=>{if(Oe.method===D){if(Oe.pathPattern instanceof RegExp){const Je=B.match(Oe.pathPattern);return Je?{...Oe,args:Je.slice(1)}:!1}return Oe.pathPattern===B?{...Oe,args:[]}:!1}}).filter(Boolean)[0];if(!Q)return null;const Te=Q.cb(...Q.args);return Q.mwList&&Q.mwList.map(Oe=>Oe(Te,q,W)),{status:Q.status,result:Te}};try{self.addEventListener("message",({data:{rpcID:I,data:D}})=>{let B,U;try{B=pe(D)}catch(W){U=W.message}self.postMessage({rpcID:I,result:B,error:U})})}catch{}return{request:pe}},Si=()=>{const l=`( ${Li.toString()} )()`,e=new Blob([l],{type:"text/javascript"}),t=new Worker(window.URL.createObjectURL(e));let n=1;const i={};return t.addEventListener("message",({data:{rpcID:o,result:a,error:f}})=>{const c=i[o];delete i[o],f&&c.reject(new Error(f)),c.resolve(a)}),{request:o=>{const a=n++,f=i[a]=Bt();return t.postMessage({rpcID:a,data:o}),f.promise},destroy:()=>t.terminate()}};function Mi(l){let e,t,n,i,s;return t=new ci({props:{operatorSelf:l[0],config:l[2],notifyEvents:l[1],createApi:l[3]}}),{c(){e=y("div"),ge(t.$$.fragment),b(e,"class","pos_rel flex")},m(r,o){z(r,e,o),fe(t,e,null),n=!0,i||(s=$e(ot.call(null,e)),i=!0)},p(r,o){const a={};o&1&&(a.operatorSelf=r[0]),t.$set(a)},i(r){n||(j(t.$$.fragment,r),n=!0)},o(r){R(t.$$.fragment,r),n=!1},d(r){r&&N(e),ce(t),i=!1,s()}}}function Ti(l){let e,t,n,i,s;return e=new Jn({props:{select:"operators"}}),i=new pi({props:{api:l[4]}}),{c(){ge(e.$$.fragment),t=A(),n=y("div"),ge(i.$$.fragment),b(n,"class","flex")},m(r,o){fe(e,r,o),z(r,t,o),z(r,n,o),fe(i,n,null),s=!0},p:ae,i(r){s||(j(e.$$.fragment,r),j(i.$$.fragment,r),s=!0)},o(r){R(e.$$.fragment,r),R(i.$$.fragment,r),s=!1},d(r){ce(e,r),r&&N(t),r&&N(n),ce(i)}}}function Oi(l){let e,t,n,i,s,r;const o=[Ti,Mi],a=[];function f(c,m){return c[0]?1:0}return t=f(l),n=a[t]=o[t](l),s=new ts({props:{events:l[1]}}),{c(){e=y("main"),n.c(),i=A(),ge(s.$$.fragment),b(e,"class","flex flex_clm flex_grow_1 pos_rel overhide svelte-l8w6xt")},m(c,m){z(c,e,m),a[t].m(e,null),g(e,i),fe(s,e,null),r=!0},p(c,[m]){let d=t;t=f(c),t===d?a[t].p(c,m):(he(),R(a[d],1,1,()=>{a[d]=null}),ve(),n=a[t],n?n.p(c,m):(n=a[t]=o[t](c),n.c()),j(n,1),n.m(e,i))},i(c){r||(j(n),j(s.$$.fragment,c),r=!0)},o(c){R(n),R(s.$$.fragment,c),r=!1},d(c){c&&N(e),a[t].d(),ce(s)}}}function Ii(l,e,t){let n;Se(l,kt,f=>t(0,n=f));const i=Ut(),s=g_Config,o=(f=>{var u;const c=((u=f.testMode)!=null?u:!0)&&!un().has("real-api");let m=()=>null,d=f.api;if(c){const _=Si();Be(_.destroy),d={protocol:"https:",host:"test.mode.dev",path_base:"api/"},m=()=>async({method:p,path:k,options:w,request:h})=>{const v=Object.fromEntries([...h.headers]),{status:E,result:M}=await _.request({method:p,path:k,options:w,headers:v});return{status:E,json:()=>M}}}return(_=null)=>ki(d,{onerror:p=>i.emit("error",p),onnotify:p=>i.emit("debug",p),onNotAuthorizedError:()=>Ge(kt,n=null,n),operator:_},m())})(s),a=o();return[n,i,s,o,a]}class Di extends ke{constructor(e){super(),ye(this,e,Ii,Oi,me,{})}}new Di({target:document.getElementById("app")});
